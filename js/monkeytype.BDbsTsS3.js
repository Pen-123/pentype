const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/firebase-config-live.R96vBKIB.js","js/monkeytype-packages.wuwULPqP.js","js/vendor.DVxhWSpD.js","js/vendor-firebase.B_LZ9FeP.js"])))=>i.map(i=>d[i]);
import"./modulepreload-polyfill.C6WOKFkE.js";import{e as lt,a as G,p as Lo,c as ie,t as et,b as Kn,s as Z,h as N,d as Rt,f as ke,g as jn,r as $o,i as _b,j as QC,k as YC,m as JC,n as Xs,z as XC,o as Sa,q as Gn,u as ZC,v as Eb,w as qb,x as rn,y as ek,A as Ib,B as Po,C as tk,D as ak,E as ur,F as ri,G as xa,H as ok,I as Qn,J as ik,K as nk,L as Fb,M as Tg,N as sk,O as rk,P as lk,Q as Lg,R as ck,S as dk,T as $g,U as id,V as uk,W as fk,X as mp,Y as pk}from"./misc.BHCZGzFC.js";/* empty css              */import{h as H,y as Wt,k as mk,C as qu,q as gk,S as hk,a as Pb,g as Bb,f as fe,c as fr,b as Rb,d as nd,t as bk,E as Cs,s as Dl,T as zr,M as Hr,e as Db,i as Wl,V as yk,N as ht,j as Wb,l as vk,m as Zs,x as Iu,n as Zd,o as zb,p as wk,r as Ck,z as gp,u as kk,v as uc,w as yl,I as Sk,A as xk,B as Or,D as fc,R as Hb,F as Ob,L as Tk,G as sd,H as Lk,J as $k,K as Mk,O as Ak,P as _k,Q as Ek,U as qk,W as Ik,X as Fk,Y as Pk,Z as Bk,_ as Rk}from"./monkeytype-packages.wuwULPqP.js";import{d as Mt,b as W,c as Dk,t as Wk,U as Na,e as zk,s as Hk,f as Fu,j as Ok,k as Mn,m as Nk,n as Uk,p as Vk,q as Kk,r as J,u as Mg,v as jk,w as Ag,x as Gk,y as Qk,z as q,A as Ze,H as pc,C as ca,B as Yk,D as Jk,E as Xk,F as Zk,L as e2,G as t2,I as a2,P as o2,S as i2,T as n2,J as s2,K as r2,M as l2,N as c2,O as d2,Q as Ei,R as _g,V as Nb,W as u2,X as f2,Y as Ge,_ as Ub,$ as Vb,a0 as hp,a1 as Kb,a2 as jb,a3 as p2,a4 as m2,a5 as Gb,a6 as g2,a7 as h2,a8 as Qb,a9 as b2,aa as Eg,ab as Yb,ac as qg,ad as y2,ae as v2}from"./vendor.DVxhWSpD.js";import{g as w2,i as C2,a as k2,b as S2,c as x2,o as T2,s as L2,d as $2,e as M2,f as A2,h as _2,j as E2,k as bp,l as q2,F as I2,m as F2,n as P2,G as B2,p as R2,q as D2,u as Jb,t as yp,E as Xb,v as W2,w as z2,x as H2,y as O2}from"./vendor-firebase.B_LZ9FeP.js";import{$ as n}from"./vendor-jquery.pqbXaY2m.js";try{let e=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},t=new e.Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="43da0a22-e3e1-4c2d-bf0a-582f297dddb9",e._sentryDebugIdIdentifier="sentry-dbid-43da0a22-e3e1-4c2d-bf0a-582f297dddb9")}catch{}{let e=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};e._sentryModuleMetadata=e._sentryModuleMetadata||{},e._sentryModuleMetadata[new e.Error().stack]=Object.assign({},e._sentryModuleMetadata[new e.Error().stack],{"_sentryBundlerPluginAppKey:monkeytype-frontend":!0})}const ks={backendUrl:"https://api.monkeytype.com",recaptchaSiteKey:"6Lc-V8McAAAAAJ7s6LGNe7MBZnRiwbsbiWts87aj",clientVersion:"2025.11.19_19.00_8e9379203"},N2="modulepreload",U2=function(e){return"/"+e},Ig={},Nr=function(t,a,o){let i=Promise.resolve();if(a&&a.length>0){let d=function(u){return Promise.all(u.map(p=>Promise.resolve(p).then(g=>({status:"fulfilled",value:g}),g=>({status:"rejected",reason:g}))))};document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),c=l?.nonce||l?.getAttribute("nonce");i=d(a.map(u=>{if(u=U2(u),u in Ig)return;Ig[u]=!0;const p=u.endsWith(".css"),g=p?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${g}`))return;const m=document.createElement("link");if(m.rel=p?"stylesheet":N2,p||(m.as="script"),m.crossOrigin="",m.href=u,c&&m.setAttribute("nonce",c),document.head.appendChild(m),p)return new Promise((h,y)=>{m.addEventListener("load",h),m.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${u}`)))})}))}function s(l){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=l,window.dispatchEvent(c),!c.defaultPrevented)throw l}return i.then(l=>{for(const c of l||[])c.status==="rejected"&&s(c.reason);return t().catch(s)})};let Zb=!0;function eu(e){Zb=e}function zi(){return Zb}const ey=[];function V2(e){ey.push(e)}function Fg(){ey.forEach(e=>{try{e()}catch(t){console.error("Banner event subscriber threw an error"),console.error(t)}})}const ty=[];function K2(e){ty.push(e)}function j2(e,t,a){ty.forEach(o=>{try{o(e,t,a)}catch(i){console.error("Notification event subscriber threw an error"),console.error(i)}})}function pr(e){return e*parseFloat(getComputedStyle(document.documentElement).fontSize)}function tu(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ")}function Pg(e){const t=["","thousand","million","billion","trillion","quadrillion","quintillion","sextillion","septillion","octillion","nonillion","decillion"];let a=0,o=e;for(;o>=1e3;)o/=1e3,a++;const i=t[a]??"unknown";return{rounded:Math.round(o),roundedTo2:H(o),orderOfMagnitude:i}}function mc(e,t=1){if(e<1e3)return e.toFixed(t);const a=Math.floor(Math.log(e)/Math.log(1e3)),o="kmbtqQsSond".charAt(a-1);return(e/Math.pow(1e3,a)).toFixed(t)+o}function G2(e){let t=0,a=0,o=0,i=0,s=0,l=0,c=0;const d=e.length;if(d===0)return null;for(let h=0;h<d;h++)l=h+1,c=e[h],t+=l,a+=c,i+=l*l,o+=l*c,s++;const u=(s*o-t*a)/(s*i-t*t),p=a/s-u*t/s,g=[1,1*u+p],m=[d,d*u+p];return[g,m]}function Bg(e,t=10){return e!=null?parseInt(e,t):void 0}function Pu(){const e=n("#bannerCenter").height();n("#app").css("padding-top",e+pr(2)+"px"),n("#notificationCenter").css("margin-top",e+"px")}let Yn=0,Q2=0;class vp{constructor(t,a,o,i,s,l,c,d=()=>{},u){this.type=t,this.message=u?a:lt(a),this.level=o,this.important=i??!1,t==="banner"||t==="psa"?this.duration=s:s===void 0?o===-1?this.duration=0:this.duration=3e3:this.duration=s*1e3,this.customTitle=l,this.customIcon=c,this.id=Q2++,this.closeCallback=d}show(){let t="notice",a='<i class="fas fa-info-circle"></i>',o="Notice";if(this.level===1?(t="good",a='<i class="fas fa-check-circle"></i>',o="Success"):this.level===-1&&(t="bad",a='<i class="fas fa-times-circle"></i>',o="Error"),this.important&&(t+=" important"),this.customTitle!==void 0&&(o=this.customTitle),(this.type==="banner"||this.type==="psa")&&(a='<i class="fas fa-fw fa-bullhorn"></i>'),this.customIcon!==void 0&&(a=`<i class="fas fa-fw fa-${this.customIcon}"></i>`),this.type==="notification"){this.duration===0&&(Yn++,gc()),n("#notificationCenter .history").prepend(`
        <div class="notif ${t}" id=${this.id} style="opacity: 0;">
            <div class="message"><div class="title"><div class="icon">${a}</div>${o}</div>${this.message}</div>
        </div>
      `);const i=document.querySelector(`#notificationCenter .notif[id='${this.id}']`);if(i===null)return;const s=i.offsetHeight,l=G(250);W(i,{opacity:[0,1],duration:l/2,delay:l/2}),i?.addEventListener("click",()=>{this.hide(),this.closeCallback(),this.duration===0&&Yn--,gc()});const c=document.querySelector("#notificationCenter .history");W(c,{marginTop:{from:"-="+s,to:0},duration:l/2}),n(`#notificationCenter .notif[id='${this.id}']`).on("hover",()=>{n(`#notificationCenter .notif[id='${this.id}']`).toggleClass("hover")})}else if(this.type==="banner"||this.type==="psa"){let i=`<div class="icon lefticon">${a}</div>`,s=!1;/images\/.*/.test(this.customIcon)&&(s=!0,i=`<div class="icon lefticon"><i class="fas fa-fw fa-bullhorn"></i></div><div class="image" style="background-image: url(${this.customIcon})"></div>`),n("#bannerCenter").prepend(`
        <div class="${this.type} ${t} content-grid ${s?"withImage":""}" id="${this.id}">
        <div class="container">
          ${i}
          <div class="text">
            ${this.message}
          </div>
          ${this.duration>=0?`
          <div class="closeButton">
            <i class="fas fa-fw fa-times"></i>
          </div>
          `:`<div class="righticon">${a}</div>`}
        </div>
      </div>
      `),Pu(),Fg(),this.duration>=0&&n(`#bannerCenter .banner[id='${this.id}'] .closeButton, #bannerCenter .psa[id='${this.id}'] .closeButton`).on("click",()=>{this.hide(),this.closeCallback()}),/please (<a.*>)?refresh/i.test(this.message)&&(n(`#bannerCenter .banner[id='${this.id}'], #bannerCenter .psa[id='${this.id}']`).addClass("clickable"),n(`#bannerCenter .banner[id='${this.id}'], #bannerCenter .psa[id='${this.id}']`).on("click",()=>{window.location.reload()}))}this.duration>0&&setTimeout(()=>{this.hide()},this.duration+250)}hide(){if(this.type==="notification"){const t=document.querySelector(`#notificationCenter .notif[id='${this.id}']`),a=G(250);W(t,{opacity:{to:0,duration:a},height:{to:0,duration:a/2,delay:a/2},marginBottom:{to:0,duration:a/2,delay:a/2},onComplete:()=>{t.remove()}})}else(this.type==="banner"||this.type==="psa")&&(n(`#bannerCenter .banner[id='${this.id}'], #bannerCenter .psa[id='${this.id}']`).remove(),Pu(),Fg())}}function gc(){Yn>1?(n("#notificationCenter .clearAll").removeClass("invisible"),n("#notificationCenter .clearAll").slideDown(125)):Yn<1&&(n("#notificationCenter .clearAll").addClass("invisible"),n("#notificationCenter .clearAll").slideUp(125))}function f(e,t=0,a={}){j2(e,t,a.customTitle),new vp("notification",e,t,a.important,a.duration,a.customTitle,a.customIcon,a.closeCallback,a.allowHTML).show()}function Y2(e,t=-1,a="bullhorn",o=!1,i,s){const l=new vp("banner",e,t,!1,o?-1:0,void 0,a,i,s);return l.show(),l.id}function qi(e,t=-1,a="bullhorn",o=!1,i,s){const l=new vp("psa",e,t,!1,o?-1:0,void 0,a,i,s);return l.show(),l.id}function J2(){n("#notificationCenter .notif").remove(),Yn=0,gc()}const X2=Mt(100,Pu);n(window).on("resize",()=>{X2()});n("#notificationCenter .clearAll").on("click",()=>{n("#notificationCenter .notif.bad").each((e,t)=>{n(t)[0]?.click()}),Yn=0,gc()});const ay=[];function Z2(e){ay.push(e)}function eS(e,t){ay.forEach(a=>{try{a(e,t)}catch(o){console.error("Google Sign Up event subscriber threw an error"),console.error(o)}})}let zl,bt,Dn=!1,oy;const{promise:tS,resolve:aS}=Lo();async function oS(e){try{let t;const o=Object.assign({"./constants/firebase-config-live.ts":()=>Nr(()=>import("./firebase-config-live.R96vBKIB.js"),__vite__mapDeps([0,1,2,3]))})["./constants/firebase-config-live.ts"];if(o)t=(await o()).firebaseConfig;else throw new Error("No config file found. Make sure frontend/src/ts/constants/firebase-config.ts exists");oy=e,zl=S2().length===0?C2(t):k2(),bt=x2(zl);const i=window.localStorage.getItem("firebasePersistence")==="LOCAL";await wp(i,!1),T2(bt,async s=>{Dn||await e(!0,s)})}catch(t){zl=void 0,bt=void 0,console.error("Firebase failed to initialize",t),await e(!1,null)}finally{aS()}}function A(){return bt?.currentUser!==void 0&&bt?.currentUser!==null}function tt(){return bt?.currentUser??null}function iS(){return w2(zl)}function na(){return bt!==void 0}async function nS(){console.log("auth signout"),await bt?.signOut()}async function sS(e,t,a){if(bt===void 0)throw new Error("Authentication uninitialized");await wp(a,!0);const{data:o,error:i}=await Wt(_2(bt,e,t));if(i!==null)throw console.error(i),iy(i,"Failed to sign in with email and password");return o}async function rS(e,t){if(bt===void 0)throw new Error("Authentication uninitialized");await wp(t,!0),Dn=!0;const{data:a,error:o}=await Wt(E2(bt,e));if(o!==null)throw Dn=!1,console.log(o),iy(o,"Failed to sign in with popup");bp(a)?.isNewUser?eS(a,!0):(Dn=!1,await oy?.(!0,a.user))}async function lS(e,t){if(bt===void 0)throw new Error("Authentication uninitialized");return Dn=!0,await q2(bt,e,t)}async function cS(){const e=tt();return e===null?null:A2(e)}async function wp(e,t=!1){if(bt===void 0)throw new Error("Authentication uninitialized");const a=e?$2:M2;t&&window.localStorage.setItem("firebasePersistence",e?"LOCAL":"SESSION"),await L2(bt,a)}function iy(e,t){let a=ie(e,t);return e instanceof I2&&(e.code==="auth/wrong-password"?a="Incorrect password":e.code==="auth/user-not-found"?a="User not found":e.code==="auth/invalid-email"?a="Invalid email format (make sure you are using your email to login - not your username)":e.code==="auth/invalid-credential"?a="Email/password is incorrect or your account does not have password authentication enabled.":e.code==="auth/popup-closed-by-user"?a="":e.code==="auth/popup-blocked"?a="Sign in popup was blocked by the browser. Check the address bar for a blocked popup icon, or update your browser settings to allow popups.":e.code==="auth/user-cancelled"?a="":e.code==="auth/account-exists-with-different-credential"&&(a="Account already exists, but its using a different authentication method. Try signing in with a different method")),new Error(a,{cause:e})}function ny(){Dn=!1}let Rg=!1,sy;function dS(e){const t=new AbortController;return setTimeout(()=>t.abort(new Error("request timed out")),e),t.signal}function uS(e){return async t=>{try{const a=await cS();a!==null&&(t.headers.Authorization=`Bearer ${a}`);const o=AbortSignal?.timeout===void 0;t.fetchOptions={...t.fetchOptions,signal:o?dS(e):AbortSignal.timeout(e)};const i=await Wk(t);i.status>=400&&console.error(`${t.method} ${t.path} failed`,{status:i.status,...i.body});const s=i.headers.get(mk);if(s!==null&&(sy=parseInt(s)),s!==null&&!Rg){const l=parseInt(s);if(l!==qu){const c=l>qu?'Looks like the client and server versions are mismatched (backend is newer). Please <a onClick="location.reload(true)">refresh</a> the page.':"Looks like our monkeys didn't deploy the new server version correctly. If this message persists contact support.";qi(c,1,void 0,!1,void 0,!0),Rg=!0}}return i}catch(a){let o="Unknown error";return a instanceof Error&&(a.message.includes("timed out")?o="request took too long to complete":o=a.message),{status:500,body:{message:o},headers:new Headers}}}}function ry(e,t,a=1e4){return Dk(e,{baseUrl:t,jsonQuery:!0,api:uS(a),baseHeaders:{Accept:"application/json","X-Client-Version":ks.clientVersion}})}const ly=ks.backendUrl,fS=ry(gk,ly,1e4),pS=ry(hk,ly,24e4),T={...fS,dev:pS},cy=[];function mS(e){cy.push(e)}window.addEventListener("load",()=>{window.addEventListener("online",()=>{Dg(!0)}),window.addEventListener("offline",()=>{Dg(!1)})});function Dg(e){cy.forEach(t=>{try{t(e)}catch(a){console.error("Connection event subscriber threw an error"),console.error(a)}})}let ba=!1,Hi=!1,we=!1,It=null,Ur=!0,ki=!1,Bu=1,le=0,dy=!0,da=!1,li=!1,zt=!1,ce=!1;function uy(e){ba=e}function gS(e){Hi=e}function Cp(e){we=e}function fy(e){It=e}function Wg(e){Ur=e}function kp(e){ki=e}function Sp(e){Bu=e}function hS(e){le=e}function zg(){le++}function bS(){le--}function py(e){dy=e}function yS(e){da=e}function vS(e){li=e}let{promise:wS,resolve:Hg}=Lo();function Hl(e){zt=e,e?{promise:wS,resolve:Hg}=Lo():Hg()}function my(e){ce=e}let mr=navigator.onLine;function Xe(){return mr}let er,Ru=!1;function rd(){Ru||er===void 0&&(er=qi("No internet connection",0,"exclamation-triangle",!1,()=>{Ru=!0,er=void 0}))}const CS=Mt(5e3,()=>{mr?(er!==void 0&&(f("You're back online",1,{customTitle:"Connection"}),n(`#bannerCenter .psa.notice[id="${er}"] .closeButton`).trigger("click")),Ru=!1):we||rd()});mS(e=>{mr=e,CS()});window.addEventListener("load",()=>{mr=navigator.onLine,mr||rd()});function Og(e,t){if(Array.isArray(e))return t.length===e.length?void 0:e.filter((a,o)=>!t.includes(o));{const a=Object.entries(e);return t.length===a.length?void 0:Object.fromEntries(a.filter(([o])=>!t.includes(o)))}}function kS(e,t){return t.slice(0,-1).reduce((a,o)=>a[o],e)}function xp(e,t){let o,i=structuredClone(t);for(let l=0;l<=2;l++){if(o=e.safeParse(i),o.success)return o.data;if(l===2)break;const c=o.error.errors.reduce((d,{path:u})=>{const p=u.slice(0,-1).join("."),g=u.at(-1);return g!==void 0&&d.set(p,[...d.get(p)??[],g]),d},new Map);for(const[d,u]of c.entries())if(d==="")i=Og(i,u)??(Array.isArray(i)?[]:{});else{const p=d.split("."),g=kS(i,p),m=p.at(-1),h=Og(g[m],u);h===void 0?delete g[m]:g[m]=h}}const s=o?.error.errors.map(l=>`${l.path.join(".")}: ${l.message}`).join(", ");throw new Error("unable to sanitize: "+s)}const SS={theme:"serika_dark",themeLight:"serika",themeDark:"serika_dark",autoSwitchTheme:!1,customTheme:!1,customThemeColors:["#323437","#e2b714","#e2b714","#646669","#2c2e31","#d1d0c5","#ca4754","#7e2a33","#ca4754","#7e2a33"],favThemes:[],showKeyTips:!0,smoothCaret:"medium",codeUnindentOnBackspace:!1,quickRestart:"off",punctuation:!1,numbers:!1,words:50,time:30,mode:"time",quoteLength:[1],language:"english",fontSize:2,freedomMode:!1,difficulty:"normal",blindMode:!1,quickEnd:!1,caretStyle:"default",paceCaretStyle:"default",flipTestColors:!1,layout:"default",funbox:[],confidenceMode:"off",indicateTypos:"off",timerStyle:"mini",liveSpeedStyle:"off",liveAccStyle:"off",liveBurstStyle:"off",colorfulMode:!1,randomTheme:"off",timerColor:"main",timerOpacity:"1",stopOnError:"off",showAllLines:!1,keymapMode:"off",keymapStyle:"staggered",keymapLegendStyle:"lowercase",keymapLayout:"overrideSync",keymapShowTopRow:"layout",keymapSize:1,fontFamily:"Roboto_Mono",smoothLineScroll:!1,alwaysShowDecimalPlaces:!1,alwaysShowWordsHistory:!1,singleListCommandLine:"on",capsLockWarning:!0,playSoundOnError:"off",playSoundOnClick:"off",soundVolume:.5,startGraphsAtZero:!0,showOutOfFocusWarning:!0,paceCaret:"off",paceCaretCustomSpeed:100,repeatedPace:!0,accountChart:["on","on","on","on"],minWpm:"off",minWpmCustomSpeed:100,highlightMode:"letter",typingSpeedUnit:"wpm",ads:"result",hideExtraLetters:!1,strictSpace:!1,minAcc:"off",minAccCustom:90,monkey:!1,repeatQuotes:"off",oppositeShiftMode:"off",customBackground:"",customBackgroundSize:"cover",customBackgroundFilter:[0,1,1,1],customLayoutfluid:["qwerty","dvorak","colemak"],customPolyglot:["english","spanish","french","german"],monkeyPowerLevel:"off",minBurst:"off",minBurstCustomSpeed:100,burstHeatmap:!1,britishEnglish:!1,lazyMode:!1,showAverage:"off",tapeMode:"off",tapeMargin:50,maxLineWidth:0,playTimeWarning:"off"};function $a(){return structuredClone(SS)}function ld(e){return xS(TS(LS(e)))}function xS(e){const t=$a(),a={};for(const o of et(t)){const i=e[o]??t[o];a[o]=i}return a}function TS(e){return xp(Pb.strip(),e)}function LS(e){if(e.quickTab===!0&&e.quickRestart===void 0&&(e.quickRestart="tab"),typeof e.smoothCaret=="boolean"&&(e.smoothCaret=e.smoothCaret?"medium":"off"),e.swapEscAndTab===!0&&e.quickRestart===void 0&&(e.quickRestart="esc"),e.alwaysShowCPM===!0&&e.typingSpeedUnit===void 0&&(e.typingSpeedUnit="cpm"),e.showAverage==="wpm"&&(e.showAverage="speed"),typeof e.playSoundOnError=="boolean"&&(e.playSoundOnError=e.playSoundOnError?"1":"off"),e.showTimerProgress===!1&&e.timerStyle===void 0&&(e.timerStyle="off"),e.showLiveWpm===!0&&e.liveSpeedStyle===void 0){let t="mini";e.timerStyle!=="bar"&&e.timerStyle!=="off"&&(t=e.timerStyle),e.liveSpeedStyle=t}if(e.showLiveBurst===!0&&e.liveBurstStyle===void 0){let t="mini";e.timerStyle!=="bar"&&e.timerStyle!=="off"&&(t=e.timerStyle),e.liveBurstStyle=t}if(e.showLiveAcc===!0&&e.liveAccStyle===void 0){let t="mini";e.timerStyle!=="bar"&&e.timerStyle!=="off"&&(t=e.timerStyle),e.liveAccStyle=t}if(typeof e.soundVolume=="string"&&(e.soundVolume=parseFloat(e.soundVolume)),typeof e.funbox=="string"&&(e.funbox==="none"?e.funbox=[]:e.funbox=e.funbox.split("#")),typeof e.customLayoutfluid=="string"&&(e.customLayoutfluid=e.customLayoutfluid.split("#")),typeof e.indicateTypos=="boolean"&&(e.indicateTypos=e.indicateTypos===!1?"off":"replace"),typeof e.fontSize=="string"){const t=e.fontSize;let a=parseInt(t);t==="125"?a=1.25:t==="15"&&(a=1.5),e.fontSize=a}else e.fontSize!==void 0&&e.fontSize<0&&(e.fontSize=1);if(Array.isArray(e.accountChart)&&e.accountChart.length!==4&&(e.accountChart=["on","on","on","on"]),typeof e.minAccCustom=="number"&&e.minAccCustom>100&&(e.minAccCustom=100),Array.isArray(e.customThemeColors)&&e.customThemeColors.length===9){const t=e.customThemeColors;t.splice(4,0,"#000000"),e.customThemeColors=t}if(Array.isArray(e.customBackgroundFilter)&&e.customBackgroundFilter.length===5){const t=e.customBackgroundFilter;e.customBackgroundFilter=[t[0],t[1],t[2],t[3]]}return typeof e.quoteLength=="number"&&(e.quoteLength===-1?e.quoteLength=[0,1,2,3]:e.quoteLength=[e.quoteLength]),e.tapeMargin!==void 0&&(e.tapeMargin<10?e.tapeMargin=10:e.tapeMargin>90&&(e.tapeMargin=90)),e.maxLineWidth!==void 0&&(e.maxLineWidth<20&&e.maxLineWidth!==0?e.maxLineWidth=20:e.maxLineWidth>1e3&&(e.maxLineWidth=1e3)),e}class tr{constructor(t,a,o,i=!1){this.firstDayOfWeek=o;const s=new Na(a),l=this.getInterval(s,i);this.startDay=l.start,this.endDay=l.end,this.data=this.buildData(t,s),this.isFullYear=i}getInterval(t,a=!1){const o=a?zk(t):new Na;let i=Hk(t);return a||(i=Fu(Ok(o),1),this.isFirstDayOfWeek(i)||(i=this.previousFirstDayOfWeek(i))),{start:i,end:o}}buildData(t,a){const o=new Array(Math.max(0,386-t.length)).fill(void 0);o.push(...t);const i=Mn(this.endDay,this.startDay)+1,s=o.length-i+Mn(this.endDay,a);return o.slice(s)}getMonths(){const t=Nk({start:this.startDay,end:this.endDay}),a=[];for(let o=0;o<t.length;o++){const i=t[o];let s=o===0?this.startDay:Uk(i),l=o===t.length-1?this.endDay:Vk(s);this.isFirstDayOfWeek(s)||(s=o===0?this.previousFirstDayOfWeek(s):this.nextFirstDayOfWeek(s)),this.isLastDayOfWeek(l)||(l=this.nextLastDayOfWeek(l));const c=Kk(l,s,{roundingMethod:"ceil"});c>2?a.push({text:J(i,"MMM").toLowerCase(),weeks:c}):o===0&&a.push({text:"",weeks:c})}return a}getDays(){const t=[],a=this.getBuckets(),o=l=>{if(l===void 0||l===null||l===0)return"0";for(let c=0;c<4;c++)if(l<=(a[c]??0))return(1+c).toString();return"4"};for(let l=0;l<this.startDay.getDay()-this.firstDayOfWeek;l++)t.push({level:"filler"});const i=Mn(this.endDay,this.startDay);let s=this.startDay;for(let l=0;l<=i;l++){const c=this.data[l],d=J(s,"EEEE dd MMM yyyy");t.push({level:o(c),label:c!=null?`${c} ${c===1?"test":"tests"} on ${d}`:`no activity on ${d}`}),s=Fu(s,1)}for(let l=this.endDay.getDay()-this.firstDayOfWeek;l<6;l++)t.push({level:"filler"});return t}getTotalTests(){const t=Mn(this.endDay,this.startDay);return this.data.slice(0,t+1).reduce((a,o)=>(a??0)+(o??0),0)??0}getBuckets(){const a=this.data.filter(l=>l!=null).sort((l,c)=>l-c),o=a.slice(Math.round(a.length*.1),a.length-Math.round(a.length*.1)),s=o.reduce((l,c)=>l+c,0)/o.length;return[Math.floor(s/2),Math.round(s),Math.round(s*1.5)]}isFirstDayOfWeek(t){return Mg(t).getDay()===this.firstDayOfWeek}previousFirstDayOfWeek(t){return jk(t,this.firstDayOfWeek)}nextFirstDayOfWeek(t){return Ag(t,this.firstDayOfWeek)}isLastDayOfWeek(t){return Mg(t).getDay()===(this.firstDayOfWeek+6)%7}nextLastDayOfWeek(t){return Ag(t,(this.firstDayOfWeek+6)%7)}}class $S extends tr{constructor(t,a,o){super(t,a,o),this.lastDay=new Na(a)}increment(t){const a=new Na(t),o=new Na(this.lastDay);if(Gk(a,o)){const i=this.data.length-1;this.data[i]=(Bb(this.data[i])??0)+1}else{if(Qk(a,o))throw new Error("cannot alter data in the past.");{const i=Mn(a,o)-1;for(let l=0;l<i;l++)this.data.push(void 0);this.data.push(1);const s=this.getInterval(a);this.startDay=s.start,this.endDay=s.end,this.lastDay=a}}this.data=this.buildData(this.data,this.lastDay)}getFullYearCalendar(){const t=new Date;return this.lastDay.getFullYear()!==new Na(t).getFullYear()?new tr([],t,this.firstDayOfWeek,!0):new tr(this.data,this.lastDay,this.firstDayOfWeek,!0)}}const MS={results:void 0,personalBests:{time:{},words:{},quote:{},zen:{},custom:{}},name:"",email:"",uid:"",isPremium:!1,config:$a(),customThemes:[],presets:[],tags:[],banned:void 0,verified:void 0,lbMemory:{time:{15:{english:0},60:{english:0}}},typingStats:{timeTyping:0,startedTests:0,completedTests:0},quoteRatings:void 0,quoteMod:!1,favoriteQuotes:{},addedAt:0,filterPresets:[],xp:0,inboxUnreadSize:0,streak:0,maxStreak:0,streakHourOffset:void 0,allTimeLbs:{time:{15:{english:{count:0,rank:0}},60:{english:{count:0,rank:0}}}},connections:{}};function Ng(){return structuredClone(MS)}function Ye(e,t=!1,a=!1,o=":",i=!0,s=!1){e=Math.abs(e);let l=0,c;s?(l=Math.floor(e/86400),c=Math.floor(e%86400/3600)):c=Math.floor(e/3600);const d=Math.floor(e%3600/60),u=H(e%3600%60);let p,g,m,h;s&&(l<10&&o!=="text"?p="0"+l:p=l),c<10&&o!=="text"?g="0"+c:g=c,d<10&&o!=="text"?m="0"+d:m=d,u<10&&(d>0||c>0||t)&&o!=="text"?h="0"+u:h=u;let y="";return l>0&&s&&(y+=p,o==="text"?l===1?y+=" day ":y+=" days ":y+=o),(c>0||a)&&(y+=g,o==="text"?c===1?y+=" hour ":y+=" hours ":y+=o),(d>0||c>0||t)&&(y+=m,o==="text"?d===1?y+=" minute ":y+=" minutes ":i&&(y+=o)),i&&(y+=h,o==="text"&&(u===1?y+=" second":y+=" seconds")),c===0&&d===0&&!i&&o==="text"&&(y="less than 1 minute"),y.trim()}const Ug={af:0,ar:6,arDZ:0,arEG:0,arMA:1,arSA:0,arTN:1,az:1,be:1,beTarask:1,bg:1,bn:0,bs:1,ca:1,ckb:0,cs:1,cy:0,da:1,de:1,deAT:1,el:1,enAU:1,enCA:0,enGB:1,enIE:1,enIN:1,enNZ:1,enUS:0,enZA:0,eo:1,es:1,et:1,eu:1,faIR:6,fi:1,fr:1,frCA:0,frCH:1,fy:1,gd:0,gl:1,gu:1,he:0,hi:0,hr:1,ht:1,hu:1,hy:1,id:1,is:1,it:1,itCH:1,ja:0,jaHira:0,ka:1,kk:1,km:0,kn:1,ko:0,lb:1,lt:1,lv:1,mk:1,mn:1,ms:1,mt:1,nb:1,nl:1,nlBE:1,nn:1,oc:1,pl:1,pt:1,ptBR:0,ro:1,ru:1,se:1,sk:1,sl:1,sq:1,sr:1,srLatn:1,sv:1,ta:1,te:0,th:0,tr:1,ug:0,uk:1,uz:1,uzCyrl:1,vi:1,zhCN:1,zhHK:0,zhTW:1};function gy(){if(navigator.language===void 0||navigator.language===null)return 0;const e=new Intl.Locale(navigator.language);if(e==null)return 0;if("weekInfo"in e)return e.weekInfo.firstDay%7;if("getWeekInfo"in e)return e.getWeekInfo().firstDay%7;let t=Ug[navigator.language.replaceAll("-","")];return t!==void 0||(t=Ug[navigator.language.split("-")[0]],t!==void 0)?t:0}const hy=[];function qa(e){hy.push(e)}function cd(e){hy.forEach(t=>{try{t(e)}catch(a){console.error("Auth event subscriber threw an error"),console.error(a)}})}let by;const{promise:Tp,resolve:AS,reject:_S}=Lo();function Ma(){return by}async function ES(){const e=await T.configuration.get();if(e.status!==200){const t=`Could not fetch configuration: ${e.body.message}`;console.error(t),_S(t);return}else by=e.body.data??void 0,AS(!0)}let O;const yy=gy();class Sn extends Error{constructor(t,a){super(t),this.responseCode=a,this.name="SnapshotInitError",this.responseCode=a}}function S(){return O}function at(e,t){const a=O?.banned,o=O?.verified,i=O?.lbOptOut;try{delete e?.banned}catch{}try{delete e?.verified}catch{}try{delete e?.lbOptOut}catch{}O=e,O&&(O.banned=a,O.verified=o,O.lbOptOut=i),t?.dispatchEvent!==!1&&cd({type:"snapshotUpdated",data:{isInitial:!1}})}async function qS(){const e=Ng();await Tp;try{if(!A())return!1;const t=Ma()?.connections.enabled?T.connections.get():{status:200,body:{message:"",data:[]}},[a,o,i,s]=await Promise.all([T.users.get(),T.configs.get(),T.presets.get(),t]);if(a.status!==200)throw new Sn(`${a.body.message} (user)`,a.status);if(o.status!==200)throw new Sn(`${o.body.message} (config)`,o.status);if(i.status!==200)throw new Sn(`${i.body.message} (presets)`,i.status);if(s.status!==200)throw new Sn(`${s.body.message} (connections)`,s.status);const l=a.body.data,c=o.body.data,d=i.body.data,u=s.body.data;if(l===null)throw new Sn("Request was successful but user data is null",200);if(c!==null&&"config"in c)throw new Error("Config data is not in the correct format. Please refresh the page or contact support.");e.name=l.name,e.personalBests=l.personalBests,e.personalBests??={time:{},words:{},quote:{},zen:{},custom:{}};for(const g of["time","words","quote","zen","custom"])e.personalBests[g]??={};e.banned=l.banned,e.lbOptOut=l.lbOptOut,e.verified=l.verified,e.discordId=l.discordId,e.discordAvatar=l.discordAvatar,e.needsToChangeName=l.needsToChangeName,e.typingStats={timeTyping:l.timeTyping??0,startedTests:l.startedTests??0,completedTests:l.completedTests??0},e.quoteMod=l.quoteMod,e.favoriteQuotes=l.favoriteQuotes??{},e.quoteRatings=l.quoteRatings,e.details=l.profileDetails,e.addedAt=l.addedAt,e.inventory=l.inventory,e.xp=l.xp??0,e.inboxUnreadSize=l.inboxUnreadSize??0,e.streak=l?.streak?.length??0,e.maxStreak=l?.streak?.maxLength??0,e.filterPresets=l.resultFilterPresets??[],e.isPremium=l?.isPremium??!1,e.allTimeLbs=l.allTimeLbs,l.testActivity!==void 0&&(e.testActivity=new $S(l.testActivity.testsByDays,new Date(l.testActivity.lastDay),yy));const p=l?.streak?.hourOffset;if(e.streakHourOffset=p??void 0,l.lbMemory!==void 0&&(e.lbMemory=l.lbMemory),c==null?e.config={...$a()}:e.config=ld(c),e.customThemes=l.customThemes??[],e.tags=l.tags?.map(g=>({...g,display:g.name.replaceAll("_"," ")}))??[],e.tags=e.tags?.sort((g,m)=>g.name>m.name?1:g.name<m.name?-1:0),d!=null){const g=d.map(m=>({...m,display:m.name.replace(/_/gi," ")}));e.presets=g,e.presets=e.presets?.sort((m,h)=>m.name>h.name?1:m.name<h.name?-1:0)}return e.connections=Sy(u),O=e,O}catch(t){throw O=Ng(),t}}async function Lp(e){if(!A()||!O||O.results!==void 0&&(e===void 0||O.results.length>e)||!Xe())return!1;const t=await T.results.get({query:{offset:e}});if(t.status!==200)return f("Error getting results: "+t.body.message,-1),!1;if(!A())return!1;const a=t.body.data.map(o=>(o.bailedOut===void 0&&(o.bailedOut=!1),o.blindMode===void 0&&(o.blindMode=!1),o.lazyMode===void 0&&(o.lazyMode=!1),o.difficulty===void 0&&(o.difficulty="normal"),o.funbox===void 0&&(o.funbox=[]),(o.language===void 0||o.language===null)&&(o.language="english"),o.numbers===void 0&&(o.numbers=!1),o.punctuation===void 0&&(o.punctuation=!1),o.numbers===void 0&&(o.numbers=!1),o.quoteLength===void 0&&(o.quoteLength=-1),o.restartCount===void 0&&(o.restartCount=0),o.incompleteTestSeconds===void 0&&(o.incompleteTestSeconds=0),o.afkDuration===void 0&&(o.afkDuration=0),o.tags===void 0&&(o.tags=[]),o));if(a?.sort((o,i)=>i.timestamp-o.timestamp),O.results!==void 0&&O.results.length>0){const o=Kn(O.results)?.timestamp,i=a.filter(s=>s.timestamp<o);O.results.push(...i)}else O.results=a;return!0}async function IS(e){if(!O)return!1;if(O.customThemes===void 0&&(O.customThemes=[]),O.customThemes.length>=20)return f("Too many custom themes!",0),!1;const t=await T.users.addCustomTheme({body:{...e}});if(t.status!==200)return f("Error adding custom theme: "+t.body.message,-1),!1;if(t.body.data===null)return f("Error adding custom theme: No data returned",-1),!1;const a={...e,_id:t.body.data._id};return O.customThemes.push(a),!0}async function FS(e,t){if(!A()||!O)return!1;O.customThemes===void 0&&(O.customThemes=[]);const a=O.customThemes?.find(s=>s._id===e);if(!a)return f("Editing failed: Custom theme with id: "+e+" does not exist",-1),!1;const o=await T.users.editCustomTheme({body:{themeId:e,theme:t}});if(o.status!==200)return f("Error editing custom theme: "+o.body.message,-1),!1;const i={...t,_id:e};return O.customThemes[O.customThemes.indexOf(a)]=i,!0}async function PS(e){if(!A()||!O||!O.customThemes?.find(o=>o._id===e))return!1;const a=await T.users.deleteCustomTheme({body:{themeId:e}});return a.status!==200?(f("Error deleting custom theme: "+a.body.message,-1),!1):(O.customThemes=O.customThemes?.filter(o=>o._id!==e),!0)}async function vy(e,t,a,o,i,s,l){const c=S();if(!c)return[0,0];function d(){const p=[];c?.tags?.forEach(w=>{w.active===!0&&p.push(w._id)});let g=0,m=0,h=0,y=0,C=0,M=0;if(c?.results!==void 0){for(const w of c.results)if(w.mode===e&&(w.punctuation??!1)===a&&(w.numbers??!1)===o&&w.language===i&&w.difficulty===s&&(w.lazyMode===l||w.lazyMode===void 0&&!l)&&(p.length===0||p.some(F=>w.tags?.includes(F)))){if(`${w.mode2}`!=`${t}`&&e!=="quote")continue;if(M<10&&(h+=w.wpm,y+=w.acc,M++),`${w.mode2}`==`${t}`&&(g+=w.wpm,m+=w.acc,C++,C>=10))break}}return C===0&&e==="quote"?[h/M,y/M]:[g/C,m/C]}return c===null||await Lp()===null?[0,0]:d()}async function BS(e,t,a,o,i,s,l){const c=S();if(!c)return 0;function d(){const p=[];c?.tags?.forEach(m=>{m.active===!0&&p.push(m._id)});let g=0;if(c?.results!==void 0){for(const m of c.results)if(m.mode===e&&(m.punctuation??!1)===a&&(m.numbers??!1)===o&&m.language===i&&m.difficulty===s&&(m.lazyMode===l||m.lazyMode===void 0&&!l)&&(p.length===0||p.some(h=>m.tags?.includes(h)))){if(m.timestamp<Date.now()-864e5||`${m.mode2}`!=`${t}`&&e!=="quote")continue;m.wpm>g&&(g=m.wpm)}}return g}return c===null||await Lp()===null?0:d()}async function RS(e,t,a,o,i,s,l){const c=S();if(!c)return 0;let d=0;for(const u of c.tags){if(!u.active)continue;const p=await wy(u._id,e,t,a,o,i,s,l);p>d&&(d=p)}return d}async function gr(e,t,a,o,i,s,l,c){return c.every(u=>u.canGetPb)?O?.personalBests?.[e]?.[t]?.find(u=>(u.punctuation??!1)===a&&(u.numbers??!1)===o&&u.difficulty===s&&u.language===i&&(u.lazyMode??!1)===l):void 0}function DS(e,t,a,o,i,s,l,c,d,u,p){if(e==="quote"||!O)return;function g(){if(!O)return;let m=!1;O.personalBests??={time:{},words:{},quote:{},zen:{},custom:{}},O.personalBests[e]??={[t]:[]},O.personalBests[e][t]??=[],O.personalBests[e][t].forEach(h=>{(h.punctuation??!1)===a&&(h.numbers??!1)===o&&h.difficulty===s&&h.language===i&&(h.lazyMode??!1)===l&&(m=!0,h.wpm=c,h.acc=d,h.raw=u,h.timestamp=Date.now(),h.consistency=p,h.lazyMode=l)}),m||O.personalBests[e][t].push({language:i,difficulty:s,lazyMode:l,punctuation:a,numbers:o,wpm:c,acc:d,raw:u,timestamp:Date.now(),consistency:p})}O!==null&&g()}async function wy(e,t,a,o,i,s,l,c){if(O===null)return 0;let d=0;const u=(S()?.tags??[]).find(g=>g._id===e);return u===void 0||(u.personalBests??={time:{},words:{},quote:{},zen:{},custom:{}},u.personalBests[t]??={[a]:[]},u.personalBests[t][a]??=[],d=(u.personalBests[t][a]??[]).find(g=>(g.punctuation??!1)===o&&(g.numbers??!1)===i&&g.difficulty===l&&g.language===s&&(g.lazyMode===c||g.lazyMode===void 0&&!c))?.wpm??0),d}async function WS(e,t,a,o,i,s,l,c,d,u,p,g){if(!O||t==="quote")return;function m(){const h=O?.tags?.find(y=>y._id===e);h.personalBests??={time:{},words:{},quote:{},zen:{},custom:{}},h.personalBests[t]??={[a]:[]},h.personalBests[t][a]??=[];try{let y=!1;h.personalBests[t][a].forEach(C=>{(C.punctuation??!1)===o&&(C.numbers??!1)===i&&C.difficulty===l&&C.language===s&&(C.lazyMode===c||C.lazyMode===void 0&&!c)&&(y=!0,C.wpm=d,C.acc=u,C.raw=p,C.timestamp=Date.now(),C.consistency=g,C.lazyMode=c)}),y||h.personalBests[t][a].push({language:s,difficulty:l,lazyMode:c,punctuation:o,numbers:i,wpm:d,acc:u,raw:p,timestamp:Date.now(),consistency:g})}catch{h.personalBests={time:{},words:{},quote:{},zen:{},custom:{}},h.personalBests[t][a]=[{language:s,difficulty:l,lazyMode:c,punctuation:o,numbers:i,wpm:d,acc:u,raw:p,timestamp:Date.now(),consistency:g}]}}O!==null&&m()}async function zS(e,t,a,o,i=!1){{const s=e,l=t,c=S();if(!c)return;c.lbMemory===void 0&&(c.lbMemory={time:{15:{english:0},60:{english:0}}}),c.lbMemory[s]===void 0&&(c.lbMemory[s]={15:{english:0},60:{english:0}}),c.lbMemory[s][l]===void 0&&(c.lbMemory[s][l]={});const d=c.lbMemory?.[s]?.[l]?.[a],u=c.lbMemory[s][l];u[a]=o,i&&d!==o&&await T.users.updateLeaderboardMemory({body:{mode:e,mode2:t,language:a,rank:o}}),at(c)}}async function Cy(e){if(A()){const t=await T.configs.save({body:e});t.status!==200&&f("Failed to save config: "+t.body.message,-1)}}async function HS(){if(A()){const e=await T.configs.delete();e.status!==200&&f("Failed to reset config: "+e.body.message,-1)}}function ky(e){const t=S();if(t){if(e.result!==void 0){t?.results!==void 0&&t.results.unshift(e.result),t.testActivity!==void 0&&t.testActivity.increment(new Date(e.result.timestamp)),t.typingStats===void 0&&(t.typingStats={timeTyping:0,startedTests:0,completedTests:0});const a=e.result.testDuration+e.result.incompleteTestSeconds-e.result.afkDuration;t.typingStats.timeTyping+=a,t.typingStats.startedTests+=e.result.restartCount+1,t.typingStats.completedTests+=1,e.isPb&&DS(e.result.mode,e.result.mode2,e.result.punctuation,e.result.numbers,e.result.language,e.result.difficulty,e.result.lazyMode,e.result.wpm,e.result.acc,e.result.rawWpm,e.result.consistency)}e.xp!==void 0&&(t.xp===void 0&&(t.xp=0),t.xp+=e.xp),e.streak!==void 0&&(t.streak=e.streak,t.streak>t.maxStreak&&(t.maxStreak=t.streak)),at(t,{dispatchEvent:!1})}}function OS(e){const t=S();t&&(t.xp===void 0&&(t.xp=0),t.xp+=e,at(t,{dispatchEvent:!1}))}function NS(e){const t=S();t&&(t.inboxUnreadSize=e,at(t))}function US(e){const t=S();t&&(t.inventory===void 0&&(t.inventory={badges:[]}),t.inventory.badges.push(e),at(t))}async function VS(e){if(!A()||O===void 0)return;if(e==="current")return O.testActivity;const t=new Date().getFullYear().toString();if(e===t)return O.testActivity?.getFullYearCalendar();if(O.testActivityByYear===void 0){if(!Xe())return;Z();const a=await T.users.getTestActivity();if(a.status!==200){f("Error getting test activities: "+a.body.message,-1),N();return}O.testActivityByYear={};for(const o in a.body.data){if(o===t)continue;const i=a.body.data[o]??[],s=Fu(new Date(parseInt(o),0,1),i.length);O.testActivityByYear[o]=new tr(i,s,yy,!0)}N()}return O.testActivityByYear[e]}function KS(e){const t=S();if(!t)return;const a=Sy(e);for(const[o,i]of Object.entries(a))t.connections[o]=i;at(t)}function Sy(e){return Object.fromEntries(e.map(t=>{const a=tt()?.uid===t.initiatorUid;return[a?t.receiverUid:t.initiatorUid,t.status==="pending"&&!a?"incoming":t.status]}))}function $p(e){if(e===void 0||e===tt()?.uid)return!1;const t=S();return t?Object.entries(t.connections).some(([a,o])=>a===e&&o==="accepted"):!1}async function dd(){return await Nr(()=>import("./vendor-sentry.MS4h6M3c.js"),[])}let Ol=!1,hr=!1;async function jS(){if(hr){console.warn("Sentry already activated");return}hr=!0,console.log("Activating Sentry");const e=await dd();e.init({release:ks.clientVersion,dsn:"https://f50c25dc9dd75304a63776063896a39b@o4509236448133120.ingest.us.sentry.io/4509237217394688",sendDefaultPii:!0,environment:"production",integrations:[e.browserTracingIntegration(),e.thirdPartyErrorFilterIntegration({filterKeys:["monkeytype-frontend"],behaviour:"drop-error-if-contains-third-party-frames"})],tracesSampleRate:.25,tracePropagationTargets:["localhost",/^https:\/\/api\.monkeytype\.com/],replaysSessionSampleRate:0,replaysOnErrorSampleRate:.5,ignoreErrors:["TypeError: can't access dead object","NotFoundError: Failed to execute 'removeChild' on 'Node': The node to be removed is not a child of this node.","NotFoundError: Failed to execute 'insertBefore' on 'Node': The node before which the new node is to be inserted is not a child of this node.","Error: There is no clipping info for given tab","Non-Error promise rejection captured","Object captured as promise rejection"],beforeSend(t){return Ol&&console.debug("Sentry beforeSend",t),t},beforeBreadcrumb(t,a){return t.category==="console"&&t.level==="debug"?null:t}})}async function GS(e,t){if(!hr)return;(await dd()).setUser({id:e,username:t})}async function QS(){if(!hr)return;(await dd()).setUser(null)}async function Mp(e){if(!hr)return;(await dd()).captureException(e)}function YS(){Ol=!Ol,console.debug("Sentry debug mode:",Ol)}function JS(e,t,a){let o=`Invalid value for ${e} (${t}). Please try to change this setting again.`;f(o,-1),console.error(o),Mp(new Error(o))}function xy(e,t,a){const o=a.safeParse(t).success;return o||JS(e,t),o}const Ty=[];function ge(e){Ty.push(e)}function Ii(e,t,a,o,i){Ty.forEach(s=>{try{s(e,t,a,o,i)}catch(l){console.error("Config event subscriber threw an error"),console.error(l)}})}const XS=[{name:"Prime Ape",description:"Paying for a monthly subscription",icon:"fa-dollar-sign",test:e=>e.isPremium===!0},{name:"Banned",description:"This account is banned",icon:"fa-gavel",color:"var(--error-color)",test:e=>e.banned===!0},{name:"LbOptOut",description:"This account has opted out of leaderboards",icon:"fa-crown",color:"var(--error-color)",test:e=>e.lbOptOut===!0},{name:"Friend",description:"Friend :)",icon:"fa-user-friends",test:e=>e.isFriend===!0}],ZS={iconsOnly:!1};function e5(e){return XS.filter(a=>a.test(e))}function t5(e,t){const a=`<i class="fas ${e.icon}"></i>`;if(t.iconsOnly)return a;const o=[];return e.background!==void 0&&o.push(`background: ${e.background};`),e?.color!==void 0&&o.push(`color: ${e.color};`),e?.customStyle!==void 0&&o.push(e.customStyle),`<div class="flag" ${`aria-label="${e.description}" data-balloon-pos="right"`} style="${o.join("")}">${a}</div>`}function Ss(e,t){const a={...ZS,...t};return e5(e).map(o=>t5(o,a)).join("")}function hc(e){return Math.floor((Math.sqrt(392*e+22801)-53)/98)}function a5(e){return 49*(e-1)+100}function o5(e){return(49*Math.pow(e,2)+53*e-102)/2}function Jn(e){const t=hc(e);return{level:t,levelCurrentXp:e-o5(t),levelMaxXp:a5(t)}}function Ns(e){return e<1e3?Math.round(e).toString():mc(e)}let Ct={bg:"#323437",main:"#e2b714",caret:"#e2b714",sub:"#646669",subAlt:"#2c2e31",text:"#d1d0c5",error:"#ca4754",errorExtra:"#7e2a33",colorfulError:"#ca4754",colorfulErrorExtra:"#7e2a33"};async function jt(e){return Ct[e]||Vr(),Ct[e]}async function ci(){return Ct.bg||Vr(),Ct}function i5(){Ct={bg:"",main:"",caret:"",sub:"",subAlt:"",text:"",error:"",errorExtra:"",colorfulError:"",colorfulErrorExtra:""}}function Vr(){const e=getComputedStyle(document.body);Ct.bg=e.getPropertyValue("--bg-color").replace(" ",""),Ct.main=e.getPropertyValue("--main-color").replace(" ",""),Ct.caret=e.getPropertyValue("--caret-color").replace(" ",""),Ct.sub=e.getPropertyValue("--sub-color").replace(" ",""),Ct.subAlt=e.getPropertyValue("--sub-alt-color").replace(" ",""),Ct.text=e.getPropertyValue("--text-color").replace(" ",""),Ct.error=e.getPropertyValue("--error-color").replace(" ",""),Ct.errorExtra=e.getPropertyValue("--error-extra-color").replace(" ",""),Ct.colorfulError=e.getPropertyValue("--colorful-error-color").replace(" ",""),Ct.colorfulErrorExtra=e.getPropertyValue("--colorful-error-extra-color").replace(" ","")}let bc=!1,We=!1,Ly=!1,yi={currentXp:0,addedXp:0};const Fi=document.querySelector("nav .xpBar .xpBreakdown .total"),xt=document.querySelector("nav .xpBar .xpBreakdown .list"),Pi=document.querySelector("nav .level"),Ba=document.querySelector("nav .xpBar .bar"),Nl=document.querySelector("nav .xpBar");async function n5(){if(We=!0,!bc)return;Ly?Fi.textContent=`+${yi.addedXp}`:ea(yi.addedXp,!0),W(xt,{opacity:[1,0],duration:G(250),onComplete:()=>{xt.innerHTML="",xt.classList.add("hidden")}}),Pi.textContent=`${hc(yi.currentXp+yi.addedXp)}`;const e=Jn(yi.currentXp+yi.addedXp),t=e.level+e.levelCurrentXp/e.levelMaxXp;Ba.style.width=`${t%1*100}%`,await ke(2e3),bc=!1,W(Nl,{opacity:[1,0],duration:G(250)})}function Vg(e){const t=Jn(e),a=t.levelCurrentXp/t.levelMaxXp;Pi.textContent=`${t.level}`,Ba.style.width=a*100+"%"}async function $y(e,t,a){We=!1,bc=!0,yi={currentXp:e,addedXp:t,breakdown:a},Pi.textContent=`${hc(e)}`;const o=Jn(e),i=Jn(e+t),s=o.level+o.levelCurrentXp/o.levelMaxXp,l=i.level+i.levelCurrentXp/i.levelMaxXp;xt.style.opacity="0",xt.innerHTML="",Nl.style.opacity="0",Fi.textContent="";const c=Rt(Nl,{opacity:1,duration:G(125),ease:"linear"}),d=Rt(xt,{opacity:1,duration:G(125),ease:"linear"});if(a!==void 0?(xt.classList.remove("hidden"),Promise.all([c,d])):xt.classList.add("hidden"),We)return;const u=r5(s,l),p=s5(t,a);await Promise.all([u,p]),!We&&(await ke(5e3),!We&&(bc=!1,Pi.textContent=`${hc(e+t)}`,W(Nl,{opacity:[1,0],duration:G(250)})))}async function ea(e,t=!1){if(!t&&We)return;Fi.textContent=`+${e}`;const a=(Math.random()*2-1)/4,o=(Math.random()+1)/2;W(Fi,{scale:[1+.5*o,1],rotate:[10*a,0],duration:G(2e3),ease:"out(5)"})}async function Zt(e,t,a){if(We)return;if(t===void 0)xt.insertAdjacentHTML("beforeend",`<div class="line" data-string='${e}'><div>${e}</div><div></div></div>`);else if(typeof t=="string")xt.insertAdjacentHTML("beforeend",`
      <div class="line" data-string='${e}'>
      <div class="${a?.extraClass}">${e}</div>
      <div class="${a?.extraClass}">${t}</div>
      </div>`);else{const i=t===void 0?void 0:t>=0;xt.insertAdjacentHTML("beforeend",`
      <div class="line" data-string='${e}'>

        <div class="${a?.extraClass}">${e}</div>
        <div class="${i?"positive":"negative"} ${a?.extraClass}">${i?"+":"-"}${Math.abs(t)}</div>
      </div>`)}if(a?.noAnimation)return;const o=xt.querySelector(`.line[data-string='${e}']`);await Rt(o,{opacity:[0,1],duration:G(250)})}async function s5(e,t){if(We)return;if(xt.style.opacity="1",!t){Fi.textContent=`+${e}`;return}const a=G(250);let o=0;xt.innerHTML="",xt.classList.remove("hidden"),Fi.textContent="+0",o+=t.base??0,Fi.textContent=`+${o}`,await Zt("time typing",t.base,{noAnimation:!0}),await ke(a),fe(t.fullAccuracy)?(await ke(a),o+=t.fullAccuracy,ea(o),await Zt("perfect",t.fullAccuracy)):fe(t.corrected)&&(await ke(a),o+=t.corrected,ea(o),await Zt("clean",t.corrected)),!We&&(fe(t.quote)?(await ke(a),o+=t.quote,ea(o),await Zt("quote",t.quote)):(fe(t.punctuation)&&(await ke(a),o+=t.punctuation,ea(o),await Zt("punctuation",t.punctuation)),fe(t.numbers)&&(await ke(a),o+=t.numbers,ea(o),await Zt("numbers",t.numbers))),!We&&(fe(t.funbox)&&(await ke(a),o+=t.funbox,ea(o),await Zt("funbox",t.funbox)),!We&&(fe(t.streak)&&(await ke(a),o+=t.streak,ea(o),await Zt("streak",t.streak)),!We&&(fe(t.accPenalty)&&t.accPenalty>0&&(await ke(a),o-=t.accPenalty,ea(o),await Zt("accuracy penalty",t.accPenalty*-1)),!We&&(fe(t.incomplete)&&t.incomplete>0&&(await ke(a),o+=t.incomplete,ea(o),await Zt("incomplete tests",t.incomplete)),!We&&(fe(t.configMultiplier)&&(await ke(a),o*=t.configMultiplier,ea(o),await Zt("global multiplier",`x${t.configMultiplier}`)),!We&&(fe(t.daily)&&(await ke(a),o+=t.daily,ea(o),await Zt("daily bonus",t.daily)),Ly=!0,!We&&await ke(a))))))))}async function r5(e,t){if(We)return;const a=t-e;if(Ba.style.width=`${e%1*100}%`,t%1===0){if(await Rt(Ba,{width:"100%",duration:G(1e3),ease:"out(5)"}),We)return;au(),Ba.style.width="0%"}else if(Math.floor(e)===Math.floor(t))await Rt(Ba,{width:`${t%1*100}%`,duration:G(1e3),ease:"out(5)"});else{const o=Math.min(1e3/a,200);let i=a,s=!1,l=o,c=1-e%1;do{if(We)return;s&&(au(),Ba.style.width="0%",c=1),await Rt(Ba,{width:"100%",duration:G(l),ease:"linear"}),i-=c,s=!0}while(i>1);if(We||(au(),Ba.style.width="0%",We))return;await Rt(Ba,{width:`${i%1*100}%`,duration:G(1e3),ease:"out(5)"})}}async function au(){const e=await ci();Pi.textContent=`${parseInt(Pi.textContent??"0")+1}`;const t=Math.random()*2-1,a=Math.random()+1;W(Pi,{scale:[1+.5*a,1],backgroundColor:[e.main,e.sub],rotate:[10*t,0],duration:G(2e3),ease:"out(5)"})}const Kg=new Set;function Du(e,t){const a=document.createElement("div");if(a.classList.add("avatar"),e===null||Kg.has(e))a.innerHTML=`<div class="userIcon"><i class="${t?.userIcon??"fas fa-user-circle"}"></i></div>`;else{const o=document.createElement("div");o.className="loading",o.innerHTML='<i class="fas fa-circle-notch fa-spin"></i>';const i=document.createElement("div");i.className="discordImage";const s=document.createElement("img");s.src=`${e}?size=${t?.size??32}`,s.addEventListener("load",async()=>{o.remove()}),s.addEventListener("error",()=>{Kg.add(e),a.replaceWith(Du(null,t))}),i.appendChild(s),a.appendChild(o),a.appendChild(i)}return a}function Kr({discordId:e,discordAvatar:t},a){return Du(e===void 0||e===""||t===void 0||t===""?null:`https://cdn.discordapp.com/avatars/${e}/${t}.png`,a)}function l5(){n("nav .accountButtonAndMenu").addClass("hidden"),n("nav .textButton.view-login").addClass("hidden")}function Qa(e){n("nav .accountButtonAndMenu .spinner").css({opacity:e?"1":"0"}),n("nav .accountButtonAndMenu .avatar").css({opacity:e?"0":"1"})}function jg(e){n("header nav .view-account > .text").text(e)}function Gg(e){n("nav .textButton.view-account > .text").append(Ss(e,{iconsOnly:!0}))}function Wu(e){const t=Kr(e??{},{userIcon:"fas fa-fw fa-user"});n("header nav .view-account .avatar").replaceWith(t)}function c5(){if(A()){const e=S();if(e===void 0)return;const{xp:t,name:a}=e;Qa(!1),jg(a),Gg(e??{}),Vg(t),Wu(e),n("nav .accountButtonAndMenu .menu .items .goToProfile").attr("href",`/profile/${a}`),jn(document.querySelector("nav .textButton.view-login"),document.querySelector("nav .accountButtonAndMenu"),250)}else jn(document.querySelector("nav .accountButtonAndMenu"),document.querySelector("nav .textButton.view-login"),250,async()=>{jg(""),Gg({}),Vg(0),Wu()});My()}function My(){const e=S()?.connections;if(e!==void 0){const t=Object.values(e).filter(a=>a==="incoming").length;if(t>0){n("nav .view-account > .notificationBubble").removeClass("hidden"),n("nav .goToFriends > .notificationBubble").removeClass("hidden").text(t);return}}n("nav .view-account > .notificationBubble").addClass("hidden"),n("nav .goToFriends > .notificationBubble").addClass("hidden")}const d5=window.matchMedia("(pointer:coarse)")?.matches;d5&&n("nav .accountButtonAndMenu .textButton.view-account").attr("href","");qa(e=>{(e.type==="authStateChanged"&&!e.data.isUserSignedIn||e.type==="snapshotUpdated")&&c5()});function u5(e){return e.normalize("NFD").replace(/[\u0300-\u036f]/g,"")}function Ay(e){return e.replace(/([A-Z])/g," $1").trim().toLowerCase()}function _y(e){try{return e.charAt(e.length-1)}catch{return""}}function Qg(e,t,a){return t>e.length-1?e:e.substring(0,t)+a+e.substring(t+1)}function ln(e){return e.split(/ +/).map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" ")}function $t(e){return e.charAt(0).toUpperCase()+e.slice(1)}function ou(e,t){if(t=t.filter(o=>o!==""),t.length===0)return e;const a=new RegExp(`(?<!\\p{L})(?:${t.join("|")})(?!\\p{L})`,"gu");return e.replace(a,'<span class="highlight">$&</span>')}function Aa(e,t=!1){let a="";return t?a=Wa(e):a=e,a.replace(/_/g," ")}function Wa(e){return e.replace(/_\d*k$/g,"")}function Ey(e){const t={"“":'"',"”":'"',"„":'"',"’":"'","‘":"'",",":",","—":"-","…":"...","«":"<<","»":">>","–":"-"," ":" "," ":" "," ":" ","᾽":"'"};return e.replace(/[“”’‘—,…«»–\u2007\u202F\u00A0]/g,a=>t[a]||"")}function Go(e){const t=[];for(const a of e)t.push(a);return t}function f5(e){return e=e.replace(new RegExp("(?<!\\\\)\\\\t","g"),"	"),e=e.replace(/\\n/g,` 
`),e=e.replace(/([^\\]|^)\\n/gm,`$1
`),e=e.replace(/\\\\t/gm,"\\t"),e=e.replace(/\\\\n/gm,"\\n"),e}function p5(e){return!e||e.length===0?!1:/[\u0590-\u05FF\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]/.test(e)}let zu=new Map;function m5(){zu.clear()}function qy(e,t,a){if(e===void 0||e.length===0)return a?!t:t;const o=e.replace(/^[\p{P}\p{S}\s]+|[\p{P}\p{S}\s]+$/gu,"");if(o.length===0)return a?!t:t;const i=zu.get(o);if(i!==void 0)return a?!i:i;const s=p5(o);return zu.set(o,s),a?!s:s}const g5=[new Map(["’","‘","'","ʼ","׳","ʻ","᾽","᾽"].map((e,t)=>[e,t])),new Map(['"',"”","“","„"].map((e,t)=>[e,t])),new Map(["–","—","-","‐"].map((e,t)=>[e,t])),new Map([",","‚"].map((e,t)=>[e,t]))];function h5(e,t){if(e===t)return!0;for(const a of g5)if(a.has(e)&&a.has(t))return!0;return!1}function b5(e){return Uint8Array.prototype.toHex!==void 0?new Uint8Array(e).toHex():Array.from(new Uint8Array(e)).map(o=>o.toString(16).padStart(2,"0")).join("")}function Hu(e,t,a){if(a.length===0)return{result:!0};if(e==="words"||e==="time")return t===0?a.filter(i=>i.properties?.includes("noInfiniteDuration")).length>0?{result:!1,forcedConfigs:[e==="words"?10:15]}:{result:!0}:{result:!0};{const o={};for(const i of a)if(i.frontendForcedConfig)for(const s in i.frontendForcedConfig)o[s]===void 0?o[s]=i.frontendForcedConfig[s]:o[s]=Rb(o[s],i.frontendForcedConfig[s],!0);if(o[e]===void 0)return{result:!0};if(o[e]?.length===0)throw new Error("No intersection of forced configs");return{result:(o[e]??[]).includes(t),forcedConfigs:o[e]}}}function Iy(e,t,a=[],o=!1){let i=0;const s=fr(a);if(e==="mode"){let l=fr(a).filter(c=>c.frontendForcedConfig?.mode!==void 0&&!c.frontendForcedConfig.mode.includes(t));t==="zen"&&(l=l.concat(s.filter(c=>{const d=c.frontendFunctions??[],u=c.properties??[];return d.includes("getWord")||d.includes("pullSection")||d.includes("alterText")||d.includes("withWords")||u.includes("changesCapitalisation")||u.includes("nospace")||u.some(p=>p.startsWith("toPush:"))||u.includes("changesWordsVisibility")||u.includes("speaks")||u.includes("changesLayout")||u.includes("changesWordsFrequency")}))),(t==="quote"||t==="custom")&&(l=l.concat(s.filter(c=>{const d=c.frontendFunctions??[],u=c.properties??[];return d.includes("getWord")||d.includes("pullSection")||d.includes("withWords")||u.includes("changesWordsFrequency")}))),l.length>0&&(i+=1)}if(e==="words"||e==="time"){if(!Hu(e,t,s).result)if(o)i+=1;else return f("Active funboxes do not support infinite tests",0),!1}else Hu(e,t,s).result||(i+=1);return i>0?(o||f(`You can't set ${Ay(e)} to ${t.toString()} with currently active funboxes.`,0,{duration:5}),!1):!0}function Fy(e,t){console.log("cansetfunboxwithconfig",e,t.mode);let a=[...t.funbox,e];const o=[];for(const[i,s]of Object.entries(t))Iy(i,s,a,!0)||o.push({key:i,value:s});if(o.length>0){const i=[];for(const s of o)i.push(`${$t(Ay(s.key))} cannot be set to ${s.value.toString()}.`);return f(`You can't enable ${e.replace(/_/g," ")}:<br>${i.join("<br>")}`,0,{duration:5,allowHTML:!0}),!1}else return!0}class pt{constructor(t){this.key=t.key,this.schema=t.schema,this.fallback=t.fallback,this.migrate=t.migrate}get(){if(this.cache!==void 0)return console.debug(`LS ${this.key} Got cached value:`,this.cache),this.cache;console.debug(`LS ${this.key} Getting value from localStorage`);const t=window.localStorage.getItem(this.key);if(t===null)return console.debug(`LS ${this.key} No value found, returning fallback`),this.cache=this.fallback,this.cache;let a=!1;const{data:o,error:i}=nd(()=>Cs(t,this.schema,{fallback:this.fallback,migrate:(s,l)=>(console.debug(`LS ${this.key} Schema validation failed`),a=!0,this.migrate?(console.debug(`LS ${this.key} Migrating from old format to new format`),this.cache=this.migrate(s,l),this.cache):(console.debug(`LS ${this.key} No migration function provided, returning fallback`),this.cache=this.fallback,this.cache))}));return i?(console.error(`LS ${this.key} Failed to parse from localStorage: ${i.message}`),window.localStorage.setItem(this.key,JSON.stringify(this.fallback)),this.cache=this.fallback,this.cache):((a||o===this.fallback)&&(console.debug(`LS ${this.key} Setting in localStorage`),window.localStorage.setItem(this.key,JSON.stringify(o))),console.debug(`LS ${this.key} Got value:`,o),this.cache=o,this.cache)}set(t){try{console.debug(`LS ${this.key} Parsing to set in localStorage`);const a=this.schema.parse(t);return console.debug(`LS ${this.key} Setting in localStorage`),window.localStorage.setItem(this.key,JSON.stringify(a)),this.cache=a,!0}catch(a){let o="Unknown error occurred";bk(a)?(console.error(a),o="Schema validation failed"):a.message.includes("exceeded the quota")&&(o="Local storage is full. Please clear some space and try again.");const i=`Failed to set ${this.key} in localStorage: ${o}`;return console.error(i),f(i,-1),!1}}}const Py={punctuation:{icon:"fa-at",changeRequiresRestart:!0,overrideValue:({value:e,currentConfig:t})=>t.mode==="quote"?!1:e},numbers:{icon:"fa-hashtag",changeRequiresRestart:!0,overrideValue:({value:e,currentConfig:t})=>t.mode==="quote"?!1:e},words:{icon:"fa-font",displayString:"word count",changeRequiresRestart:!0,overrideConfig:({currentConfig:e})=>e.mode!=="words"?{mode:"words"}:{}},time:{icon:"fa-clock",changeRequiresRestart:!0,displayString:"time",overrideConfig:({currentConfig:e})=>e.mode!=="time"?{mode:"time"}:{}},mode:{icon:"fa-bars",changeRequiresRestart:!0,overrideConfig:({value:e})=>e==="custom"||e==="quote"||e==="zen"?{numbers:!1,punctuation:!1}:{},afterSet:({currentConfig:e})=>{e.mode==="zen"&&e.paceCaret!=="off"&&f("Pace caret will not work with zen mode.",0)}},quoteLength:{icon:"fa-quote-right",displayString:"quote length",changeRequiresRestart:!0,overrideConfig:({currentConfig:e})=>e.mode!=="quote"?{mode:"quote"}:{}},language:{icon:"fa-language",displayString:"language",changeRequiresRestart:!0},burstHeatmap:{icon:"fa-fire",displayString:"word burst heatmap",changeRequiresRestart:!1},difficulty:{icon:"fa-star",changeRequiresRestart:!0},quickRestart:{icon:"fa-redo-alt",displayString:"quick restart",changeRequiresRestart:!1},repeatQuotes:{icon:"fa-sync-alt",displayString:"repeat quotes",changeRequiresRestart:!1},blindMode:{icon:"fa-eye-slash",displayString:"blind mode",changeRequiresRestart:!1},alwaysShowWordsHistory:{icon:"fa-align-left",displayString:"always show words history",changeRequiresRestart:!1},singleListCommandLine:{icon:"fa-list",displayString:"single list command line",changeRequiresRestart:!1},minWpm:{icon:"fa-bomb",displayString:"min speed",changeRequiresRestart:!0},minWpmCustomSpeed:{icon:"fa-bomb",displayString:"min speed custom",changeRequiresRestart:!0,overrideConfig:({currentConfig:e})=>e.minWpm!=="custom"?{minWpm:"custom"}:{}},minAcc:{icon:"fa-bomb",displayString:"min accuracy",changeRequiresRestart:!0},minAccCustom:{icon:"fa-bomb",displayString:"min accuracy custom",changeRequiresRestart:!0,overrideConfig:({currentConfig:e})=>e.minAcc!=="custom"?{minAcc:"custom"}:{}},minBurst:{icon:"fa-bomb",displayString:"min word burst",changeRequiresRestart:!0},minBurstCustomSpeed:{icon:"fa-bomb",displayString:"min word burst custom speed",changeRequiresRestart:!0},britishEnglish:{icon:"fa-language",displayString:"british english",changeRequiresRestart:!0},funbox:{icon:"fa-gamepad",changeRequiresRestart:!0,isBlocked:({value:e,currentConfig:t})=>{if(!zr(e))return f(`${$t(e.join(", "))} is an invalid combination of funboxes`,0),!0;for(const a of e)if(!Fy(a,t))return f(`${e}" cannot be enabled with the current config`,0),!0;return!1}},customLayoutfluid:{icon:"fa-tint",displayString:"custom layoutfluid",changeRequiresRestart:!0,overrideValue:({value:e})=>Array.from(new Set(e))},customPolyglot:{icon:"fa-language",displayString:"custom polyglot",changeRequiresRestart:!1,overrideValue:({value:e})=>Array.from(new Set(e))},freedomMode:{icon:"fa-feather-alt",changeRequiresRestart:!1,displayString:"freedom mode",overrideConfig:({value:e})=>e?{confidenceMode:"off"}:{}},strictSpace:{icon:"fa-minus",displayString:"strict space",changeRequiresRestart:!0},oppositeShiftMode:{icon:"fa-exchange-alt",displayString:"opposite shift mode",changeRequiresRestart:!1},stopOnError:{icon:"fa-hand-paper",displayString:"stop on error",changeRequiresRestart:!0,overrideConfig:({value:e})=>e!=="off"?{confidenceMode:"off"}:{}},confidenceMode:{icon:"fa-backspace",displayString:"confidence mode",changeRequiresRestart:!1,overrideConfig:({value:e})=>e!=="off"?{freedomMode:!1,stopOnError:"off"}:{}},quickEnd:{icon:"fa-step-forward",displayString:"quick end",changeRequiresRestart:!1},indicateTypos:{icon:"fa-exclamation",displayString:"indicate typos",changeRequiresRestart:!1},hideExtraLetters:{icon:"fa-eye-slash",displayString:"hide extra letters",changeRequiresRestart:!1},lazyMode:{icon:"fa-couch",displayString:"lazy mode",changeRequiresRestart:!0},layout:{icon:"fa-keyboard",displayString:"layout",changeRequiresRestart:!0},codeUnindentOnBackspace:{icon:"fa-code",displayString:"code unindent on backspace",changeRequiresRestart:!0},soundVolume:{icon:"fa-volume-down",displayString:"sound volume",changeRequiresRestart:!1},playSoundOnClick:{icon:"fa-volume-up",displayString:"play sound on click",changeRequiresRestart:!1},playSoundOnError:{icon:"fa-volume-mute",displayString:"play sound on error",changeRequiresRestart:!1},playTimeWarning:{icon:"fa-exclamation-triangle",displayString:"play time warning",changeRequiresRestart:!1},smoothCaret:{icon:"fa-i-cursor",displayString:"smooth caret",changeRequiresRestart:!1},caretStyle:{icon:"fa-i-cursor",displayString:"caret style",changeRequiresRestart:!1},paceCaret:{icon:"fa-i-cursor",displayString:"pace caret",changeRequiresRestart:!1,isBlocked:({value:e})=>document.readyState==="complete"&&(e==="pb"||e==="tagPb")&&!A()?(f('Pace caret "pb" and "tag pb" are unavailable without an account',0),!0):!1},paceCaretCustomSpeed:{icon:"fa-i-cursor",displayString:"pace caret custom speed",changeRequiresRestart:!1,overrideConfig:({currentConfig:e})=>e.paceCaret!=="custom"?{paceCaret:"custom"}:{}},paceCaretStyle:{icon:"fa-i-cursor",displayString:"pace caret style",changeRequiresRestart:!1},repeatedPace:{icon:"fa-i-cursor",displayString:"repeated pace",changeRequiresRestart:!1},timerStyle:{icon:"fa-chart-pie",displayString:"timer style",changeRequiresRestart:!1},liveSpeedStyle:{icon:"fa-tachometer-alt",displayString:"live speed style",changeRequiresRestart:!1},liveAccStyle:{icon:"fa-tachometer-alt",displayString:"live accuracy style",changeRequiresRestart:!1},liveBurstStyle:{icon:"fa-tachometer-alt",displayString:"live word burst style",changeRequiresRestart:!1},timerColor:{icon:"fa-chart-pie",displayString:"timer color",changeRequiresRestart:!1},timerOpacity:{icon:"fa-chart-pie",displayString:"timer opacity",changeRequiresRestart:!1},highlightMode:{icon:"fa-highlighter",displayString:"highlight mode",changeRequiresRestart:!1},tapeMode:{icon:"fa-tape",triggerResize:!0,changeRequiresRestart:!1,displayString:"tape mode",overrideConfig:({value:e})=>e!=="off"?{showAllLines:!1}:{}},tapeMargin:{icon:"fa-tape",displayString:"tape margin",triggerResize:!0,changeRequiresRestart:!1},smoothLineScroll:{icon:"fa-align-left",displayString:"smooth line scroll",changeRequiresRestart:!1},showAllLines:{icon:"fa-align-left",changeRequiresRestart:!1,displayString:"show all lines",isBlocked:({value:e,currentConfig:t})=>e&&t.tapeMode!=="off"?(f("Show all lines doesn't support tape mode.",0),!0):!1},alwaysShowDecimalPlaces:{icon:"00",displayString:"always show decimal places",changeRequiresRestart:!1},typingSpeedUnit:{icon:"fa-tachometer-alt",displayString:"typing speed unit",changeRequiresRestart:!1},startGraphsAtZero:{icon:"fa-chart-line",displayString:"start graphs at zero",changeRequiresRestart:!1},maxLineWidth:{icon:"fa-text-width",changeRequiresRestart:!1,triggerResize:!0,displayString:"max line width"},fontSize:{icon:"fa-font",changeRequiresRestart:!1,triggerResize:!0,displayString:"font size"},fontFamily:{icon:"fa-font",displayString:"font family",changeRequiresRestart:!1},keymapMode:{icon:"fa-keyboard",displayString:"keymap mode",changeRequiresRestart:!1},keymapLayout:{icon:"fa-keyboard",displayString:"keymap layout",changeRequiresRestart:!1,overrideConfig:({currentConfig:e})=>e.keymapMode==="off"?{keymapMode:"static"}:{}},keymapStyle:{icon:"fa-keyboard",displayString:"keymap style",changeRequiresRestart:!1,overrideConfig:({currentConfig:e})=>e.keymapMode==="off"?{keymapMode:"static"}:{}},keymapLegendStyle:{icon:"fa-keyboard",displayString:"keymap legend style",changeRequiresRestart:!1,overrideConfig:({currentConfig:e})=>e.keymapMode==="off"?{keymapMode:"static"}:{}},keymapShowTopRow:{icon:"fa-keyboard",displayString:"keymap show top row",changeRequiresRestart:!1,overrideConfig:({currentConfig:e})=>e.keymapMode==="off"?{keymapMode:"static"}:{}},keymapSize:{icon:"fa-keyboard",triggerResize:!0,changeRequiresRestart:!1,displayString:"keymap size",overrideValue:({value:e})=>(e<.5&&(e=.5),e>3.5&&(e=3.5),Dl(e)),overrideConfig:({currentConfig:e})=>e.keymapMode==="off"?{keymapMode:"static"}:{}},flipTestColors:{icon:"fa-adjust",displayString:"flip test colors",changeRequiresRestart:!1},colorfulMode:{icon:"fa-fill-drip",displayString:"colorful mode",changeRequiresRestart:!1},customBackground:{icon:"fa-link",displayString:"URL background",changeRequiresRestart:!1,overrideValue:({value:e})=>e.trim()},customBackgroundSize:{icon:"fa-image",displayString:"custom background size",changeRequiresRestart:!1},customBackgroundFilter:{icon:"fa-image",displayString:"custom background filter",changeRequiresRestart:!1},autoSwitchTheme:{icon:"fa-palette",displayString:"auto switch theme",changeRequiresRestart:!1},themeLight:{icon:"fa-palette",displayString:"theme light",changeRequiresRestart:!1},themeDark:{icon:"fa-palette",displayString:"theme dark",changeRequiresRestart:!1},randomTheme:{icon:"fa-palette",changeRequiresRestart:!1,displayString:"random theme",isBlocked:({value:e})=>{if(e==="custom"){const t=S();if(!A())return f("Random theme 'custom' is unavailable without an account",0),!0;if(!t)return f("Random theme 'custom' requires a snapshot to be set",0),!0;if(t?.customThemes?.length===0)return f("Random theme 'custom' requires at least one custom theme to be saved",0),!0}return!1}},favThemes:{icon:"fa-palette",displayString:"favorite themes",changeRequiresRestart:!1},theme:{icon:"fa-palette",changeRequiresRestart:!1,overrideConfig:()=>({customTheme:!1})},customTheme:{icon:"fa-palette",displayString:"custom theme",changeRequiresRestart:!1},customThemeColors:{icon:"fa-palette",displayString:"custom theme colors",changeRequiresRestart:!1,overrideValue:({value:e})=>e.every(a=>a===e[0])?$a().customThemeColors:e},showKeyTips:{icon:"fa-question",displayString:"show key tips",changeRequiresRestart:!1},showOutOfFocusWarning:{icon:"fa-exclamation",displayString:"show out of focus warning",changeRequiresRestart:!1},capsLockWarning:{icon:"fa-exclamation-triangle",displayString:"caps lock warning",changeRequiresRestart:!1},showAverage:{icon:"fa-chart-bar",displayString:"show average",changeRequiresRestart:!1},accountChart:{icon:"fa-chart-line",displayString:"account chart",changeRequiresRestart:!1,overrideValue:({value:e,currentValue:t})=>{if(e[0]==="off"&&e[1]==="off"){const a=e[0]===t[0]?0:1;e[a]="on"}return e}},monkey:{icon:"fa-egg",displayString:"monkey",changeRequiresRestart:!1},monkeyPowerLevel:{icon:"fa-egg",displayString:"monkey power level",changeRequiresRestart:!1},ads:{icon:"fa-ad",changeRequiresRestart:!1,overrideValue:({value:e})=>e,isBlocked:({value:e})=>!1,afterSet:({nosave:e})=>{e||($o(3),f("Ad settings changed. Refreshing...",0))}}},Ap=new pt({key:"config",schema:Hr,fallback:$a(),migrate:(e,t)=>_b(e)?ld(e):$a()});let r={...$a()},Ul={};const y5=Mt(1e3,()=>{Object.keys(Ul).length>0&&(Qa(!0),Cy(Ul).then(()=>{Qa(!1)})),Ul={}});function _p(e,t=!1,a=!1){if(t)return;Ap.set(r),a||(Ul[e]=r[e],y5());const o=JSON.stringify(r);Ii("saveToLocalStorage",o)}function xs(e=!1){console.log("saving full config to localStorage"),Ap.set(r),e||(Qa(!0),Cy(r),Qa(!1));const t=JSON.stringify(r);Ii("saveToLocalStorage",t)}function v5(){return we&&r.funbox.includes("no_quit")?(f("No quit funbox is active. Please finish the test.",0,{important:!0}),!0):!1}function $(e,t,a=!1){const o=Py[e];if(o===void 0)throw new Error(`Config metadata for key "${e}" is not defined.`);o.overrideValue&&(t=o.overrideValue({value:t,currentValue:r[e],currentConfig:r}));const i=r[e];if(o.changeRequiresRestart&&we&&r.funbox.includes("no_quit"))return f("No quit funbox is active. Please finish the test.",0,{important:!0}),console.warn(`Could not set config key "${e}" with value "${JSON.stringify(t)}" - no quit funbox active.`),!1;if(o.isBlocked?.({value:t,currentConfig:r}))return console.warn(`Could not set config key "${e}" with value "${JSON.stringify(t)}" - blocked.`),!1;const s=Hr.shape[e];if(!xy(o.displayString??e,t,s))return console.warn(`Could not set config key "${e}" with value "${JSON.stringify(t)}" - invalid value.`),!1;if(!Iy(e,t,r.funbox))return console.warn(`Could not set config key "${e}" with value "${JSON.stringify(t)}" - funbox conflict.`),!1;if(o.overrideConfig){const l=o.overrideConfig({value:t,currentConfig:r});for(const c of et(l)){const d=l[c];if(r[c]===d)continue;if(!$(c,d,a))throw new Error(`Failed to set config key "${c}" with value "${d}" for ${o.displayString} config override.`)}}return r[e]=t,a||_p(e,a),Ii(e,t,a,i),o.triggerResize&&!a&&QC(),o.afterSet?.({nosave:a||!1,currentConfig:r}),!0}function po(e,t){return $("numbers",e,t)}function ei(e,t){return $("punctuation",e,t)}function rt(e,t){return $("mode",e,t)}function w5(e,t){return $("playSoundOnError",e,t)}function C5(e,t){return $("playSoundOnClick",e,t)}function k5(e,t){return $("soundVolume",e,t)}function S5(e,t){return $("playTimeWarning",e,t)}function no(e,t){return $("difficulty",e,t)}function yc(e,t){return $("favThemes",e,t)}function zo(e,t){return $("funbox",e,t)}function Wn(e,t){if(v5()||!Fy(e,r))return!1;let a=r.funbox;return a.includes(e)?a=a.filter(o=>o!==e):(a.push(e),a.sort()),xy("funbox",a,Db)?(r.funbox=a,_p("funbox",t),Ii("funbox",r.funbox),!0):!1}function x5(e,t){return $("blindMode",e,t)}function ud(e,t){return $("accountChart",e,t)}function By(e,t){return $("stopOnError",e,t)}function T5(e,t){return $("alwaysShowDecimalPlaces",e,t)}function L5(e,t){return $("typingSpeedUnit",e,t)}function $5(e,t){return $("showOutOfFocusWarning",e,t)}function M5(e,t){return $("paceCaret",e,t)}function A5(e,t){return $("repeatedPace",e,t)}function _5(e,t){return $("minWpm",e,t)}function E5(e,t){return $("minAcc",e,t)}function Vl(e,t){return $("minBurst",e,t)}function Yg(e,t){return $("minBurstCustomSpeed",e,t)}function q5(e,t){return $("alwaysShowWordsHistory",e,t)}function I5(e,t){return $("singleListCommandLine",e,t)}function F5(e,t){return $("capsLockWarning",e,t)}function Ou(e,t){return $("showAllLines",e,t)}function P5(e,t){return $("quickEnd",e,t)}function B5(e,t){return $("ads",e,t)}function R5(e,t){return $("repeatQuotes",e,t)}function D5(e,t){return $("flipTestColors",e,t)}function W5(e,t){return $("colorfulMode",e,t)}function z5(e,t){return $("strictSpace",e,t)}function H5(e,t){return $("oppositeShiftMode",e,t)}function O5(e,t){return $("caretStyle",e,t)}function N5(e,t){return $("paceCaretStyle",e,t)}function U5(e,t){return $("showAverage",e,t)}function Si(e,t){return $("highlightMode",e,t)}function V5(e,t){return $("tapeMode",e,t)}function K5(e,t){return $("tapeMargin",e,t)}function j5(e,t){return $("hideExtraLetters",e,t)}function G5(e,t){return $("timerStyle",e,t)}function Q5(e,t){return $("liveSpeedStyle",e,t)}function Y5(e,t){return $("liveAccStyle",e,t)}function J5(e,t){return $("liveBurstStyle",e,t)}function X5(e,t){return $("timerColor",e,t)}function Z5(e,t){return $("timerOpacity",e,t)}function e3(e,t){return $("showKeyTips",e,t)}function uo(e,t){return $("time",e,t)}function fd(e,t){return $("quoteLength",e,t)}function zn(e){return $("quoteLength",[0,1,2,3],e)}function Oi(e,t){return $("words",e,t)}function t3(e,t){return $("smoothCaret",e,t)}function a3(e,t){return $("codeUnindentOnBackspace",e,t)}function o3(e,t){return $("startGraphsAtZero",e,t)}function i3(e,t){return $("smoothLineScroll",e,t)}function n3(e,t){return $("quickRestart",e,t)}function Ry(e,t){return $("fontFamily",e,t)}function s3(e,t){return $("freedomMode",e,t)}function r3(e,t){return $("confidenceMode",e,t)}function l3(e,t){return $("indicateTypos",e,t)}function Dy(e,t){return $("autoSwitchTheme",e,t)}function mo(e,t){return $("customTheme",e,t)}function Ep(e,t){return $("theme",e,t)}function c3(e,t){return $("themeLight",e,t)}function d3(e,t){return $("themeDark",e,t)}function u3(e,t){return $("randomTheme",e,t)}function f3(e,t){return $("britishEnglish",e,t)}function An(e,t){return $("lazyMode",e,t)}function Xn(e,t){return $("customThemeColors",e,t)}function Zn(e,t){return $("language",e,t)}function fa(e,t){return $("keymapMode",e,t)}function p3(e,t){return $("keymapLegendStyle",e,t)}function m3(e,t){return $("keymapStyle",e,t)}function Ti(e,t){return $("keymapLayout",e,t)}function g3(e,t){return $("keymapShowTopRow",e,t)}function pd(e,t){return $("keymapSize",e,t)}function Do(e,t){return $("layout",e,t)}function h3(e,t){return $("fontSize",e,t)}function b3(e,t){return $("maxLineWidth",e,t)}function y3(e,t){return $("customBackground",e,t)}function v3(e,t){return $("customLayoutfluid",e,t)}function w3(e,t){return $("customPolyglot",e,t)}function Wy(e,t){return $("customBackgroundSize",e,t)}function _n(e,t){return $("customBackgroundFilter",e,t)}function C3(e,t){return $("burstHeatmap",e,t)}const Jg=new Set(["keymapMode","minWpm","minAcc","minBurst","paceCaret","quoteLength","words","time","mode","numbers","punctuation","funbox"]);async function es(e){if(e==null)return;const t=ld(e);Ii("fullConfigChange");const a=$a();for(const s of et(t))r[s]=a[s];const o=[],i=et(t).filter(s=>!Jg.has(s));for(const s of[...i,...Jg]){const l=t[s];$(s,l,!0)||o.push(s)}for(const s of o)_p(s);Ii("configApplied",void 0,void 0,void 0,r),Ii("fullConfigChangeFinished")}async function qp(){await es($a()),await HS(),xs(!0)}async function k3(){console.log("loading localStorage config");const e=Ap.get();e===void 0?await qp():(await es(e),xs(!0)),S3()}function Xg(){const e={};return et(r).filter(t=>r[t]!==$a()[t]).forEach(t=>{e[t]=r[t]}),e}async function zy(e){try{const t=Cs(e,Pb.strip(),{migrate:a=>{if(Array.isArray(a))throw new Error("Invalid config");return ld(a)}});await es(t),xs(),f("Done",1)}catch(t){const a=ie(t,"Failed to import settings");console.error(a),f(a,-1)}}const{promise:Hy,resolve:S3}=Lo();class x3{constructor(){this.list=[],this.sectionIndexList=[],this.length=0}get(t,a=!1){return t===void 0?this.list:a?this.list[t]?.replace(/[.?!":\-,]/g,"")?.toLowerCase():this.list[t]}getCurrent(){return this.list[le]??""}getLast(){return this.list[this.list.length-1]}push(t,a){this.list.push(t),this.sectionIndexList.push(a),this.length=this.list.length}reset(){this.list=[],this.sectionIndexList=[],this.length=this.list.length}clean(){for(const t of this.list)if(/ +/.test(t)){const a=this.list.indexOf(t),o=t.split(" ");this.list.splice(a,1);for(let i=0;i<o.length;i++)this.list.splice(a+i,0,o[i])}}}const _=new x3;let br=!1,yr=!1,Ip=!1,me=null;function Nu(e){me=e}function T3(e){br=e}function L3(e){yr=e}function $3(e){Ip=e}const Oy=new Set(["NumpadMultiply","NumpadSubtract","NumpadAdd","NumpadDecimal","NumpadEqual","NumpadDivide","Numpad0","Numpad1","Numpad2","Numpad3","Numpad4","Numpad5","Numpad6","Numpad7","Numpad8","Numpad9","Backquote","Digit1","Digit2","Digit3","Digit4","Digit5","Digit6","Digit7","Digit8","Digit9","Digit0","Minus","Equal","KeyQ","KeyW","KeyE","KeyR","KeyT","KeyY","KeyU","KeyI","KeyO","KeyP","BracketLeft","BracketRight","Backslash","KeyA","KeyS","KeyD","KeyF","KeyG","KeyH","KeyJ","KeyK","KeyL","Semicolon","Quote","IntlBackslash","KeyZ","KeyX","KeyC","KeyV","KeyB","KeyN","KeyM","Comma","Period","Slash","Space","Enter","Tab","NoCode"]);class M3{constructor(){this.current="",this.history=[],this.koreanStatus=!1}reset(){this.current="",this.history=[]}resetHistory(){this.history=[]}setKoreanStatus(t){this.koreanStatus=t}getKoreanStatus(){return this.koreanStatus}pushHistory(){this.history.push(this.current),this.current=""}popHistory(){return this.history.pop()??""}getHistory(t){return t===void 0?this.history:this.history[t]}getHistoryLast(){return Kn(this.history)}}class A3{constructor(){this.current="",this.history=[]}reset(){this.history=[],this.current=""}getHistory(t){return this.history[t]}popHistory(){return this.history.pop()??""}pushHistory(){this.history.push(this.current),this.current=""}}let St={};const k=new M3,Ke=new A3;let Ni=[],vc=0,md=0,go={},sa={correct:0,incorrect:0},he={spacing:{first:-1,last:-1,array:[]},duration:{array:[]}},so={total:0,lastStartTime:-1},ti=[],jr=[],Ta=[],Gr=[],vr={count:0,words:[]},Qr=[],wc=!0;function Uu(){vc++}function Ny(){wc=!1}function Uy(){vr.count++}function Vu(e){vr.words.push(e)}function _3(e){md=e}function gd(){Ni.push(vc),vc=0}function hd(){Qr.push(wc),wc=!0}function bd(){Gr.push(vr),vr={count:0,words:[]}}function Vy(e){e?sa.correct++:sa.incorrect++}function E3(e){const t=new Set(Object.values(St).map(s=>s.index)),a=he.duration.array.filter((s,l)=>!t.has(l));if(a.length===0)return;const o=H(Wl(a)),i=Object.entries(St).sort((s,l)=>s[1].timestamp-l[1].timestamp);for(const[s,{index:l}]of i)he.duration.array[l]=o,s==="NoCode"&&ts--,delete St[s],Fp(e)}let ts=0;function q3(e,t){if(!Oy.has(t))return;t==="NoCode"&&(ts--,t="NoCode"+ts);const a=St[t];if(a===void 0)return;const o=Math.abs(a.timestamp-e);he.duration.array[a.index]=o,console.debug("Keyup recorded",t,o),delete St[t],Fp(e)}function I3(e,t){if(!Oy.has(t)){console.debug("Key not tracked",t);return}if(t==="NoCode"&&(t="NoCode"+ts,ts++),St[t]!==void 0){console.debug("Key already down",t);return}if(St[t]={timestamp:e,index:he.duration.array.length},he.duration.array.push(0),Fp(St[t]?.timestamp),he.spacing.last!==-1){const a=Math.abs(e-he.spacing.last);he.spacing.array.push(H(a)),console.debug("Keydown recorded",t,a)}he.spacing.last=e,he.spacing.first===-1&&(he.spacing.first=e,console.debug("First keydown recorded",t,e))}function Fp(e){Object.keys(St).length>1?so.lastStartTime===-1&&(so.lastStartTime=e):so.lastStartTime!==-1&&(so.total+=e-so.lastStartTime,so.lastStartTime=-1)}function F3(){const e=Object.keys(St).reduce((a,o)=>{const i=St[a]?.index,s=St[o]?.index;return i===void 0?o:s===void 0||i>s?a:o}),t=St[e];he={spacing:{first:-1,last:-1,array:[]},duration:{array:[]}},so={total:0,lastStartTime:-1},St={},ts=0,t!==void 0&&(he={spacing:{first:t.timestamp,last:t.timestamp,array:[]},duration:{array:[0]}},St[e]={timestamp:t.timestamp,index:0}),console.debug("Keypress timings reset")}function Ky(e){Object.keys(go).includes(e)?go[e]++:go[e]=1}function jy(e){ti.push(e)}function Gy(e){jr.push(e)}function Qy(e){Ta[le]===void 0?Ta.push(e):Ta[le]=e}function P3(){ti=[],jr=[],Ta=[],Ni=[],vc=0,Qr=[],wc=!0,Gr=[],vr={count:0,words:[]},md=0,go={},sa={correct:0,incorrect:0}}const Cc=new Map;function Pp(e,t){B3(e);const a=requestAnimationFrame(()=>{Cc.delete(e),t()});Cc.set(e,a)}function B3(e){const t=Cc.get(e);t!==void 0&&(cancelAnimationFrame(t),Cc.delete(e))}const R3=document.querySelector("#words"),vl=document.querySelector("#wordsWrapper");let Ps=!0;class Yy{constructor(t,a){this.style="default",this.readyToResetMarginTop=!1,this.readyToResetMarginLeft=!1,this.isMainCaret=!1,this.cumulativeTapeMarginCorrection=0,this.posAnimation=null,this.marginTopAnimation=null,this.marginLeftAnimation=null,this.id=t.id,this.element=t,this.setStyle(a),this.id==="caret"&&(this.isMainCaret=!0)}setStyle(t){this.style=t,this.element.style.width="",this.element.classList.remove("off","default","underline","outline","block","carrot","banana","monkey"),this.element.classList.add(t)}getElement(){return this.element}show(){this.element.classList.remove("hidden"),this.element.style.display=""}hide(){this.element.classList.add("hidden")}isHidden(){return this.element.classList.contains("hidden")}getWidth(){return this.element.offsetWidth}resetWidth(){this.element.style.width=""}getHeight(){if(!this.isHidden())return this.element.offsetHeight;let t=0;return this.show(),t=this.element.offsetHeight,this.hide(),t}isFullWidth(){return["block","outline","underline"].includes(this.style)}setPosition(t){this.posAnimation?.cancel(),this.element.style.left=`${t.left}px`,this.element.style.top=`${t.top}px`,t.width!==void 0&&(this.element.style.width=`${t.width}px`)}startBlinking(){r.smoothCaret!=="off"?this.element.style.animationName="caretFlashSmooth":this.element.style.animationName="caretFlashHard"}stopBlinking(){this.element.style.animationName="none",this.element.style.opacity="1"}updateBlinkingAnimation(){r.smoothCaret==="off"?this.element.style.animationName="caretFlashHard":this.element.style.animationName="caretFlashSmooth"}stopAllAnimations(){this.posAnimation?.cancel(),this.marginTopAnimation?.cancel(),this.marginLeftAnimation?.cancel()}clearMargins(){this.element.style.marginTop="",this.element.style.marginLeft="",this.readyToResetMarginTop=!1,this.readyToResetMarginLeft=!1,this.cumulativeTapeMarginCorrection=0}handleTapeWordsRemoved(t){this.cumulativeTapeMarginCorrection+=t}handleTapeScroll(t){if(this.isMainCaret&&Ps)return;this.readyToResetMarginLeft=!1;const a=t.newValue-this.cumulativeTapeMarginCorrection;if(t.duration===0){this.marginLeftAnimation?.cancel(),this.element.style.marginLeft=`${a}px`,this.readyToResetMarginLeft=!0;return}this.marginLeftAnimation=W(this.element,{marginLeft:a,duration:t.duration,ease:t.ease,onComplete:()=>{this.readyToResetMarginLeft=!0}})}handleLineJump(t){if(!(this.isMainCaret&&t.duration===0)){if(this.readyToResetMarginTop=!1,t.duration===0){this.marginTopAnimation?.cancel(),this.element.style.marginTop=`${t.newMarginTop}px`,this.readyToResetMarginTop=!0;return}this.marginTopAnimation=W(this.element,{marginTop:t.newMarginTop,duration:t.duration,onComplete:()=>{this.readyToResetMarginTop=!0}})}}animatePosition(t){const a=r.smoothCaret==="off"?0:r.smoothCaret==="slow"?150:r.smoothCaret==="medium"?100:r.smoothCaret==="fast"?85:0,o=t.duration??a,i={left:t.left,top:t.top};t.width!==void 0&&(i.width=t.width),this.posAnimation=W(this.element,{...i,duration:o,ease:t.easing??"inOut(1.25)"})}goTo(t){this.style!=="off"&&Pp(`caret.${this.id}.goTo`,()=>{const a=R3.querySelector(`.word[data-wordindex="${t.wordIndex}"]`),o=a?.querySelectorAll("letter")??[],i=_.get(t.wordIndex);let s="beforeLetter";(t.letterIndex>=o.length||r.blindMode&&t.letterIndex>=i.length)&&(s="afterLetter",t.letterIndex=o.length-1),t.letterIndex<0&&(t.letterIndex=0);let l=a?.querySelectorAll("letter")[t.letterIndex];if(a===null||l===void 0)return;this.element.classList.remove("debug");const{left:c,top:d,width:u}=this.getTargetPositionAndWidth({word:a,letter:l,wordText:i,side:s,isLanguageRightToLeft:t.isLanguageRightToLeft,isDirectionReversed:t.isDirectionReversed});let p=parseFloat(this.element.style.marginTop||"0");if(this.readyToResetMarginTop){this.readyToResetMarginTop=!1;const h=parseFloat(this.element.style.top||"0");n(this.element).css({marginTop:0,top:h+p}),p=0}let g=parseFloat(this.element.style.marginLeft||"0");if(this.readyToResetMarginLeft){this.readyToResetMarginLeft=!1;const h=parseFloat(this.element.style.left||"0");n(this.element).css({marginLeft:0,left:h+g}),this.cumulativeTapeMarginCorrection+=g,g=0}const m={left:c-g,top:d-p,...this.isFullWidth()&&{width:u},...t.animate&&t.animationOptions};t.animate?this.animatePosition(m):this.setPosition(m)})}getTargetPositionAndWidth(t){const a=qy(t.wordText,t.isLanguageRightToLeft,t.isDirectionReversed);if(!(t.letter.offsetWidth>0)){const d=t.word.querySelectorAll("letter");if(d.length===0)throw new Error("Caret getLeftTopWidth: no letters found in word");let u=!0;for(let p=d.length-1;p>=0;p--){const g=d[p];if(g===t.letter){u=!1;continue}if(!u&&g.offsetWidth>0){t.letter=g;break}}}const i=YC(t.word);let s=i;this.isFullWidth()&&t.side==="beforeLetter"&&(s=t.letter.offsetWidth);let l=0,c=0;if(a){let d=0;t.side==="afterLetter"&&(this.isFullWidth()?d+=i*-1:d+=t.letter.offsetWidth*-1),r.tapeMode==="off"?(this.isFullWidth()||(l+=t.letter.offsetWidth),l+=t.letter.offsetLeft,l+=t.word.offsetLeft,l+=d):r.tapeMode==="word"?(this.isFullWidth()||(l+=t.letter.offsetWidth),l+=t.word.offsetWidth*-1,l+=t.letter.offsetLeft,l+=d,this.isMainCaret&&Ps?l+=vl.offsetWidth*(r.tapeMargin/100):(l+=t.word.offsetLeft,l+=t.word.offsetWidth)):r.tapeMode==="letter"&&(this.isFullWidth()&&(l+=s*-1),this.isMainCaret&&Ps?l+=vl.offsetWidth*(r.tapeMargin/100):(l+=t.letter.offsetLeft,l+=t.word.offsetLeft,l+=d,l+=s))}else{let d=0;t.side==="afterLetter"&&(d+=t.letter.offsetWidth),r.tapeMode==="off"?(l+=t.letter.offsetLeft,l+=t.word.offsetLeft,l+=d):r.tapeMode==="word"?(l+=t.letter.offsetLeft,l+=d,this.isMainCaret&&Ps?l+=vl.offsetWidth*(r.tapeMargin/100):l+=t.word.offsetLeft):r.tapeMode==="letter"&&(this.isMainCaret&&Ps?l+=vl.offsetWidth*(r.tapeMargin/100):(l+=t.letter.offsetLeft,l+=t.word.offsetLeft,l+=d))}return c+=t.letter.offsetTop,c+=t.word.offsetTop,this.style==="underline"?c+=t.letter.offsetHeight:c+=(t.letter.offsetHeight-this.getHeight())/2,this.isFullWidth()||(l+=this.getWidth()/2*-1),{left:l,top:c,width:s}}}function Jy(){Yt.stopBlinking()}function Xy(){Yt.startBlinking()}function Yr(){Yt.hide()}function D3(){Yt.stopAllAnimations(),Yt.clearMargins(),Yt.goTo({wordIndex:0,letterIndex:0,isLanguageRightToLeft:da,isDirectionReversed:li,animate:!1})}function vo(e=!1){Yt.goTo({wordIndex:le,letterIndex:k.current.length,isLanguageRightToLeft:da,isDirectionReversed:li,animate:r.smoothCaret!=="off"&&!e})}const Yt=new Yy(document.getElementById("caret"),r.caretStyle);ge(e=>{e==="caretStyle"&&(Yt.setStyle(r.caretStyle),vo(!0)),e==="smoothCaret"&&Yt.updateBlinkingAnimation()});function Zy(e=!1){Yt.show(),vo(e),Xy()}class Bs{constructor(t,a,o,i,s){this.unit=t,this.convertFactor=a,this.fullUnitString=o,this.histogramDataBucketSize=i,this.historyStepSize=s}fromWpm(t){return t*this.convertFactor}toWpm(t){return t/this.convertFactor}}const W3={wpm:new Bs("wpm",1,"Words per Minute",10,10),cpm:new Bs("cpm",5,"Characters per Minute",50,100),wps:new Bs("wps",1/60,"Words per Second",.5,2),cps:new Bs("cps",5/60,"Characters per Second",5,5),wph:new Bs("wph",60,"Words per Hour",250,1e3)};function dt(e){return W3[e]}const iu={suffix:"",fallback:"-",showDecimalPlaces:void 0,rounding:Math.round};class z3{constructor(t){this.config=t}typingSpeed(t,a={}){const o={...iu,...a};if(t==null)return o.fallback??"";const i=dt(this.config.typingSpeedUnit).fromWpm(t);return this.number(i,o)}percentage(t,a={}){const o={...iu,...a};return o.suffix="%"+(o.suffix??""),this.number(t,o)}accuracy(t,a={}){return this.percentage(t,{rounding:Math.floor,...a})}decimals(t,a={}){const o={...iu,...a};return this.number(t,o)}number(t,a){if(t==null)return a.fallback??"";const o=a.suffix??"";return(a.showDecimalPlaces!==void 0?a.showDecimalPlaces:this.config.alwaysShowDecimalPlaces)?H(t).toFixed(2)+o:(a.rounding??Math.round)(t).toString()+o}rank(t,a={}){const o={fallback:"-",...a};if(t==null)return o.fallback??"";let i="th";const s=t%10,l=t%100;return s===1&&l!==11&&(i="st"),s===2&&l!==12&&(i="nd"),s===3&&l!==13&&(i="rd"),t+i}}const D=new z3(r),as=document.querySelector("#liveStatsTextBottom .liveSpeed"),os=document.querySelector("#liveStatsMini .speed");function H3(){as.innerHTML="0",os.innerHTML="0"}function O3(e,t){let a=e;r.blindMode&&(a=t);const o=D.typingSpeed(a,{showDecimalPlaces:!1});as.innerHTML=o,os.innerHTML=o}let kc=!1;function Bp(){r.liveSpeedStyle!=="off"&&we&&(kc||(r.liveSpeedStyle==="mini"?(os.classList.remove("hidden"),W(os,{opacity:[0,1],duration:G(125)})):(as.classList.remove("hidden"),W(as,{opacity:[0,1],duration:G(125)})),kc=!0))}function yd(){kc&&(W(os,{opacity:[1,0],duration:G(125),onComplete:()=>{os.classList.add("hidden")}}),W(as,{opacity:[1,0],duration:G(125),onComplete:()=>{as.classList.add("hidden")}}),kc=!1)}ge((e,t)=>{e==="liveSpeedStyle"&&(t==="off"?yd():Bp())});const is=document.querySelector("#liveStatsTextBottom .liveBurst"),ns=document.querySelector("#liveStatsMini .burst");function N3(){is.innerHTML="0",ns.innerHTML="0"}async function U3(e){const t=D.typingSpeed(e,{showDecimalPlaces:!1});ns.innerHTML=t,is.innerHTML=t}let Sc=!1;function Rp(){r.liveBurstStyle!=="off"&&we&&(Sc||(r.liveBurstStyle==="mini"?(ns.classList.remove("hidden"),W(ns,{opacity:[0,1],duration:G(125)})):(is.classList.remove("hidden"),W(is,{opacity:[0,1],duration:G(125)})),Sc=!0))}function vd(){Sc&&(W(is,{opacity:[1,0],duration:G(125),onComplete:()=>{is.classList.add("hidden")}}),W(ns,{opacity:[1,0],duration:G(125),onComplete:()=>{ns.classList.add("hidden")}}),Sc=!1)}ge((e,t)=>{e==="liveBurstStyle"&&(t==="off"?vd():Rp())});const ss=document.querySelector("#liveStatsTextBottom .liveAcc"),rs=document.querySelector("#liveStatsMini .acc");function V3(e){let t=Math.floor(e);r.blindMode&&(t=100),rs.innerHTML=t+"%",ss.innerHTML=t+"%"}function K3(){rs.innerHTML="100%",ss.innerHTML="100%"}let xc=!1;function Dp(){r.liveAccStyle!=="off"&&we&&(xc||(r.liveAccStyle==="mini"?(rs.classList.remove("hidden"),W(rs,{opacity:[0,1],duration:G(125)})):(ss.classList.remove("hidden"),W(ss,{opacity:[0,1],duration:G(125)})),xc=!0))}function wd(){xc&&(W(ss,{opacity:[1,0],duration:G(125),onComplete:()=>{ss.classList.add("hidden")}}),W(rs,{opacity:[1,0],duration:G(125),onComplete:()=>{rs.classList.add("hidden")}}),xc=!1)}ge((e,t)=>{e==="liveAccStyle"&&(t==="off"?wd():Dp())});const j3=q.record(q.string(),q.string()),G3=q.record(q.string(),q.object({text:q.string(),progress:q.number()})),e0=new pt({key:"customText",schema:j3,fallback:{}}),t0=new pt({key:"customTextLong",schema:G3,fallback:{}}),a0=yk.omit({textLen:!0}).extend({text:q.array(q.string()).min(1)}),Zg={text:["The","quick","brown","fox","jumps","over","the","lazy","dog"],mode:"repeat",limit:{value:9,mode:"word"},pipeDelimiter:!1},ut=new pt({key:"customTextSettings",schema:a0,fallback:Zg,migrate:(e,t)=>{const a=structuredClone(Zg);if(typeof e!="object"||e===null)return a;const o=a;return"text"in e&&q.array(q.string()).safeParse(o.text).success&&(o.text=e.text),o}});function Jr(){return ut.get().text}function wo(e){const t=ut.get();ut.set({...t,text:e,limit:{value:e.length,mode:t.limit.mode}})}function Kl(){return ut.get().mode}function ls(e){const t=ut.get();ut.set({...t,mode:e,limit:{value:t.text.length,mode:t.limit.mode}})}function Ku(){return ut.get().limit}function ye(){return ut.get().limit.value}function ve(){return ut.get().limit.mode}function Ua(e){const t=ut.get();ut.set({...t,limit:{value:e,mode:t.limit.mode}})}function ya(e){const t=ut.get();ut.set({...t,limit:{value:t.limit.value,mode:e}})}function Ts(){return ut.get().pipeDelimiter}function Ui(e){const t=ut.get();ut.set({...t,pipeDelimiter:e})}function Co(){return ut.get()}function Tc(e,t=!1){if(t){const o=Ls()[e];if(o===void 0)throw new Error(`Custom text ${e} not found`);return o.text.split(/ +/)}else{const a=Cd()[e];if(a===void 0)throw new Error(`Custom text ${e} not found`);return a.split(/ +/)}}function Q3(e,t,a=!1){if(a){const o=Ls();o[e]={text:"",progress:0};const i=o[e];if(i===void 0)throw new Error("Custom text not found");return typeof t=="string"?i.text=t:i.text=t.join(" "),zp(o)}else{const o=Cd();return typeof t=="string"?o[e]=t:o[e]=t.join(" "),i0(o)}}function o0(e,t){const a=t?Ls():Cd();delete a[e],t?zp(a):i0(a)}function Wp(e){const t=Ls()[e];if(t===void 0)throw new Error("Custom text not found");return t.progress??0}function ju(e,t){const a=Ls(),o=a[e];if(o===void 0)throw new Error("Custom text not found");o.progress=t,zp(a)}function Cd(){return e0.get()}function Ls(){return t0.get()}function i0(e){return e0.set(e)}function zp(e){return t0.set(e)}function Gu(e=!1){return Object.keys(e?Ls():Cd())}let Hp=0;function Xr(){return Hp}function Y3(e){Hp=e}function J3(){Hp++}const Qu=document.querySelector("#barTimerProgress .bar"),Yu=document.querySelector("#barTimerProgress .opacityWrapper"),za=document.querySelector("#liveStatsTextTop .timerProgress"),Ha=document.querySelector("#liveStatsMini .time");function Op(){we&&(r.mode!=="zen"&&r.timerStyle==="bar"?W(Yu,{opacity:[0,1],duration:G(125),onBegin:()=>{Yu.classList.remove("hidden")}}):r.timerStyle==="text"?W(za,{opacity:[0,1],duration:G(125),onBegin:()=>{za.classList.remove("hidden")}}):(r.mode==="zen"||r.timerStyle==="mini")&&W(Ha,{opacity:[0,1],duration:G(125),onBegin:()=>{Ha.classList.remove("hidden")}}))}function X3(){let e="0vw";(r.mode==="time"||r.mode==="custom"&&ve()==="time")&&(e="100vw"),W(Qu,{width:e,duration:0}),Ha.textContent="0",za.textContent="0"}function kd(){W(Yu,{opacity:0,duration:G(125)}),W(Ha,{opacity:0,duration:G(125),onComplete:()=>{Ha.classList.add("hidden")}}),W(za,{opacity:0,duration:G(125),onComplete:()=>{za.classList.add("hidden")}})}function eh(){return r.mode==="custom"&&ve()==="section"?_.sectionIndexList[le]-1:k.getHistory().length}function Zr(){const e=Xr();if(r.mode==="time"||r.mode==="custom"&&ve()==="time"){let t=r.time;if(r.mode==="custom"&&ve()==="time"&&(t=ye()),r.timerStyle==="bar"){const a=100-(e+1)/t*100;W(Qu,{width:a+"vw",duration:1e3,ease:"linear"})}else if(r.timerStyle==="text"){let a=Ye(t-e);t===0&&(a=Ye(e)),za!==null&&(za.innerHTML="<div>"+a+"</div>")}else if(r.timerStyle==="mini"){let a=Ye(t-e);t===0&&(a=Ye(e)),Ha!==null&&(Ha.innerHTML=a)}}else if(r.mode==="words"||r.mode==="custom"||r.mode==="quote"){let t=_.length;if(r.mode==="words"&&(t=r.words),r.mode==="custom"&&(t=ye()),r.mode==="quote"&&(t=me?.textSplit.length??1),r.timerStyle==="bar"){const a=Math.floor((le+1)/t*100);W(Qu,{width:a+"vw",duration:250})}else r.timerStyle==="text"?t===0?za.innerHTML=`<div>${k.getHistory().length}</div>`:za.innerHTML=`<div>${eh()}/${t}</div>`:r.timerStyle==="mini"&&(t===0?Ha.innerHTML=`${k.getHistory().length}`:Ha.innerHTML=`${eh()}/${t}`)}else r.mode==="zen"&&(r.timerStyle==="text"?za.innerHTML=`<div>${k.getHistory().length}</div>`:Ha.innerHTML=`${k.getHistory().length}`)}function Z3(){we&&(kd(),Zr(),r.timerStyle!=="off"&&setTimeout(()=>{Op()},125))}ge((e,t)=>{e==="timerStyle"&&Z3()});const th=3;let Us=!1,ah=!1,Ra={};function ex(){if(ah)return;const e="body, button, a",t=["app","header","footer","main","#bannerCenter","#notificationCenter","#capsWarning","#ad-vertical-right-wrapper","#ad-vertical-left-wrapper","#ad-footer-wrapper","#ad-footer-small-wrapper"].join(",");Ra.cursor=[...document.querySelectorAll(e)],Ra.focus=[...document.querySelectorAll(t)],ah=!0}function _a(e,t=!1){Pp("focus.set",()=>{if(ex(),e&&!Us){if(Us=!0,Ra.focus)for(const a of Ra.focus)a.classList.add("focus");if(!t&&Ra.cursor)for(const a of Ra.cursor)a.style.cursor="none";Jy(),Bp(),Rp(),Dp(),Op()}else if(!e&&Us){if(Us=!1,Ra.focus)for(const a of Ra.focus)a.classList.remove("focus");if(Ra.cursor)for(const a of Ra.cursor)a.style.cursor="";Xy(),yd(),vd(),wd(),kd()}})}n(document).on("mousemove",function(e){zi()||Us&&e.originalEvent&&(e.originalEvent.movementX>th||e.originalEvent.movementY>th)&&_a(!1)});const tx={title:"Minimum word burst...",configKey:"minBurst",list:[{id:"setMinBurstOff",display:"off",configValue:"off",exec:()=>{Vl("off")}},{id:"setMinBurstFixed",display:"fixed...",configValue:"fixed",input:!0,exec:({input:e})=>{if(e===void 0||e==="")return;Vl("fixed");const t=dt(r.typingSpeedUnit).toWpm(parseInt(e));Yg(t)}},{id:"setMinBurstFlex",display:"flex...",configValue:"flex",input:!0,exec:({input:e})=>{if(e===void 0||e==="")return;Vl("flex");const t=dt(r.typingSpeedUnit).toWpm(parseInt(e));Yg(t)}}]},n0=[{id:"changeMinBurst",display:"Minimum word burst...",alias:"minimum",icon:"fa-bomb",subgroup:tx}],s0=[];function $s(){n("#words, #koInputVisualContainer").css("transition","none").removeClass("blurred"),n(".outOfFocusWarning").addClass("hidden"),JC(s0)}function r0(){s0.push(setTimeout(()=>{n("#words, #koInputVisualContainer").css("transition","0.25s").addClass("blurred"),n(".outOfFocusWarning").removeClass("hidden")},1e3))}const ax={afrikaans:"654f8a7ffe6e9e63b08c568c7cf005968981bb91e05e128c1eff8180f740b2a7",afrikaans_10k:"c1e3361c8ea41d021b9505850a191af51d870631c9a3a03cb35056f0b754c43c",afrikaans_1k:"c7f3d0a9f997d44303af6d0393c69efac5e522298394feeda98f41e2c8c9c1c8",albanian:"b5de15563f7ec674f2d531412dba85d83b60220853d90e765c274cf60abe5856",albanian_1k:"83968465aa0ec5052bb96302adef4f70077aa815219afba41b5595b0b6c37c09",amharic:"bc41917d7306f456bd86dc489aae403bb7507f5681960f3b9fd30152a0614d91",amharic_1k:"e759c7c9e64332f430d27c685f77ff4e2c2051165939cf05a877d13c7da55bd4",amharic_5k:"a22f8cabebccd5352d492dab8328bf8a812895f6012f2aa31dfcc5cb116208af",arabic:"4cb6c81a965ea73cb1e91dbfd6c3938146cd8a3c2f7cc79a2ce67fe8065b86e9",arabic_10k:"0ca61d20de7a045a16b14b72adb65bb7d8338a867bf22bec5f4b66589dce678c",arabic_egypt:"3d6a3e4968304d6eb82e029f6c53875cb708f5b0277a237810f353036ef07898",arabic_egypt_1k:"119fc91f555392e4324ea65ba160a14c84f5469c7897ff679c57d8e120a3e8b1",arabic_morocco:"55922ffaf5ac80e54c65f463890c6d6ea1b3465dafaa789e0467a0952929d742",armenian:"7a4371ac5f6b7b6ae455ab011bfac51c8e9065174a896b637949aa3153388a5b",armenian_1k:"b08b7ec92dcc2d9b33d004831034ca9a04df10673b863228a60cd53549181d90",armenian_western:"e4ea65d2311a40ec60857820aca4dbb37a3760c258eb5c13209cb39a7f42f980",armenian_western_1k:"ad979ba585678d20cd707108bcc6a7254e16ebbca95eff6b24c659d51a3542b9",azerbaijani:"95f24bf8668df3b1a76dc175fbc29ffb326d7d8e8205ba73f4b71eb7c98a4b48",azerbaijani_1k:"6b4c07b507c8e3c1ee07f699a6effb07c9e34490ecff4cb43b0a3bcdfc290394",bangla:"15809945d0d74ecceca68e3921d764217ec5376cd7ac2bba0aa6040d8fd9838d",bangla_10k:"9bf45b2fee1461683771a0a686e0185c21e332902cd51ed8cbc41d12d9d5e34e",bangla_letters:"fdaf4185fa1c8663208e6334f684cc8e84934c02573dc4ab990281b504cc8042",bashkir:"dbe83f3f7e97a9fdcf59777f422b3f830a09b93fb638a3a904089dcabb37b913",belarusian:"0b63a4ca1af298b64bdd84990df2aced80ed195fa18399307c76e917d35f7821",belarusian_100k:"8a3887cb8644e42dda0803609e9f1a4b8b383781a06fb8cbeb43f79d6ed9ff65",belarusian_10k:"fcd4adfc487d1405f258ebae17a753aed1fc34da48a1e0ef2501a20c63d7b75d",belarusian_1k:"50742a4854b3fdc198ab0e1da2fdf662d8e3145b5e17a6aedefd25cd522ad426",belarusian_25k:"1ffcd03111f935397f187efdeec0651dbec2bdb452fdc8b0ae5a1bea27c8cb1f",belarusian_50k:"2694fd62f3aa527678b7024f862d4dfed3d655f8161d785d156d3a4df8f71f6b",belarusian_5k:"824b544532e4d40cef933bf3dae36ae5c03541398ba388349bc446205a6cc803",belarusian_lacinka:"3dcf64d002a38001c71d55bc2504c75f4f14f9c86a3c5802a56e0a41f06504e3",belarusian_lacinka_1k:"76f54286481701d3d54747d66eb465d04d005617e7dabcf2481cc368cabd2950",bosnian:"c1dafd4f50c3d8381ba35bca1c82a3a34234120fa23b890c882110f118b59723",bosnian_4k:"7eafc78c84967c8b14b9e7c26d8cd5e43bd8e36c6c1a2b5b41593815c5770382",bulgarian:"b910cc80a37015bff686d09c4b0b6ad83f78aa4f124076e35492a3270f79824e",bulgarian_latin:"5fb7bfa629dd829ffd4a2ebe2533d32caeb2deffaea3e85bf06be203000fa7d6",catalan:"28bd314b770dfa4c3d84a4ad9d4e509616fcac28824cacbfade94d7b9235cfbd",catalan_1k:"f1b96d32471b7fcf93c2d47e7ba71797daf6d7ad037714d72e89088a8441cc10",chinese_simplified:"be597eff68df1330d5e86b16761adacdfff47b8a1b28636e184ed8f1a55835c3",chinese_simplified_10k:"65c7994307985af7a16867e2edf614a984eccbd6bed109fb864656410cb9436a",chinese_simplified_1k:"3b68f48b4ae562300990d85a979907c5db748380e8a2eb13b509bcbefc265c44",chinese_simplified_50k:"209cae39cf2d1fc961442e71c7b1ccd990e8e52da848a607520ad155e1d81bc4",chinese_simplified_5k:"f67a633c820488e85a7e2c8de2b580258da67f0a177b9d311019514203f9a569",chinese_traditional:"16f66cd0a8ff33443fe28fb83f2e29635baae198c2345cdfdd34b59c21e3b74c",code_abap:"62e10348c6d76f84ecf67ae87a60794af59f9aa8ef000b751325988225750186",code_abap_1k:"1cf25cdbf953501fc2e0c612d851fb625d57cda5ebe9068cace694f9803322ac",code_arduino:"818a6d0cdb63d3f059343f5f31c979ead5a55ada8570df4822c62fdab9e99179",code_assembly:"b809d8b99cad85bd43d0c340daf35ac2d58e9114609e969f30981db9af568c49",code_bash:"5d995c9e173d2211f8244a763cf474d9d32274f8e02dfa2c90f597343379204e",code_brainfck:"bd48a900aa32c89075d1edc622c13dbac7331bf70d1cd626f5db8ed4c294608e","code_c++":"8a62cde1ae6572382f9b34fbd031578924eab6fe9197b92975d1ce37937c4016",code_c:"8b8d42d5183a0a113065fc4f03ecf69f317eea5592116f9011bc6260908c7d2d",code_clojure:"3304aa4ca0b1a7021f81c38859dd511871e09044f986fa93fb2c8146e230fa05",code_cobol:"40c79f667c0e2cefcad03225380cceae7476bdc239882115da7db8c1f1b4bb69",code_common_lisp:"7b5e004c5c66b0f5e5dbe103d62164020c52e4646204b2ef18c33de6f0bb95b9",code_csharp:"299c21929376d776644ce45b4efadb8e461a1d554f842c8807c7355e988b4454",code_css:"9236ee768a90d450a8c0e5c3aee45dd06fea4a86f85f69cc313d9d0a3eb463b9",code_cuda:"38d44b996213b50b4de4c79fe9707436f8e58448d1707ede30de00eebcdf40b5",code_dart:"373fe67b30deca1096f307c33baf9367c67ef3a05e8182e7012416bc8bb078d6",code_elixir:"e663677cab488bcb5d85b56695cae6145fa8f1ce5a7ee38244221d3ec01cdf3f",code_erlang:"9b625ebf83d202c03624226a93c08744170769e95d9ec17ab030755ce0441441",code_fortran:"ae3ae038a8b78ec9aa7c043041a9ff41f12c2e6c0fcdb596080bd57b63895d0a",code_fsharp:"36e4f8d025860e3d137ddddde954fa5d69b47439a36f4256d4090001ede577b6",code_gdscript:"3d3ae4a51bca6f6efa9758d96e7af20a1b0e7b3c92076d9cbf77f2189953807f",code_gdscript_2:"7f9d025966bae20675cb012fdb2e2aa63bf35fc6e79d2ec5b877040808bad973",code_gleam:"4e05219fa6e4de0a20bb47ee5db39974ed95baceb2b08bf911594eff93dac12e",code_go:"a597626a3bafc95f004bbf7623096eb983b1294670392a20685a2e647a53ad87",code_haskell:"a4e1d753cc9a6bf705c450e61b5daaeaa14e8d3fc9e4145bab45e5404d14ea4f",code_html:"5af5e15e121adb2e90fd13a42a9e2596bf030bb7159471af626cb426736f0bc6",code_java:"92bc6d6bb22ef2867fa9548a8dc87b0aef27bfcaf9ee6e7e080cf0a71ebbec9b",code_javascript:"3270d6e75633480c0f073f27013e66c01edf55abd1f18727c5dd83a231e1c470",code_javascript_1k:"ad484c1db646b70063d2dba29ae7c0618ba643479f02aef8d4ac2425a78b33b0",code_javascript_react:"79f07fa0d6db6586a7e099a00bd14634420242e4b3a165aca8f86ed5d23fd06f",code_jule:"c995fbe6159f72b73ca01585e4c25d5df55a4ba88dc5e96419d1c6b4e93b6121",code_julia:"27d867aa972185984c1823a5effec781559a7830771d7a9f183d97f2b3fcbe1e",code_kotlin:"2a9226a1c3ed297f772ee5f9c7c72b28b29cc5745f4102d6c2be192618bed953",code_latex:"7cc3447ac9f7d9d8c7b918987ab526a90695581bc0f474e3e9cdf614ee1c5013",code_lua:"e11931badfb2ee1c05cd7d55091ed7209597d8d6d9eac1c4c81690e894d01c1d",code_luau:"807f3f29402e8348ab5c089b271712114b51a292e0ad44cbf0d4aa97046258ea",code_matlab:"78a7c0f1f428b6fa6b0dbbaa661bacdd1c3e0107a9a935afa6f03c01e01706d1",code_nim:"b9d2481a91cdac5327ad5c26cbc50f92c6c46177498fd25f495598ce8f96c479",code_nix:"eaccf934d3ed4dce81d325640ad87da422b2c70828b8082bc597f75e7c7f11ce",code_ocaml:"2c0a5af0e007402c8f807e7b0894e65e9ef04774b5f592bd9c2f1276794168d5",code_odin:"e5cdd8c757e0c7389e7979213eacc166f8fa05400fab639b412433eb7472eae7",code_ook:"f255d31297a126aa4b2d21adf3d516448cf71c7e5f56f0539a5e3cb5d235f00e",code_opencl:"410d313f79db1c7b3a24a5c0b0f030e5b1e07c861025e668ed772d765feb2660",code_pascal:"15386a026d290be50678c422c56828c692aa056b4f31fa51190efa44a4865930",code_perl:"cd532175a2bcfd0f0e4a815fc3b88981b42671141a00886b6a625b947dc845fe",code_php:"acf81331fe0e9f269a1d120c392f633a482bd96120b0b41ad82e2778e97309b2",code_powershell:"319628995a9e02d616b2bbaf6cdedb4dc42c468308dbd812fc7d8b383bf29d9d",code_python:"8e99768d1dd7ed0c904b70f36c0647b41bcd7a1a4c98acaba4cb1a2d68f48255",code_python_1k:"382d0d152126eab82aa115ebc866fcc487800d45e62e5b3e603733d31e4df0c1",code_python_2k:"3e28fa8bceffe0eba9319a33a4d11a5ea2473f4997ff290f0607035c2ba4fa56",code_python_5k:"abd33c6158bd8d46b9913a10469742180353580517462823a30729a282682c78",code_r:"6952bfc9ff965470937164b503c489c5491721a059df2033bf6c266be44803c4",code_r_2k:"c996cb36c7f74d70873cbeba703c50482d3fd861762ac3de823bde72f657c56f",code_rockstar:"31c2921ebd37a7d3d1ef2c46f7ed8053fb073210339ef5cd7a54851e34a5a8a8",code_ruby:"fde2951498e30a353f72743eaf27064e00a757e99ef2014bf109dc46a8b2513a",code_rust:"0b4bf199e69b21c40e0a8a00569ced79a27b19f41fc66a08345fd680cd1b182d",code_scala:"b66c9a0f45130c5234866b4176bd817f9cdb7a63f92e2dbe41ef5bfc68f1b0bb",code_sql:"e1351b4ed8be3bd67913684f71e9b6570a1cca98b207162f5a573443cb1c1ce4",code_swift:"95bcdcd2f3e565a767eab720636af945003d0132e5164c312f7b0ff1caa8b38f",code_systemverilog:"840ace018c4d36942f35c8cb734328d08d2ab113d4530b3682ef9f3157bc1367",code_typescript:"8e5c0be961c5517d53657da355ffdc1973d7c868e77dc27c7d49f7a4fab9a4f5",code_typst:"7c1fa9ac95d5c3f8b842ef997c1a014886c368dfa452c3d45d9f8945dee2ae91",code_v:"b85324670125aa9faf7680db0d6160b10b696dc3cf3b60075c17a28c0bb5d702",code_vim:"29d0478f3063068017579a4a00d4dcb622616511475ae5dc4809b46601043fd3",code_vimscript:"900d791be3f89bd80e0c50bea52bcca1a112fed4ac4df514e662662c121acc3c",code_visual_basic:"55133943d956dd775dd8dab21151b1e4c518ff04be6fb2284242bc80de70b303",code_yoptascript:"f53082b3a0fc9dc25404428ca314336720ab78ba2d9d59eb8baf134477b1da90",code_zig:"1f87ed8920eb2b4ecb733743a37a93e67bce8f093f8d3693de64c218927f1f5c",croatian:"c8e909f0e0af57c1c0a2dd6898e7f54c226d0a12c025453a5e130bacabb8ba80",croatian_1k:"a0f89f20806eff9fefc5d5bba7e9c5b25a65c97d86cb87ab6e363ff71fef9145",czech:"6fd0fc8496b0c990f5fe8a3d7172cb618c6b3b0accaa26e0da15e4f5dc25ba29",czech_10k:"967458b65eac13f1fce48ef3321855278b27a1ec95a3f2d80c5815253e2cd8d8",czech_1k:"0340ef2d13fbdf063023cbf5c5477e875e6ba7a4b5a1ffbdee5542b16f73223b",danish:"b7788e52a047250e514acd7eedd14eca8002b788f013c66fd620e06db2559e7b",danish_10k:"67ec967d43b67a8a70308b4fb1ed2f7620b4ac2e1e8fb637cf005767128ce94c",danish_1k:"45077f00fde0988fccf77e0e767c04a57f02b054d4bd069b505ada3ccf6fa66e",docker_file:"443a1bce00fefe90f69ece5742b140ab1024b69f2675671f8ba44cb277e27bcd",dutch:"b45d538903a4bc37a3590dfad23958ee268e9e96c737e8b42ad70cd7514d5ae6",dutch_10k:"59daa737277a50d63fa9043b7907d4e9587ea2ba12f1276e67b897cab083a95f",dutch_1k:"d12d4acd447560c4701ea5a44df573c5cebaf387b65f1210bd3fd69199f374d1",english:"253965d2581f6cbd8f015272f00f01398bcaa069b00e367a7e6a99f0f66bebf0",english_10k:"4f30781215806d558ea46f61bccecd1793fa1f8bf2f9654ba473dec97f9bbe27",english_1k:"95ddc0c1af383432f228807d6fddbea650c3ec2900c86810acc2659ffbd200ba",english_25k:"5847a211db59307637e4eb793b4a5dc132b102c815d886ae47f6c36b1efb5b9f",english_450k:"8da19763c33ac90330ebd8f2bea6d3e1cc899671f15cc869544a5b1a1d7b8f7c",english_5k:"9b3995bda8615de2515d05a5cb776de382745aae13bbe69aeceea313bad3b916",english_commonly_misspelled:"db9371da74c8097a38345914e1f6a658b7bf63a483b0e7255b8a2c0538b9ba0e",english_contractions:"02ed6cda798cf67180a2c18984cdff212975081614b5da9b6114306b1402c33a",english_doubleletter:"3052132c98599b760ff475a67146320d06e91215c40759b461377c78ced8ee49",english_medical:"16f3533b5803eaef0017793838a04e35f5fe20bd523578fb058b05c21fe87083",english_old:"a0c198a52fde8bb1c39d73ceadaf7aeac5cb0137812bf6263ede5e47077a1cd0",english_shakespearean:"376fd648d2c67e967373b79827c8a57db3a4587e0dd0b484e888d822c8a29508",esperanto:"18898143432b80d22f331b57198f4eb8510949dbc6792d3d66c63077eb0aef7b",esperanto_10k:"e57574c6e2498c9dc602a8d0e3b0fa35ccad20ca64cf35bec8c802be7644e158",esperanto_1k:"5555af14d955ae093d8fd00b3462f5e3a068b9c4b5f2f35fb76af60f2f204008",esperanto_25k:"63b8507e7833205ec5ee21fdfc7c2606fb494155bba456d99b0e998062824658",esperanto_36k:"32bf64ec4c523bc6b07341c93dd8351119ebd58f36e53ae1cde7cce27e5e9935",esperanto_h_sistemo:"a51495e34e5d6e7fd6e980a7c15fed1fb5ed7293312393bac0a97d2fae4533ed",esperanto_h_sistemo_10k:"a9b4ad45ef7222548a07d6f82d9fee2261e5b8f8ba986c64750a8fba25bc2c2b",esperanto_h_sistemo_1k:"a42f549733c204af9ff76811c79cc99abc5a2c53f75c7b40b0d120d1fb4da506",esperanto_h_sistemo_25k:"1176a980150816c8c895a0283e9215cd4592ae96b7f2b0623a0018f55fd0a5b6",esperanto_h_sistemo_36k:"373888cbe1640cc3f4ceffaa0b08e6630b001434ed642f4393757216f443f05e",esperanto_x_sistemo:"9a844890c855a4a6d05073599e5981e6bc63dd4782fe9c8d08ffb40b8e3ab051",esperanto_x_sistemo_10k:"396fa00f80f7cccf326cdaf37fba0598a0d482c141683f955fa41121d6e9f65a",esperanto_x_sistemo_1k:"33ead85cdbe8237da83cbc497f9c162b3b90ee762372218f32df6f21dce0cba7",esperanto_x_sistemo_25k:"07f67e10468a4e2c720ef5c355a0a197ec8eb87963da320da6b0fea95845346d",esperanto_x_sistemo_36k:"fad8cacf82eed3a5f90ddc08bdeca5493e2e8bd36ce9e212662039be22cdf894",estonian:"6e0575cb7222eabd972b720a56af4cb260bbb5608609c574a9918dc780e97419",estonian_10k:"50b95590c235b2081cd5ada4c25bd3a3dd714de4cfa839835b10950dc9f3f634",estonian_1k:"77ff7ad7164a0a6fcb1f046a9d55277154966aec16c0ed33ea42820e1f229a56",estonian_5k:"94c98cc7dc638a1fc6d2918326f7608e6cbc6c4044452767a6e2c140908ea0f9",euskera:"c800126fb5d0cfad8de37e8d8b46252ec47ac16604107e181a9f4d5822838c6b",filipino:"fe7cf2e92e29bce0f2ad97202a350c21b4f26a363ecc41ffb2744c6f138311cb",filipino_1k:"bcbc3fed67db5a8c443e2e2642e3020b57bd679ba56840fee769025a9d4668ea",finnish:"97d060729de2fa3eb3ab6f7da6a58153029641a26384a5f9f23385f801fb5a11",finnish_10k:"79217cd7b4ae9c428d26a762d255f53538eee085818aede3fbc171966c05d339",finnish_1k:"c0a3e82e88c8d3c22a1db9924156bdaf4adc328afefe1d729f26967f438221fc",french:"5b53ce8727edbda94cf4955182d91bdc2d2d6f868f0c7186095ca02fe2d3d945",french_10k:"1900e5d88ade6903333f992828242a8b5446f62fd2a6d640a6fc0ebb53f604ed",french_1k:"415a6a075532c476cb7279fc68f1c32e1aa22b345bd136f78ef516ec947309b6",french_2k:"1539845556d88a3f4106a072eaef1aaf6f9c6942d2f6f2963a009018e7deda15",french_600k:"27cb016f5d1e9ae632a07848d86338dbd2101d804aad8073d233de666abef21d",french_bitoduc:"7bf2fb5e0f5d4534ac642041f32c361679fce99c4fed4737f22b8b73a4df514e",frisian:"b24430f7b16f2bbf1afae93c0d9b43405135c01b45b05818cd03cdf5c9e48782",frisian_1k:"1c58dd2b506a7affa8f4ac5a537824f31fd1ff0225fe64034986bf32f552c510",friulian:"3f1110210cc868db0045b1dd7d1c5f200d016b7dc13b5bb9f7e4847a4b513b64",galician:"34301e12606ea2e9d65684f810c13e3874e9b9306ae39daf29239d1b936442a0",georgian:"be5d8d4c69a7538141b6b5c96f467e55acea3ba354210f73853ec701e106041b",german:"c2caf567ee18f09aae0ecee6092a6efe439cea1b7d18a2300e99047bcd1f9961",german_10k:"3b9ee1fcbf5082c3e55a542e5150f9fdf0bebefda0e409c3c15a03f6d11e3569",german_1k:"82bcc90cfe49b785d426ab5b0a760165c25da53e25c2979a1fb69c7b8cd04b59",german_250k:"a638ee31ea4dd7cd64b7db1a86d592243edc912fec26c8609b3f133ad0f37a18",git:"dbd7eeb44833bb642da20d772dc672a3e7c0ed09a17437db322b7eb91c8edcac",greek:"fb1bc21c3ee3923e1942bb95394327b70779fd9477e2a05697ad5a000528030e",greek_10k:"6d305831131f85d09ee7e44059fd6abbdf641619974a18257533ed606abfa627",greek_1k:"de81c001f7db19016866f90431c2ac375c08651fd5240c3ce6d287dc0236d6c6",greek_25k:"7d39919392aec67f2d4c025919a627ffb0e471e63583596e6a6622779a1b7ded",greek_5k:"e4439a1c018792273041e04d788dad6f3e02d4ca0aa8449ad046e2d05d146100",greeklish:"af60eb28e8e13d6b967e92f00d1a6c088cb19c98ce6d4b3bf25482129d66cc0a",greeklish_10k:"81e050d3a22b76836645ab283105546a9af4eba46169397c8c0eb9f00fb3d9eb",greeklish_1k:"7457452b0db40c432e42298d7fad05341249c3d01a66c90f137e77b91031ee81",greeklish_25k:"c55313d8a3f3b7fa33d6a5aba7a77156c6460b46c51cf225c841a2b0a21edd74",greeklish_5k:"1de8c5ba6cfda13519463ac66c58a6b1f4b40b0ff63ffefe402392ba173701d5",gujarati:"29541768926ce62dafb447c2ad7baf6e4e9a59ebb8a2ab76313fb644cb91ece2",gujarati_1k:"48e9a951ca3b380300b902b89ba69d4bfdcb9b47d914c5d0893247761a066bd7",hausa:"12599ee0d7e82d9c189e109e17e325e91c6d843c1f9e45880e3c3ba2bd873655",hausa_1k:"27b79d6e1e47c9a870dbab566f3c74f7a31a811c9f15914b909c7b29ccae70f9",hawaiian:"4eb2e79f6b86ab674d2876e295d87fbd9bd2e53a10c5a2eb35d13e0e45259dea",hawaiian_1k:"19cf51d578cdf847eb87a8a0b2cdec90ed7b0212eb0fd7a05a1bcdf81dc6c8b7",hebrew:"dcba0d86539a926d4fbe19971a2b68a4d9cb303ca6be82778a2c1a853fbddb49",hebrew_10k:"ff831c8c225c82cd81572df1ca0dfe3cf7ac15e7d413518da623401ad5281069",hebrew_1k:"708c4f8c097feb48a16ff0254e787f1152eb45231a1ce06a3063fb9ba81da02e",hebrew_5k:"bc673c4684a2d678476e48325a8ab9e530e0ba45aa5549a6511106ca06b18a96",hindi:"d02d6a1585d060dd39a9c19e09d413c91317986d66802da4fdbea3c3e108f732",hindi_1k:"d577765c0f6d98d0f663a03f05ce038fa6e2432080f7db9d93ba23b0790a72a4",hinglish:"35d359e1f73bc5e239f91efad1d007a2c10eb7c7829293655b5085bffa09b219",hungarian:"c3cfe0e30f073f1a8d868c5c8d52f8b02d4d3ad1dbcbbfe231f104468c705231",hungarian_1k:"abd118f6168c93f90304f201abd523c7d29a62485ebf34a90a18215adc515e39",hungarian_2k:"64b2cea7e3ee62dce39a1a50576d09b0eacaa4cd001272e609a2605d8dd61e9b",icelandic:"c353b486606eb13dfdbe4c26c69cb2ae732d0c5303a52f0ff7e55ee51ea3129d",icelandic_1k:"6e7efe95983183268a0b2efdc961be30bdbf5e0d70874f609e38c4cbe1518e32",indonesian:"cc0b723eb64435c4c3be589426d1ec1e76d651e180542c0f03e7da1f3d28e13b",indonesian_10k:"54cc7722c753bf2a10aa29b9c125967ded99c92a39918af549bc4e937ac937c4",indonesian_1k:"b9b4098836e5ff448788c5cd863cb2849cae40505f45b947c67305531b442250",irish:"2e7a5f303d3d6d815a4aceb8e94a183430076e138c8c422870109e875e0eed73",italian:"5a6c3b3afb002d28c6e4535e5758208d8b3117e64b9da99f48d9b76a84ff92c4",italian_1k:"a275c6fb5faef76db524426ddba89172a9d7112be41c7d69db66e532ca3e239a",italian_280k:"db4981e72d2e0e2864039a4cd2fc2c5a8008db3e301bbf2feed24c33586d463b",italian_60k:"37655520e59c9579e3045675c47f424cd007afc9726df6d494655dd1be510109",italian_7k:"4a32cf8e0fc8ad9352bdf25254eabba4ac21aea6d0cc94a9aad48d33e27ad4eb",japanese_hiragana:"a319c93e893af78bc127b12c05c2c2fe220990ba3be6dc37593b379e3bc4fbad",japanese_katakana:"2ee1eba3e2177db9d9c4107b9c6638aca86af7f07f0b2fd835350a8300f707ef",japanese_romaji:"b3d7533ba4948fa39ccddd96bc64e17fc5e60ef84f7d88417bf91109d717eaa8",japanese_romaji_1k:"96092be026fca0735f8d06a5387fffdc249b6ea5a07ade2cc72de6d408ce2020",jyutping:"6f5de5de4b14aa9193898c777e5c53dee94603307128205664f7b39ea21cd8d7",kabyle:"947580bb10f0aa66aee44e3f01d946dc9b23fb4bff132d916b2952e5fa0660bc",kabyle_10k:"9901d2d720c735f515da18bc534adc16622e31847f97e45c355445234a0b1424",kabyle_1k:"530eafe3ab575badcee939c9b34631fbfd3554d2b397a802b7c89897a8ad5273",kabyle_2k:"dd58c67529a45d92b8044a4e90d3556eb304932e17938905212a744d0226416a",kabyle_5k:"bfd15adb2df178af1be05feca954e188c9ece5bb500037ac81b70dd738469660",kannada:"d0ffed0863f660a7957ca6aa35afdc2148b87daaebde65cb7fdb0dba572d24ad",kazakh:"7eadbcd2133a69c4de8e614917ac044160dbbe18c402a4719a9131e89a675f45",kazakh_1k:"17ab99ad8a7c2e315d8783927c4cf55ac4c3e7d7dfa5d80640333bdef2cd6554",khmer:"757b239b8fab806eb22b39da2ac611f6c7f640e3d2eb6ffb7f6d8f8b3e0d4891",klingon:"efb9b0635ec83a0668e00d382a0c3f571ff2c15719a3e8cc176df8901fa73fac",klingon_1k:"4f27bbfe67b92d2b58e473fd7c89e7ec32d6a8f9e622f59a153aca33a1c239a4",korean:"123210dd240c2b508d90e0c923ed915e2fa87772c2c381e79da1a042202dac0a",korean_1k:"b1feb16d21734e4a8b4efd2ce104499f4945029247254db176bb6bc7e68f3074",korean_5k:"8764b4661021f6c2d41d4f1514df72caf18e3e486de1879c0034be3a763cd240",kurdish_central:"a77988c700c5568bcc6caa53d22da6ff6745aa8adebd82ef8d0418f829192593",kurdish_central_2k:"316d537f8cced13c97bad76a0e9c7e2c45e94410e46335fa50c6a0d0386f9e53",kurdish_central_4k:"fcb2b9b450223af340f5a479eec727a6d332f755c06969fc1acfae719b08a97c",kyrgyz:"a7fd20ab0973cf1d3e44f466a3dba009cc3b759d746aa9ae0ea391f4cdab0009",kyrgyz_1k:"2e9eb8559df934bb8b1e96cfcc2d0c5b8fd2fe3c79877cd43557e4ced0f4e70d",latin:"1ec6b10f6e3e412253abe64b55d686fca1db7fc3cb9445b9ab9e28c9ee80d2d1",latvian:"15090d064e6ef5080e6280c2cea036f391aaef152652b945458480730a87284e",latvian_1k:"d6702463da4ffc0bf865921000d3af547ce201f299f19f64213fb5b8ca3df1da",league_of_legends:"badd838e6d593653068fc1db197df0fc3ed0052a37895e0508de7f10b798c275",lithuanian:"f02455846da11fa4e7386a534f133e1e7f2c306b165ebcdf796fb038676ec6b0",lithuanian_1k:"d95c2e4be4c711472effbf4e95edd57b2be9525502b0152a16e073a37ba011f8",lithuanian_3k:"cc0994bad9182a6a9eea922a208314ef154093384082024a67e69250d378e743",lojban_cmavo:"e9eca6a86147f3c319c26960fbe8fc2eeed17c0861e6fae67a8727a2e27948dd",lojban_gismu:"2f78c532ef5d08959744a2b8797789a519d829c7adb261f062b4d08c7a685968",lorem_ipsum:"2d0f8654550ee8b47290cd09983bc5560ab1524f6ef3f397fdadffd16d10c7e2",macedonian:"079eff9ae13ad2b87202c65f08a8e715143a4f5c8a9196f56a526b34d8850462",macedonian_10k:"bbe2aed361bf09781ed23dccb39f4f8465a5850eb0cefe225ae6a7abef81c73d",macedonian_1k:"0d875624ffe073889bfe62fcf3696b7e80e9f599f6556d8f2dde2250920bd485",macedonian_75k:"f603af89735baaaf73dbbaa4a16d915e9d89c0e50d8b03d98bb346475b997ade",malagasy:"3c604d1ff6759e4c1d7d9941388e11401ddd034c60342435fd851f5a135976c3",malagasy_1k:"0bf3ef364fb37976f197280ecfc7d8f70e94ee93249e670cff85dee75cab4bf5",malay:"fd321d10f2472a8ee3b448673021fb2c404244fe7dca3414b8563eac6bd476a9",malay_1k:"51e4f1785a6c09d518e7581987aa6f63e1c0ab438d8bf5294b79c2495b55024c",malayalam:"12a8a828560cacb69d3724f525af3240fa0b8ed0d7de85d711e6466b4d3ac20e",maltese:"d4313f792d3ca5397eb616c3867957a373510482ab17c9c3254ea0817ec19e37",maltese_1k:"126886b0d28d0a4bbdf84f46c003e91754c130b31df05c9aa48b4a6659241b75",maori_1k:"b8b6b7d28744625d1f1a93e2a526f25b5ff1fe0dff573cec5431b4f40f2e9b18",marathi:"72886f8b97ed17fcef73ab97546c5701016c0295109cd31513a211a4d6968599",mongolian:"f58382772bc7b5de7bd9568f82a709a743c0c7cd09e099b601a3f5889242c721",mongolian_10k:"b1019361468cc36fd07fb6b4936504e25a3e30aa15bf82a868d2067b56b36443",myanmar_burmese:"fc5ac6e4c70cf3aaa11643010f963c7d2a402f10f81b8111087f97c38cef6ee8",nepali:"ed63f5b30ce11f96ca25149c68ec94725b38144fa410a33b4ce54c1da90d3be4",nepali_1k:"caab902263e38d0fc073945511b501180a62996c2fcb130b942db4c53a9d2be2",nepali_romanized:"5aab2843b093c22f5ae7eafdd43040bbd38fd3a8791574d8d281db0c06a8733d",norwegian_bokmal:"5809762d30068a2a61c2fca49709a79729ea0d5627e788f93548057ca3333fba",norwegian_bokmal_10k:"4d37f68b0d44a4fc55fbfd545b7fbdf6b614febee6dd9a2944cb599464a40dcc",norwegian_bokmal_150k:"db47ba8a239a38d57cd2ea69954fe7160f872c07f193c2c1d8d28b2d15df2786",norwegian_bokmal_1k:"bf14054e03d604d0dcb9a5a07fb3b29e4e20e06c864ec2cffff0c6e414385da4",norwegian_bokmal_5k:"cf53f353c93fdb4ad40a071cb2cb39f2b2168643d8d7684edc7507d36e81163f",norwegian_bokmal_600k:"0e43bf193dde65683076fef88afb6f887a64f7fb278a64a372af383edfa28341",norwegian_nynorsk:"a3c7fd011ebfc658dfabb81a71c10fcab257f346abb4f714abdb93541c2e8ef7",norwegian_nynorsk_100k:"f72e9ad5af12940cfc9788503e7d6ebd46379ab566e0e46ef8471e7dd939d212",norwegian_nynorsk_10k:"21533df997c261e949556aba71ed2408d1c447496d176a2bfa28249d5bc0dddb",norwegian_nynorsk_1k:"5430194b6e33d1e9fc8725fe0573a892787abc5f2952fdd2d87bec4b63dfa9f6",norwegian_nynorsk_400k:"691091b126cb955672fac29bd8e722d3f352b0e655af6fe38fb81b2222055733",norwegian_nynorsk_5k:"0394aa7d1d989c1cf6d91517cdabc4a6f60b897ab74ecb7067018c0653b2657c",occitan:"5ac6f97bcbcbc6bbb43fd874b6bb2081ca9babab0f3e319383b7076b9bb18725",occitan_10k:"0d163ea55456831ab249c762595a3b44a3f4fbd60c40df17527d479c6bf52ca3",occitan_1k:"d8e6b083bf164f9b0dd9efba9ffaa092d59508f8309ba152c2fecf4397313d82",occitan_2k:"0dd8d764ded7fc69d5c7b91e066a5cb7b20a962bd3f845afa35457ce30c939be",occitan_5k:"c52dfb474201b20a65bd3b924aaedc47a1161ef021992ee92b9b240acb6c1bf5",oromo:"d3a12d48c5271c289b44752b20cd292b8637340bd39d5d2422dd8134bea85266",oromo_1k:"82e388fe4e5c91824244921bdddba1c9be28003cd339c2bfb96fb0be0c2ef82d",oromo_5k:"5ac62b4ccc39f46f9c29878e70e209d569b72cac4651ceda460d9bf6f958e4b2",pashto:"9628308657c3b06bfa9d7356c5bcb002eaec8ccb5e67f3b302e269f769b6fab4",persian:"64aaba40ed14e61e4b1bb5891b163c18d3fd30dab99468d1a773e8ea1c65ad03",persian_1k:"448ad827f61f0b8569a0e106979494cbaa827ded3f4ec1cf3061287db3c150fd",persian_20k:"4113246b95626454c316e93564fd9d950f7a49883fa6617f216747d891c4745d",persian_5k:"cc74c68b29902ee75ed598e4696bb228d834f84bf79ecd559ceea62e298c5656",persian_romanized:"f4edacc72a55173cc70fe67a905b6d0940a03030901b19a016f54a4b4d68edde",pig_latin:"e0cbaa48295107db1a5a7c681c197431b00db195d5df8396b241c057288a5da6",pinyin:"c2b633966a6b6dbb8c7f259e6fb8ef9b38bf50ddef1631c8291930505a937d1e",pinyin_10k:"bd800567b583c5aba5377dfaacffd737f467c8eadefcf5541f8f062b4d65cbb3",pinyin_1k:"d78c5079213d89d026c960ca8e8b9f36c58737987b65b6f2eae1ff4862ff8c60",polish:"66ed5d2f2e71a058d0d872e8b072b0ca09f0d057275de277e20fafed217ecaba",polish_10k:"bea3dfab31bee37d35eaa7abaecfc9745c2a0eab0349da09e190af29850c3de5",polish_200k:"b8368fd682563941327398428b37b08da096ca03cf1d4fac8f42131b385554fd",polish_20k:"c678e3b10a1a64b30c3a57eebb385ca3641ad95574df73fc76d3e9b5e58bf53f",polish_2k:"d20d4cb9a8eddc2fe4e9f0ce8a3f8a1d9db70380d2dd636f7b981f9be829f605",polish_40k:"32c629230e23338610760a52886d85d4c1e3ed9592e5068a810f016e127be989",polish_5k:"3b2c26c7aaf8c814681df4df5eb902b3bc44bea5ed2eaeaf33d141d887d0b095",portuguese:"349962e64a8581fe38ebedd8235663421939e5c28d1d2ec0a51296add4096d60",portuguese_1k:"9a128edfb342a06ac7e49af7b37a0f6947a1aac70bf06b44fdb4c265ef3160c9",portuguese_320k:"988008783f00a81c031226b4b8924d3fb934638adf7bcddeadbcd553d9abe9a8",portuguese_3k:"eb5e9297e07c919d972d87e03327ec3de1d971626313ec3d801c677e1d5fd6a8",portuguese_550k:"5a88275db7e1e36749e677d35c7f4f3bcddcd57b2050d2d14c2a34efaab92b67",portuguese_5k:"e9eae9f93f322520a39fefb8977b00293043d94bdb3ea155ac5f000cc58dd8f0",portuguese_acentos_e_cedilha:"86296fe834926eda5a27aab2bfbffdc30818016f682885e28ee5d8be265b1f87",quenya:"e2ccaf46e0b41fd6d3e3eb30b09b9d10f4b11286dde758c777d86fb67320e7ef",romanian:"20308ebfc8f574768259bd5b8ba28f3b64d084a99b118eb3ddc1d1a27db498ed",romanian_100k:"34fd28c351f7703ecb0c518d8e370bad882ad4d7852dc9c081fd93aedb9f7f38",romanian_10k:"cccd27f68fd0f385ba7cbba2327bde417f2637fd2bb6c5fc4addfcaf4d6112d5",romanian_1k:"493b83f0fd1e04c43ae0c5ee964d6a40b40b7fc037bf56057710721822b45e98",romanian_200k:"30887183f9b167fd0e1062feff03fb6ab0f269d41ef69e48a19fe5f25e804f55",romanian_25k:"6e4a513369400e61fe8b327f256644b3a047c057e396f7af2e716482c53bcc9a",romanian_50k:"4a14faa54f71818b1e6b4bed3157fcb5dba0e6547ad8bfa84b1a20b7942be200",romanian_5k:"6b5ecfda21c22e8f2fd7dad29cd66733614177189a58a2c80801eefdfa4c61c7",russian:"dac5553f360a6d64c01ed39b39ec8652425425923e0f65cecf951e061721355c",russian_10k:"37747c6876e8b5f2c882a0ad86a28bf61e9d56c56863527536447ed7ebf0fe08",russian_1k:"36a778eed866f750bad2bb404dab8161705f7f46e3a34cc7a604c61fc9ed2942",russian_25k:"2d488fa79bcab3bf6ebc1246e735f4f337d687eaf0c24f693a0fc08aa5c1d6ce",russian_375k:"4752fadeb9e25e5c77736d8f78f87d04ee38dd68b513b27251cc8b7cf97410e0",russian_50k:"41591cf880bd92041f6b83c7d4e9e1006a823b53b7dcecccc412027c338cf5ab",russian_5k:"16b60305cbcfcd2a6462f22003ddfff2b0cdde6530bc54dc82d2672dc71ef738",russian_abbreviations:"cf28a5a04c4da920da46e954f34691d94d8e3d4dc5c95d97ebc6be8b35a6f61d",russian_contractions:"12f09f8f5350a649de4395d267c4bda1e16cbf29191a1fb3afa606a189947db0",russian_contractions_1k:"3c13320178c0132add8bbc5e6f4f42ed9ea69c28505a0c4cd5e91446260c7328",sanskrit:"d13f978830dc58c67c56352c1a5cd4d0c55cd54828d70296d6b2c982956a5738",sanskrit_roman:"e2e213ecd435747818eedc4bbce2bf530e9c582cfa801f2703d67e93f505d851",santali:"2870e0a7e7d32cafcbad214ab544ec7622672d7b94b82dd1f5bf5d89ac329b58",serbian:"ac290bf64d0de2331f7299a4f5abfd948e9950a3876cb018a069a64a07e6ab83",serbian_10k:"37999c660de6faff68d9a5017594f57b349e3ea1d684df3c79012cdb24ad1b2a",serbian_latin:"6e0bdadfa8ecf0d529664ef2709b0bf8a74ec884a734ab7da9a35aff20f96382",serbian_latin_10k:"f38e35823f0a42facf0cda4429f6746ee2053b146be8b3d9c1650b9aa6b9ac12",shona:"a028029f20b7588d1b3d084b7543d0435e8a303b85b760e0842e7238ff486a56",shona_1k:"3790b14dd0469cbf7647aca7e762646f1ac6e2d6efa601430366c1c1c1ba0916",sinhala:"84d150168a6d7a0e44e5d2ec0448aa474d439cad984b0a1971d12b6029f8a1b2",slovak:"b4a28738a1c5a7f561899fa4992ac5f676041382dd1229a71515d89caf8bd183",slovak_10k:"1caeebcf033a917ff68b3ff0555ebf7eec21e1baca8b508a16f58ddee24ca681",slovak_1k:"dd3fd5284254ee7abe0b2ba3e62484bca35eb0137553eefd0e933124fe87fb69",slovenian:"b19634ffd1b59bf8a856759a04a9faf4b61b307f54f2ffeb58bdc8c2abb5dfb8",slovenian_1k:"0eddb19672ba2cddc9fe827ffa460aac93bbb8b0ac496550f4826d216d6fae1a",slovenian_5k:"d42d2cfbca696363e0a6d6f077721dd931689c75d9109e2ee97b4252b12f2c7b",spanish:"464f7580531cf85588bd5bc2e0aeed1b6da63e7b686550cb881f4ebfd997528f",spanish_10k:"d92d7e61541245c2088089a780dca0b0b785554d5b06662c740287739a4ef3b7",spanish_1k:"1cf0f31238c063e5ccd022e5e5ff4e072ffa8c717e63dfd5687cefff1a164fd6",spanish_650k:"2745c0a1b939b0a24fddff320de8a928ba1233df1cad17782aa322e289b65ebe",swahili_1k:"a38b530791f3fa73423e0887622529551324e1ac2bedc309d8860d20181fe005",swedish:"7591eb0b1559038f91128a04963c815217bfd4eae900651dd5a0452a423d2156",swedish_1k:"72cca84c0e5a9307137bf8299a0e612219ca2d0a3244314ae34444c973403f82",swedish_diacritics:"ed9a2bcd829dc734a34ddd55495c2d57de27a096c07e3b5a401b26c19fe4851f",swiss_german:"98764305c3fc15fe2f3bc25ff9512003e9e076dafac402a168e93f28a5664bea",swiss_german_1k:"4c47f104d09551de5b92d46d67e7b433a7dff8cfae0e1ee53e219e85e4f2f0e4",swiss_german_2k:"ffde545b319259d8fbe1fb865897906bef0ff83ef02e40bb5efe4e01ece6e3d9",tamil:"1ccddac6dbed10e1dfb9f4fd67afce8158fa323ee6592f3c6985dd369dc6d880",tamil_1k:"7fe640c332e27c8e60261773aa65c737356682d40bdd9a8e27a6de78a7afe2c2",tamil_old:"68273605bdd4b2ac797b32a3281a80d88877fe24385a6b12887d8020e1bbfd68",tanglish:"181f66ba3e401d84403eee9984c509a19beb1f43f27c21f1b2cb1a31d4c5fc81",tatar:"56be46871e14efc1663b8cd5028165859db7cb308c8a24e8c8504a8b9bf90572",tatar_1k:"bb1752f805abc8825149443d498c4b6acfbfbfc0e193b6559aa703afee1c1ed8",tatar_5k:"21732d99bc63cadd62624382a15616d5c643098eaa0270fe4ffc1a221be5ffb9",tatar_9k:"5454d966964cb65fc395abb30498c7f24214fbdbaeac998375ee6c3b4df3e312",tatar_crimean:"a8de360f16e65222db89134ddffc7c44c3f567c1e45817c154acd0f57bc068f1",tatar_crimean_10k:"9acf2f894d5f0ad9626cec17ebc1cafccb4b12511a557ec6bd3e85e4f9c0c463",tatar_crimean_15k:"ef2cefed9315b72be69966861ae4e8d3334f877b038ddafc45ae375d9d232029",tatar_crimean_1k:"fe48d207f4c13f75bafc65dedfed36d94e03ee535218671481ba21af90bb631d",tatar_crimean_5k:"382a618abc5bad9834caf87e3ad9bb51e77734e9f82e006f9375916a68a0c357",tatar_crimean_cyrillic:"499ef50a2e3585fc824781f85fc16891e9904c6a193b8a27de9589c04def759c",tatar_crimean_cyrillic_10k:"83de2484fb1a9a12031b331afaac5c7320dde92666d3649ee0988b252fd21f58",tatar_crimean_cyrillic_15k:"a20e1e977a7b17244b699ba448169ccbf54f3f8aa32640edfebf03cfb2c72f3e",tatar_crimean_cyrillic_1k:"09f5138c012c23987748860531c89fb8b6adab457e5716b59694788a7df25c19",tatar_crimean_cyrillic_5k:"514b71e249cde7272dc026253ff9be632801300d8c1034f7815e969381ddb5d1",telugu:"a5137e48e9285171b00130ddb3c52d27898a2e8abe22f7581ea8a30eb74b8ebe",telugu_1k:"af9e6150a8311bad02d927509e96b026e3d351d4a210701ebd3c70441db15e74",thai:"309d4be5d5a30f0d4f6bf8a1a13a3cbb752c9cf64dcf31c7b24c902ab17335a4",thai_10k:"7ee4dbb7f6cdfac6ec7c239dc99e17e3ca97bcf5793efb5549b3fe4fd468e4da",thai_1k:"dc6dd162bee1f45397d6046d09dd9ee612ebab4ac5f797340d0a4318510d0d43",thai_20k:"68f6ec19ec2b7a641859fbfd113a484ced463b11deb38eb226c33965ba860750",thai_50k:"b9ac5de9640bd450dedff42d752658d5e5e38e0d8a0f784bb202594d9d12611e",thai_5k:"92dcb6812d08ecaeb4b3272b403538301d5cc2f424feeb1ff9bea25114cc2efc",thai_60k:"f27b4e3439addb2f71787e148b650783f8b02639f873fd06240883e9907c1850",tibetan:"a805b31dfde148d7474cb9607959f517dee33d4a199f77d717b5eedd6b7a9042",tibetan_1k:"4cb7db268fde63c8499dee1da85eecba51466ad5b2d6ab9471577ade29c39f11",toki_pona:"152137a84bc9ae578bf1a6c3f72850d7b1b372b4a896dc416a87a863ddee7519",toki_pona_ku_lili:"d7ffe36d1433513b68b94d99c3cc962c2b26ca014bf93a20063483eebb1bf602",toki_pona_ku_suli:"ca0d2ebf0ca820cd4d3928a732a30e9853ac08586f43b394d1f465e63a52c183",turkish:"f6f62100c8dd8f06c37c5b9d1e05627b8c03d42fada25fd651b6cb931149179c",turkish_1k:"823e5b5401cd2a71e631d64982ebb7700def55682f0f82019c93468015aef7b4",turkish_5k:"8cab406413b147ac3664b081cab99dbb421de394f9fda4befa8f8bae76f915ea",twitch_emotes:"f73bf670c9c525e3b803a350346c4ee4fb158d6585061e1a4aeed4c771702292",typing_of_the_dead:"b6f2d2f014afa30787f10d1fc7bb99b4ced7ce765fc7af51d5eff1cb51bc1950",udmurt:"2ac88d0b6a1682aad9f917c73f1919c5020e971f04108453d2b258a8f3965586",ukrainian:"e693520ae92b2d4467e85392b5b2fff89c1c2ef22e594e7373f50941175f3876",ukrainian_10k:"106712ce54c94da4fb2ec3f41c389325cf7d3c64ef59d33c7a05f4755df87c81",ukrainian_1k:"dc9fd23dc8229f66d82692c66298a2995ac07573535e13830a761262293316eb",ukrainian_50k:"6cd51bf11243c0652c4559dc37525e9a2145297cad74b82a323e910c70cab4a9",ukrainian_endings:"0e27e0086c862f556ee2120f03a11f22846358400f24b1f810bc58fd173f3609",ukrainian_latynka:"213883c243ea9feb63943603fb8a6b9fce1495c5e96028ca403e87e21255daf6",ukrainian_latynka_10k:"60ea8e418f98272bf6c7313da82fb6056e48c0b9372b0e70e3cb3a911af8d696",ukrainian_latynka_1k:"d278f196a89cdd75b0d3f8f9d4a134c685acfd071497c8cf6f421fbfecb310fa",ukrainian_latynka_50k:"3f3ed559f26918c22cce4e81bf422e79b0ce9225a3603245440b04b3345274c1",ukrainian_latynka_endings:"e22299f87774eb13c663f62386a5138ca8822e13f86a18e95b596e72a19935f5",urdish:"2458b0c85debfd819b2cbf24cc6621ce1223830307c406db0896c1dc24125549",urdu:"4d14915278b4af72258999a81e9bc15d2c0b4f3a2af7e6072e2f173a4544807e",urdu_1k:"8af4fca80c002d5b6412998b4cdf72f387df751bd285b9b10e3f7784cabaab5b",urdu_5k:"ec2c5eeeacecacbc5783bc004a93c6b743917bcc618a9157eaab53cd781f3f14",uzbek:"aa79f87a2d6bf152198e1eb6f24f2e6c56426f2fd93ac4e8a156818e3aa5ddfd",uzbek_1k:"5f82518428e19e676ed6d5a4aa249ce8f026f7d72a1e75872cc6d15672a6eb43",uzbek_70k:"88a5be27a1215882024a821bd901e741f88cf796a40e973a98e6fc8df2ec80cf",vietnamese:"2bbb05c3214a6da2371dba81e18584a2c368ac18371d6e032e4207355817a5e4",vietnamese_1k:"b715a183634527d6d152b82df4be3311946607e4c062afd33061c9355cb1a473",vietnamese_5k:"00e944d74899089b73f5e774047cd852693b497b8a67fe5866a02b23291239dc",viossa:"09a2bc7f5c6c9dbc576614d33a9a88d446df8f3f597bb2e18e6ad9bdd0dd1434",viossa_njutro:"6debf62d2035df4b3d9712525836440079488b1f61ed77bbdf7f6430221986b5",welsh:"f003979f0d1e21d6ce55f41c61e5eac3e5a693afea3e0bb239947a43a058c847",welsh_1k:"087e8911bf81808bd3565fdf58fcefa9b990e315d7c4b651e1705b19b22da429",wordle:"dc0b4a38eb6271c16df78c38c9619920a0e4e93c8b89563d5bef3ac9ab7ab245",wordle_1k:"4595d47bc80537b428b9ceda7d9df7b073a5328c18528384d515f0cbbb430515",xhosa:"e4b2c64102460458731946ed58468e0119cb8a49ec4dab49fdf93d64b9f97986",xhosa_3k:"cc4569b137f6c6bb1f30a3031dd13b2f5f7f296aa37bfb3593671340f054a0d5",yiddish:"3fbf303c9489e0f915a130e2602e4d7cef5e8e077d57c9b0f5c5e0ab836d4641",yoruba_1k:"b0acb98309268729daeb80c374be9d4c6a434b8a5a1d127f5ccad93be8fa8e53",zulu:"bc07c4c9412abc44751568993d93dbb2d733a3253eebdef80f7e03e4be3f10ae"},ox=window.fetch,ix=window.crypto.subtle;async function nx(e){try{if(!e)throw new Error("No URL");const t=await ox(e);if(t.ok){if(!t.headers.get("content-type")?.startsWith("application/json"))throw new Error("Content is not JSON");return await t.json()}else throw new Error(`${t.status} ${t.statusText}`)}catch(t){throw console.error("Error fetching JSON: "+e,t),t}}function sx(e,t){const a=new Map;return(async(...o)=>{const i=o[0];if(a.has(i)){const l=await a.get(i);if(l!==void 0)return l}const s=e.apply(null,o);return a.set(i,s),s})}const di=sx(nx);async function Bi(e){return await di(`/layouts/${e}.json`)}let wl;async function ai(e){if(wl===void 0||wl.name!==e){const t=await di(`/languages/${e}.json`);{const o=new TextEncoder().encode(JSON.stringify(t,null,0)),i=await ix.digest("SHA-256",o);if(b5(i)!==ax[e])throw new Error("Integrity check failed. Try refreshing the page. If this error persists, please contact support.")}wl=t}return wl}async function rx(e){const t=await ai(e);return t.orderedByFrequency===!0?"yes":t.orderedByFrequency===!1?"no":"unknown"}async function lx(e){return await ai(e)}class l0{constructor(t,a,o){this.title=t,this.author=a,this.words=o}}async function c0(){return await di("/challenges/_list.json")}async function cx(){return await di("/about/supporters.json")}async function dx(){return await di("/about/contributors.json")}async function ux(){const e=await di("https://api.github.com/repos/monkeytypegame/monkeytype/releases?per_page=1");if(e[0]===void 0||e[0].name===void 0)throw new Error("No release found");return e[0].name}async function fx(){return di("https://api.github.com/repos/monkeytypegame/monkeytype/releases?per_page=5")}function aa(e,t,a){const o=oh(e),i=oh(t);if(o&&i){const s=o.a??1,l=i.a??1,c=Math.round(o.r*(1-a)+i.r*a),d=Math.round(o.g*(1-a)+i.g*a),u=Math.round(o.b*(1-a)+i.b*a),p=s*(1-a)+l*a;return o.a!==void 0||i.a!==void 0||p!==1?ih(c,d,u,p):ih(c,d,u)}else return"#ff00ffff"}function oh(e){if(e.length!==4&&e.length!==5&&e.length!==7&&e.length!==9||!e.startsWith("#"))return;let t,a,o,i;if(e.length===4)t=+("0x"+e[1]+e[1]),a=+("0x"+e[2]+e[2]),o=+("0x"+e[3]+e[3]);else if(e.length===5)t=+("0x"+e[1]+e[1]),a=+("0x"+e[2]+e[2]),o=+("0x"+e[3]+e[3]),i=+("0x"+e[4]+e[4])/255;else if(e.length===7)t=+("0x"+e[1]+e[2]),a=+("0x"+e[3]+e[4]),o=+("0x"+e[5]+e[6]);else if(e.length===9)t=+("0x"+e[1]+e[2]),a=+("0x"+e[3]+e[4]),o=+("0x"+e[5]+e[6]),i=+("0x"+e[7]+e[8])/255;else return;const s={r:t,g:a,b:o};return i!==void 0&&(s.a=i),s}function ih(e,t,a,o){const i=Math.round(e).toString(16).padStart(2,"0"),s=Math.round(t).toString(16).padStart(2,"0"),l=Math.round(a).toString(16).padStart(2,"0");if(o!==void 0){const c=Math.round(o*255).toString(16).padStart(2,"0");return`#${i}${s}${l}${c}`}return`#${i}${s}${l}`}function Lc(e){let t,a,o,i;e.length===4?(t="0x"+e[1]+e[1],a="0x"+e[2]+e[2],o="0x"+e[3]+e[3]):e.length===5?(t="0x"+e[1]+e[1],a="0x"+e[2]+e[2],o="0x"+e[3]+e[3],i=("0x"+e[4]+e[4])/255):e.length===7?(t="0x"+e[1]+e[2],a="0x"+e[3]+e[4],o="0x"+e[5]+e[6]):e.length===9?(t="0x"+e[1]+e[2],a="0x"+e[3]+e[4],o="0x"+e[5]+e[6],i=("0x"+e[7]+e[8])/255):(t=0,a=0,o=0),t/=255,a/=255,o/=255;const s=Math.min(t,a,o),l=Math.max(t,a,o),c=l-s;let d=0,u=0,p=0;c===0?d=0:l===t?d=(a-o)/c%6:l===a?d=(o-t)/c+2:d=(t-a)/c+4,d=Math.round(d*60),d<0&&(d+=360),p=(l+s)/2,u=c===0?0:c/(1-Math.abs(2*p-1)),u=+(u*100).toFixed(1),p=+(p*100).toFixed(1);const g={hue:d,sat:u,lgt:p,string:i!==void 0?`hsla(${d}, ${u}%, ${p}%, ${i.toFixed(3)})`:`hsl(${d}, ${u}%, ${p}%)`};return i!==void 0&&(g.alpha=i),g}function d0(e){return Lc(e).lgt>=50}function Np(e){return Lc(e).lgt<50}function px(e){const t=e.match(/^rgb\((\d+), \s*(\d+), \s*(\d+)\)$/);if(t===null||t.length<3)return;function a(o){return("0"+parseInt(o).toString(16)).slice(-2)}return"#"+a(t[1])+a(t[2])+a(t[3])}const Sd={composing:!1,startPos:-1};function Ri(){return Sd.composing}function mx(){return Sd.startPos}function Up(e){Sd.composing=e}function gx(e){Sd.startPos=e}const kt=16,u0=12,Ju=kt/2,hx=u0/2,nh=250;let Pt=[],nt,cs={},$c=[],xd=[],ar=[],Vp=[],En=[],Cl,mn,f0=new Date,wr=!1,p0=!1,Xu=!0,Mc=!0,kl=!1;async function bx(e,t){if(!p0||En!==void 0&&e===En[0]&&t===En[1]||!wr&&!await vx()||e===void 0||t===void 0||e<0||t<0||t<e)return!1;t=Math.min(t,nt.length-1);const a=wx(e,t,da);for(let o=0;o<Pt.length;o++){const i=xd[o],s=i.children[0];i.classList.remove("highlight-hidden"),!Xu&&!Mc?(i.classList.add("withAnimation"),s.classList.add("withAnimation")):(i.classList.remove("withAnimation"),s.classList.remove("withAnimation"));const l=a[o];l&&(i.style.right=l.highlightRight+"px",s.style.left=l.inputContainerLeft+"px",i.style.left=l.highlightLeft+"px")}return Xu=!1,Mc=!1,En=[e,t],!0}function yx(){for(const e of xd)e.classList.add("highlight-hidden");Mc=!0,En=[]}function Kp(){if(wr){for(const e of $c)e.remove();xd=[],$c=[],cs={},Pt=[],ar=[],Vp=[],wr=!1,Xu=!0,Mc=!0,En=[]}}function m0(e){p0=e}async function vx(){if(wr||kl)return!1;kl=!0;const e=new Date().getTime()-f0.getTime();if(e<nh&&await new Promise(d=>setTimeout(d,nh-e)),Cl=n("#resultWordsHistory")[0],mn=Cl.getBoundingClientRect(),nt=n(Cl).find(".words .word[input]"),nt.length===0)return kl=!1,!1;let t=-1,a,o=0;cs[0]=0;for(let d=1;d<nt.length;d++){const u=nt[d],p=nt[d-1];u.offsetTop!==p.offsetTop&&(o++,a=Xs([nt[t+1],p]),Pt.push({firstWordIndex:t+1,lastWordIndex:d-1,rect:a}),t=d-1),cs[d]=o}a=Xs([nt[t+1],nt[nt.length-1]]),Pt.push({firstWordIndex:t+1,lastWordIndex:nt.length-1,rect:a});const i=mn.width,s=mn.height,l=mn.top,c=mn.left;return Pt.forEach(d=>{const u=document.createElement("div");u.classList.add("highlightContainer"),$c.push(u);const p=d.rect.top-hx,g=d.rect.left-Ju,m=p-l,h=g-c,y=d.rect.width+kt,C=d.rect.height+u0,M=d.rect.width,w=d.rect.height,F=m/s*100+"%",I=h/i*100+"%",P=y/i*100+"%",U=C/s*100+"%";u.style.width=P,u.style.top=F,u.style.left=I,u.style.height=U;const K=document.createElement("div"),ne=document.createElement("div");ne.style.top=d.rect.top-p+"px",ne.style.left=d.rect.left-g+"px",ne.style.width=M+"px",ne.style.height=w+"px",K.className="highlight highlight-hidden",ne.className="inputWordsContainer";for(let _e=d.firstWordIndex;_e<=d.lastWordIndex;_e+=1){const He=nt[_e],Pe=He.getAttribute("input")??"";if(!Pe)continue;const Oe=document.createElement("div");let ee;da?ee=d.rect.left-mn.left+kt:ee=0,Oe.style.left=He.offsetLeft+Ju-ee+"px",Oe.innerHTML=Pe.replace(/\t/g,"_").replace(/\n/g,"_").replace(/</g,"&lt").replace(/>/g,"&gt").slice(0,He.childElementCount),Oe.className="inputWord",ne.append(Oe),Vp.push(Oe)}ar.push(ne),xd.push(K),K.append(ne),u.append(K),Cl.append(u)}),wr=!0,kl=!1,!0}function wx(e,t,a=!1){const o=cs[e],i=new Array(Pt.length).fill(null).map(()=>({highlightLeft:0,highlightRight:0,inputContainerLeft:0,inputContainerRight:0})),s=Cx(e,t),l=nt[e],c=Pt[o],d=i[o],u=$c[o],p=ar[o];if(l===void 0||c===void 0||d===void 0||u===void 0||p===void 0)return i;if(!a)d.highlightLeft=l.offsetLeft,d.highlightRight=c.rect.width-(d.highlightLeft+s)+kt;else{const g=u.offsetLeft;d.highlightRight=c.rect.width-(l.offsetLeft+l.offsetWidth)+g+Ju,d.highlightLeft=c.rect.width-(d.highlightRight+s)+kt}a?d.inputContainerLeft=-1*(p.getBoundingClientRect().width-s-d.highlightRight):d.inputContainerLeft=-1*d.highlightLeft;for(let g=o-1;g>=0;g--){const m=i[g],h=i[g+1],y=Pt[g],C=ar[g];m===void 0||y===void 0||h===void 0||C===void 0||(a?(m.highlightRight=h.highlightRight+y.rect.width+kt,m.highlightLeft=y.rect.width-(m.highlightRight+s)+kt,m.inputContainerLeft=-1*(C.getBoundingClientRect().width-s-m.highlightRight)):(m.highlightLeft=h.highlightLeft+y.rect.width+kt,m.highlightRight=y.rect.width-(m.highlightLeft+s)+kt,m.inputContainerLeft=-1*m.highlightLeft))}for(let g=o+1;g<Pt.length;g++){const m=i[g],h=Pt[g-1],y=Pt[g],C=i[g-1],M=ar[g];m===void 0||h===void 0||y===void 0||C===void 0||M===void 0||(a?(m.highlightRight=-1*(h.rect.width-C.highlightRight+kt),m.highlightLeft=y.rect.width-(m.highlightRight+s)+kt,m.inputContainerLeft=-1*(M.getBoundingClientRect().width-s-m.highlightRight)):(m.highlightLeft=-1*(h.rect.width-C.highlightLeft+kt),m.highlightRight=y.rect.width-(m.highlightLeft+s)+kt,m.inputContainerLeft=-1*m.highlightLeft))}return i}function Cx(e,t){const a=cs[e],o=cs[t];if(a===void 0||o===void 0)return 0;const i=nt[e],s=nt[t],l=Vp[t],c=nt[Pt[a]?.lastWordIndex??-1],d=nt[Pt[o]?.firstWordIndex??-1];if(i===void 0||s===void 0||l===void 0||c===void 0||d===void 0)return 0;if(a===o){const y=Xs([i,s]),C=s.getBoundingClientRect(),M=l.getBoundingClientRect();let w=y.width+kt;return w-=C.width-M.width,w}const u=Xs([i,c]),p=Xs([d,s]);let g=u.width+p.width;for(let y=a+1;y<o;y++)g+=Pt[y].rect.width;g+=2*kt*(o-a);const m=s.getBoundingClientRect(),h=l.getBoundingClientRect();return g-=m.width-h.width,g}function kx(){f0=new Date}let g0="loading";function X(){return g0}function sh(e){g0=e}let Rs=null;class Td{constructor(t){this.words=t,this.length=this.words.length,this.shuffledIndexes=[],this.orderedIndex=0}resetIndexes(){this.orderedIndex=0,this.shuffledIndexes=[]}randomWord(t){return t==="zipf"?this.words[XC(this.words.length)]:Sa(this.words)}shuffledWord(){return this.shuffledIndexes.length===0&&this.generateShuffledIndexes(),this.words[this.shuffledIndexes.pop()]}generateShuffledIndexes(){this.shuffledIndexes=[];for(let t=0;t<this.length;t++)this.shuffledIndexes.push(t);Gn(this.shuffledIndexes)}nextWord(){return this.orderedIndex>=this.length&&(this.orderedIndex=0),this.words[this.orderedIndex++]}}async function Sx(e){return(Rs===null||e!==Rs.words)&&(Rs=new Td(e)),Rs.resetIndexes(),Rs}function xx(){return Math.floor(Math.random()*256).toString(2).padStart(8,"0")}function Tx(){const e=ht(1,4);return Array.from({length:e},()=>Math.floor(Math.random()*256).toString(16).padStart(2,"0")).join("")}function Lx(e){const t={a:".-",b:"-...",c:"-.-.",d:"-..",e:".",f:"..-.",g:"--.",h:"....",i:"..",j:".---",k:"-.-",l:".-..",m:"--",n:"-.",o:"---",p:".--.",q:"--.-",r:".-.",s:"...",t:"-",u:"..-",v:"...-",w:".--",x:"-..-",y:"-.--",z:"--..",0:"-----",1:".----",2:"..---",3:"...--",4:"....-",5:".....",6:"-....",7:"--...",8:"---..",9:"----.",".":".-.-.-",",":"--..--","?":"..--..","'":".----.","/":"-..-.","(":"-.--.",")":"-.--.-","&":".-...",":":"---...",";":"-.-.-.","=":"-...-","+":".-.-.","-":"-....-",_:"..--.-",'"':".-..-.",$:"...-..-","!":"-.-.--","@":".--.-."};let a="";const o=u5(e);for(let i=0;i<o.length;i++){const s=t[o.toLowerCase()[i]];a+=s!==void 0?s+"/":""}return a}function $x(){const e=ht(1,7);let t="";for(let a=0;a<e;a++)t+=String.fromCharCode(97+ht(0,25));return t}function Mx(){const e=ht(1,10);let t="";for(let a=0;a<e;a++){const o=33+ht(0,93);t+=String.fromCharCode(o)}return t}const Ax=["`","~","!","@","#","$","%","^","&","*","(",")","-","_","=","+","{","}","[","]","'",'"',"/","\\","|","?",";",":",">","<",",","."];function _x(){const e=ht(1,7);let t="";for(let a=0;a<e;a++)t+=Sa(Ax);return t}function h0(e){const t=ht(1,e);let a="";for(let o=0;o<t;o++){let i;o===0?i=ht(1,9):i=ht(0,9),a+=i.toString()}return a}let jl={};function Ve(e,t,a){jl[e]??={value:t,setFunction:a}}function b0(){Object.keys(jl).forEach(e=>{const t=jl[e];t.setFunction(t.value,!0)}),jl={}}const y0=[];function Ex(e){y0.push(e)}async function qx(e){y0.forEach(t=>{try{t(e)}catch(a){console.error("TTS event subscriber threw an error"),console.error(a)}})}let Ds=!1,Sl=0,nu=0,rh=0,lh=3,gn=0,hn=0;function Ix(e){nu--;let t=Math.round(Math.random()),a=Math.round(Math.random()*5-.5);return e?(Ds=!!Math.round(Math.random()),Ds?a=3:a=0):(Ds?(rh===t?gn++:gn=0,(gn>1||hn>0&&gn>0)&&(t=1-t,gn=0),rh=t,a=t*(Sl+1)):(lh===t?hn++:hn=0,(hn>1||hn>0&&gn>0)&&(t=1-t,hn=0),lh=t,a=3-t*(Sl+1)),Ds=!Ds,nu<0&&t===0&&(Sl=1-Sl,nu=Math.floor(Math.random()*3)+3)),a}function Fx(e){const t=["←","↓","↑","→"];let a="";for(let o=0;o<4;o++)a+=t[Ix(o===0&&e)];return a}const Ld=document.querySelector("#typingTest #layoutfluidTimer");function v0(){W(Ld,{opacity:1,duration:G(125)})}function or(){W(Ld,{opacity:0,duration:G(125)})}function su(e,t){Ld.textContent=`${$t(t)} in: ${e}s`}function Px(e,t){const a=$t(t.replace(/_/g," "));let o=`${a} in: ${e} words`;e===1&&(o=`${a} starting next word`),Ld.textContent=o}const jp=[];function Bx(e){jp.push(e)}async function w0(e,t){jp.forEach(a=>{try{a("flash",e,t)}catch(o){console.error("Keymap flash event subscriber threw an error"),console.error(o)}})}async function Ho(e){jp.forEach(t=>{try{t("highlight",e)}catch(a){console.error("Keymap highlight event subscriber threw an error"),console.error(a)}})}let qo=null,Gl=null;const Gp=document.querySelector("#typingTest #memoryTimer");function Rx(){W(Gp,{opacity:1,duration:G(125)})}function C0(){W(Gp,{opacity:0,duration:G(125)})}function ds(){Gl!==null&&(clearInterval(Gl),Gl=null),qo=null,C0()}function Dx(e){ds(),qo=e,ch(qo),Rx(),Gl=setInterval(()=>{qo!==null&&(qo-=1,qo===0?C0():ch(qo),qo<=0&&(ds(),n("#wordsWrapper").addClass("hidden")))},1e3)}function ch(e){Gp.textContent=`Timer left to memorise all words: ${e}s`}const Wx=new Set(["—","_"," "]),zx=100,Hx="https://poetrydb.org/random";class Ox extends l0{constructor(t,a,o){super(t,a,o),this.title=t,this.author=a,this.words=o,this.cleanUpText()}cleanUpText(){let t=0;const a=[];for(const o of this.words){let i="";for(const s of o)Wx.has(s)||(i+=s);if(i!==""&&(a.push(i),t++,t===zx))break}this.words=a}}async function Nx(){console.log("Getting poem");try{const a=(await(await fetch(Hx)).json())[0];if(!a)return!1;const o=[];return a.lines.forEach(i=>{i.split(/ +/).forEach(s=>{o.push(s)})}),new Ox(a.title,a.author,o)}catch(e){return console.log(e),!1}}const Qp=Wb._def.values,k0={english:["english","english_1k","english_5k","english_10k","english_25k","english_450k","english_commonly_misspelled","english_contractions","english_doubleletter","english_shakespearean","english_old","english_medical"],spanish:["spanish","spanish_1k","spanish_10k","spanish_650k"],french:["french","french_1k","french_2k","french_10k","french_600k","french_bitoduc"],german:["german","german_1k","german_10k","german_250k"],swiss_german:["swiss_german","swiss_german_1k","swiss_german_2k"],portuguese:["portuguese","portuguese_1k","portuguese_3k","portuguese_5k","portuguese_320k","portuguese_550k","portuguese_acentos_e_cedilha"],arabic:["arabic","arabic_10k"],arabic_egypt:["arabic_egypt","arabic_egypt_1k"],arabic_morocco:["arabic_morocco"],italian:["italian","italian_1k","italian_7k","italian_60k","italian_280k"],friulian:["friulian"],latin:["latin"],afrikaans:["afrikaans","afrikaans_1k","afrikaans_10k"],mongolian:["mongolian","mongolian_10k"],korean:["korean","korean_1k","korean_5k"],khmer:["khmer"],marathi:["marathi"],chinese:["chinese_traditional","chinese_simplified","chinese_simplified_1k","chinese_simplified_5k","chinese_simplified_10k","chinese_simplified_50k"],russian:["russian","russian_1k","russian_5k","russian_10k","russian_25k","russian_50k","russian_375k","russian_contractions","russian_contractions_1k","russian_abbreviations"],polish:["polish","polish_2k","polish_5k","polish_10k","polish_20k","polish_40k","polish_200k"],czech:["czech","czech_1k","czech_10k"],slovak:["slovak","slovak_1k","slovak_10k"],ukrainian:["ukrainian","ukrainian_1k","ukrainian_10k","ukrainian_50k","ukrainian_endings"],ukrainian_latynka:["ukrainian_latynka","ukrainian_latynka_1k","ukrainian_latynka_10k","ukrainian_latynka_50k","ukrainian_latynka_endings"],lithuanian:["lithuanian","lithuanian_1k","lithuanian_3k"],indonesian:["indonesian","indonesian_1k","indonesian_10k"],kurdish_central:["kurdish_central","kurdish_central_2k","kurdish_central_4k"],greek:["greek","greek_1k","greek_5k","greek_10k","greek_25k"],greeklish:["greeklish","greeklish_1k","greeklish_5k","greeklish_10k","greeklish_25k"],turkish:["turkish","turkish_1k","turkish_5k"],irish:["irish"],galician:["galician"],thai:["thai","thai_1k","thai_5k","thai_10k","thai_20k","thai_50k","thai_60k"],tamil:["tamil","tamil_1k","tanglish","tamil_old"],kannada:["kannada"],telugu:["telugu","telugu_1k"],slovenian:["slovenian","slovenian_1k","slovenian_5k"],croatian:["croatian","croatian_1k"],dutch:["dutch","dutch_1k","dutch_10k"],filipino:["filipino","filipino_1k"],danish:["danish","danish_1k","danish_10k"],hungarian:["hungarian","hungarian_1k","hungarian_2k"],norwegian_bokmal:["norwegian_bokmal","norwegian_bokmal_1k","norwegian_bokmal_5k","norwegian_bokmal_10k","norwegian_bokmal_150k","norwegian_bokmal_600k"],norwegian_nynorsk:["norwegian_nynorsk","norwegian_nynorsk_1k","norwegian_nynorsk_5k","norwegian_nynorsk_10k","norwegian_nynorsk_100k","norwegian_nynorsk_400k"],hebrew:["hebrew","hebrew_1k","hebrew_5k","hebrew_10k"],icelandic:["icelandic","icelandic_1k"],malagasy:["malagasy","malagasy_1k"],malay:["malay","malay_1k"],romanian:["romanian","romanian_1k","romanian_5k","romanian_10k","romanian_25k","romanian_50k","romanian_100k","romanian_200k"],finnish:["finnish","finnish_1k","finnish_10k"],estonian:["estonian","estonian_1k","estonian_5k","estonian_10k"],udmurt:["udmurt"],welsh:["welsh","welsh_1k"],persian:["persian","persian_1k","persian_5k","persian_20k","persian_romanized"],kazakh:["kazakh","kazakh_1k"],vietnamese:["vietnamese","vietnamese_1k","vietnamese_5k"],jyutping:["jyutping"],pinyin:["pinyin","pinyin_1k","pinyin_10k"],hausa:["hausa","hausa_1k"],swedish:["swedish","swedish_1k","swedish_diacritics"],serbian:["serbian","serbian_latin","serbian_10k","serbian_latin_10k"],georgian:["georgian"],yoruba:["yoruba_1k"],swahili:["swahili_1k"],maori:["maori_1k"],catalan:["catalan","catalan_1k"],bulgarian:["bulgarian","bulgarian_latin"],bosnian:["bosnian","bosnian_4k"],esperanto:["esperanto","esperanto_1k","esperanto_10k","esperanto_25k","esperanto_36k","esperanto_x_sistemo","esperanto_x_sistemo_1k","esperanto_x_sistemo_10k","esperanto_x_sistemo_25k","esperanto_x_sistemo_36k","esperanto_h_sistemo","esperanto_h_sistemo_1k","esperanto_h_sistemo_10k","esperanto_h_sistemo_25k","esperanto_h_sistemo_36k"],bangla:["bangla","bangla_letters","bangla_10k"],urdu:["urdu","urdu_1k","urdu_5k","urdish"],albanian:["albanian","albanian_1k"],shona:["shona","shona_1k"],armenian:["armenian","armenian_1k","armenian_western","armenian_western_1k"],myanmar:["myanmar_burmese"],japanese:["japanese_hiragana","japanese_katakana","japanese_romaji","japanese_romaji_1k"],hindi:["hindi","hindi_1k","hinglish"],sanskrit:["sanskrit","sanskrit_roman"],gujarati:["gujarati","gujarati_1k"],nepali:["nepali","nepali_1k","nepali_romanized"],santali:["santali"],macedonian:["macedonian","macedonian_1k","macedonian_10k","macedonian_75k"],uzbek:["uzbek","uzbek_1k","uzbek_70k"],belarusian:["belarusian","belarusian_1k","belarusian_5k","belarusian_10k","belarusian_25k","belarusian_50k","belarusian_100k"],belarusian_lacinka:["belarusian_lacinka","belarusian_lacinka_1k"],tatar:["tatar","tatar_1k","tatar_5k","tatar_9k"],tatar_crimean:["tatar_crimean","tatar_crimean_1k","tatar_crimean_5k","tatar_crimean_10k","tatar_crimean_15k","tatar_crimean_cyrillic","tatar_crimean_cyrillic_1k","tatar_crimean_cyrillic_5k","tatar_crimean_cyrillic_10k","tatar_crimean_cyrillic_15k"],azerbaijani:["azerbaijani","azerbaijani_1k"],malayalam:["malayalam"],sinhala:["sinhala"],latvian:["latvian","latvian_1k"],maltese:["maltese","maltese_1k"],toki_pona:["toki_pona","toki_pona_ku_suli","toki_pona_ku_lili"],xhosa:["xhosa","xhosa_3k"],tibetan:["tibetan","tibetan_1k"],bashkir:["bashkir"],other:["lojban_gismu","lojban_cmavo","pig_latin","twitch_emotes","git","typing_of_the_dead","league_of_legends","docker_file"],amharic:["amharic","amharic_1k","amharic_5k"],oromo:["oromo","oromo_1k","oromo_5k"],wordle:["wordle","wordle_1k"],kyrgyz:["kyrgyz","kyrgyz_1k"],yiddish:["yiddish"],frisian:["frisian","frisian_1k"],pashto:["pashto"],euskera:["euskera"],klingon:["klingon","klingon_1k"],quenya:["quenya"],lorem_ipsum:["lorem_ipsum"],occitan:["occitan","occitan_1k","occitan_2k","occitan_5k","occitan_10k"],kabyle:["kabyle","kabyle_1k","kabyle_2k","kabyle_5k","kabyle_10k"],zulu:["zulu"],hawaiian:["hawaiian","hawaiian_1k"],code:["code_python","code_python_1k","code_python_2k","code_python_5k","code_c","code_css","code_csharp","code_c++","code_dart","code_brainfck","code_fsharp","code_javascript","code_javascript_1k","code_javascript_react","code_jule","code_julia","code_haskell","code_html","code_nim","code_nix","code_pascal","code_java","code_kotlin","code_go","code_rockstar","code_rust","code_ruby","code_r","code_r_2k","code_swift","code_scala","code_bash","code_powershell","code_lua","code_luau","code_latex","code_typst","code_matlab","code_sql","code_perl","code_php","code_vim","code_vimscript","code_opencl","code_visual_basic","code_arduino","code_systemverilog","code_elixir","code_gleam","code_zig","code_gdscript","code_gdscript_2","code_assembly","code_v","code_ook","code_typescript","code_cobol","code_clojure","code_common_lisp","code_erlang","code_ocaml","code_odin","code_fortran","code_abap","code_abap_1k","code_yoptascript","code_cuda"],viossa:["viossa","viossa_njutro"]},Yp=Array.from(Object.keys(k0));function Ux(e){return Yp.find(t=>t.includes(e))}async function Vx(e){switch(e){case"english":return"en";case"spanish":return"es";case"french":return"fr";case"german":return"de";case"portuguese":return"pt";case"arabic":return"ar";case"italian":return"it";case"latin":return"la";case"afrikaans":return"af";case"korean":return"ko";case"russian":return"ru";case"polish":return"pl";case"czech":return"cs";case"slovak":return"sk";case"ukrainian":return"uk";case"lithuanian":return"lt";case"indonesian":return"id";case"greek":return"el";case"turkish":return"tr";case"thai":return"th";case"tamil":return"ta";case"slovenian":return"sl";case"croatian":return"hr";case"dutch":return"nl";case"danish":return"da";case"hungarian":return"hu";case"norwegian_bokmal":return"no";case"norwegian_nynorsk":return"nn";case"hebrew":return"he";case"malay":return"ms";case"romanian":return"ro";case"finnish":return"fi";case"estonian":return"et";case"welsh":return"cy";case"persian":return"fa";case"kazakh":return"kk";case"vietnamese":return"vi";case"swedish":return"sv";case"serbian":return"sr";case"georgian":return"ka";case"catalan":return"ca";case"bulgarian":return"bg";case"esperanto":return"eo";case"bangla":return"bn";case"urdu":return"ur";case"armenian":return"hy";case"myanmar":return"my";case"hindi":return"hi";case"macedonian":return"mk";case"uzbek":return"uz";case"belarusian":return"be";case"azerbaijani":return"az";case"latvian":return"lv";case"euskera":return"eu";default:return"en"}}const Kx=q.object({query:q.object({pages:q.record(q.string(),q.object({extract:q.string()}))})});async function jx(e){Z();let t="en";const a=Ux(e);a!==void 0&&(t=await Vx(a));const o=`https://${t}.wikipedia.org/api/rest_v1/page/random/summary`,i={title:"",author:""},s=await fetch(o);let l=0;if(s.status===200){const c=await s.json();i.title=c.title,i.author=c.author,l=c.pageid}return new Promise((c,d)=>{s.status!==200&&(N(),d(s.status));const u=`https://${t}.wikipedia.org/w/api.php?action=query&format=json&pageids=${l}&prop=extracts&exintro=true&origin=*`,p=new XMLHttpRequest;p.onload=()=>{if(p.readyState===4)if(p.status===200){const m=Cs(p.responseText,Kx).query.pages[l.toString()];if(!m){N(),d("Page not found");return}let h=m.extract;h=h.replace(/<\/p><p>+/g," "),h=ZC(h),h=h.replace(/\[\d+\]/gi,""),h=h.replace(/[\u200B-\u200D\uFEFF]/g,""),h=Ey(h),t==="en"&&(h=h.replace(/[^\x20-\x7E]+/g,"")),h=h.replace(/\s+/g," "),h=h.trim();const y=h.split(" "),C=new l0(i.title,i.author,y);N(),c(C)}else N(),d(p.status)},p.open("GET",u),p.send()})}const Gx=50,Qx=20,Yx=5e3,ir={};class Jx{constructor(){this.average=0,this.count=0}update(t){this.count<Gx&&this.count++;const a=1/this.count;this.average=t*a+this.average*(1-a)}}function Xx(e,t){const a=he.spacing.array;if(a.length===0||typeof a=="string")return;let o=a[a.length-1];t||(o+=Yx),e in ir||(ir[e]=new Jx),ir[e]?.update(o)}function Zx(e){let t=0,a=0;for(const o of e)o in ir&&(t+=ir[o].average,a++);return a===0?0:t/a}function e4(e){let t,a="";for(let o=0;o<Qx;o++){const i=e.randomWord("normal"),s=Zx(i);(o===0||t===void 0||s>t)&&(a=i,t=s)}return a}function S0(e,t,a,o,i){const s=[],l=Math.round(e/t);for(let c=0;c<t;c++){let u=ht(0,2**l-1).toString(a);if(o){const p=Math.ceil(l/Math.ceil(Math.log2(a)));u="0".repeat(Math.max(0,p-u.length))+u}s.push(u)}return s.join(i)}function dh(e,t,a,o,i,s){const l=i.split(o).map(u=>parseInt(u,a)),c=Math.round(e/t);let d=s;for(let u=0;u<t;u++)d-=c,d<0&&(-d<=c?l[u]&=2**c-1^2**-d-1:l[u]=0);return l.map(u=>u.toString(a)).join(o)+"/"+s.toString()}function t4(){return S0(32,4,10,!1,".")}function a4(){return S0(128,8,16,!0,":")}function uh(e){return e.includes(":")?dh(128,8,16,":",e,ht(16,32)*4):dh(32,4,10,".",e,ht(8,32))}function o4(e){const t=e.split("/");let a=t[0].split(":"),o="";a=a.map(p=>p.replace(/^0+/gm,""));let i=0,s=-1,l=-1,c=0,d=-1,u=-1;for(let p=0;p<a.length;p++)a[p]===""?(d===-1&&(d=p),c++):(u=p-1,i<c&&(i=c,s=d,l=u),c=0,d=-1,u=-1);return i<c&&(i=c,s=d,l=a.length-1),a=a.map((p,g)=>p===""?g>=s&&g<=l&&s!==l?":":"0":p),o=a.join(":"),o=o.replace(/:{3,}/gm,"::"),t.length>1&&(o+="/"+t[1]),o}class Qe extends Error{constructor(t){super(t),this.name="WordGenError"}}async function ru(e){const t=(k.current??"").slice(-1),a=_.getCurrent().slice(k.current.length-1,k.current.length),o=t===a;e.key==="Backspace"&&!o&&(k.current!==""||k.getHistory(le-1)!==_.get(le-1)||r.freedomMode)?n("#words").addClass("read_ahead_disabled"):e.key===" "&&n("#words").removeClass("read_ahead_disabled")}class i4{constructor(){this.chars={},this.count=0}addChar(t){this.count++,t in this.chars?this.chars[t]++:this.chars[t]=1}randomChar(){const t=ht(0,this.count-1);let a=0;for(const[o,i]of Object.entries(this.chars))if(a+=i,a>t)return o;return Object.keys(this.chars)[0]}}class n4 extends Td{constructor(t){super(t),this.ngrams={},this.length=1/0;for(let a of t){a+=" ";let o="";for(const i of a)o in this.ngrams||(this.ngrams[o]=new i4),this.ngrams[o].addChar(i),o=(o+i).slice(-2)}}randomWord(){let t="";for(;;){const a=t.slice(-2),o=this.ngrams[a];if(!o){t="";continue}const i=o.randomChar();if(i===" ")break;t+=i}return t}}class Jp extends Td{constructor(t,a){const o=Array.from(t.keys());Gn(o),super(o),this.wordsWithLanguage=t,this.languageProperties=a}}const s4={58008:{getWord(){let e=h0(7);return r.language.startsWith("kurdish")?e=Eb(e):r.language.startsWith("nepali")&&(e=qb(e)),e},punctuateWord(e){if(e.length>3&&(Math.random()<.5&&(e=Qg(e,ht(1,e.length-2),".")),Math.random()<.75)){const t=ht(1,e.length-2);if(e[t-1]!=="."&&e[t+1]!=="."&&e[t+1]!=="0"){const a=Sa(["/","*","-","+"]);e=Qg(e,t,a)}}return e},rememberSettings(){Ve("numbers",r.numbers,po)},handleChar(e){return e===`
`?" ":e}},simon_says:{applyConfig(){fa("next",!0)},rememberSettings(){Ve("keymapMode",r.keymapMode,fa)}},tts:{applyConfig(){fa("off",!0)},rememberSettings(){Ve("keymapMode",r.keymapMode,fa)},toggleScript(e){if(window.speechSynthesis===void 0){f("Failed to load text-to-speech script",-1);return}e[0]!==void 0&&qx(e[0])}},arrows:{getWord(e,t){return Fx(t===0)},rememberSettings(){Ve("highlightMode",r.highlightMode,Si)},handleChar(e){return e==="a"||e==="ArrowLeft"||e==="j"?"←":e==="s"||e==="ArrowDown"||e==="k"?"↓":e==="w"||e==="ArrowUp"||e==="i"?"↑":e==="d"||e==="ArrowRight"||e==="l"?"→":e},isCharCorrect(e,t){return(e==="a"||e==="ArrowLeft"||e==="j")&&t==="←"||(e==="s"||e==="ArrowDown"||e==="k")&&t==="↓"||(e==="w"||e==="ArrowUp"||e==="i")&&t==="↑"||(e==="d"||e==="ArrowRight"||e==="l")&&t==="→"},async preventDefaultEvent(e){return["ArrowLeft","ArrowUp","ArrowRight","ArrowDown"].includes(e.key)},getWordHtml(e,t){let a="";return e==="↑"&&(t&&(a+="<letter>"),a+='<i class="fas fa-arrow-up"></i>',t&&(a+="</letter>")),e==="↓"&&(t&&(a+="<letter>"),a+='<i class="fas fa-arrow-down"></i>',t&&(a+="</letter>")),e==="←"&&(t&&(a+="<letter>"),a+='<i class="fas fa-arrow-left"></i>',t&&(a+="</letter>")),e==="→"&&(t&&(a+="<letter>"),a+='<i class="fas fa-arrow-right"></i>',t&&(a+="</letter>")),a}},rAnDoMcAsE:{alterText(e){let t=e[0];for(let a=1;a<e.length;a++)t[a-1]===t[a-1].toUpperCase()?t+=e[a].toLowerCase():t+=e[a].toUpperCase();return t}},backwards:{alterText(e){return e.split("").reverse().join("")}},capitals:{alterText(e){return ln(e)}},layout_mirror:{applyConfig(){let e=r.layout;r.layout==="default"&&(e="qwerty"),Do(e,!0),Ti("overrideSync",!0)},rememberSettings(){Ve("keymapMode",r.keymapMode,fa),Ve("layout",r.layout,Do)}},layoutfluid:{applyConfig(){const e=r.customLayoutfluid[0]??"qwerty";Do(e,!0),Ti(e,!0)},rememberSettings(){Ve("keymapMode",r.keymapMode,fa),Ve("layout",r.layout,Do),Ve("keymapLayout",r.keymapLayout,Ti)},handleSpace(){if(r.mode!=="time"){const e=r.customLayoutfluid,t=_.length,a=Math.floor(t/e.length),o=Math.floor((k.getHistory().length+1)/a),i=a-(le+1)%a;e[o]?(i<=3&&e[o+1]?(v0(),Px(i,e[o+1])):or(),i===a&&(Do(e[o]),Ti(e[o]),i>3&&or())):or(),setTimeout(()=>{Ho(_.getCurrent().charAt(k.current.length))},1)}},getResultContent(){return r.customLayoutfluid.join(" ")},restart(){this.applyConfig&&this.applyConfig(),setTimeout(()=>{Ho(_.getCurrent().substring(k.current.length,k.current.length+1))},1)}},gibberish:{getWord(){return $x()}},ascii:{getWord(){return Mx()}},specials:{getWord(){return _x()}},read_ahead_easy:{rememberSettings(){Ve("highlightMode",r.highlightMode,Si)},async handleKeydown(e){await ru(e)}},read_ahead:{rememberSettings(){Ve("highlightMode",r.highlightMode,Si)},async handleKeydown(e){await ru(e)}},read_ahead_hard:{rememberSettings(){Ve("highlightMode",r.highlightMode,Si)},async handleKeydown(e){await ru(e)}},memory:{applyConfig(){n("#wordsWrapper").addClass("hidden"),Ou(!0,!0),r.keymapMode==="next"&&fa("react",!0)},rememberSettings(){Ve("mode",r.mode,rt),Ve("showAllLines",r.showAllLines,Ou),r.keymapMode==="next"&&Ve("keymapMode",r.keymapMode,fa)},start(){ds(),n("#words").addClass("hidden")},restart(){Dx(Math.round(Math.pow(_.length,1.2))),n("#words").removeClass("hidden"),r.keymapMode==="next"&&fa("react")}},nospace:{rememberSettings(){Ve("highlightMode",r.highlightMode,Si)}},poetry:{async pullSection(){return Nx()}},wikipedia:{async pullSection(e){return jx((e??"")||"english")}},weakspot:{getWord(e){return e!==void 0?e4(e):""}},pseudolang:{async withWords(e){return e!==void 0?new n4(e):new Td([])}},IPv4:{getWord(){return t4()},punctuateWord(e){let t=e;return Math.random()<.25&&(t=uh(e)),t},rememberSettings(){Ve("numbers",r.numbers,po)}},IPv6:{getWord(){return a4()},punctuateWord(e){let t=e;return Math.random()<.25&&(t=uh(e)),t.includes(":")&&(t=o4(t)),t},rememberSettings(){Ve("numbers",r.numbers,po)}},binary:{getWord(){return xx()}},hexadecimal:{getWord(){return Tx()},punctuateWord(e){return`0x${e}`},rememberSettings(){Ve("punctuation",r.punctuation,ei)}},zipf:{getWordsFrequencyMode(){return"zipf"}},ddoouubblleedd:{alterText(e){return e.replace(/./gu,"$&$&")}},instant_messaging:{alterText(e){return e.toLowerCase().replace(/[.!?]$/g,`
`).replace(/[().'"]/g,"").replace(/\n+/g,`
`)}},morse:{alterText(e){return Lx(e)}},underscore_spaces:{alterText(e,t,a){return t===a-1?e:e+"_"}},crt:{applyGlobalCSS(){if(/^((?!chrome|android).)*safari/i.test(navigator.userAgent)){const t=navigator.userAgent.match(/.*Version\/([0-9]*)\.([0-9]*).*/),a=t!==null?parseInt(t[1]??"0"):0,o=t!==null?parseInt(t[2]??"0"):0;if(a<=16&&o<=5){f("CRT is not available on Safari 16.5 or earlier.",0,{duration:5}),Wn("crt");return}}n("body").append('<div id="scanline" />'),n("body").addClass("crtmode"),n("#globalFunBoxTheme").attr("href","funbox/crt.css")},clearGlobal(){n("#scanline").remove(),n("body").removeClass("crtmode"),n("#globalFunBoxTheme").attr("href","")}},ALL_CAPS:{alterText(e){return e.toUpperCase()}},polyglot:{async withWords(e){const t=r.customPolyglot.map(async u=>ai(u).catch(()=>(f(`Failed to load language: ${u}. It will be ignored.`,0),null))),a=(await Promise.all(t)).filter(u=>u!==null);if(a.length===0)throw Wn("polyglot"),new Error(`No valid languages found. Please check your polyglot languages config (${r.customPolyglot.join(", ")}).`);if(a.length===1){const u=a[0];throw Zn(u.name,!0),Wn("polyglot",!0),f(`Disabled polyglot funbox because only one valid language was found. Check your polyglot languages config (${r.customPolyglot.join(", ")}).`,0,{duration:7}),new Qe("")}const o=a.every(u=>u.rightToLeft),i=a.every(u=>!u.rightToLeft),l=(await ai(r.language))?.rightToLeft??!1;if(l&&i||!l&&o){const u=a[0]?.name??(o?"arabic":"english");throw Zn(u),f(`Language direction conflict: switched to ${u} for consistency.`,0,{duration:5}),new Qe("")}const c=new Map(a.map(u=>[u.name,{noLazyMode:u.noLazyMode,ligatures:u.ligatures,rightToLeft:u.rightToLeft,additionalAccents:u.additionalAccents}])),d=new Map(a.flatMap(u=>u.words.map(p=>[p,u.name])));return new Jp(d,c)}}};function r4(){return s4}const l4=vk(),c4=r4(),Zu={};for(const[e,t]of Object.entries(l4))Zu[e]={...t,functions:c4[e]};function ef(e){return Array.isArray(e)?e.map(a=>Zu[a]):Zu[e]}function Mo(){return ef(Jt())}function Jt(){return r.funbox??[]}function x0(e){return Mo().filter(t=>t.properties?.includes(e))}function ui(e){return x0(e).length>0}function T0(e){return Jt().includes(e)}function ft(e){return Mo().filter(t=>t.functions?.[e])}function L0(e){return ft(e).length>0}function Ao(e){const t=ft(e);if(t.length!==0){if(t.length===1)return t[0];throw new Error(`Expecting exactly one funbox implementing "${e} but found ${t.length}`)}}let Xp=0,Q=null;const Dt=new Yy(document.getElementById("paceCaret"),r.paceCaretStyle);let tf=0;function d4(e){(!Hi||Hi&&e>tf)&&(tf=e)}function u4(){r.paceCaret==="off"&&!Hi||r.mode!=="zen"&&(Dt.hide(),Dt.stopAllAnimations(),Dt.clearMargins(),Dt.goTo({wordIndex:0,letterIndex:0,isLanguageRightToLeft:da,isDirectionReversed:li,animate:!1}))}async function Ac(){Dt.hide();const e=rn(r,me);let t=0;if(r.paceCaret==="pb"?t=(await gr(r.mode,e,r.punctuation,r.numbers,r.language,r.difficulty,r.lazyMode,Mo()))?.wpm??0:r.paceCaret==="tagPb"?t=await RS(r.mode,e,r.punctuation,r.numbers,r.language,r.difficulty,r.lazyMode):r.paceCaret==="average"?([t]=await vy(r.mode,e,r.punctuation,r.numbers,r.language,r.difficulty,r.lazyMode),t=Math.round(t)):r.paceCaret==="daily"?(t=await BS(r.mode,e,r.punctuation,r.numbers,r.language,r.difficulty,r.lazyMode),t=Math.round(t)):r.paceCaret==="custom"?t=r.paceCaretCustomSpeed:(r.paceCaret==="last"||Hi)&&(t=tf),t===void 0||t<1||Number.isNaN(t)){Q=null;return}const a=t*5,o=a/60,i=60/a;Q={wpm:t,cps:o,spc:i,correction:0,currentWordIndex:0,currentLetterIndex:0,wordsStatus:{},timeout:null}}async function $0(e){if(!(Q===null||!we||ce)){Dt.isHidden()&&Dt.show(),p4();try{const t=performance.now(),o=Xp+e-t;Dt.goTo({wordIndex:Q.currentWordIndex,letterIndex:Q.currentLetterIndex,isLanguageRightToLeft:da,isDirectionReversed:li,animate:!0,animationOptions:{duration:o,easing:"linear"}}),Q.timeout=setTimeout(()=>{$0(e+(Q?.spc??0)*1e3).catch(()=>{Q=null})},Math.max(0,o))}catch(t){console.error(t),Dt.hide();return}}}function f4(){Q?.timeout!==null&&Q?.timeout!==void 0&&clearTimeout(Q.timeout),Q=null,Xp=0}function p4(){if(Q!==null)try{if(Q.currentLetterIndex++,Q.currentLetterIndex>=_.get(Q.currentWordIndex).length+1&&(Q.currentLetterIndex=0,Q.currentWordIndex++),!r.blindMode){if(Q.correction<0)for(;Q.correction<0;)Q.currentLetterIndex--,Q.currentLetterIndex<=-2&&(Q.currentLetterIndex=_.get(Q.currentWordIndex-1).length-1,Q.currentWordIndex--),Q.correction++;else if(Q.correction>0)for(;Q.correction>0;)Q.currentLetterIndex++,Q.currentLetterIndex>=_.get(Q.currentWordIndex).length&&(Q.currentLetterIndex=0,Q.currentWordIndex++),Q.correction--}}catch{Q=null,console.log("pace caret out of words"),Dt.hide();return}}function fh(e,t){e?Q!==null&&Q.wordsStatus[le]===!0&&!r.blindMode&&(Q.wordsStatus[le]=void 0,Q.correction-=t.length+1):Q!==null&&Q.wordsStatus[le]===void 0&&!r.blindMode&&(Q.wordsStatus[le]=!0,Q.correction+=t.length+1)}function m4(){Xp=performance.now(),$0((Q?.spc??0)*1e3)}ge(e=>{e==="paceCaret"&&Ac(),e==="paceCaretStyle"&&Dt.setStyle(r.paceCaretStyle)});const g4=Mt(250,async()=>{const e=await rx(r.language);e==="no"&&f(`${$t(Aa(r.language))} does not support Zipf funbox, because the list is not ordered by frequency. Please try another word list.`,0,{duration:7}),e==="unknown"&&f(`${$t(Aa(r.language))} may not support Zipf funbox, because we don't know if it's ordered by frequency or not. If you would like to add this label, please contact us.`,0,{duration:7})}),$d=ek(b4,{rejectSkippedCalls:!1});ge((e,t,a)=>{(e==="language"||e==="funbox")&&r.funbox.includes("zipf")&&g4(),e==="fontSize"&&(n("#caret, #paceCaret, #liveStatsMini, #typingTest, #wordsInput").css("fontSize",t+"rem"),a||($s(),nf())),["fontSize","fontFamily","blindMode","hideExtraLetters"].includes(e)&&$d(),e==="theme"&&Hn(),t!==void 0&&(e==="highlightMode"&&X()==="test"&&Md(),["highlightMode","blindMode","indicateTypos","tapeMode","hideExtraLetters"].includes(e)&&nf(),["tapeMode","tapeMargin"].includes(e)&&_4(),e==="showAllLines"&&(_c(!0),t===!1&&F0()),typeof t=="boolean"&&(e==="flipTestColors"&&w4(t),e==="colorfulMode"&&C4(t),e==="burstHeatmap"&&Hn()))});let af=!1,Ql=0,Vi=!1;function M0(e){Vi=e}function h4(){Ql=0}function Ki(e=!1){const t=document.querySelector("#wordsInput");if(e&&t?.blur(),t?.focus({preventScroll:!0}),we)A0(!0);else{const a=document.querySelector("#typingTest");Ib(a)}}function A0(e=!1){const t=document.querySelector("#wordsInput"),a=document.querySelector("#wordsWrapper");if(!t||!a)return;const o=a.offsetHeight,i=window.innerHeight;o<i||!(t.getBoundingClientRect().top>i/2)&&!e||t.scrollIntoView({block:"center"})}function Ms(e){return document.querySelector(`#words .word[data-wordindex='${e}']`)}function Ia(){return Ms(le)}function Md(e,t=!1){const a=document.querySelector("#words .active");e||a?.classList.add("typed"),r.mode==="zen"&&e?a?.remove():a!==null&&!t&&a.classList.remove("active");const o=Ia();if(o===null)throw new Error("activeWord is null - can't update active element");o.classList.add("active"),o.classList.remove("error"),o.classList.remove("typed"),o.offsetTop,Zp(),!t&&r.tapeMode!=="off"&&Ad()}function of(e,t,a,o=!0){const i=typeof a=="string",s=i?Go(a):a;let l="",c=0;for(const d of e)for(const u of d){const p=t[u],g=`${u}`,m=i?s[u]:s[c++];l+=`<hint data-chars-index=${g} style="left:${p.offsetLeft+p.offsetWidth/2}px;">${m}</hint>`}return o&&(l=`<div class="hints">${l}</div>`),l}async function _0(e,t,a){const o=qy(_.getCurrent(),da,li);let i=!1,s=0,l=a.length;for(;s<l-1;){const c=a[s],d=a[s+1],u=c.dataset.charsIndex?.split(",")??[],p=d.dataset.charsIndex?.split(",")??[],g=parseInt(u[0]??"0"),m=parseInt(p[0]??"0");if(!e.some(U=>U.includes(g)&&U.includes(m))){s++,i=!1;continue}const y=t[g],C=t[m],M=y.offsetTop===C.offsetTop,w=o?d:c,F=o?c:d,I=w.offsetLeft+w.offsetWidth/2,P=F.offsetLeft-F.offsetWidth/2;if(M&&I>P){c.dataset.charsIndex=[...u,...p].join(",");const U=y.offsetLeft+(o?y.offsetWidth:0),K=d.offsetLeft-c.offsetLeft;c.style.left=U+K+"px",c.insertAdjacentHTML("beforeend",d.innerHTML),d.remove(),l--,i&&s>0&&s--}else s++;i=!0}}async function b4(){if(X()!=="test"||ce||r.indicateTypos!=="below"&&r.indicateTypos!=="both")return;let e,t=[],a=[];const o=document.querySelectorAll(".hints > hint");for(const s of o){const l=s.parentElement;l!==e&&(await i(e,t,a),e=l,t=[],a=[]);const c=s.dataset.charsIndex?.split(",").map(d=>parseInt(d));if(!(c===void 0||c.length===0)){for(const d of c){const u=t[t.length-1];u&&u[u.length-1]===d-1?u.push(d):t.push([d])}a.push(...Go(s.innerHTML))}}await i(e,t,a);async function i(s,l,c){if(!s||l.length===0)return;const d=s.parentElement,u=d.querySelectorAll("letter");s.innerHTML=of(l,u,c,!1);const p=d.getElementsByTagName("hint");await _0(l,u,p)}}function E0(e,t){let a=!1,o=`<div class='word' data-wordindex='${t}'>`;const i=Ao("getWordHtml"),s=Go(e);for(const l of s)i?o+=i.functions.getWordHtml(l,!0):l==="	"?o+=`<letter class='tabChar'><i class="fas fa-long-arrow-alt-right fa-fw"></i></letter>`:l===`
`?(a=!0,o+=`<letter class='nlChar'><i class="fas fa-level-down-alt fa-rotate-90 fa-fw"></i></letter>`):o+="<letter>"+l+"</letter>";return o+="</div>",a&&(o+="<div class='beforeNewline'></div><div class='newline'></div><div class='afterNewline'></div>"),o}function nf(){r.tapeMode!=="off"?(n("#words").addClass("tape"),n("#wordsWrapper").addClass("tape")):(n("#words").removeClass("tape"),n("#wordsWrapper").removeClass("tape")),r.blindMode?(n("#words").addClass("blind"),n("#wordsWrapper").addClass("blind")):(n("#words").removeClass("blind"),n("#wordsWrapper").removeClass("blind")),r.indicateTypos==="below"||r.indicateTypos==="both"?(n("#words").addClass("indicateTyposBelow"),n("#wordsWrapper").addClass("indicateTyposBelow")):(n("#words").removeClass("indicateTyposBelow"),n("#wordsWrapper").removeClass("indicateTyposBelow")),r.hideExtraLetters?(n("#words").addClass("hideExtraLetters"),n("#wordsWrapper").addClass("hideExtraLetters")):(n("#words").removeClass("hideExtraLetters"),n("#wordsWrapper").removeClass("hideExtraLetters"));const e=n("#words")?.attr("class")?.split(/\s+/)?.filter(t=>!t.startsWith("highlight-"))??[];r.highlightMode!==null&&e.push("highlight-"+r.highlightMode.replaceAll("_","-")),n("#words").attr("class",e.join(" ")),P0(),_c(!0),v4(),Zp(),$d(),vo()}function y4(){const e=n("#words");if(e.empty(),r.mode==="zen")q0();else{let t="";for(let a=0;a<_.length;a++)t+=E0(_.get(a),a);e.html(t)}Md(void 0,!0),nf(),u4()}function q0(e=k.getHistory().length){n("#words").append(`<div class='word' data-wordindex='${e}'><letter class='invisible'>_</letter></div>`)}function Zp(){Pp("test-ui.updateWordsInputPosition",()=>{if(X()!=="test")return;const e=li?!da:da,t=document.querySelector("#wordsInput"),a=document.querySelector("#wordsWrapper");if(!t||!a)return;const o=Ia();if(!o){t.style.top="0px",t.style.left="0px";return}const i=pr(r.fontSize),s=o.offsetTop+i/2-t.offsetHeight/2+1;r.tapeMode!=="off"?t.style.maxWidth=`${100-r.tapeMargin}%`:t.style.maxWidth="",o.offsetWidth<i?t.style.width=i+"px":t.style.width=o.offsetWidth+"px",t.style.top=s+"px",r.tapeMode!=="off"?t.style.left=`${a.offsetWidth*(r.tapeMargin/100)}px`:o.offsetWidth<i&&e?t.style.left=o.offsetLeft-i+"px":t.style.left=Math.max(0,o.offsetLeft)+"px",A0()})}let I0=Promise.resolve();async function F0(){if(r.showAllLines)return;const{resolve:e,promise:t}=Lo();I0=t;const a=Ia();if(!a){e();return}const o=a.offsetTop;let i=o;for(let s=le-1;s>=0;s--)if(i=Ms(s)?.offsetTop??o,i<o){await em(i,!0),e();return}e()}function _c(e=!1){if(X()!=="test"||ce||!e&&r.mode!=="custom")return;const t=document.getElementById("wordsWrapper"),a=document.querySelector(".outOfFocusWarning"),o=Ia();if(!o)return;t.classList.remove("hidden");const i=window.getComputedStyle(o),s=parseInt(i.marginTop)+parseInt(i.marginBottom),l=o.offsetHeight+s,c=r.mode==="time"||r.mode==="custom"&&ve()==="time"||r.mode==="custom"&&ye()===0;if(r.showAllLines&&!c)t.style.height="";else if(r.mode==="zen")t.style.height=l*2+"px";else if(r.tapeMode==="off"){const u=document.querySelectorAll("#words .word");let p=0,g=0,m=0,h=0;for(;p<3;){const y=u[m];if(!y)break;const C=y.offsetTop;C>g&&(p++,h+=y.offsetHeight+s,g=C),m++}p<3&&(h=h*(3/p)),t.style.height=h+"px"}else if(yr)t.style.height=l*3+"px";else{const u=document.getElementById("words")?.offsetHeight??l;t.style.height=u+"px"}a.style.maxHeight=l*3+"px"}function v4(){if(r.tapeMode!=="off")Ad(!0);else{const e=document.getElementById("words");n(e).stop(!0,!1);const t=e.querySelectorAll(".afterNewline");e.style.marginLeft="0",e.style.marginTop="0";for(const a of t)a.style.marginLeft="0"}}function ph(e,t=_.length-1){n("#words").append(E0(e,t))}function w4(e){e?n("#words").addClass("flipped"):n("#words").removeClass("flipped")}function C4(e){e?n("#words").addClass("colorfulMode"):n("#words").removeClass("colorfulMode")}async function va(e){const t=e??k.current,a=_.getCurrent();if(!a&&r.mode!=="zen")return;let o="";const i=Ia();if(!i)return;const s=[];let l=!1;if(r.mode==="zen"){for(const c of k.current)c==="	"?o+=`<letter class='tabChar correct' style="opacity: 0"><i class="fas fa-long-arrow-alt-right fa-fw"></i></letter>`:c===`
`?(l=!0,o+=`<letter class='nlChar correct' style="opacity: 0"><i class="fas fa-level-down-alt fa-rotate-90 fa-fw"></i></letter>`):o+=`<letter class="correct">${c}</letter>`;k.current===""&&(o+="<letter class='invisible'>_</letter>")}else{let c=!1;const d=k.getKoreanStatus();if(d){const m=Ze.disassemble(a).join(""),h=Ze.disassemble(t).join(""),y=Po.test(t)?t.search(Po):h.length;t.search(Po)<Ze.d(m).length&&m.slice(0,y)===h.slice(0,y)&&(c=!0)}else{const m=Po.test(t)?t.search(Po):t.length;t.search(Po)<a.length&&a.slice(0,m)===t.slice(0,m)&&(c=!0)}const u=Ao("getWordHtml"),p=Go(t),g=Go(a);for(let m=0;m<p.length;m++){const h=g[m]===p[m];let y=g[m],C="",M="";if(u){const w=u.functions.getWordHtml(y);w!==""&&(y=w)}else y==="	"?(C="tabChar",y='<i class="fas fa-long-arrow-alt-right fa-fw"></i>'):y===`
`&&(M="nlChar",y='<i class="fas fa-level-down-alt fa-rotate-90 fa-fw"></i>');if(h)o+=`<letter class="correct ${C}${M}">${y}</letter>`;else if(y!==void 0&&Ri()&&m>=mx()&&!(d&&!c))o+=`<letter class="dead">${r.indicateTypos==="replace"||r.indicateTypos==="both"?p[m]===" "?"_":p[m]:y}</letter>`;else if(y===void 0){let w=p[m];(w===" "||w==="	"||w===`
`)&&(w="_"),o+=`<letter class="incorrect extra ${C}${M}">${w}</letter>`}else if(o+=`<letter class="incorrect ${C}${M}">`+(r.indicateTypos==="replace"||r.indicateTypos==="both"?p[m]===" "?"_":p[m]:y)+"</letter>",r.indicateTypos==="below"||r.indicateTypos==="both"){const w=s[s.length-1];w&&w[w.length-1]===m-1?w.push(m):s.push([m])}}for(let m=p.length;m<g.length;m++){const h=g[m];u?.functions?.getWordHtml?o+=u.functions.getWordHtml(h,!0):h==="	"?o+=`<letter class='tabChar'><i class="fas fa-long-arrow-alt-right fa-fw"></i></letter>`:h===`
`?o+=`<letter class='nlChar'><i class="fas fa-level-down-alt fa-rotate-90 fa-fw"></i></letter>`:o+="<letter>"+h+"</letter>"}}if(i.innerHTML=o,s?.length){const c=i.querySelectorAll("letter");let d;r.indicateTypos==="both"?d=of(s,c,a):d=of(s,c,t),i.insertAdjacentHTML("beforeend",d);const u=i.getElementsByTagName("hint");await _0(s,c,u)}l&&n("#words").append("<div class='beforeNewline'></div><div class='newline'></div><div class='afterNewline'></div>"),r.tapeMode!=="off"&&Ad()}function k4(e,t=!0){let a;if(e?a=e.querySelector("letter.nlChar"):a=document.querySelector("#words > .word > letter.nlChar"),!a||t&&a.classList.contains("incorrect"))return 0;const o=window.getComputedStyle(a),i=parseFloat(o.marginLeft)+parseFloat(o.marginRight);return a.offsetWidth+i}async function Ad(e=!1){if(X()!=="test"||ce)return;await I0;const t=li?!da:da,a=document.querySelector("#wordsWrapper").offsetWidth,o=document.getElementById("words"),i=[...o.children],s=Ia();if(!s)return;const l=o.getElementsByClassName("afterNewline");let c=0,d=0,u=!1,p,g=0;const m=[],h=[],y=[];for(const ee of i)if(ee.classList.contains("word")){p&&(g+=parseFloat(p.style.marginLeft));break}else ee.classList.contains("afterNewline")&&(y.push(ee),u=!0,p=ee);let C;const M=i.indexOf(s),w=i.slice(0,M).filter(ee=>ee.classList.contains("afterNewline")).length;let F=l[w+1];F?C=i.indexOf(F):(F=l[w],F?C=i.indexOf(F):C=M-1);const I=parseFloat(window.getComputedStyle(s).marginRight);for(let ee=0;ee<=C;ee++){const Le=i[ee];if(Le.classList.contains("word")){u=!1;const At=n(Le).outerWidth(!0)??0,ot=Math.floor(Le.offsetLeft),vt=Math.floor(Le.offsetWidth);!t&&ot<0-vt||t&&ot>a?(y.push(Le),g+=At):(d+=At,ee<M&&(c=d))}else if(Le.classList.contains("afterNewline")){if(u)continue;const At=k4(i[ee-3]);d-=At+I,ee<M&&(c=d);const ot=3*o.offsetWidth;if(d<ot)h.push(d),m.push(g);else{h.push(ot),m.push(g),ee<C&&(h.push(ot),m.push(g));break}}}if(y.length>0){for(const Le of y)Le.remove();for(let Le=0;Le<m.length;Le++){const At=l[Le],ot=parseFloat(At.style.marginLeft)||0;At.style.marginLeft=`${ot-(m[Le]??0)}px`}t&&(g*=-1);const ee=parseFloat(o.style.marginLeft)||0;o.style.marginLeft=`${ee+g}px`,Yt.handleTapeWordsRemoved(g),Dt.handleTapeWordsRemoved(g)}let P=0;const U=k.current.length;if(r.tapeMode==="letter"&&U>0){const ee=s.querySelectorAll("letter");let Le=0;for(let At=0;At<U;At++){const ot=ee[At];if((r.blindMode||r.hideExtraLetters)&&ot.classList.contains("extra"))continue;const vt=n(ot).outerWidth(!0)??0;P+=vt,vt>0&&(Le=vt)}n(ee[U]).outerWidth(!0)===0&&(P-=Le)}const K=a*(r.tapeMargin/100);let ne=c+P,_e=K-ne;t&&(ne*=-1,_e=I-_e);const He=e?0:125,Pe="inOut(1.25)",Oe={newValue:ne*-1,duration:r.smoothLineScroll?He:0,ease:Pe};if(Yt.handleTapeScroll(Oe),Dt.handleTapeScroll(Oe),r.smoothLineScroll){W(o,{marginLeft:_e,duration:He,ease:Pe});for(let ee=0;ee<h.length;ee++){const Le=h[ee]??0;W(l[ee],{marginLeft:Le,duration:He,ease:Pe})}}else{o.style.marginLeft=`${_e}px`;for(let ee=0;ee<h.length;ee++){const Le=h[ee]??0;l[ee].style.marginLeft=`${Le}px`}}}function S4(){const e=rn(r,me);let t="";r.funbox.length>0&&(t=" "+r.funbox.join(" ")),n(".pageTest #premidTestMode").text(`${r.mode} ${e} ${Aa(r.language)}${t}`),n(".pageTest #premidSecondsLeft").text(r.time)}function mh(e){const t=document.getElementById("words")?.children;if(t!==void 0)for(let a=e;a>=0;a--){const o=t[a];!o||!o.isConnected||o.remove()}}let xl=0;async function em(e,t=!1){const{resolve:a,promise:o}=Lo();if(Ql>0||t){const i=e,s=document.getElementById("words"),l=Ia();if(!l){a();return}const c=[...s.children],d=c.indexOf(l);let u;for(let y=d-1;y>=0;y--){const C=c[y];if(!C.classList.contains("hidden")&&Math.floor(C.offsetTop)<i){if(C.classList.contains("word")){u=y;break}else if(C.classList.contains("beforeNewline")){u=y+1;break}}}if(u===void 0)return a(),Ql++,_c(),o;xl++;const g=-1*n(l).outerHeight(!0)*xl,m=125,h={newMarginTop:g,duration:r.smoothLineScroll?m:0};Yt.handleLineJump(h),Dt.handleLineJump(h),r.smoothLineScroll?(af=!0,W(s,{marginTop:g,duration:m,onComplete:()=>{xl=0,l.offsetTop,mh(u),s.style.marginTop="0",af=!1,a()}})):(xl=0,mh(u),a())}return Ql++,_c(),o}function x4(e){e?(n("#words").addClass("rightToLeftTest"),n("#resultWordsHistory .words").addClass("rightToLeftTest"),n("#resultReplay .words").addClass("rightToLeftTest")):(n("#words").removeClass("rightToLeftTest"),n("#resultWordsHistory .words").removeClass("rightToLeftTest"),n("#resultReplay .words").removeClass("rightToLeftTest"))}function T4(e){e||r.mode==="custom"||r.mode==="zen"?(n("#words").addClass("withLigatures"),n("#resultWordsHistory .words").addClass("withLigatures"),n("#resultReplay .words").addClass("withLigatures")):(n("#words").removeClass("withLigatures"),n("#resultWordsHistory .words").removeClass("withLigatures"),n("#resultReplay .words").removeClass("withLigatures"))}function L4(e,t,a,o,i,s,l){let c="";for(let d=0;d<e;d++){let u;try{u=l?Ze.assemble(a.split(""))[d]:s[d]}catch{u=void 0}let p="";const g=l?Ze.assemble(a.split("")):a;d+1===e&&g!==void 0&&g.length>t.length&&(p="extraCorrected"),r.mode==="zen"||i[d]!==void 0?r.mode==="zen"||o[d]===i[d]?u===o[d]||u===void 0?c+=`<letter class="correct ${p}">${o[d]}</letter>`:c+=`<letter class="corrected ${p}">`+o[d]+"</letter>":o[d]===k.current?c+=`<letter class='correct ${p}'>`+i[d]+"</letter>":o[d]===void 0?c+="<letter>"+i[d]+"</letter>":c+=`<letter class="incorrect ${p}">`+i[d]+"</letter>":c+='<letter class="incorrect extra">'+o[d]+"</letter>"}return c}async function $4(){n("#resultWordsHistory .words").empty();let e="";for(let t=0;t<k.getHistory().length+2;t++){const a=k.getHistory(t),o=Ke.getHistory(t),i=_.get(t),s=a?.match(/[\uac00-\ud7af]|[\u1100-\u11ff]|[\u3130-\u318f]|[\ua960-\ua97f]|[\ud7b0-\ud7ff]/g)!==null||i?.match(/[\uac00-\ud7af]|[\u1100-\u11ff]|[\u3130-\u318f]|[\ua960-\ua97f]|[\ud7b0-\ud7ff]/g)!==null;let l="";try{if(a===void 0||a==="")throw new Error("empty input word");const c=r.mode==="zen"?"":a!==i?"error":"";if(o!==void 0&&o!==""){const m=s?Ze.assemble(o.split("")):o;l=`<div class='word nocursor ${c}' burst="${Ta[t]}" input="${m.replace(/"/g,"&quot;").replace(/ /g,"_")}">`}else l=`<div class='word nocursor ${c}' burst="${Ta[t]}" input="${a.replace(/"/g,"&quot;").replace(/ /g,"_")}">`;const d=Go(a),u=Go(i??""),p=Go(o??"");let g;if(r.mode==="zen"||a.length>i.length?g=d.length:g=u.length,o===void 0)throw new Error("empty corrected word");l+=L4(g,a,o,d,u,p,s),l+="</div>"}catch{try{l="<div class='word'>";for(const d of i)l+="<letter>"+d+"</letter>";l+="</div>"}catch{l+="</div>"}}e+=l}return n("#resultWordsHistory .words").html(e),n("#showWordHistoryButton").addClass("loaded"),!0}function tm(e=!1){ce&&(kx(),n("#resultWordsHistory").stop(!0,!0).hasClass("hidden")?n("#resultWordsHistory .words .word").length===0?(n("#words").html('<div class="preloader"><i class="fas fa-fw fa-spin fa-circle-notch"></i></div>'),$4().then(()=>{r.burstHeatmap&&Hn(),n("#resultWordsHistory").removeClass("hidden").css("display","none").slideDown(e?0:250,()=>{r.burstHeatmap&&Hn()})})):(r.burstHeatmap&&Hn(),n("#resultWordsHistory").removeClass("hidden").css("display","none").slideDown(e?0:250)):n("#resultWordsHistory").slideUp(250,()=>{n("#resultWordsHistory").addClass("hidden")}))}async function Hn(){if(r.burstHeatmap){n("#resultWordsHistory .heatmapLegend").removeClass("hidden");let e=[...Ta];e=e.filter(d=>d!==1/0),e=e.filter(d=>d<500);const t=dt(r.typingSpeedUnit);e.forEach((d,u)=>{e[u]=Math.round(t.fromWpm(d))});const a=await ci();let o=[a.colorfulError,aa(a.colorfulError,a.text,.5),a.text,aa(a.main,a.text,.5),a.main],i=a.sub;a.main===a.text&&(o=[a.colorfulError,aa(a.colorfulError,a.text,.5),a.sub,aa(a.sub,a.text,.5),a.main],i=a.subAlt);const s=e.sort((d,u)=>d-u),l=e.length,c=[{val:0,colorId:0},{val:s[l*.15|0],colorId:1},{val:s[l*.35|0],colorId:2},{val:s[l*.65|0],colorId:3},{val:s[l*.85|0],colorId:4}];c.forEach((d,u)=>{const p=c[u+1];let g="";u===0&&p?g=`<${Math.round(p.val)}`:u===4?g=`${Math.round(d.val)}+`:p&&(d.val!==p.val?g=`${Math.round(d.val)}-${Math.round(p.val)-1}`:g=`${Math.round(d.val)}-${Math.round(d.val)}`),n("#resultWordsHistory .heatmapLegend .box"+u).html(`<div>${g}</div>`)}),n("#resultWordsHistory .words .word").each((d,u)=>{const p=n(u).attr("burst");if(p===void 0)n(u).css("color",i);else{let g=parseInt(p);g=Math.round(dt(r.typingSpeedUnit).fromWpm(g)),c.forEach(m=>{g>=m.val&&(n(u).addClass("heatmapInherit"),n(u).css("color",o[m.colorId]))})}}),n("#resultWordsHistory .heatmapLegend .boxes .box").each((d,u)=>{n(u).css("background",o[d])})}else n("#resultWordsHistory .heatmapLegend").addClass("hidden"),n("#resultWordsHistory .words .word").removeClass("heatmapInherit"),n("#resultWordsHistory .words .word").css("color",""),n("#resultWordsHistory .heatmapLegend .boxes .box").css("color","")}function M4(e){n(Ms(e)).addClass("error")}function A4(e){n(Ms(e)).find("letter").addClass("correct")}function P0(){let e={};r.tapeMode==="off"?r.maxLineWidth===0?e={"max-width":"100%"}:e={"max-width":r.maxLineWidth+"ch"}:r.maxLineWidth===0?e={"max-width":"100%"}:e={"max-width":"100%"};const t=n("#typingTest");t.css(e),r.maxLineWidth===0?t.removeClass("full-width-padding").addClass("content"):t.removeClass("content").addClass("full-width-padding")}function _4(){r.tapeMode==="off"?n("#liveStatsMini").css({"justify-content":"start","margin-left":"0.25em"}):n("#liveStatsMini").css({"justify-content":"center","margin-left":r.tapeMargin+"%"})}function E4(e){n("#barTimerProgress").css("opacity",parseFloat(e)),n("#liveStatsTextTop").css("opacity",parseFloat(e)),n("#liveStatsTextBottom").css("opacity",parseFloat(e)),n("#liveStatsMini").css("opacity",parseFloat(e))}function q4(e){n("#barTimerProgress").removeClass("timerSub"),n("#barTimerProgress").removeClass("timerText"),n("#barTimerProgress").removeClass("timerMain"),n("#liveStatsTextTop").removeClass("timerSub"),n("#liveStatsTextTop").removeClass("timerText"),n("#liveStatsTextTop").removeClass("timerMain"),n("#liveStatsTextBottom").removeClass("timerSub"),n("#liveStatsTextBottom").removeClass("timerText"),n("#liveStatsTextBottom").removeClass("timerMain"),n("#liveStatsMini").removeClass("timerSub"),n("#liveStatsMini").removeClass("timerText"),n("#liveStatsMini").removeClass("timerMain"),e==="main"?(n("#barTimerProgress").addClass("timerMain"),n("#liveStatsTextTop").addClass("timerMain"),n("#liveStatsTextBottom").addClass("timerMain"),n("#liveStatsMini").addClass("timerMain")):e==="sub"?(n("#barTimerProgress").addClass("timerSub"),n("#liveStatsTextTop").addClass("timerSub"),n("#liveStatsTextBottom").addClass("timerSub"),n("#liveStatsMini").addClass("timerSub")):e==="text"&&(n("#barTimerProgress").addClass("timerText"),n("#liveStatsTextTop").addClass("timerText"),n("#liveStatsTextBottom").addClass("timerText"),n("#liveStatsMini").addClass("timerText"))}n(".pageTest #copyWordsListButton").on("click",async()=>{let e;r.mode==="zen"?e=k.getHistory().join(" "):e=_.get().slice(0,k.getHistory().length).join(" "),await B0(e)});n(".pageTest #copyMissedWordsListButton").on("click",async()=>{let e;r.mode==="zen"?e=k.getHistory().join(" "):e=Object.keys(go??{}).join(" "),await B0(e)});async function B0(e){try{await navigator.clipboard.writeText(e),f("Copied to clipboard",0,{duration:2})}catch(t){const a=ie(t,"Could not copy to clipboard");f(a,-1)}}n(".pageTest #toggleBurstHeatmap").on("click",async()=>{C3(!r.burstHeatmap),Kp()});n(".pageTest #resultWordsHistory").on("mouseleave",".words .word",()=>{n(".wordInputHighlight").remove()});n(".pageTest #result #wpmChart").on("mouseleave",()=>{m0(!1),yx()});n(".pageTest #result #wpmChart").on("mouseenter",()=>{m0(!0)});n(".pageTest #resultWordsHistory").on("mouseenter",".words .word",e=>{if(ce){const t=n(e.currentTarget).attr("input"),a=parseInt(n(e.currentTarget).attr("burst"));t!==void 0&&n(e.currentTarget).append(`<div class="wordInputHighlight withSpeed">
          <div class="text">
          ${t.replace(/\t/g,"_").replace(/\n/g,"_").replace(/</g,"&lt").replace(/>/g,"&gt")}
          </div>
          <div class="speed">
          ${D.typingSpeed(a,{showDecimalPlaces:!1})}
          ${r.typingSpeedUnit}
          </div>
          </div>`)}});addEventListener("resize",()=>{Kp()});n("#wordsInput").on("focus",e=>{e.target===document.activeElement&&(!ce&&r.showOutOfFocusWarning&&$s(),Zy(!0))});n("#wordsInput").on("focusout",()=>{!ce&&r.showOutOfFocusWarning&&r0(),Yr()});n(".pageTest").on("click","#showWordHistoryButton",()=>{tm()});n("#wordsWrapper").on("click",()=>{Ki()});ge((e,t)=>{e==="quickRestart"&&(t==="off"?n(".pageTest #restartTestButton").removeClass("hidden"):n(".pageTest #restartTestButton").addClass("hidden")),e==="maxLineWidth"&&P0(),e==="timerOpacity"&&E4(t),e==="timerColor"&&q4(t),e==="showOutOfFocusWarning"&&t===!1&&$s()});let am=!1;function te(){am=!0}function Cr(){am=!1}function I4(){return am}let R0="",D0=!1;function om(){return R0}function Xa(){return D0}function oi(e,t){R0=e,D0=t}let im=!1,ji,As,sf,rf,kr,Sr,Gi=!1,W0;function F4(e){W0=e}function z0(){const e={lastResult:W0,start:ji,end:As,start3:kr,end3:Sr,afkHistory:Qr,errorHistory:Gr,wpmHistory:ti,rawHistory:jr,burstHistory:Ta,keypressCountHistory:Ni,currentBurstStart:md,lastSecondNotRound:Gi,missedWords:go,accuracy:sa,keypressTimings:he,keyOverlap:so,wordsHistory:_.list.slice(0,k.getHistory().length),inputHistory:k.getHistory()};try{e.keypressTimings.spacing.average=he.spacing.array.reduce((t,a)=>a+=t)/he.spacing.array.length,e.keypressTimings.spacing.sd=Zs(he.spacing.array)}catch{}try{e.keypressTimings.duration.average=he.duration.array.reduce((t,a)=>a+=t)/he.duration.array.length,e.keypressTimings.duration.sd=Zs(he.duration.array)}catch{}return e}function P4(){ji=0,As=0,im=!1,Gi=!1}let nm=0,Ec=0,sm=[];function rm(){nm++}function lm(e){Ec+=e}function cm(e,t){sm.push({acc:e,seconds:t})}function H0(){nm=0,Ec=0,sm=[]}function Tl(){im=!0}function el(e){let t=(As-ji)/1e3;return e!==void 0&&(t=(e-ji)/1e3),r.mode==="zen"&&t<0&&(t=0,console.log("Zen mode with negative duration detected, setting to 0")),t}function dm(e,t=!1){const a=el(we?performance.now():As),o=N0(t),i=H((o.correctWordChars+o.correctSpaces)*(60/a)/5),s=H((o.allCorrectChars+o.spaces+o.incorrectChars+o.extraChars)*(60/a)/5);return{wpm:e?i:Math.round(i),raw:e?s:Math.round(s)}}function gh(e){As=e,rf=Date.now(),Sr=new Date().getTime()}function B4(e){ji=e,sf=Date.now(),kr=new Date().getTime()}function um(e){let t=0;return e!==void 0&&(r.mode==="time"?t=Math.round(e)-Ni.length:t=Math.ceil(e)-Ni.length,t<0&&(t=0)),Qr.filter(o=>o).length+t}function R4(){Gi=!0}function O0(){const e=k.getKoreanStatus(),t=(performance.now()-md)/1e3;let a;if(a=e?pc.disassemble(k.current).length:k.current.length,a===0&&(a=e?pc.disassemble(k.getHistoryLast())?.length??0:k.getHistoryLast()?.length??0),a===0)return 0;const o=H(a*(60/t)/5);return Math.round(o)}function tl(){const e=sa.correct/(sa.correct+sa.incorrect)*100;return isNaN(e)?100:e}function D4(){const e=el();Ni.splice(e),ti.splice(e),Ta.splice(e),jr.splice(e)}function W4(){const e=k.getKoreanStatus();let t=[...k.getHistory()];return we&&t.push(k.current),e&&(t=t.map(a=>pc.disassemble(a).join(""))),t}function z4(){const e=k.getKoreanStatus();let t=[...r.mode==="zen"?k.getHistory():_.list];return we&&t.push(r.mode==="zen"?k.current:_.getCurrent()),e&&(t=t.map(a=>pc.disassemble(a).join(""))),t}function N0(e=!1){let t=0,a=0,o=0,i=0,s=0,l=0,c=0;const d=W4(),u=z4();for(let p=0;p<d.length;p++){const g=d[p],m=u[p];if(g===m)t+=m.length,a+=m.length,p<d.length-1&&_y(g)!==`
`&&c++;else if(g.length>=m.length)for(let h=0;h<g.length;h++)h<m.length?g[h]===m[h]?a++:o++:i++;else{const h={correct:0,incorrect:0,missed:0};for(let M=0;M<m.length;M++)M<g.length?g[M]===m[M]?h.correct++:h.incorrect++:h.missed++;a+=h.correct,o+=h.incorrect;const y=r.mode==="time"||r.mode==="custom"&&Ku().mode==="time",C=!e||e&&y;p===d.length-1&&C?h.incorrect===0&&(t+=h.correct):s+=h.missed}p<d.length-1&&l++}return ui("nospace")&&(l=0,c=0),{spaces:l,correctWordChars:t,allCorrectChars:a,incorrectChars:r.mode==="zen"?sa.incorrect:o,extraChars:i,missedChars:s,correctSpaces:c}}function H4(){console.debug("Calculating result stats");let e=el();console.debug("Test seconds",e," (date based) ",(rf-sf)/1e3," (performance.now based)",(Sr-kr)/1e3," (new Date based)"),console.debug("Test seconds",Dl(e)," (date based) ",Dl((rf-sf)/1e3)," (performance.now based)",Dl((Sr-kr)/1e3)," (new Date based)"),r.mode!=="custom"&&(e=H(e),console.debug("Mode is not custom - rounding to 2. New time: ",e));const t=N0(!0),{wpm:a,raw:o}=dm(!0,!0),i=H(tl()),s={wpm:isNaN(a)?0:a,wpmRaw:isNaN(o)?0:o,acc:i,correctChars:t.correctWordChars,incorrectChars:t.incorrectChars,missedChars:t.missedChars,extraChars:t.extraChars,allChars:t.allCorrectChars+t.spaces+t.incorrectChars+t.extraChars,time:H(e),spaces:t.spaces,correctSpaces:t.correctSpaces};return console.debug("Result stats",s),s}const Se={mode:null,punctuation:null,numbers:null,customText:null};function lf(e,t){if(r.mode==="zen")return!1;let a;e==="words"&&!t||e==="off"&&t?a=20:a=10;let o=[];e==="words"&&(Object.keys(go).forEach(g=>{const m=go[g];m!==void 0&&o.push([g,m])}),o.sort((g,m)=>m[1]-g[1]),o=o.slice(0,a));let i=[];if(e==="biwords"){for(let g=0;g<_.length;g++){const m=_.get(g),h=go[m];h!==void 0&&(g===0?i.push([m,"",h]):i.push([m,_.get(g-1),h]))}i.sort((g,m)=>m[2]-g[2]),i=i.slice(0,a)}if((e==="words"&&o.length===0||e==="biwords"&&i.length===0)&&!t)return f("You haven't missed any words",0),!1;let s=[];if(t){const g=_.get().slice(0,k.getHistory().length-1);s=g.map((m,h)=>[m,Ta[h]??0]),s.sort((m,h)=>m[1]-h[1]),s=s.slice(0,Math.min(a,Math.round(g.length*.2))),s.length===0&&f("Test too short to classify slow words.",0)}if(o.length===0&&i.length===0&&s.length===0)return f("Could not start a new custom test",0),!1;const l=[];o.forEach(g=>{for(let m=0;m<g[1];m++)l.push(g[0])}),i.forEach(g=>{for(let m=0;m<g[2];m++)g[1]!==""?l.push(g[1]+" "+g[0]):l.push(g[0])}),s.forEach((g,m)=>{for(let h=0;h<s.length-m;h++)l.push(g[0])});const c=Se.mode===null?r.mode:Se.mode,d=Se.punctuation===null?r.punctuation:Se.punctuation,u=Se.numbers===null?r.numbers:Se.numbers;let p=null;return r.mode==="custom"&&(p=Co()),rt("custom",!0),Ui(!0),wo(l),ya("section"),ls("shuffle"),Ua((s.length+o.length+i.length)*5),oi("practise",void 0),Se.mode=c,Se.punctuation=d,Se.numbers=u,Se.customText=p,!0}function fm(){Se.mode=null,Se.punctuation=null,Se.numbers=null,Se.customText=null}ge(e=>{e==="mode"&&fm()});const hh=[["Backquote","Digit1","Digit2","Digit3","Digit4","Digit5","Digit6","Digit7","Digit8","Digit9","Digit0","Minus","Equal"],["KeyQ","KeyW","KeyE","KeyR","KeyT","KeyY","KeyU","KeyI","KeyO","KeyP","BracketLeft","BracketRight","Backslash"],["KeyA","KeyS","KeyD","KeyF","KeyG","KeyH","KeyJ","KeyK","KeyL","Semicolon","Quote"],["KeyZ","KeyX","KeyC","KeyV","KeyB","KeyN","KeyM","Comma","Period","Slash"],["Space"]],O4=new Set(["Backquote","Digit1","Digit2","Digit3","Digit4","Digit5","Digit6","KeyQ","KeyW","KeyE","KeyR","KeyT","KeyY","KeyA","KeyS","KeyD","KeyF","KeyG","ShiftLeft","IntlBackslash","KeyZ","KeyX","KeyC","KeyV","KeyB","Space"]),N4=new Set(["Digit6","Digit7","Digit8","Digit9","Digit0","Minus","Equal","Backspace","KeyY","KeyU","KeyI","KeyO","KeyP","BracketLeft","BracketRight","Backslash","KeyH","KeyJ","KeyK","KeyL","Semicolon","Quote","Enter","KeyB","KeyN","KeyM","Comma","Period","Slash","ShiftRight","ArrowUp","ArrowLeft","ArrowDown","ArrowRight","NumpadMultiply","NumpadSubtract","NumpadAdd","NumpadDecimal","NumpadEqual","NumpadDivide","Numpad0","Numpad1","Numpad2","Numpad3","Numpad4","Numpad5","Numpad6","Numpad7","Numpad8","Numpad9","NumpadEnter","Space"]);function U0(e,t){const a=Object.values(t.keys),o=a.findIndex(c=>c.find(d=>d.includes(e))),i=a[o];if(i===void 0)return;const s=i.findIndex(c=>c.includes(e));if(s===-1)return;let l=hh[o]?.[s];return t.type==="iso"&&(o===2&&s===11?l="Backslash":o===3&&s===0?l="IntlBackslash":o===3&&(l=hh[3]?.[s-1])),l}function pm(e){const t=O4.has(e),a=N4.has(e);return{leftSide:t,rightSide:a}}function mm(e){const t=[11,10,10,10,10],a={row1:[...[...e.keys.row1.slice(0,t[0])].reverse(),...e.keys.row1.slice(t[0])],row2:[...[...e.keys.row2.slice(0,t[1])].reverse(),...e.keys.row2.slice(t[1])],row3:[...[...e.keys.row3.slice(0,t[2])].reverse(),...e.keys.row3.slice(t[2])],row4:[...[...e.keys.row4.slice(0,t[3])].reverse(),...e.keys.row4.slice(t[3])],row5:[...[...e.keys.row5.slice(0,t[4])].reverse(),...e.keys.row5.slice(t[4])]};return{...e,keys:a}}let ii=!1,ni=!1;n(document).on("keydown",e=>{e.code==="ShiftLeft"?(ii=!0,ni=!1):e.code==="ShiftRight"&&(ii=!1,ni=!0)});n(document).on("keyup",e=>{(e.code==="ShiftLeft"||e.code==="ShiftRight")&&(ii=!1,ni=!1)});function U4(){ii=!1,ni=!1}function cf(e){if(!ii&&!ni||r.oppositeShiftMode==="off")return!0;const{leftSide:t,rightSide:a}=pm(e);return!!(!t&&!a||ii&&a||ni&&t)}let _d=!1,Ed=!1;n(document).on("keydown",e=>{e.code==="AltLeft"?_d=!0:e.code==="AltRight"&&(Ed=!0)});n(document).on("keyup",e=>{e.code==="AltLeft"?_d=!1:e.code==="AltRight"&&(Ed=!1)});function V4(){_d=!1,Ed=!1}function qc(...e){if(r.funbox.length!==0)for(const t of ft("toggleScript"))t.functions.toggleScript(e)}function K4(e){if(e.length===0)for(const t of ft("clearGlobal"))t.functions.clearGlobal();return b0(),zo(e,!1),!0}function V0(e){if(!zr(Jt(),e)&&!r.funbox.includes(e)){f(`${$t(e.replace(/_/g," "))} funbox is not compatible with the current funbox selection`,0);return}b0(),Wn(e,!1),Jt().includes(e)?ef(e).functions?.applyGlobalCSS?.():ef(e).functions?.clearGlobal?.()}async function qn(){return n("body").attr("class",n("body")?.attr("class")?.split(/\s+/)?.filter(e=>!e.startsWith("fb-"))?.join(" ")??""),n(".funBoxTheme").remove(),n("#wordsWrapper").removeClass("hidden"),ds(),te(),!0}async function K0(e){if(e==null?e=r.funbox:r.funbox!==e&&(r.funbox=e),!zr(Jt()))return f(ie(void 0,`Failed to activate funbox: funboxes ${r.funbox.map(i=>i.replace(/_/g," ")).join(", ")} are not compatible`),-1),zo([],!0),await qn(),!1;ds(),await G4(),await Q4(),n("#wordsWrapper").removeClass("hidden");const{data:t,error:a}=await Wt(lx(r.language));if(a)return f(ie(a,"Failed to activate funbox"),-1),zo([],!0),await qn(),!1;if(t.ligatures&&ui("noLigatures")){f("Current language does not support this funbox mode",0),zo([],!0),await qn();return}let o=!0;for(const[i,s]of Object.entries(r)){const l=Hu(i,s,Mo());if(!l.result&&!l.result)if(l.forcedConfigs&&l.forcedConfigs.length>0)i==="mode"&&rt(l.forcedConfigs[0]),i==="words"&&Oi(l.forcedConfigs[0]),i==="time"&&uo(l.forcedConfigs[0]),i==="punctuation"&&ei(l.forcedConfigs[0]),i==="numbers"&&po(l.forcedConfigs[0]),i==="highlightMode"&&Si(l.forcedConfigs[0]);else{o=!1;break}}if(!o){r.funbox.length>1?f(`Failed to activate funboxes ${r.funbox}: no intersecting forced configs. Disabling funbox`,-1):f(`Failed to activate funbox ${r.funbox}: no forced configs. Disabling funbox`,-1),zo([],!0),await qn();return}te();for(const i of ft("applyConfig"))i.functions.applyConfig();return!0}async function j4(){for(const e of ft("rememberSettings"))e.functions.rememberSettings()}async function G4(){const e=n("body"),t=Jt().map(o=>"fb-"+o.replaceAll("_","-")),a=e?.attr("class")?.split(/\s+/).filter(o=>!o.startsWith("fb-"))??[];return ui("ignoreReducedMotion")&&a.push("ignore-reduced-motion"),e.attr("class",[...new Set([...a,...t]).keys()].join(" ")),!0}async function Q4(){n(".funBoxTheme").remove();for(const e of x0("hasCssFile")){const t=document.createElement("link");t.classList.add("funBoxTheme"),t.rel="stylesheet",t.href="funbox/"+e.name+".css",document.head.appendChild(t)}return!0}const j0=document.querySelector("#capsWarning");let us=!1,Ic=!1;function Y4(){Ic||(j0?.classList.remove("hidden"),Ic=!0)}function J4(){Ic&&(j0?.classList.add("hidden"),Ic=!1)}function G0(e){const t=e?.originalEvent?.getModifierState?.("CapsLock");t!==void 0&&(us=t);try{r.capsLockWarning&&us?Y4():J4()}catch{}}n(document).on("keyup",G0);n(document).on("keydown",e=>{tk()&&G0(e)});const Q0="~~",X4={keymapShowTopRow:!0,type:"matrix",keys:{row1:[],row2:[["s","S"],["t","T"],["p","P"],["h","H"],["*","*"],["f","F"],["p","P"],["l","L"],["t","T"],["d","D"]],row3:[["s","S"],["k","K"],["w","W"],["r","R"],["*","*"],["r","R"],["b","B"],["g","G"],["s","S"],["z","Z"]],row4:[["a","A"],["o","O"],["e","E"],["u","U"]],row5:[]}};function Z4(e){if(r.mode!=="zen"){e===""&&(e=" ");try{n(".activeKey").removeClass("activeKey");let t;r.language.startsWith("korean")&&(e=Ze.disassemble(e)[0]??e),e===" "?t="#keymap .keySpace":e==='"'?t=`#keymap .keymapKey[data-key*='${e}']`:t=`#keymap .keymapKey[data-key*="${e}"]`,n(t).addClass("activeKey")}catch(t){t instanceof Error&&console.log("could not update highlighted keymap key: "+t.message)}}}async function e6(e,t){if(e===void 0)return;e===" "?e="#keymap .keySpace":e==='"'?e=`#keymap .keymapKey[data-key*='${e}']`:e=`#keymap .keymapKey[data-key*="${e}"]`;const a=await ci();try{let o={color:a.bg,backgroundColor:a.sub,borderColor:a.sub};t||r.blindMode?o={color:a.bg,backgroundColor:a.main,borderColor:a.main}:o={color:a.bg,backgroundColor:a.error,borderColor:a.error},W(e,{color:[o.color,a.sub],backgroundColor:[o.backgroundColor,a.subAlt],borderColor:[o.borderColor,a.sub],duration:250,easing:"out(5)"})}catch{}}function t6(){n("#keymap").addClass("hidden")}function a6(){n("#keymap").removeClass("hidden")}function o6(e){const{layoutData:t,rowId:a,isMatrix:o,showTopRow:i,isSteno:s,isISO:l,layoutNameDisplayString:c,isAlice:d}=e;let{rowKeys:u}=e,p=!1,g="",m="",h="";if(a==="row1"&&(o||r.keymapStyle==="staggered")&&(u=u.slice(1)),a==="row1"&&(!i||s))return"";if((a==="row2"||a==="row3"||a==="row4")&&!o&&!s&&(h+="<div></div>"),a==="row4"&&!l&&!o&&!s&&(h+="<div></div>"),o&&(a!=="row5"&&t.matrixShowRightColumn?h+='<div class="keymapKey"></div>':h+="<div></div>"),a==="row5"){if(s)return"";let y=c.replace(/_/g," "),C="";r.keymapLegendStyle==="blank"&&(C='style="display: none;"');const M=F=>ur(F??[],[" "]);u.length===1&&M(u[0])&&(u[1]=u[0]??[]),u.length===1&&!M(u[0])&&(u[1]=[" "],u.reverse()),u.length>1&&!M(u[0])&&ur(u[0],u[1])&&(u[0]=[" "]);const w=F=>F.some(I=>I!==" ");p=u.some(w),h+="<div></div>";for(let F=0;F<u.length;F++){const I=u[F];let P=I[0];r.keymapLegendStyle==="uppercase"&&(P=P.toUpperCase());const U=I.map(ne=>ne.replace('"',"&quot;"));let K=F<1?"left":"right";p&&!d&&(K=""),F===1&&(h+='<div class="keymapSplitSpacer"></div>',g+="-"),M(U)?(h+=`<div class="keymapKey keySpace layoutIndicator ${K}">
              <div class="letter" ${C}>${y}</div>
            </div>`,g+="3",y=""):(h+=`<div class="keymapKey ${K}">
              <div class="letter">${P}</div>
            </div>`,g+="1")}}else for(let y=0;y<u.length;y++){if(a==="row2"&&y===12||a==="row4"&&o&&l&&y===0)continue;let C=10;if(t.matrixShowRightColumn&&(C=11),a==="row4"&&o&&l&&(C+=1),(r.keymapStyle==="matrix"||r.keymapStyle==="split_matrix")&&y>=C)continue;const M=u[y],w=a==="row3"&&(y===3||y===6);let F=M[0],I="";r.keymapLegendStyle==="blank"?I='style="display: none;"':r.keymapLegendStyle==="uppercase"&&(F=F.toUpperCase());let P="";a==="row1"&&y===0&&!o&&r.keymapStyle!=="staggered"&&(P=" invisible");const U=`<div class="keymapKey${P}" data-key="${M.map(ne=>ne.replace('"',"&quot;")).join(Q0)}"><span class="letter" ${I}>${F}</span>${w?"<div class='bump'></div>":""}</div>`;let K="";(r.keymapStyle==="split"||r.keymapStyle==="split_matrix"||r.keymapStyle==="alice"||s)&&(a==="row4"&&s&&(y===0||y===2||y===4)?K+='<div class="keymapSplitSpacer"></div>':a==="row4"&&(r.keymapStyle==="split"||r.keymapStyle==="alice")&&l?y===6&&(K+='<div class="keymapSplitSpacer"></div>'):a==="row1"&&(r.keymapStyle==="split"||r.keymapStyle==="alice")?y===7&&(K+='<div class="keymapSplitSpacer"></div>'):a==="row4"&&o&&l?y===6&&(K+='<div class="keymapSplitSpacer"></div>'):y===5&&(K+='<div class="keymapSplitSpacer"></div>')),r.keymapStyle==="alice"&&a==="row4"&&(l&&y===6||!l&&y===5)&&(K+='<div class="extraKey"><span class="letter"></span></div>'),h+=K+U}if(a==="row5")m+=`<div
          class="row r5"
          data-row5-grid="${g}"
          data-row5-has-alpha="${p}"
        >${h}</div>`;else{const y=parseInt(a.replace("row",""));m+=`<div class="row r${y}">${h}</div>`}return m}async function Fc(){const e=r.keymapLayout==="overrideSync"?r.keymapLayout:r.layout;if(r.keymapMode!=="off"&&X()==="test"&&e)try{let t=e,a;try{r.keymapLayout==="overrideSync"?r.layout==="default"?(a=await Bi("qwerty"),t="default"):(a=await Bi(r.layout),t=r.layout):(a=await Bi(r.keymapLayout),t=r.keymapLayout)}catch(p){f(ie(p,`Failed to load keymap ${e}`),-1);return}const o=Ip&&r.keymapMode==="next"||r.keymapShowTopRow==="always"||a.keymapShowTopRow&&r.keymapShowTopRow!=="never",i=r.keymapStyle==="matrix"||r.keymapStyle==="split_matrix",s=r.keymapStyle==="steno"||r.keymapStyle==="steno_matrix",l=r.keymapStyle==="alice";s&&(a=X4),Jt().includes("layout_mirror")&&(a=mm(a));const d=a.type==="iso";let u="";for(const[p,g]of Object.entries(a.keys))u+=o6({layoutData:a,rowId:p,rowKeys:g,isMatrix:i,showTopRow:o,isSteno:s,isISO:d,layoutNameDisplayString:t,isAlice:l});n("#keymap").html(u),n("#keymap").removeClass("staggered"),n("#keymap").removeClass("matrix"),n("#keymap").removeClass("split"),n("#keymap").removeClass("split_matrix"),n("#keymap").removeClass("alice"),n("#keymap").removeClass("steno"),n("#keymap").removeClass("steno_matrix"),n("#keymap").addClass(r.keymapStyle)}catch(t){t instanceof Error&&console.log("something went wrong when changing layout, resettings: "+t.message)}}const i6=ak(),n6=/^[^\p{L}\p{N}]{1}$/u;let lu=[0,0];function s6(){const e=ii||ni,t=_d||Ed,o=((i6?e||us:e!==us)?1:0)+(t?2:0),i=(e?1:0)+(t?2:0),[s,l]=lu;if(!(s===o&&l===i))return lu=[o,i],lu}async function Y0(){const e=s6();if(e===void 0)return;const t=[...document.getElementsByClassName("keymapKey")].filter(d=>{const u=d.classList.contains("keymapKey"),p=!d.classList.contains("keySpace");return u&&p}),a=t.map(d=>d.dataset.key?.split(Q0));if(a.includes(void 0))return;const o=t.map(d=>d.childNodes[0]),[i,s]=e,l=r.keymapLayout==="overrideSync"?r.layout==="default"?"qwerty":r.layout:r.keymapLayout,c=await Bi(l).catch(()=>{});if(c===void 0){f("Failed to load keymap layout",-1);return}for(let d=0;d<a.length;d++){const u=a[d],p=o[d],g=u[0],m=u[1];if(p===void 0||u===void 0||g===void 0||m===void 0)continue;const h=[g,m].some(I=>n6.test(I??"")),y=U0(g,c);if(y===void 0)return;const w=cf(y)?h?s:i:0,F=u[w]??u[w-2];p.textContent=F??""}}let cu=!1;ge(e=>{const t=()=>{n(".activeKey").removeClass("activeKey"),n(".keymapKey").attr("style",""),r.keymapMode==="off"?t6():a6()},a=()=>{n("#keymap").css("zoom",r.keymapSize)},o=()=>{let i=r.keymapLegendStyle;["lowercase","uppercase","blank","dynamic"].forEach(l=>{n(".keymapLegendStyle").removeClass(l)}),i=i||"lowercase",n(".keymapKey > .letter").css("display",""),n(".keymapKey > .letter").css("text-transform",""),i==="uppercase"&&n(".keymapKey > .letter").css("text-transform","capitalize"),i==="blank"&&n(".keymapKey > .letter").css("display","none"),n(".keymapLegendStyle").addClass(i)};e==="fullConfigChange"&&(cu=!0),e==="fullConfigChangeFinished"&&(cu=!1,Fc(),t(),a(),o()),!cu&&((e==="layout"&&r.keymapLayout==="overrideSync"||e==="keymapLayout"||e==="keymapStyle"||e==="keymapShowTopRow"||e==="keymapMode")&&Fc(),e==="keymapMode"&&t(),e==="keymapSize"&&a(),e==="keymapLegendStyle"&&o())});Bx((e,t,a)=>{e==="highlight"&&Z4(t),e==="flash"&&e6(t,a)});n(document).on("keydown",e=>{r.keymapLegendStyle==="dynamic"&&(e.code==="ShiftLeft"||e.code==="ShiftRight"||e.code==="AltRight"||e.code==="AltLeft")&&Y0()});n(document).on("keyup",e=>{r.keymapLegendStyle==="dynamic"&&(e.code==="ShiftLeft"||e.code==="ShiftRight"||e.code==="AltRight"||e.code==="AltLeft")&&Y0()});ca.register(Yk,Jk,Xk,Zk,e2,t2,a2,o2,i2,n2,s2,r2,l2,c2);ca.defaults.animation.duration=0;ca.defaults.elements.line.tension=.5;ca.defaults.elements.line.fill="origin";class _s extends ca{constructor(t,a){super(t,a)}async updateColors(){await l6(this)}getDataset(t){return this.data.datasets?.find(a=>a.yAxisID===t)}getScaleIds(){return et(this.options?.scales??{})}getScale(t){return this.options.scales[t]}}let bh;const ue=new _s(document.querySelector("#wpmChart"),{type:"line",data:{labels:[],datasets:[{clip:!1,label:"wpm",data:[],borderColor:"rgba(125, 125, 125, 1)",borderWidth:3,yAxisID:"wpm",order:2,pointRadius:1},{clip:!1,label:"raw",data:[],borderColor:"rgba(125, 125, 125, 1)",borderWidth:2,yAxisID:"raw",borderDash:[8,8],order:3,pointRadius:0},{clip:!1,label:"errors",data:[],borderColor:"rgba(255, 125, 125, 1)",pointBackgroundColor:"rgba(255, 125, 125, 1)",borderWidth:2,order:1,yAxisID:"error",type:"scatter",pointStyle:"crossRot",pointRadius:function(e){const t=e.dataIndex;return(e.dataset.data[t]??0)<=0?0:3},pointHoverRadius:function(e){const t=e.dataIndex;return(e.dataset.data[t]??0)<=0?0:5}},{clip:!1,label:"burst",data:[],borderColor:"rgba(125, 125, 125, 1)",borderWidth:3,yAxisID:"burst",order:4,pointRadius:1}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{x:{axis:"x",ticks:{autoSkip:!0,autoSkipPadding:20},display:!0,title:{display:!1,text:"Seconds"}},wpm:{axis:"y",display:!0,title:{display:!0,text:"Words per Minute"},beginAtZero:!0,min:0,ticks:{autoSkip:!0,autoSkipPadding:20},grid:{display:!0}},raw:{axis:"y",display:!1,title:{display:!0,text:"Raw Words per Minute"},beginAtZero:!0,min:0,ticks:{autoSkip:!0,autoSkipPadding:20},grid:{display:!1}},burst:{axis:"y",display:!1,title:{display:!0,text:"Burst Words per Minute"},beginAtZero:!0,min:0,ticks:{autoSkip:!0,autoSkipPadding:20},grid:{display:!1}},error:{axis:"y",display:!0,position:"right",title:{display:!0,text:"Errors"},beginAtZero:!0,ticks:{precision:0,autoSkip:!0,autoSkipPadding:20},grid:{display:!1}}},plugins:{annotation:{annotations:[]},tooltip:{animation:{duration:250},mode:"index",intersect:!1,callbacks:{afterLabel:function(e){if(bh===e)return"";bh=e;try{const t=Math.round(parseFloat(e.label))-1,a=Gr[t]?.words,o=[...new Set(a)],i=o[0],s=Kn(o);if(i===void 0||s===void 0)return"";bx(i,s)}catch{}return""}}}}}});let J0;const z=new _s(document.querySelector(".pageAccount #accountHistoryChart"),{type:"line",data:{datasets:[{yAxisID:"wpm",data:[],fill:!1,borderWidth:0,order:3},{yAxisID:"pb",data:[],fill:!1,stepped:!0,pointRadius:0,pointHoverRadius:0,order:4},{yAxisID:"acc",fill:!1,data:[],pointStyle:"triangle",borderWidth:0,pointRadius:3.5,order:3},{yAxisID:"wpmAvgTen",data:[],fill:!1,pointRadius:0,pointHoverRadius:0,order:2},{yAxisID:"accAvgTen",data:[],fill:!1,pointRadius:0,pointHoverRadius:0,order:2},{yAxisID:"wpmAvgHundred",data:[],fill:!1,pointRadius:0,pointHoverRadius:0,order:1},{yAxisID:"accAvgHundred",label:"accAvgHundred",data:[],fill:!1,pointRadius:0,pointHoverRadius:0,order:1}]},options:{maintainAspectRatio:!1,hover:{mode:"nearest",intersect:!1},scales:{x:{axis:"x",type:"linear",reverse:!0,min:0,ticks:{stepSize:10},display:!1,grid:{display:!1}},wpm:{axis:"y",type:"linear",beginAtZero:!0,min:0,ticks:{stepSize:10},display:!0,title:{display:!0,text:"Words per Minute"},position:"right"},pb:{axis:"y",beginAtZero:!0,min:0,ticks:{stepSize:10},display:!1},acc:{axis:"y",beginAtZero:!0,min:0,max:100,reverse:!0,ticks:{stepSize:10},display:!0,title:{display:!0,text:"Accuracy"},grid:{display:!1},position:"left"},wpmAvgTen:{axis:"y",beginAtZero:!0,min:0,ticks:{stepSize:10},display:!1,grid:{display:!1}},accAvgTen:{axis:"y",beginAtZero:!0,min:0,max:100,reverse:!0,ticks:{stepSize:10},display:!1,grid:{display:!1}},wpmAvgHundred:{axis:"y",beginAtZero:!0,min:0,ticks:{stepSize:10},display:!1,grid:{display:!1}},accAvgHundred:{axis:"y",beginAtZero:!0,min:0,max:100,reverse:!0,ticks:{stepSize:10},display:!1,grid:{display:!1}}},plugins:{annotation:{annotations:[]},tooltip:{animation:{duration:250},enabled:!0,intersect:!1,external:function(e){e!==void 0&&(e.tooltip.options.displayColors=!1)},filter:function(e){return e.datasetIndex!==1&&e.datasetIndex!==3&&e.datasetIndex!==4&&e.datasetIndex!==5&&e.datasetIndex!==6},callbacks:{title:function(){return""},beforeLabel:function(e){if(e.datasetIndex!==0){const i=e.dataset.data[e.dataIndex];return`error rate: ${H(i.errorRate)}%
acc: ${H(100-i.errorRate)}%`}const t=e.dataset.data[e.dataIndex];let a=`${r.typingSpeedUnit}: ${t.wpm}
raw: ${t.raw}
acc: ${t.acc}

mode: ${t.mode} `;(t.mode==="time"||t.mode==="words")&&(a+=t.mode2);let o=t.difficulty;return o===void 0&&(o="normal"),a+=`
difficulty: ${o}`,a+=`
punctuation: ${t.punctuation}
language: ${t.language}${t.isPb?`

new personal best`:""}

date: ${J(new Date(t.timestamp),"dd MMM yyyy HH:mm")}`,a},label:function(){return""},afterLabel:function(e){return J0=e.dataIndex,""}}}}}}),Oo=new _s(document.querySelector(".pageAccount #accountActivityChart"),{type:"bar",data:{labels:[],datasets:[{yAxisID:"count",label:"Seconds",data:[],trendlineLinear:{style:"rgba(255,105,180, .8)",lineStyle:"dotted",width:2},order:3},{yAxisID:"avgWpm",label:"Average Wpm",data:[],type:"line",order:2,tension:0,fill:!1}]},options:{responsive:!0,maintainAspectRatio:!1,hover:{mode:"nearest",intersect:!1},scales:{x:{axis:"x",ticks:{autoSkip:!0,autoSkipPadding:20},type:"time",time:{unit:"day",displayFormats:{day:"d MMM"}},bounds:"ticks",display:!0,title:{display:!1,text:"Date"},offset:!0},count:{axis:"y",beginAtZero:!0,min:0,ticks:{autoSkip:!0,autoSkipPadding:20,stepSize:1},display:!0,title:{display:!0,text:"Time typing (minutes)"}},avgWpm:{axis:"y",beginAtZero:!0,min:0,ticks:{autoSkip:!0,autoSkipPadding:20,stepSize:10},display:!0,position:"right",title:{display:!0,text:"Average Wpm"},grid:{display:!1}}},plugins:{annotation:{annotations:[]},tooltip:{animation:{duration:250},intersect:!1,mode:"index",filter:e=>e.datasetIndex===0,callbacks:{title:function(e){const t=e[0],a=t.dataset.data[t.dataIndex];return J(new Date(a.x),"dd MMM yyyy")},beforeLabel:function(e){const t=e.dataset.data[e.dataIndex],a=dt(r.typingSpeedUnit);return`Time Typing: ${Ye(Math.round(t.y*60),!0,!0)}
Tests Completed: ${t.amount}
Restarts per test: ${H((t.restarts??0)/(t.amount??0))}
Highest ${r.typingSpeedUnit.toUpperCase()}: ${H(a.fromWpm(t.maxWpm??0))}
Average ${r.typingSpeedUnit.toUpperCase()}: ${H(a.fromWpm(t.avgWpm??0))}
Average Accuracy: ${H(t.avgAcc??0)}%
Average Consistency: ${H(t.avgCon??0)}%`},label:function(){return""}}}}}}),On=new _s(document.querySelector(".pageAccount #accountHistogramChart"),{type:"bar",data:{labels:[],datasets:[{yAxisID:"count",label:"Tests",data:[]}]},options:{responsive:!0,maintainAspectRatio:!1,hover:{mode:"nearest",intersect:!1},scales:{x:{axis:"x",bounds:"ticks",display:!0,title:{display:!1,text:"Bucket"},offset:!0},count:{axis:"y",beginAtZero:!0,min:0,ticks:{autoSkip:!0,autoSkipPadding:20,stepSize:10},display:!0,title:{display:!0,text:"Tests"}}},plugins:{annotation:{annotations:[]},tooltip:{animation:{duration:250},intersect:!1,mode:"index"}}}}),Nn=new _s(document.querySelector(".pageAbout #publicStatsHistogramChart"),{type:"bar",data:{labels:[],datasets:[{yAxisID:"count",label:"Users",data:[]}]},options:{responsive:!0,maintainAspectRatio:!1,hover:{mode:"nearest",intersect:!1},scales:{x:{axis:"x",bounds:"ticks",display:!0,title:{display:!1,text:"Bucket"},offset:!0},count:{axis:"y",beginAtZero:!0,min:0,ticks:{autoSkip:!0,autoSkipPadding:20,stepSize:10},display:!0,title:{display:!0,text:"Users"}}},plugins:{annotation:{annotations:[]},tooltip:{animation:{duration:250},intersect:!1,mode:"index"}}}}),Ut=new _s(document.querySelector("#miniResultChartModal canvas"),{type:"line",data:{labels:[],datasets:[{label:"wpm",data:[],borderColor:"rgba(125, 125, 125, 1)",borderWidth:3,yAxisID:"wpm",order:2,pointRadius:1},{label:"burst",data:[],borderColor:"rgba(125, 125, 125, 1)",borderWidth:3,yAxisID:"burst",order:3,pointRadius:1},{label:"errors",data:[],borderColor:"rgba(255, 125, 125, 1)",pointBackgroundColor:"rgba(255, 125, 125, 1)",borderWidth:2,order:1,yAxisID:"error",type:"scatter",pointStyle:"crossRot",pointRadius:function(e){const t=e.dataIndex;return(e.dataset.data[t]??0)<=0?0:3},pointHoverRadius:function(e){const t=e.dataIndex;return(e.dataset.data[t]??0)<=0?0:5}}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{x:{axis:"x",ticks:{autoSkip:!0,autoSkipPadding:20},display:!0,title:{display:!1,text:"Seconds"}},wpm:{axis:"y",display:!0,title:{display:!0,text:"Words per Minute"},beginAtZero:!0,min:0,ticks:{autoSkip:!0,autoSkipPadding:20},grid:{display:!0}},burst:{axis:"y",display:!1,title:{display:!0,text:"Burst Words per Minute"},beginAtZero:!0,min:0,ticks:{autoSkip:!0,autoSkipPadding:20},grid:{display:!1}},error:{display:!0,position:"right",title:{display:!0,text:"Errors"},beginAtZero:!0,ticks:{precision:0,autoSkip:!0,autoSkipPadding:20},grid:{display:!1}}},plugins:{annotation:{annotations:[]},tooltip:{animation:{duration:250},mode:"index",intersect:!1}}}});function r6(){X0(!1),Z0(!1),ev(!1),tv(!1)}function qd(e,t){e?n(`.pageAccount ${t}`).addClass("active"):n(`.pageAccount ${t}`).removeClass("active")}function X0(e=!0){const t=r.accountChart[0]==="on";qd(t,".toggleResultsOnChart"),z.getDataset("wpm").hidden=!t,z.getDataset("pb").hidden=!t,z.getDataset("wpmAvgTen").hidden=!t,z.getDataset("wpmAvgHundred").hidden=!t,z.getScale("wpm").display=t,e&&z.updateColors()}function Z0(e=!0){const t=r.accountChart[0]==="on",a=r.accountChart[1]==="on";if(qd(a,".toggleAccuracyOnChart"),z.getDataset("acc").hidden=!a,z.getDataset("accAvgTen").hidden=!a,z.getDataset("accAvgHundred").hidden=!a,z.getScale("acc").display=a,t)z.getScale("acc").min=0,z.getScale("accAvgTen").min=0,z.getScale("accAvgHundred").min=0;else{const o=Math.floor(Math.min(...z.getDataset("acc").data.map(i=>i.y))/5)*5;z.getScale("acc").min=o,z.getScale("accAvgTen").min=o,z.getScale("accAvgHundred").min=o}e&&z.updateColors()}function ev(e=!0){const t=r.accountChart[0]==="on",a=r.accountChart[1]==="on",o=r.accountChart[2]==="on";qd(o,".toggleAverage10OnChart"),a&&(z.getDataset("accAvgTen").hidden=!o),t&&(z.getDataset("wpmAvgTen").hidden=!o),e&&z.updateColors()}function tv(e=!0){const t=r.accountChart[0]==="on",a=r.accountChart[1]==="on",o=r.accountChart[3]==="on";qd(o,".toggleAverage100OnChart"),a&&(z.getDataset("accAvgHundred").hidden=!o),t&&(z.getDataset("wpmAvgHundred").hidden=!o),e&&z.updateColors()}async function l6(e){const t=await jt("bg"),a=await jt("sub"),o=await jt("subAlt"),i=await jt("main"),s=await jt("error"),l=await jt("text"),c=o;for(const m of et(e.scales)){const h=e.getScale(m);h.grid.color=c,h.grid.tickColor=c,h.grid.borderColor=c,h.ticks.color=a,h.title.color=a}if(e.id===ue.id){const m=e,h=m.getDataset("wpm");h.backgroundColor="transparent",h.borderColor=i,h.pointBackgroundColor=i,h.pointBorderColor=i;const y=m.getDataset("raw");y.backgroundColor="transparent",y.borderColor=i+"99",y.pointBackgroundColor=i+"99",y.pointBorderColor=i+"99";const C=m.getDataset("error");C.backgroundColor=s,C.borderColor=s,C.pointBackgroundColor=s,C.pointBorderColor=s;const M=m.getDataset("burst");M.backgroundColor=aa(o,o+"00",.5),M.borderColor=a,M.pointBackgroundColor=a,M.pointBorderColor=a,e.update("resize");return}if(e.id===Ut.id){const m=e,h=m.getDataset("wpm");h.backgroundColor="transparent",h.borderColor=i,h.pointBackgroundColor=i,h.pointBorderColor=i;const y=m.getDataset("error");y.backgroundColor=s,y.borderColor=s,y.pointBackgroundColor=s,y.pointBorderColor=s;const C=m.getDataset("burst");C.backgroundColor=aa(o,o+"00",.75),C.borderColor=a,C.pointBackgroundColor=a,C.pointBorderColor=a,e.update("resize");return}e.data.datasets[0].borderColor=m=>m.raw?.isPb?l:i,e.data.datasets[1]&&(e.data.datasets[1].borderColor=a),e.data.datasets[2]&&(e.data.datasets[2].borderColor=s);const d=e.data.datasets[0];e?.data?.datasets[0]?.type===void 0?e.config.type==="line"?d.pointBackgroundColor=m=>m.raw?.isPb?l:i:e.config.type==="bar"&&(d.backgroundColor=i):e.data.datasets[0].type==="bar"?e.data.datasets[0].backgroundColor=i:e.data.datasets[0].type==="line"&&(d.pointBackgroundColor=i);const u=e.data.datasets[1];u!==void 0&&(u.type===void 0?e.config.type==="line"?u.pointBackgroundColor=a:e.config.type==="bar"&&(u.backgroundColor=a):u?.type==="bar"?u.backgroundColor=a:u.type==="line"&&(u.pointBackgroundColor=a)),e.data.datasets.length===2&&(u.borderColor=()=>a);const p=e.data.datasets[2];if(e.data.datasets.length===7){p.borderColor=()=>a;const m=r.accountChart[2]==="on",h=r.accountChart[3]==="on",y=aa(t,l,.2),C=aa(t,i,.2),M=aa(t,i,.4),w=aa(t,a,.2),F=aa(t,a,.4),[I,P,U,K,ne,_e,He]=e.data.datasets;if(I===void 0||P===void 0||U===void 0||K===void 0||ne===void 0||_e===void 0||He===void 0)return;m&&h?(I.pointBackgroundColor=C,P.borderColor=y,U.pointBackgroundColor=w,K.borderColor=M,ne.borderColor=F,_e.borderColor=i,He.borderColor=a):m&&!h||!m&&h?(P.borderColor=y,I.pointBackgroundColor=M,U.pointBackgroundColor=F,K.borderColor=i,_e.borderColor=i,ne.borderColor=a,He.borderColor=a):(P.borderColor=y,I.pointBackgroundColor=i,U.pointBackgroundColor=a)}const g=e.options;Object.keys(g.scales).forEach(m=>{const h=g.scales[m];h.ticks.color=a,h.title.color=a,h.grid.color=c,h.grid.tickColor=c,h.grid.borderColor=c});try{d.trendlineLinear.style=a}catch{}e.options.plugins.annotation.annotations.forEach(m=>{m.id!=="funbox-label"&&(m.borderColor=a),m.label.backgroundColor=a,m.label.color=t}),e.update("none")}function c6(e){ca.defaults.font.family=e.replace(/_/g," ")}function av(){Vr(),ue.updateColors(),z.updateColors(),On.updateColors(),Nn.updateColors(),Oo.updateColors(),Ut.updateColors()}ge((e,t)=>{e==="accountChart"&&X()==="account"&&(X0(),Z0(),ev(),tv()),e==="fontFamily"&&c6(t)});const Te={blur:{value:0,default:0},brightness:{value:1,default:1},saturate:{value:1,default:1},opacity:{value:1,default:1}};function d6(){let e="";return Object.keys(Te).forEach(t=>{const a=t;Te[a].value!==Te[a].default&&(e+=`${t}(${Te[a].value}${t==="blur"?"rem":""}) `)}),e}function Es(){const t={filter:d6(),width:`calc(100% + ${Te.blur.value*4}rem)`,height:`calc(100% + ${Te.blur.value*4}rem)`,left:`-${Te.blur.value*2}rem`,top:`-${Te.blur.value*2}rem`,position:"absolute"};n(".customBackground img").css(t)}function u6(){n(".section[data-config-name='customBackgroundFilter'] .blur input").val(Te.blur.value),n(".section[data-config-name='customBackgroundFilter'] .brightness input").val(Te.brightness.value),n(".section[data-config-name='customBackgroundFilter'] .saturate input").val(Te.saturate.value),n(".section[data-config-name='customBackgroundFilter'] .opacity input").val(Te.opacity.value)}function al(){n(".section[data-config-name='customBackgroundFilter'] .blur .value").html(Te.blur.value.toFixed(1)),n(".section[data-config-name='customBackgroundFilter'] .brightness .value").html(Te.brightness.value.toFixed(1)),n(".section[data-config-name='customBackgroundFilter'] .saturate .value").html(Te.saturate.value.toFixed(1)),n(".section[data-config-name='customBackgroundFilter'] .opacity .value").html(Te.opacity.value.toFixed(1))}function ov(){u6(),al()}function f6(e){Te.blur.value=e[0],Te.brightness.value=e[1],Te.saturate.value=e[2],Te.opacity.value=e[3],ov()}n(".section[data-config-name='customBackgroundFilter'] .blur input").on("input",()=>{Te.blur.value=parseFloat(n(".section[data-config-name='customBackgroundFilter'] .blur input").val()),al(),Es()});n(".section[data-config-name='customBackgroundFilter'] .brightness input").on("input",()=>{Te.brightness.value=parseFloat(n(".section[data-config-name='customBackgroundFilter'] .brightness input").val()),al(),Es()});n(".section[data-config-name='customBackgroundFilter'] .saturate input").on("input",()=>{Te.saturate.value=parseFloat(n(".section[data-config-name='customBackgroundFilter'] .saturate input").val()),al(),Es()});n(".section[data-config-name='customBackgroundFilter'] .opacity input").on("input",()=>{Te.opacity.value=parseFloat(n(".section[data-config-name='customBackgroundFilter'] .opacity input").val()),al(),Es()});n(".section[data-config-name='customBackgroundFilter'] input").on("input",()=>{p6()});const p6=Mt(2e3,async()=>{const e=Object.keys(Te).map(t=>Te[t].value);_n(e,!1)});ge((e,t)=>{e==="customBackgroundFilter"&&t&&(f6(t),Es())});const df={8008:{bgColor:"#333a45",mainColor:"#f44c7f",subColor:"#939eae",textColor:"#e9ecf0"},9009:{bgColor:"#eeebe2",mainColor:"#080909",subColor:"#99947f",textColor:"#080909"},dark_note:{bgColor:"#1f1f1f",mainColor:"#f2c17b",subColor:"#768f95",textColor:"#d2dff4"},viridescent:{bgColor:"#2c3333",mainColor:"#95d5b2",subColor:"#84a98c",textColor:"#e9f5db"},dark:{bgColor:"#111",mainColor:"#eee",subColor:"#444",textColor:"#eee"},phantom:{bgColor:"#1a1b26",mainColor:"#7aa2f7",subColor:"#414868",textColor:"#c0caf5"},muted:{bgColor:"#525252",mainColor:"#c5b4e3",subColor:"#939eae",textColor:"#b1e4e3"},dark_magic_girl:{bgColor:"#091f2c",mainColor:"#f5b1cc",subColor:"#93e8d3",textColor:"#a288d9"},carbon:{bgColor:"#313131",mainColor:"#f66e0d",subColor:"#616161",textColor:"#f5e6c8"},vesper:{bgColor:"#101010",mainColor:"#ffc799",subColor:"#99ffe4",textColor:"#ffffff"},our_theme:{bgColor:"#ce1226",mainColor:"#fcd116",subColor:"#6d0f19",textColor:"#ffffff"},dots:{bgColor:"#121520",mainColor:"#fff",subColor:"#676e8a",textColor:"#fff"},nautilus:{bgColor:"#132237",mainColor:"#ebb723",subColor:"#0b4c6c",textColor:"#1cbaac"},serika:{bgColor:"#e1e1e3",mainColor:"#e2b714",subColor:"#aaaeb3",textColor:"#323437"},serika_dark:{bgColor:"#323437",mainColor:"#e2b714",subColor:"#646669",textColor:"#d1d0c5"},bushido:{bgColor:"#242933",mainColor:"#ec4c56",subColor:"#596172",textColor:"#f6f0e9"},red_samurai:{bgColor:"#84202c",mainColor:"#c79e6e",subColor:"#55131b",textColor:"#e2dad0"},rgb:{bgColor:"#111",mainColor:"#eee",subColor:"#444",textColor:"#eee"},oblivion:{bgColor:"#313231",mainColor:"#a5a096",subColor:"#5d6263",textColor:"#f7f5f1"},magic_girl:{bgColor:"#ffffff",mainColor:"#f5b1cc",subColor:"#93e8d3",textColor:"#00ac8c"},metropolis:{bgColor:"#0f1f2c",mainColor:"#56c3b7",subColor:"#326984",textColor:"#e4edf1"},mountain:{bgColor:"#0f0f0f",mainColor:"#e7e7e7",subColor:"#4c4c4c",textColor:"#e7e7e7"},laser:{bgColor:"#221b44",mainColor:"#009eaf",subColor:"#b82356",textColor:"#dbe7e8"},retro:{bgColor:"#dad3c1",mainColor:"#1d1b17",subColor:"#918b7d",textColor:"#1d1b17"},dracula:{bgColor:"#282a36",mainColor:"#bd93f9",subColor:"#6272a4",textColor:"#f8f8f2"},nord:{bgColor:"#242933",mainColor:"#88C0D0",subColor:"#2E3440",textColor:"#88C0D0"},mr_sleeves:{bgColor:"#d1d7da",mainColor:"#daa99b",subColor:"#9a9fa1",textColor:"#1d1d1d"},olivia:{bgColor:"#1c1b1d",mainColor:"#deaf9d",subColor:"#4e3e3e",textColor:"#f2efed"},bliss:{bgColor:"#262727",mainColor:"#f0d3c9",subColor:"#665957",textColor:"#fff"},mizu:{bgColor:"#afcbdd",mainColor:"#fcfbf6",subColor:"#85a5bb",textColor:"#1a2633"},metaverse:{bgColor:"#232323",mainColor:"#d82934",subColor:"#5e5e5e",textColor:"#e8e8e8"},shadow:{bgColor:"#000",mainColor:"#eee",subColor:"#444",textColor:"#eee"},mint:{bgColor:"#05385b",mainColor:"#5cdb95",subColor:"#20688a",textColor:"#edf5e1"},miami:{bgColor:"#f35588",mainColor:"#05dfd7",subColor:"#94294c",textColor:"#f0e9ec"},miami_nights:{bgColor:"#18181a",mainColor:"#e4609b",subColor:"#47bac0",textColor:"#fff"},modern_dolch:{bgColor:"#2d2e30",mainColor:"#7eddd3",subColor:"#54585c",textColor:"#e3e6eb"},botanical:{bgColor:"#7b9c98",mainColor:"#eaf1f3",subColor:"#495755",textColor:"#eaf1f3"},bingsu:{bgColor:"#b8a7aa",mainColor:"#83616e",subColor:"#48373d",textColor:"#ebe6ea"},terminal:{bgColor:"#191a1b",mainColor:"#79a617",subColor:"#48494b",textColor:"#e7eae0"},lavender:{bgColor:"#ada6c2",mainColor:"#e4e3e9",subColor:"#e4e3e9",textColor:"#2f2a41"},taro:{bgColor:"#b3baff",mainColor:"#130f1a",subColor:"#6f6c91",textColor:"#130f1a"},striker:{bgColor:"#124883",mainColor:"#d7dcda",subColor:"#0f2d4e",textColor:"#d6dbd9"},gruvbox_dark:{bgColor:"#282828",mainColor:"#d79921",subColor:"#665c54",textColor:"#ebdbb2"},gruvbox_light:{bgColor:"#fbf1c7",mainColor:"#689d6a",subColor:"#a89984",textColor:"#3c3836"},monokai:{bgColor:"#272822",mainColor:"#a6e22e",subColor:"#e6db74",textColor:"#e2e2dc"},sonokai:{bgColor:"#2c2e34",mainColor:"#9ed072",subColor:"#e7c664",textColor:"#e2e2e3"},camping:{bgColor:"#faf1e4",mainColor:"#618c56",subColor:"#c2b8aa",textColor:"#3c403b"},voc:{bgColor:"#190618",mainColor:"#e0caac",subColor:"#4c1e48",textColor:"#eeeae4"},vaporwave:{bgColor:"#a4a7ea",mainColor:"#e368da",subColor:"#7c7faf",textColor:"#f1ebf1"},pulse:{bgColor:"#181818",mainColor:"#17b8bd",subColor:"#53565a",textColor:"#e5f4f4"},matrix:{bgColor:"#000000",mainColor:"#15ff00",subColor:"#006500",textColor:"#d1ffcd"},olive:{bgColor:"#e9e5cc",mainColor:"#92946f",subColor:"#b7b39e",textColor:"#373731"},strawberry:{bgColor:"#f37f83",mainColor:"#fcfcf8",subColor:"#e53c58",textColor:"#fcfcf8"},night_runner:{bgColor:"#212121",mainColor:"#feff04",subColor:"#5c4a9c",textColor:"#e8e8e8"},cyberspace:{bgColor:"#181c18",mainColor:"#00ce7c",subColor:"#9578d3",textColor:"#c2fbe1"},joker:{bgColor:"#1a0e25",mainColor:"#99de1e",subColor:"#7554a3",textColor:"#e9e2f5"},dualshot:{bgColor:"#737373",mainColor:"#212222",subColor:"#aaaaaa",textColor:"#212222"},solarized_dark:{bgColor:"#002b36",mainColor:"#859900",subColor:"#2aa198",textColor:"#268bd2"},solarized_light:{bgColor:"#fdf6e3",mainColor:"#859900",subColor:"#2aa198",textColor:"#181819"},solarized_osaka:{bgColor:"#00141a",mainColor:"#859900",subColor:"#2aa198",textColor:"#b58900"},terra:{bgColor:"#0c100e",mainColor:"#89c559",subColor:"#436029",textColor:"#f0edd1"},red_dragon:{bgColor:"#1a0b0c",mainColor:"#ff3a32",subColor:"#e2a528",textColor:"#4a4d4e"},hammerhead:{bgColor:"#030613",mainColor:"#4fcdb9",subColor:"#213c53",textColor:"#e2f1f5"},future_funk:{bgColor:"#2e1a47",mainColor:"#f7f2ea",subColor:"#c18fff",textColor:"#f7f2ea"},milkshake:{bgColor:"#ffffff",mainColor:"#212b43",subColor:"#62cfe6",textColor:"#212b43"},aether:{bgColor:"#101820",mainColor:"#eedaea",subColor:"#cf6bdd",textColor:"#eedaea"},froyo:{bgColor:"#e1dacb",mainColor:"#7b7d7d",subColor:"#b29c5e",textColor:"#7b7d7d"},retrocast:{bgColor:"#07737a",mainColor:"#88dbdf",subColor:"#f3e03b",textColor:"#ffffff"},luna:{bgColor:"#221c35",mainColor:"#f67599",subColor:"#5a3a7e",textColor:"#ffe3eb"},graen:{bgColor:"#303c36",mainColor:"#a59682",subColor:"#181d1a",textColor:"#a59682"},bento:{bgColor:"#2d394d",mainColor:"#ff7a90",subColor:"#4a768d",textColor:"#fffaf8"},watermelon:{bgColor:"#1f4437",mainColor:"#d6686f",subColor:"#3e7a65",textColor:"#cdc6bc"},menthol:{bgColor:"#00c18c",mainColor:"#ffffff",subColor:"#186544",textColor:"#ffffff"},ishtar:{bgColor:"#202020",mainColor:"#91170c",subColor:"#847869",textColor:"#fae1c3"},mashu:{bgColor:"#2b2b2c",mainColor:"#76689a",subColor:"#d8a0a6",textColor:"#f1e2e4"},deku:{bgColor:"#058b8c",mainColor:"#b63530",subColor:"#255458",textColor:"#f7f2ea"},honey:{bgColor:"#f2aa00",mainColor:"#fff546",subColor:"#a66b00",textColor:"#f3eecb"},shoko:{bgColor:"#ced7e0",mainColor:"#81c4dd",subColor:"#7599b1",textColor:"#3b4c58"},norse:{bgColor:"#242425",mainColor:"#2b5f6d",subColor:"#505b5e",textColor:"#ccc2b1"},matcha_moccha:{bgColor:"#523525",mainColor:"#7ec160",subColor:"#9e6749",textColor:"#ecddcc"},cafe:{bgColor:"#ceb18d",mainColor:"#14120f",subColor:"#d4d2d1",textColor:"#14120f"},alpine:{bgColor:"#6c687f",mainColor:"#ffffff",subColor:"#9994b8",textColor:"#ffffff"},superuser:{bgColor:"#262a33",mainColor:"#43ffaf",subColor:"#526777",textColor:"#e5f7ef"},ms_cupcakes:{bgColor:"#ffffff",mainColor:"#5ed5f3",subColor:"#d64090",textColor:"#0a282f"},dollar:{bgColor:"#e4e4d4",mainColor:"#6b886b",subColor:"#8a9b69",textColor:"#555a56"},lime:{bgColor:"#7c878e",mainColor:"#93c247",subColor:"#4b5257",textColor:"#bfcfdc"},sweden:{bgColor:"#0058a3",mainColor:"#ffcc02",subColor:"#57abdb",textColor:"#ffffff"},wavez:{bgColor:"#1c292f",mainColor:"#6bde3b",subColor:"#1f5e6b",textColor:"#e9efe6"},nebula:{bgColor:"#212135",mainColor:"#be3c88",subColor:"#19b3b8",textColor:"#838686"},lil_dragon:{bgColor:"#ebe1ef",mainColor:"#8a5bd6",subColor:"#a28db8",textColor:"#212b43"},pastel:{bgColor:"#e0b2bd",mainColor:"#fbf4b6",subColor:"#b4e9ff",textColor:"#6d5c6f"},alduin:{bgColor:"#1c1c1c",mainColor:"#dfd7af",subColor:"#444444",textColor:"#f5f3ed"},paper:{bgColor:"#eeeeee",mainColor:"#444444",subColor:"#b2b2b2",textColor:"#444444"},fundamentals:{bgColor:"#727474",mainColor:"#7fa482",subColor:"#cac4be",textColor:"#131313"},drowning:{bgColor:"#191826",mainColor:"#4a6fb5",subColor:"#50688c",textColor:"#9393a7"},iceberg_dark:{bgColor:"#161821",mainColor:"#84a0c6",subColor:"#595e76",textColor:"#c6c8d1"},iceberg_light:{bgColor:"#e8e9ec",mainColor:"#2d539e",subColor:"#adb1c4",textColor:"#33374c"},onedark:{bgColor:"#2f343f",mainColor:"#61afef",subColor:"#eceff4",textColor:"#98c379"},darling:{bgColor:"#fec8cd",mainColor:"#ffffff",subColor:"#a30000",textColor:"#ffffff"},repose_dark:{bgColor:"#2f3338",mainColor:"#d6d2bc",subColor:"#8f8e84",textColor:"#d6d2bc"},repose_light:{bgColor:"#efead0",mainColor:"#5f605e",subColor:"#8f8e84",textColor:"#333538"},horizon:{bgColor:"#1c1e26",mainColor:"#c4a88a",subColor:"#db886f",textColor:"#bbbbbb"},rudy:{bgColor:"#1a2b3e",mainColor:"#af8f5c",subColor:"#3a506c",textColor:"#c9c8bf"},stealth:{bgColor:"#010203",mainColor:"#383e42",subColor:"#5e676e",textColor:"#383e42"},"80s_after_dark":{bgColor:"#1b1d36",mainColor:"#fca6d1",subColor:"#99d6ea",textColor:"#e1e7ec"},arch:{bgColor:"#0c0d11",mainColor:"#7ebab5",subColor:"#454864",textColor:"#f6f5f5"},rose_pine:{bgColor:"#1f1d27",mainColor:"#9ccfd8",subColor:"#c4a7e7",textColor:"#e0def4"},rose_pine_moon:{bgColor:"#2a273f",mainColor:"#9ccfd8",subColor:"#c4a7e7",textColor:"#e0def4"},rose_pine_dawn:{bgColor:"#fffaf3",mainColor:"#56949f",subColor:"#c4a7e7",textColor:"#286983"},copper:{bgColor:"#442f29",mainColor:"#b46a55",subColor:"#7ebab5",textColor:"#e7e0de"},grand_prix:{bgColor:"#36475c",mainColor:"#c0d036",subColor:"#5c6c80",textColor:"#c1c7d7"},peaches:{bgColor:"#e0d7c1",mainColor:"#dd7a5f",subColor:"#e7b28e",textColor:"#5f4c41"},bouquet:{bgColor:"#173f35",mainColor:"#eaa09c",subColor:"#408e7b",textColor:"#e9e0d2"},midnight:{bgColor:"#0b0e13",mainColor:"#60759f",subColor:"#394760",textColor:"#9fadc6"},blueberry_light:{bgColor:"#dae0f5",mainColor:"#506477",subColor:"#92a4be",textColor:"#678198"},blueberry_dark:{bgColor:"#212b42",mainColor:"#add7ff",subColor:"#5c7da5",textColor:"#91b4d5"},fledgling:{bgColor:"#3b363f",mainColor:"#fc6e83",subColor:"#8e5568",textColor:"#e6d5d3"},ez_mode:{bgColor:"#0068c6",mainColor:"#fa62d5",subColor:"#138bf7",textColor:"#ffffff"},vscode:{bgColor:"#1e1e1e",mainColor:"#007acc",subColor:"#4d4d4d",textColor:"#d4d4d4"},material:{bgColor:"#263238",mainColor:"#80cbc4",subColor:"#4c6772",textColor:"#e6edf3"},godspeed:{bgColor:"#eae4cf",mainColor:"#9abbcd",subColor:"#ada998",textColor:"#646669"},witch_girl:{bgColor:"#f3dbda",mainColor:"#56786a",subColor:"#ddb4a7",textColor:"#56786a"},terror_below:{bgColor:"#0b1e1a",mainColor:"#66ac92",subColor:"#015c53",textColor:"#dceae5"},sewing_tin:{bgColor:"#241963",mainColor:"#f2ce83",subColor:"#446ad5",textColor:"#ffffff"},soaring_skies:{bgColor:"#fff9f2",mainColor:"#55c6f0",subColor:"#1e107a",textColor:"#1d1e1e"},sewing_tin_light:{bgColor:"#ffffff",mainColor:"#2d2076",subColor:"#385eca",textColor:"#2d2076"},chaos_theory:{bgColor:"#141221",mainColor:"#fd77d7",subColor:"#676e8a",textColor:"#dde5ed"},hanok:{bgColor:"#d8d2c3",mainColor:"#513a2a",subColor:"#8b6f5c",textColor:"#393b3b"},comfy:{bgColor:"#4a5b6e",mainColor:"#f8cdc6",subColor:"#9ec1cc",textColor:"#f5efee"},tiramisu:{bgColor:"#cfc6b9",mainColor:"#c0976f",subColor:"#c0976f",textColor:"#7d5448"},diner:{bgColor:"#537997",mainColor:"#c3af5b",subColor:"#445c7f",textColor:"#dfdbc8"},modern_ink:{bgColor:"#ffffff",mainColor:"#ff360d",subColor:"#b7b7b7",textColor:"#000000"},dev:{bgColor:"#1b2028",mainColor:"#23a9d5",subColor:"#4b5975",textColor:"#ccccb5"},moonlight:{bgColor:"#191f28",mainColor:"#c69f68",subColor:"#4b5975",textColor:"#ccccb5"},pink_lemonade:{bgColor:"#f6d992",mainColor:"#f6a192",subColor:"#f6b092",textColor:"#fcfcf8"},creamsicle:{bgColor:"#ff9869",mainColor:"#fcfcf8",subColor:"#ff661f",textColor:"#fcfcf8"},beach:{bgColor:"#ffeead",mainColor:"#96ceb4",subColor:"#ffcc5c",textColor:"#5b7869"},desert_oasis:{bgColor:"#fff2d5",mainColor:"#d19d01",subColor:"#0061fe",textColor:"#332800"},frozen_llama:{bgColor:"#9bf2ea",mainColor:"#6d44a6",subColor:"#b690fd",textColor:"#ffffff"},ryujinscales:{bgColor:"#081426",mainColor:"#f17754",subColor:"#ffbc90",textColor:"#ffe4bc"},trackday:{bgColor:"#464d66",mainColor:"#e0513e",subColor:"#5c7eb9",textColor:"#cfcfcf"},fruit_chew:{bgColor:"#d6d3d6",mainColor:"#5c1e5f",subColor:"#b49cb5",textColor:"#282528"},evil_eye:{bgColor:"#0084c2",mainColor:"#f7f2ea",subColor:"#01589f",textColor:"#171718"},trance:{bgColor:"#00021b",mainColor:"#e51376",subColor:"#3c4c79",textColor:"#fff"},fire:{bgColor:"#0f0000",mainColor:"#b31313",subColor:"#683434",textColor:"#ffffff"},aurora:{bgColor:"#011926",mainColor:"#00e980",subColor:"#245c69",textColor:"#fff"},leather:{bgColor:"#a86948",mainColor:"#ffe4bc",subColor:"#81482b",textColor:"#ffe4bc"},fleuriste:{bgColor:"#c6b294",mainColor:"#405a52",subColor:"#64374d",textColor:"#091914"},dmg:{bgColor:"#dadbdc",mainColor:"#ae185e",subColor:"#3846b1",textColor:"#414141"},catppuccin:{bgColor:"#1e1e2e",mainColor:"#cba6f7",subColor:"#7f849c",textColor:"#cdd6f4"},snes:{bgColor:"#bfbec2",mainColor:"#553d94",subColor:"#9f8ad4",textColor:"#2e2e2e"},passion_fruit:{bgColor:"#7c2142",mainColor:"#f4a3b4",subColor:"#9994b8",textColor:"#ffffff"},blue_dolphin:{bgColor:"#003950",mainColor:"#ffcefb",subColor:"#00e4ff",textColor:"#82eaff"},mexican:{bgColor:"#f8ad34",mainColor:"#b12189",subColor:"#333",textColor:"#eee"},husqy:{bgColor:"#000000",mainColor:"#c58aff",subColor:"#972fff",textColor:"#ebd7ff"},peach_blossom:{bgColor:"#292929",mainColor:"#99b898",subColor:"#616161",textColor:"#fecea8"},dino:{bgColor:"#ffffff",mainColor:"#40d672",subColor:"#d5d5d5",textColor:"#1d221f"},tron_orange:{bgColor:"#0d1c1c",mainColor:"#f0e800",subColor:"#ff6600",textColor:"#ffffff"},hedge:{bgColor:"#415e31",mainColor:"#6a994e",subColor:"#ede5b4",textColor:"#f7f1d6"},modern_dolch_light:{bgColor:"#dbdbdb",mainColor:"#8fd1c3",subColor:"#acacac",textColor:"#454545"},iv_spade:{bgColor:"#0c0c0c",mainColor:"#b7976a",subColor:"#404040",textColor:"#d3c2c3"},iv_clover:{bgColor:"#a0a0a0",mainColor:"#573e40",subColor:"#353535",textColor:"#3b2d3b"},cheesecake:{bgColor:"#fdf0d5",mainColor:"#8e2949",subColor:"#d91c81",textColor:"#3a3335"},earthsong:{bgColor:"#292521",mainColor:"#509452",subColor:"#f5ae2d",textColor:"#e6c7a8"},purpleish:{bgColor:"#1e1e32",mainColor:"#7a52cc",subColor:"#3d3d66",textColor:"#7a52cc"},nord_light:{bgColor:"#eceff4",mainColor:"#8fbcbb",subColor:"#6a7791",textColor:"#8fbcbb"},slambook:{bgColor:"#FFFDDE",mainColor:"#13005A",subColor:"#1c82adc4",textColor:"#125d98"},breeze:{bgColor:"#e8d5c4",mainColor:"#7d67a9",subColor:"#3a98b9",textColor:"#1b4c5e"},cherry_blossom:{bgColor:"#323437",mainColor:"#d65ccc",subColor:"#787d82",textColor:"#d1d0c5"},everblush:{bgColor:"#141b1e",mainColor:"#8ccf7e",subColor:"#838887",textColor:"#dadada"},grape:{bgColor:"#2c003e",mainColor:"#ff8f00",subColor:"#651e56",textColor:"#fff"},rainbow_trail:{bgColor:"#f5f5f5",mainColor:"#363636",subColor:"#4f4f4f",textColor:"#1f1f1f"},tangerine:{bgColor:"#ffede0",mainColor:"#fe5503",subColor:"#ff9562",textColor:"#3d1705"},macroblank:{bgColor:"#b2d2c8",mainColor:"#c13117",subColor:"#717977",textColor:"#490909"},anti_hero:{bgColor:"#00002e",mainColor:"#ffadad",subColor:"#ff3d8b",textColor:"#f1deef"},incognito:{bgColor:"#0e0e0e",mainColor:"#ff9900",subColor:"#2f2f2f",textColor:"#c6c6c6"},discord:{bgColor:"#313338",mainColor:"#5a65ea",subColor:"#565861",textColor:"#dcdee3"},cy_red:{bgColor:"#6e2626",mainColor:"#e55050",subColor:"#ff6060",textColor:"#ffaaaa"},floret:{bgColor:"#00272c",mainColor:" #ffdd6d",subColor:"#779097",textColor:"#E5E5E5"},lilac_mist:{bgColor:"#fffbfe",mainColor:"#b94189",subColor:"#e094c2",textColor:"#5c2954"},terrazzo:{bgColor:"#f1e5da",mainColor:"#e0794e",subColor:"#688e8f",textColor:"#023e3b"},suisei:{bgColor:"#3b4a62",mainColor:"#bef0ff",subColor:"#fe9841",textColor:"#dbdeeb"},github:{bgColor:"#212830",mainColor:"#41ce5c",subColor:"#788386",textColor:"#ccdae6"},sunset:{bgColor:"#211e24",mainColor:"#f79777",subColor:"#5b578e",textColor:"#f4e0c9"},vesper_light:{bgColor:"#ffffff",mainColor:"#fb7100",subColor:"#067a6e",textColor:"#000000"},pale_nimbus:{bgColor:"#433e4c",mainColor:"#94ffc2",subColor:"#ffaca3",textColor:"#feffdb"}},ol=Object.keys(df).sort().map(e=>({...df[e],name:e})),m6=[...ol.sort((e,t)=>{const a=Lc(e.bgColor);return Lc(t.bgColor).lgt-a.lgt})];class g6{constructor(t="file-storage-db"){this.dbPromise=d2(t,1,{upgrade(a){a.objectStoreNames.contains("files")||a.createObjectStore("files")}})}async storeFile(t,a){await(await this.dbPromise).put("files",a,t)}async getFile(t){return(await this.dbPromise).get("files",t)}async deleteFile(t){await(await this.dbPromise).delete("files",t)}async listFilenames(){return(await this.dbPromise).getAllKeys("files")}async hasFile(t){return await this.getFile(t)!==void 0}}const Je=new g6;let ze=null,uf=!1,vi=0;const ko=["--bg-color","--main-color","--caret-color","--sub-color","--sub-alt-color","--text-color","--error-color","--error-extra-color","--colorful-error-color","--colorful-error-extra-color"];async function h6(){setTimeout(async()=>{let e,t;t=await jt("bg"),e=await jt("main"),t===e&&(t="#111",e="#eee");const a=`
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64">
  <style>
    #bg{fill:${t};}
    path{fill:${e};}
  </style>
  <g>
    <path id="bg" d="M0 16Q0 0 16 0h32q16 0 16 16v32q0 16-16 16H16Q0 64 0 48"/>
    <path d="M9.09 24.1v21.2h5.12V33.1q.256-4.61 4.48-4.61 3.46.384 3.46 3.84v12.9h5.12v-11.5q-.128-5.25 4.48-5.25 3.46.384 3.46 3.84v12.9h5.12v-12.2q0-9.47-7.04-9.47-4.22 0-7.04 3.46-2.18-3.46-6.02-3.46-3.46 0-6.02 2.43v-2.05M47 18.9v5.12h-4.61v5.12H47v16.1h5.12v-16.1h4.61v-5.12h-4.61V18.9"/>
  </g>
</svg>`;n("#favicon").attr("href","data:image/svg+xml;base64,"+btoa(a))},125)}function b6(){console.debug("Theme controller clearing custom theme");for(const e of ko)document.documentElement.style.setProperty(e,"")}let Ws=[];async function iv(e){return new Promise(t=>{function a(){console.debug("Theme controller swapping elements");const s=n("#currentTheme"),l=n("#nextTheme");if(l.length===0){console.debug("Theme controller failed to swap elements, next is missing");return}s.remove(),l.attr("id","currentTheme")}console.debug("Theme controller loading style",e),Ws.push(setTimeout(()=>{Z()},100)),n("#nextTheme").remove();const o=document.querySelector("#currentTheme"),i=document.createElement("link");i.type="text/css",i.rel="stylesheet",i.id="nextTheme",i.onload=()=>{console.debug("Theme controller loaded style",e),N(),a(),Ws.map(s=>clearTimeout(s)),Ws=[],n("#keymap .keymapKey").stop(!0,!0).removeAttr("style"),t()},i.onerror=s=>{console.debug("Theme controller failed to load style",e,s),console.error(`Failed to load theme ${e}`,s),N(),f("Failed to load theme",0),a(),Ws.map(l=>clearTimeout(l)),Ws=[],n("#keymap .keymapKey").stop(!0,!0).removeAttr("style"),t()},e==="custom"?i.href="/themes/serika_dark.css":i.href=`/themes/${e}.css`,o===null?(console.debug("Theme controller appending link to the head",i),document.head.appendChild(i)):(console.debug("Theme controller inserting link after current theme",i),o.after(i))})}async function Qo(e,t,a=!1){console.debug("Theme controller applying theme",e,t,a);const o=t?"custom":e;if(r.customTheme&&!a||t){const s=t??r.customThemeColors;for(let l=0;l<ko.length;l++){const c=ko[l];document.documentElement.style.setProperty(c,s[l])}}i5(),n(".keymapKey").attr("style",""),await iv(o),o!=="custom"&&b6(),Vr();const i=await ci();n(".keymapKey").attr("style",""),av(),h6(),n("#metaThemeColor").attr("content",i.bg),nv(a?e:void 0),Np(await jt("bg"))?n("body").addClass("darkMode"):n("body").removeClass("darkMode")}function nv(e){const t=document.querySelector("footer .right .current-theme"),a=t?.querySelector(".text"),o=t?.querySelector(".favIndicator");if(!(t instanceof HTMLElement)||!(a instanceof HTMLElement)||!(o instanceof HTMLElement))return;let i=r.theme;if(ze!==null&&(i=ze),r.customTheme&&(i="custom"),e!==void 0&&e!==""&&(i=e),i=i.replace(/_/g," "),a.innerText=i,r.customTheme){o.style.display="none";return}o.style.display="";const l=e??ze??r.theme;l!==null&&r.favThemes.includes(l)?o.style.display="block":o.style.display="none"}let nr=null;function gm(e,t){nr={theme:e,colors:t},y6()}const y6=Mt(250,()=>{nr&&(uf=!0,Qo(nr.theme,nr.colors,!0))});async function wt(e,t=!1){console.debug("Theme controller setting theme",e,t),await Qo(e,void 0,t),!t&&r.autoSwitchTheme&&(Dy(!1),f("Auto switch theme disabled",0))}async function xr(e=!0){nr=null,uf&&(uf=!1,e&&(ze!==null?await Qo(ze):r.customTheme?await Qo("custom"):await Qo(r.theme)))}let Kt=[];async function sv(){const e=ol;r.randomTheme==="fav"&&r.favThemes.length>0?Kt=r.favThemes:r.randomTheme==="light"?Kt=e.filter(t=>d0(t.bgColor)).map(t=>t.name):r.randomTheme==="dark"?Kt=e.filter(t=>Np(t.bgColor)).map(t=>t.name):r.randomTheme==="on"||r.randomTheme==="auto"?Kt=e.map(t=>t.name):r.randomTheme==="custom"&&S()&&(Kt=S()?.customThemes?.map(t=>t._id)??[]),Gn(Kt),vi=0}async function rv(){if(Kt.length===0&&(await sv(),Kt.length===0))return;let e=o=>!0;r.randomTheme==="auto"&&(e=Yl()?Np:d0);let t=null;do ze=Kt[vi],t=df[Kt[vi]],vi++,vi>=Kt.length&&(Gn(Kt),vi=0);while(!e(t.bgColor));let a;if(r.randomTheme==="custom"&&(a=S()?.customThemes?.find(i=>i._id===ze)?.colors,ze="custom"),mo(!1,!0),await Qo(ze,a),vi>=Kt.length){let o=ze.replace(/_/g," ");r.randomTheme==="custom"&&(o=(S()?.customThemes?.find(i=>i._id===ze)?.name??"custom").replace(/_/g," ")),f(o,0)}}async function du(){ze!==null&&(ze=null,r.customTheme?await Qo("custom"):await Qo(r.theme))}function lv(){r.customBackgroundSize==="max"?n(".customBackground img").css({objectFit:""}):n(".customBackground img").css({objectFit:r.customBackgroundSize})}async function fs(){let e=r.customBackground;n(".pageSettings .section[data-config-name='customBackgroundSize'] input[type='text']").val(e);const t=await Je.getFile("LocalBackgroundFile");if(t!==void 0&&(e=t),n(".pageSettings .section[data-config-name='customBackgroundFilter']").addClass("hidden"),e==="")n("#words").removeClass("noErrorBorder"),n("#resultWordsHistory").removeClass("noErrorBorder"),n(".customBackground img").remove();else{n("#words").addClass("noErrorBorder"),n("#resultWordsHistory").addClass("noErrorBorder");const a=document.querySelector(".customBackground"),o=document.createElement("img");o.setAttribute("src",e),o.setAttribute("onError","javascript:this.style.display='none'; window.dispatchEvent(new Event('customBackgroundFailed'))"),o.onload=()=>{n(".pageSettings .section[data-config-name='customBackgroundFilter']").removeClass("hidden")},a?.replaceChildren(o),Es(),lv()}}async function Tr(){let e=r.fontFamily.replace(/_/g," ");const t=await Je.getFile("LocalFontFamilyFile");t===void 0?n(".customFont").empty():(e="LOCALCUSTOM",n(".customFont").html(`
      @font-face{ 
        font-family: LOCALCUSTOM;
        src: url(${t});
        font-weight: 400;
        font-style: normal;
        font-display: block;
      }`)),document.documentElement.style.setProperty("--font",`"${e}", "Roboto Mono", "Vazirmatn", monospace`)}window.matchMedia?.("(prefers-color-scheme: dark)")?.addEventListener?.("change",e=>{!r.autoSwitchTheme||r.customTheme||(e.matches?wt(r.themeDark,!0):wt(r.themeLight,!0))});let uu=!1;ge(async(e,t,a)=>{e==="fullConfigChange"&&(uu=!0),e==="fullConfigChangeFinished"&&(uu=!1,await du(),await xr(!1),r.autoSwitchTheme?Yl()?await wt(r.themeDark,!0):await wt(r.themeLight,!0):r.customTheme?await wt("custom"):await wt(r.theme),await fs()),!uu&&(e==="randomTheme"&&sv(),e==="customTheme"&&(t?await wt("custom"):await wt(r.theme)),e==="customThemeColors"&&(a?gm("custom"):await wt("custom")),e==="theme"&&(await du(),await xr(!1),await wt(t)),e==="randomTheme"&&t==="off"&&await du(),e==="customBackground"&&await fs(),e==="customBackgroundSize"&&lv(),e==="autoSwitchTheme"&&(t?Yl()?await wt(r.themeDark,!0):await wt(r.themeLight,!0):await wt(r.theme)),e==="themeLight"&&r.autoSwitchTheme&&!Yl()&&!a&&await wt(r.themeLight,!0),e==="themeDark"&&r.autoSwitchTheme&&window.matchMedia!==void 0&&window.matchMedia("(prefers-color-scheme: dark)").matches&&!a&&await wt(r.themeDark,!0),["theme","customTheme","customThemeColors","randomTheme","favThemes"].includes(e)&&nv())});window.addEventListener("customBackgroundFailed",()=>{f("Custom background link is either temporarily unavailable or expired. Please make sure the URL is correct or change it",0,{duration:5})});function Yl(){return window.matchMedia?.("(prefers-color-scheme: dark)").matches}ge(e=>{e==="monkey"&&we&&(r.monkey?n("#monkey").removeClass("hidden"):n("#monkey").addClass("hidden"))});let oa=!1,ia=!1;const st={left:!1,right:!1,last:"right"},fu={"00":document.querySelector("#monkey .up"),"01":document.querySelector("#monkey .right"),10:document.querySelector("#monkey .left"),11:document.querySelector("#monkey .both")},pu={"00":document.querySelector("#monkey .fast .up"),"01":document.querySelector("#monkey .fast .right"),10:document.querySelector("#monkey .fast .left"),11:document.querySelector("#monkey .fast .both")};function yh(e){return e?"1":"0"}function cv(){if(r.monkey&&!document.querySelector("#monkey")?.classList.contains("hidden")){Object.keys(fu).forEach(t=>{fu[t]?.classList.add("hidden")}),Object.keys(pu).forEach(t=>{pu[t]?.classList.add("hidden")});const e=`${yh(oa)}${yh(ia)}`;fu[e]?.classList.remove("hidden"),pu[e]?.classList.remove("hidden")}}function v6(e){if(!r.monkey)return;const t=Iu(e,130,180,0,1);W("#monkey .fast",{opacity:t,duration:1e3});let a=Iu(e,130,180,.25,.01);a===.25&&(a=0),n("#monkey").css({animationDuration:a+"s"})}function w6(e){if(!r.monkey)return;const{leftSide:t,rightSide:a}=pm(e.code);t&&a?st.last==="left"?ia?oa||(oa=!0,st.last="left",st.left=!0):(ia=!0,st.last="right",st.right=!0):oa?ia||(ia=!0,st.last="right",st.right=!0):(oa=!0,st.last="left",st.left=!0):(oa=oa||t,ia=ia||a),cv()}function C6(e){if(!r.monkey)return;const{leftSide:t,rightSide:a}=pm(e.code);t&&a?st.left&&st.last==="left"?(oa=!1,st.left=!1):st.right&&st.last==="right"?(ia=!1,st.right=!1):(oa=oa&&!st.left,ia=ia&&!st.right):(oa=oa&&!t,ia=ia&&!a),cv()}function k6(){r.monkey&&(n("#monkey").removeClass("hidden"),W("#monkey",{opacity:[0,1],duration:125}))}function dv(){W("#monkey",{opacity:[1,0],duration:125,onComplete:()=>{n("#monkey").addClass("hidden").css({animationDuration:"0s"}),n("#monkey .fast").css("opacity",0)}})}let Pc=!1;function S6(){Pc||(Pc=!0,console.error("Slow timer, disabling animations"))}function Lr(){Pc=!1}function hm(){return Pc}const uv=[];function x6(e){uv.push(e)}function $r(e,t,a){uv.forEach(o=>{try{o(e,t,a)}catch(i){console.error("Timer event subscriber threw an error"),console.error(i)}})}async function bm(){return await Nr(()=>import("./vendor.DVxhWSpD.js").then(e=>e.h),__vite__mapDeps([2,3,1]))}let No=null,Qi=null,Bc=null;async function T6(){const e=(await bm()).Howl;Bc===null&&(Bc=new e({src:"../sound/timeWarning.wav"}))}async function fv(){const e=(await bm()).Howl;No===null&&(No={1:[{sounds:[new e({src:"../sound/error1/error1_1.wav"}),new e({src:"../sound/error1/error1_1.wav"})],counter:0}],2:[{sounds:[new e({src:"../sound/error2/error2_1.wav"}),new e({src:"../sound/error2/error2_1.wav"})],counter:0}],3:[{sounds:[new e({src:"../sound/error3/error3_1.wav"}),new e({src:"../sound/error3/error3_1.wav"})],counter:0}],4:[{sounds:[new e({src:"../sound/error4/error4_1.wav"}),new e({src:"../sound/error4/error4_1.wav"})],counter:0},{sounds:[new e({src:"../sound/error4/error4_2.wav"}),new e({src:"../sound/error4/error4_2.wav"})],counter:0}]},Howler.volume(r.soundVolume))}async function Id(){const e=(await bm()).Howl;Qi===null&&(Qi={1:[{sounds:[new e({src:"../sound/click1/click1_1.wav"}),new e({src:"../sound/click1/click1_1.wav"})],counter:0},{sounds:[new e({src:"../sound/click1/click1_2.wav"}),new e({src:"../sound/click1/click1_2.wav"})],counter:0},{sounds:[new e({src:"../sound/click1/click1_3.wav"}),new e({src:"../sound/click1/click1_3.wav"})],counter:0}],2:[{sounds:[new e({src:"../sound/click2/click2_1.wav"}),new e({src:"../sound/click2/click2_1.wav"})],counter:0},{sounds:[new e({src:"../sound/click2/click2_2.wav"}),new e({src:"../sound/click2/click2_2.wav"})],counter:0},{sounds:[new e({src:"../sound/click2/click2_3.wav"}),new e({src:"../sound/click2/click2_3.wav"})],counter:0}],3:[{sounds:[new e({src:"../sound/click3/click3_1.wav"}),new e({src:"../sound/click3/click3_1.wav"})],counter:0},{sounds:[new e({src:"../sound/click3/click3_2.wav"}),new e({src:"../sound/click3/click3_2.wav"})],counter:0},{sounds:[new e({src:"../sound/click3/click3_3.wav"}),new e({src:"../sound/click3/click3_3.wav"})],counter:0}],4:[{sounds:[new e({src:"../sound/click4/click4_1.wav"}),new e({src:"../sound/click4/click4_11.wav"})],counter:0},{sounds:[new e({src:"../sound/click4/click4_2.wav"}),new e({src:"../sound/click4/click4_22.wav"})],counter:0},{sounds:[new e({src:"../sound/click4/click4_3.wav"}),new e({src:"../sound/click4/click4_33.wav"})],counter:0},{sounds:[new e({src:"../sound/click4/click4_4.wav"}),new e({src:"../sound/click4/click4_44.wav"})],counter:0},{sounds:[new e({src:"../sound/click4/click4_5.wav"}),new e({src:"../sound/click4/click4_55.wav"})],counter:0},{sounds:[new e({src:"../sound/click4/click4_6.wav"}),new e({src:"../sound/click4/click4_66.wav"})],counter:0}],5:[{sounds:[new e({src:"../sound/click5/click5_1.wav"}),new e({src:"../sound/click5/click5_11.wav"})],counter:0},{sounds:[new e({src:"../sound/click5/click5_2.wav"}),new e({src:"../sound/click5/click5_22.wav"})],counter:0},{sounds:[new e({src:"../sound/click5/click5_3.wav"}),new e({src:"../sound/click5/click5_33.wav"})],counter:0},{sounds:[new e({src:"../sound/click5/click5_4.wav"}),new e({src:"../sound/click5/click5_44.wav"})],counter:0},{sounds:[new e({src:"../sound/click5/click5_5.wav"}),new e({src:"../sound/click5/click5_55.wav"})],counter:0},{sounds:[new e({src:"../sound/click5/click5_6.wav"}),new e({src:"../sound/click5/click5_66.wav"})],counter:0}],6:[{sounds:[new e({src:"../sound/click6/click6_1.wav"}),new e({src:"../sound/click6/click6_11.wav"})],counter:0},{sounds:[new e({src:"../sound/click6/click6_2.wav"}),new e({src:"../sound/click6/click6_22.wav"})],counter:0},{sounds:[new e({src:"../sound/click6/click6_3.wav"}),new e({src:"../sound/click6/click6_33.wav"})],counter:0}],7:[{sounds:[new e({src:"../sound/click7/click7_1.wav"}),new e({src:"../sound/click7/click7_11.wav"})],counter:0},{sounds:[new e({src:"../sound/click7/click7_2.wav"}),new e({src:"../sound/click7/click7_22.wav"})],counter:0},{sounds:[new e({src:"../sound/click7/click7_3.wav"}),new e({src:"../sound/click7/click7_33.wav"})],counter:0}],14:[{sounds:[new e({src:"../sound/click14/click14_1.wav"}),new e({src:"../sound/click14/click14_1.wav"})],counter:0},{sounds:[new e({src:"../sound/click14/click14_2.wav"}),new e({src:"../sound/click14/click14_2.wav"})],counter:0},{sounds:[new e({src:"../sound/click14/click14_3.wav"}),new e({src:"../sound/click14/click14_3.wav"})],counter:0},{sounds:[new e({src:"../sound/click14/click14_4.wav"}),new e({src:"../sound/click14/click14_4.wav"})],counter:0},{sounds:[new e({src:"../sound/click14/click14_5.wav"}),new e({src:"../sound/click14/click14_5.wav"})],counter:0},{sounds:[new e({src:"../sound/click14/click14_6.wav"}),new e({src:"../sound/click14/click14_6.wav"})],counter:0},{sounds:[new e({src:"../sound/click14/click14_7.wav"}),new e({src:"../sound/click14/click14_7.wav"})],counter:0},{sounds:[new e({src:"../sound/click14/click14_8.wav"}),new e({src:"../sound/click14/click14_8.wav"})],counter:0}],15:[{sounds:[new e({src:"../sound/click15/click15_1.wav"}),new e({src:"../sound/click15/click15_1.wav"})],counter:0},{sounds:[new e({src:"../sound/click15/click15_2.wav"}),new e({src:"../sound/click15/click15_2.wav"})],counter:0},{sounds:[new e({src:"../sound/click15/click15_3.wav"}),new e({src:"../sound/click15/click15_3.wav"})],counter:0},{sounds:[new e({src:"../sound/click15/click15_4.wav"}),new e({src:"../sound/click15/click15_4.wav"})],counter:0},{sounds:[new e({src:"../sound/click15/click15_5.wav"}),new e({src:"../sound/click15/click15_5.wav"})],counter:0}]},Howler.volume(r.soundVolume))}async function L6(e){if(["8","9","10","11"].includes(e)){gv("KeyQ",ym[e]);return}if(["12","13"].includes(e)){ff[e].preview();return}Qi===null&&await Id();const t=Qi;Object.keys(t).includes(e)&&(t?.[e]?.[0]?.sounds[0]?.seek(0),t?.[e]?.[0]?.sounds[0]?.play())}async function $6(e){No===null&&await fv(),Object.keys(No).includes(e)&&(No?.[e]?.[0]?.sounds[0]?.seek(0),No?.[e]?.[0]?.sounds[0]?.play())}let Vs="KeyA";n(document).on("keydown",e=>{Vs=e.code||"KeyA"});const ae={C:[16.35,32.7,65.41,130.81,261.63,523.25,1046.5,2093,4186.01],Db:[17.32,34.65,69.3,138.59,277.18,554.37,1108.73,2217.46,4434.92],D:[18.35,36.71,73.42,146.83,293.66,587.33,1174.66,2349.32,4698.64],Eb:[19.45,38.89,77.78,155.56,311.13,622.25,1244.51,2489.02,4978.03],E:[20.6,41.2,82.41,164.81,329.63,659.26,1318.51,2637.02],F:[21.83,43.65,87.31,174.61,349.23,698.46,1396.91,2793.83],Gb:[23.12,46.25,92.5,185,369.99,739.99,1479.98,2959.96],G:[24.5,49,98,196,392,783.99,1567.98,3135.96],Ab:[25.96,51.91,103.83,207.65,415.3,830.61,1661.22,3322.44],A:[27.5,55,110,220,440,880,1760,3520],Bb:[29.14,58.27,116.54,233.08,466.16,932.33,1864.66,3729.31],B:[30.87,61.74,123.47,246.94,493.88,987.77,1975.53,3951.07]};function se(e,t=0){return a=>e[a+t]??0}const vh={KeyZ:se(ae.C),KeyS:se(ae.Db),KeyX:se(ae.D),KeyD:se(ae.Eb),KeyC:se(ae.E),KeyV:se(ae.F),KeyG:se(ae.Gb),KeyB:se(ae.G),KeyH:se(ae.Ab),KeyN:se(ae.A),KeyJ:se(ae.Bb),KeyM:se(ae.B),Comma:se(ae.C,1),KeyL:se(ae.Db,1),Period:se(ae.D,1),Semicolon:se(ae.Eb,1),Slash:se(ae.E,1),KeyQ:se(ae.C,1),Digit2:se(ae.Db,1),KeyW:se(ae.D,1),Digit3:se(ae.Eb,1),KeyE:se(ae.E,1),KeyR:se(ae.F,1),Digit5:se(ae.Gb,1),KeyT:se(ae.G,1),Digit6:se(ae.Ab,1),KeyY:se(ae.A,1),Digit7:se(ae.Bb,1),KeyU:se(ae.B,1),KeyI:se(ae.C,2),Digit9:se(ae.Db,2),KeyO:se(ae.D,2),Digit0:se(ae.Eb,2),KeyP:se(ae.E,2),BracketLeft:se(ae.F,2),Equal:se(ae.Gb,2),BracketRight:se(ae.G,2)},ym={8:"sine",9:"sawtooth",10:"square",11:"triangle"};let je;function pv(){if(je!==null)try{je=new AudioContext}catch(e){je=null,console.error(e),f(ie(e,"Error initializing audio context")+". Notes will not play.",-1)}}const wh={pentatonic:["C","D","E","G","A"],wholetone:["C","D","E","Gb","Ab","Bb"]};function Ch(e){const t={octave:4,direction:1};return async()=>{Qi===null&&await Id(),mv(e,t)}}const kh={position:0,octave:4,direction:1},ff={12:{name:"pentatonic",preview:Ch("pentatonic"),meta:kh},13:{name:"wholetone",preview:Ch("wholetone"),meta:kh}};function mv(e,t){if(je===void 0&&pv(),!je)return;const a=ht(0,wh[e].length-1);Math.random()<.5&&(t.octave+=t.direction),t.octave>=6&&(t.direction=-1),t.octave<=4&&(t.direction=1);const o=wh[e][a],i=ae[o][t.octave],s=je.createOscillator(),l=je.createGain();s.type="sine",l.gain.value=r.soundVolume/10,s.connect(l),l.connect(je.destination),s.frequency.value=i,s.start(je.currentTime),l.gain.setTargetAtTime(0,je.currentTime,.3),s.stop(je.currentTime+2)}async function Rc(){Bc===null&&await T6();const e=Bc;e.stop(),e.seek(0),e.play()}function gv(e,t){if(je===void 0&&pv(),!je||(Vs=e??Vs,!(Vs in vh)))return;const o=3+(ii||ni||us?1:0),i=vh[Vs]?.(o),s=je.createOscillator(),l=je.createGain();s.type=t??ym[r.playSoundOnClick],l.gain.value=r.soundVolume/10,s.connect(l),l.connect(je.destination),s.frequency.value=i,s.start(je.currentTime),l.gain.setTargetAtTime(0,je.currentTime,.15),s.stop(je.currentTime+.5)}async function Ea(e){if(r.playSoundOnClick==="off")return;if(r.playSoundOnClick in ff){const{name:i,meta:s}=ff[r.playSoundOnClick];mv(i,s);return}if(r.playSoundOnClick in ym){gv(e??void 0);return}Qi===null&&await Id();const t=Qi[r.playSoundOnClick];if(t===void 0)throw new Error("Invalid click sound ID");const a=Sa(t),o=a.sounds[a.counter];a.counter++,a.counter===2&&(a.counter=0),o.seek(0),o.play()}async function il(){if(r.playSoundOnError==="off")return;No===null&&await fv();const e=No[r.playSoundOnError];if(e===void 0)throw new Error("Invalid error sound ID");const t=Sa(e),a=t.sounds[t.counter];t.counter++,t.counter===2&&(t.counter=0),a.seek(0),a.play()}function M6(e){try{Howler.volume(e)}catch{}}ge((e,t)=>{e==="playSoundOnClick"&&t!=="off"&&Id(),e==="soundVolume"&&M6(parseFloat(t))});const hv=q.number().int().min(30).max(1e3),ps=new pt({key:"fpsLimit",schema:hv,fallback:1e3});function A6(e){const t=ps.set(e);return bv(),t}function _6(){return ps.get()}function bv(){Ei.pauseOnDocumentHidden=!1,Ei.fps=ps.get(),Ei.defaults.frameRate=ps.get()}function E6(){Ei.fps=30,Ei.defaults.frameRate=30}function q6(){Ei.fps=ps.get(),Ei.defaults.frameRate=ps.get()}let Li=0,wa=null;const Ll=1e3;let $l=0,Ae=!1;function I6(){Ae=!0}function vm(){q6(),Y3(0),wa!==null&&clearTimeout(wa)}function F6(){Ae&&console.time("premid");const e=document.querySelector("#premidSecondsLeft");e!==null&&(e.innerHTML=(r.time-Xr()).toString()),Ae&&console.timeEnd("premid")}function P6(){Ae&&console.time("timer progress update"),(r.mode==="time"||r.mode==="custom"&&ve()==="time")&&Zr(),Ae&&console.timeEnd("timer progress update")}function B6(){Ae&&console.time("calculate wpm and raw");const e=dm();return Ae&&console.timeEnd("calculate wpm and raw"),Ae&&console.time("update live wpm"),O3(e.wpm,e.raw),Ae&&console.timeEnd("update live wpm"),Ae&&console.time("push to history"),jy(e.wpm),Gy(e.raw),Ae&&console.timeEnd("push to history"),e}function R6(e){Ae&&console.time("update monkey");const t=r.blindMode?e.raw:e.wpm;v6(t),Ae&&console.timeEnd("update monkey")}function D6(){Ae&&console.time("calculate acc");const e=H(tl());return Ae&&console.timeEnd("calculate acc"),e}function W6(){if(Ae&&console.time("layoutfluid"),r.funbox.includes("layoutfluid")&&r.mode==="time"){const e=r.customLayoutfluid,t=r.time/e.length,a=Xr(),o=Math.floor(a/t),i=e[o],s=[];for(let l=1;l<e.length;l++)s.push(Math.floor(t*l));s.includes(a+3)?(v0(),su(3,e[o+1])):s.includes(a+2)?su(2,e[o+1]):s.includes(a+1)&&su(1,e[o+1]),r.layout!==i&&i!==void 0&&(or(),Do(i,!0),Ti(i,!0))}Ae&&console.timeEnd("layoutfluid")}function z6(e,t){return Ae&&console.time("fail conditions"),gd(),bd(),hd(),r.minWpm==="custom"&&e.wpm<r.minWpmCustomSpeed&&le>3?(wa!==null&&clearTimeout(wa),Lr(),Li=0,$r("fail","min speed"),!0):r.minAcc==="custom"&&t<r.minAccCustom?(wa!==null&&clearTimeout(wa),Lr(),Li=0,$r("fail","min accuracy"),!0):(Ae&&console.timeEnd("fail conditions"),!1)}function H6(){Ae&&console.time("times up check");let e;if(r.mode==="time"?e=r.time:r.mode==="custom"&&ve()==="time"&&(e=ye()),e!==void 0&&e!==0&&Xr()>=e){wa!==null&&clearTimeout(wa),Yr(),k.pushHistory(),Ke.pushHistory(),Lr(),Li=0,$r("finish");return}Ae&&console.timeEnd("times up check")}function O6(){Ae&&console.time("play timer warning");let e;r.mode==="time"?e=r.time:r.mode==="custom"&&ve()==="time"&&(e=ye()),e!==void 0&&Xr()===e-parseInt(r.playTimeWarning,10)&&Rc(),Ae&&console.timeEnd("play timer warning")}let pf=[];function N6(){return pf}async function U6(){Ae&&console.time("timer step -----------------------------"),J3(),F6(),P6(),r.playTimeWarning!=="off"&&O6();const e=B6(),t=D6();R6(e),W6(),z6(e,t)||H6(),Ae&&console.timeEnd("timer step -----------------------------")}async function V6(){Lr(),Li=0,pf=[],$l=ji+Ll,(function e(){const t=$l-performance.now();pf.push({dateNow:Date.now(),now:performance.now(),expected:$l,nextDelay:t}),(r.mode==="time"&&r.time<130&&r.time>0||r.mode==="words"&&r.words<250&&r.words>0)&&(t<Ll/2&&(S6(),E6()),t<Ll/10&&(Li++,Li>5&&(f('This could be caused by "efficiency mode" on Microsoft Edge.'),f("Stopping the test due to bad performance. This would cause test calculations to be incorrect. If this happens a lot, please report this.",-1),$r("fail","slow timer")))),wa=setTimeout(function(){if(!we){wa!==null&&clearTimeout(wa),Lr(),Li=0;return}U6(),$l+=Ll,e()},t)})()}let wm=[],Va=[],yv=0,Cm=!0,Oa=0,gt=0,Yi=0,nl=0,Dc=[],mf=[];const ma=document.getElementById("playpauseReplayButton")?.children[0];function gf(e){wm=e}function km(){const e=document.getElementById("replayWords");if(e===null)return;e.innerHTML="";let t=0;Va.forEach(a=>{a.action==="backWord"?t--:(a.action==="submitCorrectWord"||a.action==="submitErrorWord")&&t++}),wm.forEach((a,o)=>{if(o>t)return;const i=document.createElement("div");i.className="word";for(const s of a){const l=document.createElement("letter");l.innerHTML=s,i.appendChild(l)}e.appendChild(i)})}function sl(){Dc.forEach(e=>{clearTimeout(e)}),Dc=[],mf.forEach(e=>{clearTimeout(e)}),mf=[],nl=gt,Yi=Oa,ma!==void 0&&(ma.className="fas fa-play",ma.parentNode?.setAttribute("aria-label","Resume replay"))}function bn(e=!1){e&&r.playSoundOnError!=="off"?il():Ea()}function vv(e,t=!1){let a=document.getElementById("replayWords")?.children[Oa];if(a!==void 0){if(e.action==="correctLetter")t||bn(),a.children[gt]?.classList.add("correct"),gt++;else if(e.action==="incorrectLetter"){t||bn(!0);let o;gt>=a.children.length&&(o=document.createElement("letter"),o?.classList.add("extra"),o.innerHTML=e.value?.toString()??"",a.appendChild(o)),o=a.children[gt],o?.classList.add("incorrect"),gt++}else if(e.action==="setLetterIndex"&&typeof e.value=="number"){t||bn(),gt=e.value;for(const o of[...a.children].slice(gt))o?.classList.contains("extra")?o.remove():o.className=""}else if(e.action==="submitCorrectWord")t||bn(),Oa++,gt=0;else if(e.action==="submitErrorWord")t||bn(!0),a?.classList.add("error"),Oa++,gt=0;else if(e.action==="backWord"){t||bn(),Oa--;const o=document.getElementById("replayWords");for(o!==null&&(a=o.children[Oa]),gt=a.children.length;a.children[gt-1]?.className==="";)gt--;a?.classList.remove("error")}}}function Sm(){let e=0;gt=0,Oa=0,Va.forEach((o,i)=>{(Oa<Yi||Oa===Yi&&gt<nl)&&(vv(o,!0),e=i+1)});const t=Va[e]?.time;if(t===void 0)throw new Error("Failed to load old replay: datatime is undefined");const a=Math.floor(t/1e3);return Cv(a),e}function wv(){n("#resultReplay").stop(!0,!0).hasClass("hidden")?(km(),Sm(),n("#watchReplayButton").hasClass("loaded")?n("#resultReplay").removeClass("hidden").css("display","none").slideDown(250):(n("#words").html('<div class="preloader"><i class="fas fa-fw fa-spin fa-circle-notch"></i></div>'),n("#resultReplay").removeClass("hidden").css("display","none").slideDown(250))):(ma?.parentNode?.getAttribute("aria-label")!=="Start replay"&&sl(),n("#resultReplay").slideUp(250,()=>{n("#resultReplay").addClass("hidden")}))}function K6(){n("#resultReplay").stop(!0,!0).hasClass("hidden")||wv(),n("#replayStats").text(""),Va=[],yv=performance.now(),Cm=!0,nl=0,Yi=0}function xm(){Cm=!1}function Di(e,t){if(!Cm)return;const a=performance.now()-yv;Va.push({action:e,value:t,time:a})}function Cv(e){const a=`${ti[e-1]??0}wpm	${e}s`;n("#replayStats").text(a)}function j6(){if(gt=0,Oa=0,ma===void 0)return;ma.className="fas fa-pause",ma.parentNode?.setAttribute("aria-label","Pause replay"),km();const e=Sm(),t=Va[e]?.time;if(t===void 0)throw new Error("Failed to play replay: lastTime is undefined");let a=Math.round(t/1e3);const o=Math.round(Kn(Va).time/1e3);for(;a<=o;){const i=a;mf.push(setTimeout(()=>{Cv(i)},i*1e3-t)),a++}Va.forEach((i,s)=>{s<e||Dc.push(setTimeout(()=>{vv(i)},i.time-t))}),Dc.push(setTimeout(()=>{nl=0,Yi=0,ma.className="fas fa-play",ma.parentNode.setAttribute("aria-label","Start replay")},Kn(Va).time-t))}function G6(){return JSON.stringify({replayData:Va,wordsList:wm})}n(".pageTest #playpauseReplayButton").on("click",()=>{ma?.className==="fas fa-play"?j6():ma?.className==="fas fa-pause"&&sl()});n("#replayWords").on("click","letter",e=>{sl();const a=[...document.querySelector("#replayWords")?.children??[]];Yi=a.indexOf(e.target.parentNode),nl=[...a[Yi].children].indexOf(e.target),km(),Sm()});n(".pageTest").on("click","#watchReplayButton",()=>{wv()});let Mr=0,Tm=!1,kv;function Q6(e){if(Tm&&new Date().getDate()>kv){Mr=e;return}Mr+=e}function Y6(){return Ye(Math.round(Mr),!0,!0)+(Tm?" today":" session")}function J6(){const e=new Date;e.setSeconds(0),e.setMinutes(0),e.setHours(0),e.setMilliseconds(0),kv=e.getDate();const t=e.getTime();Mr=0;const a=S();if(!a)return;a.results?.forEach(i=>{const s=new Date(i.timestamp);s.setSeconds(0),s.setMinutes(0),s.setHours(0),s.setMilliseconds(0),s.getTime()>=t&&(Mr+=i.testDuration+i.incompleteTestSeconds-i.afkDuration)}),Tm=!0}let hf=!1;function Sv(){It&&!hf&&!zt&&(f("Challenge cleared",0),fy(null))}function X6(e,t,a){let o=!0,i=[];const s=e.afkDuration/e.testDuration*100;if(t[a]===void 0)throw new Error("Requirement value is undefined");if(a==="wpm"&&t.wpm){const l=t.wpm;"exact"in l?Math.round(e.wpm)!==l.exact&&(o=!1,i.push(`WPM not ${l.exact}`)):"min"in l&&e.wpm<l.min&&(o=!1,i.push(`WPM below ${l.min}`))}else if(a==="acc"&&t.acc){const l=t.acc;"exact"in l?e.acc!==l.exact&&(o=!1,i.push(`Accuracy not ${l.exact}`)):"min"in l&&e.acc<l.min&&(o=!1,i.push(`Accuracy below ${l.min}`))}else if(a==="afk"&&t.afk){const l=t.afk;l.max&&Math.round(s)>l.max&&(o=!1,i.push(`AFK percentage above ${l.max}`))}else if(a==="time"&&t.time){const l=t.time;l.min&&Math.round(e.testDuration)<l.min&&(o=!1,i.push(`Test time below ${l.min}`))}else if(a==="funbox"&&t.funbox){const l=t.funbox.exact;if(l===void 0)throw new Error("Funbox mode is undefined");if(!ri(l,e.funbox)){o=!1;for(const c of l)e.funbox?.includes(c)||i.push(`${c} funbox not active`);if(e.funbox!==void 0&&e.funbox.length>0)for(const c of e.funbox)l.includes(c)||i.push(`${c} funbox active`)}}else if(a==="raw"&&t.raw){const l=t.raw;l.exact&&Math.round(e.rawWpm)!==l.exact&&(o=!1,i.push(`Raw WPM not ${l.exact}`))}else if(a==="con"&&t.con){const l=t.con;l.exact&&Math.round(e.consistency)!==l.exact&&(o=!1,i.push(`Consistency not ${l.exact}`))}else if(a==="config"&&t.config){const l=t.config;for(const c of et(l)){const d=l[c];r[c]!==d&&(o=!1,i.push(`${c} not set to ${d}`))}}return[o,i]}function Z6(e){if(!It)return null;try{if(e.afkDuration/e.testDuration*100>10)return f("Challenge failed: AFK time is greater than 10%",0),null;if(It.requirements===void 0)return f(`${It.display} challenge passed!`,1),It.name;{let a=!0;const o=[];for(const i of et(It.requirements)){const[s,l]=X6(e,It.requirements,i);s||(a=!1),o.push(...l)}return a?(It.autoRole&&f("You will receive a role shortly. Please don't post a screenshot in challenge submissions.",1,{duration:5}),f(`${It.display} challenge passed!`,1),It.name):(f(`${It.display} challenge failed: ${o.join(", ")}`,0),null)}}catch(t){return console.error(t),f(`Something went wrong when verifying challenge: ${t.message}`,0),null}}async function xv(e){hf=!0,zo([]);const{data:t,error:a}=await Wt(c0());if(a){const s=ie(a,"Failed to setup challenge");return f(s,-1),te(),setTimeout(()=>{n("header .config").removeClass("hidden"),n(".page.pageTest").removeClass("hidden")},250),!1}const o=t.find(s=>s.name.toLowerCase()===e.toLowerCase());let i;try{if(o===void 0)return f("Challenge not found",0),te(),setTimeout(()=>{n("header .config").removeClass("hidden"),n(".page.pageTest").removeClass("hidden")},250),!1;if(o.type==="customTime")uo(o.parameters[0],!0),rt("time",!0),no("normal",!0),o.name==="englishMaster"&&(Zn("english_10k",!0),po(!0,!0),ei(!0,!0));else if(o.type==="customWords")Oi(o.parameters[0],!0),rt("words",!0),no("normal",!0);else if(o.type==="customText")wo(o.parameters[0].split(" ")),ls(o.parameters[1]),Ua(o.parameters[2]),ya(o.parameters[3]),Ui(o.parameters[4]),rt("custom",!0),no("normal",!0);else if(o.type==="script"){Z();const s=await fetch("/challenges/"+o.parameters[0]);if(N(),s.status!==200)throw new Error(`${s.status} ${s.statusText}`);let c=(await s.text()).trim();c=c.replace(/[\n\r\t ]/gm," "),c=c.replace(/ +/gm," "),wo(c.split(" ")),ls("repeat"),ya("word"),Ui(!1),rt("custom",!0),no("normal",!0),o.parameters[1]!==null&&Ep(o.parameters[1]),o.parameters[2]!==null&&K0(o.parameters[2])}else o.type==="accuracy"?(uo(0,!0),rt("time",!0),no("master",!0)):o.type==="funbox"?(zo(o.parameters[0],!0),no("normal",!0),o.parameters[1]==="words"?Oi(o.parameters[2],!0):o.parameters[1]==="time"&&uo(o.parameters[2],!0),rt(o.parameters[1],!0),o.parameters[3]!==void 0&&no(o.parameters[3],!0)):o.type==="special"&&o.name==="semimak"&&(rt("time",!0),uo(120,!0),Zn("english_10k",!0),ei(!0,!0),By("word",!0),Do("semimak",!0),Ti("overrideSync",!0),fa("static",!0));return te(),i=o.message,n("header .config").removeClass("hidden"),n(".page.pageTest").removeClass("hidden"),f(i===void 0?`Challenge '${o.display}' loaded.`:"Challenge loaded. "+i,0),fy(o),hf=!1,!0}catch(s){return f(ie(s,"Failed to load challenge"),-1),!1}}ge(e=>{["difficulty","numbers","punctuation","mode","funbox","paceCaret","showAllLines","showLiveWpm","highlightMode","time","words","keymapMode","keymapLayout","layout"].includes(e)&&Sv()});const Fd=new Map;function Nt(e,t=!0){const a=document.getElementById(e)??void 0;if(a===void 0)throw new Error(`Element with id ${e} not found`);Fd.set(e,a),t&&yt(e)}function yt(e){const t=Fd.get(e);t?t.remove():Nt(e,!0)}const e8={popups:document.getElementById("popups"),main:document.querySelector("main")};function Ht(e,t){const a=Fd.get(e);e8[t].append(a)}function t8(e){return Fd.has(e)}const Ml=125,Al=.75;class re{constructor(t){this.open=!1,this.setupRan=!1,t.dialogId.startsWith("#")&&(t.dialogId=t.dialogId.slice(1)),this.skeletonAppendParent=t.appendTo??"popups",t8(t.dialogId)&&Ht(t.dialogId,this.skeletonAppendParent);const a=document.getElementById(t.dialogId),o=document.querySelector(`#${t.dialogId} > .modal`);if(a===null)throw new Error(`Dialog element with id ${t.dialogId} not found`);if(!(a instanceof HTMLDialogElement))throw new Error("Animated dialog must be an HTMLDialogElement");if(a===null)throw new Error(`Dialog element with id ${t.dialogId} not found`);if(o===null)throw new Error(`Div element inside #${t.dialogId} with class 'modal' not found`);this.dialogId=t.dialogId,this.wrapperEl=a,this.modalEl=o,this.customShowAnimations=t.customAnimations?.show,this.customHideAnimations=t.customAnimations?.hide,this.previousModalInChain=void 0,this.showOptionsWhenInChain=t.showOptionsWhenInChain,this.customEscapeHandler=t?.customEscapeHandler,this.customWrapperClickHandler=t?.customWrapperClickHandler,this.setup=t?.setup,this.cleanup=t?.cleanup,Nt(this.dialogId)}getPreviousModalInChain(){return this.previousModalInChain}async runSetup(){this.wrapperEl.addEventListener("keydown",async t=>{t.key==="Escape"&&xa(this.dialogId)&&(t.preventDefault(),t.stopPropagation(),this.customEscapeHandler!==void 0?(this.customEscapeHandler(t),this.cleanup?.()):await this.hide())}),this.wrapperEl.addEventListener("mousedown",async t=>{t.target===this.wrapperEl&&(this.customWrapperClickHandler!==void 0?(this.customWrapperClickHandler(t),this.cleanup?.()):await this.hide())}),this.setup!==void 0&&await this.setup(this.modalEl)}getDialogId(){return this.dialogId}getWrapper(){return this.wrapperEl}getModal(){return this.modalEl}isOpen(){return this.open}focusFirstInput(t){const o=[...this.modalEl.querySelectorAll("input")].find(i=>!i.classList.contains("hidden"));o!=null?t===!0?o.focus():t==="focusAndSelect"?(o.focus(),o.select()):this.wrapperEl.focus():this.wrapperEl.focus()}async show(t){return new Promise(async a=>{if(this.open){a();return}if(Ht(this.dialogId,this.skeletonAppendParent),this.setupRan||(await this.runSetup(),this.setupRan=!0),xa(this.dialogId)){a();return}const o=G((t?.customAnimation?.modal?.duration??t?.animationDurationMs??this.customShowAnimations?.modal?.duration??Ml)*(t?.modalChain!==void 0?Al:1));t?.modalChain!==void 0&&(this.previousModalInChain=t.modalChain,await this.previousModalInChain.hide({animationMode:"modalOnly",animationDurationMs:o,dontShowPreviousModalInchain:t.modalChain.previousModalInChain!==void 0})),this.open=!0,t?.mode==="dialog"?this.wrapperEl.show():(t?.mode==="modal"||t?.mode===void 0)&&this.wrapperEl.showModal(),await t?.beforeAnimation?.(this.modalEl,t?.modalChainData),setTimeout(async()=>{this.focusFirstInput(t?.focusFirstInput)},1);const i=(t?.customAnimation?.modal??this.customHideAnimations?.modal)!==void 0,s=t?.customAnimation?.modal??this.customShowAnimations?.modal??{opacity:[0,1],marginTop:["1rem",0]},l=t?.customAnimation?.wrapper??this.customShowAnimations?.wrapper??{opacity:[0,1]},c=G(t?.customAnimation?.wrapper?.duration??this.customShowAnimations?.wrapper?.duration??Ml),d=this.previousModalInChain!==void 0?"modalOnly":t?.animationMode??"both";d==="both"||d==="none"?(i?W(this.modalEl,{...s,duration:d==="none"?0:o}):this.modalEl.style.opacity="1",W(this.wrapperEl,{...l,duration:d==="none"?0:c,onBegin:()=>{this.wrapperEl.classList.remove("hidden")},onComplete:async()=>{this.focusFirstInput(t?.focusFirstInput),await t?.afterAnimation?.(this.modalEl,t?.modalChainData),a()}})):d==="modalOnly"&&(n(this.wrapperEl).removeClass("hidden").css("opacity","1"),W(this.modalEl,{...s,duration:o,onComplete:async()=>{this.focusFirstInput(t?.focusFirstInput),await t?.afterAnimation?.(this.modalEl,t?.modalChainData),a()}}))})}async hide(t){return new Promise(async a=>{if(!xa(this.dialogId)){a();return}t?.clearModalChain&&(this.previousModalInChain=void 0),await t?.beforeAnimation?.(this.modalEl);const o=(t?.customAnimation?.modal??this.customHideAnimations?.modal)!==void 0,i=t?.customAnimation?.modal??this.customHideAnimations?.modal??{opacity:[1,0],marginTop:[0,"1rem"]},s=G((t?.customAnimation?.modal?.duration??t?.animationDurationMs??this.customHideAnimations?.modal?.duration??Ml)*(this.previousModalInChain!==void 0?Al:1)),l=t?.customAnimation?.wrapper??this.customHideAnimations?.wrapper??{opacity:[1,0]},c=G(t?.customAnimation?.wrapper?.duration??this.customHideAnimations?.wrapper?.duration??Ml),d=this.previousModalInChain!==void 0?"modalOnly":t?.animationMode??"both";d==="both"||d==="none"?(o?W(this.modalEl,{...i,duration:d==="none"?0:s}):this.modalEl.style.opacity="1",W(this.wrapperEl,{...l,duration:d==="none"?0:c,onComplete:async()=>{this.wrapperEl.close(),this.wrapperEl.classList.add("hidden"),yt(this.dialogId),this.open=!1,await t?.afterAnimation?.(this.modalEl),this.cleanup?.(),this.previousModalInChain!==void 0&&!t?.dontShowPreviousModalInchain&&(await this.previousModalInChain.show({animationMode:"modalOnly",modalChainData:t?.modalChainData,animationDurationMs:s*Al,...this.previousModalInChain.showOptionsWhenInChain}),this.previousModalInChain=void 0),a()}})):d==="modalOnly"&&(n(this.wrapperEl).removeClass("hidden").css("opacity","1"),W(this.modalEl,{...i,duration:s,onComplete:async()=>{this.wrapperEl.close(),n(this.wrapperEl).addClass("hidden").css("opacity","0"),yt(this.dialogId),this.open=!1,await t?.afterAnimation?.(this.modalEl),this.cleanup?.(),this.previousModalInChain!==void 0&&!t?.dontShowPreviousModalInchain&&(await this.previousModalInChain.show({animationMode:"modalOnly",modalChainData:t?.modalChainData,animationDurationMs:s*Al,...this.previousModalInChain.showOptionsWhenInChain}),this.previousModalInChain=void 0),a()}}))})}destroy(){this.wrapperEl.close(),this.wrapperEl.classList.add("hidden"),this.cleanup?.(),yt(this.dialogId),this.open=!1}}let pa=0,Be=null,be=null;function a8(){Be=null}function o8(){n("#quoteRateModal .quote .text").text("-"),n("#quoteRateModal .quote .source .val").text("-"),n("#quoteRateModal .quote .id .val").text("-"),n("#quoteRateModal .quote .length .val").text("-"),n("#quoteRateModal .ratingCount .val").text("-"),n("#quoteRateModal .ratingAverage .val").text("-")}function Tv(e){return fe(e.ratings)&&fe(e.totalRating)&&e.ratings>0&&e.totalRating>0?Math.round(e.totalRating/e.ratings*10)/10:0}async function Lv(e){if(!e)return;be=e;const t=await T.quotes.getRating({query:{quoteId:be.id,language:be.language}});if(N(),t.status!==200){f("Failed to get quote ratings: "+t.body.message,-1);return}return t.body.data===null?{}:(Be=t.body.data,Be!==void 0&&Be.average===void 0&&(Be.average=Tv(Be)),Be)}function Jl(e){const t=e??pa;n("#quoteRateModal .star").removeClass("active");for(let a=1;a<=t;a++)n(`#quoteRateModal .star[data-rating=${a}]`).addClass("active")}async function i8(){Be||await Lv(),n("#quoteRateModal .ratingCount .val").text(Be?.ratings??"0"),n("#quoteRateModal .ratingAverage .val").text(Be?.average?.toFixed(1)??"-")}function n8(){if(!be)return;let e;be.group===0?e="short":be.group===1?e="medium":be.group===2?e="long":be.group===3&&(e="thicc"),n("#quoteRateModal .quote .text").text(be.text),n("#quoteRateModal .quote .source .val").text(be.source),n("#quoteRateModal .quote .id .val").text(be.id),n("#quoteRateModal .quote .length .val").text(e),i8()}function s8(e,t){$v.show({...t,beforeAnimation:async()=>{o8(),be=e,pa=0;const o=S()?.quoteRatings?.[be.language]?.[be.id];fe(o)&&(pa=o),Jl(),n8()}})}function r8(e=!1){$v.hide({clearModalChain:e})}async function l8(){if(pa===0){f("Please select a rating");return}if(!be)return;r8(!0);const e=await T.quotes.addRating({body:{quoteId:be.id,language:be.language,rating:pa}});if(N(),e.status!==200){f("Failed to submit quote rating: "+e.body.message,-1);return}const t=S();if(!t)return;const a=t.quoteRatings??{},o=a?.[be.language]??{};if(fe(o?.[be.id])){const i=a[be.language]?.[be.id],s=pa-i;o[be.id]=pa,Be={ratings:Be?.ratings,totalRating:isNaN(Be?.totalRating)?0:Be?.totalRating+s,quoteId:be.id,language:be.language},f("Rating updated",1)}else o[be.id]=pa,fe(Be?.ratings)&&fe(Be.totalRating)?(Be.ratings++,Be.totalRating+=pa):Be={ratings:1,totalRating:pa,quoteId:be.id,language:be.language},f("Rating submitted",1);t.quoteRatings=a,at(t),Be.average=Tv(Be),n(".pageTest #result #rateQuoteButton .rating").text(Be.average?.toFixed(1)),n(".pageTest #result #rateQuoteButton .icon").removeClass("far"),n(".pageTest #result #rateQuoteButton .icon").addClass("fas")}async function c8(e){e.querySelector(".submitButton")?.addEventListener("click",()=>{l8()});const t=e.querySelectorAll(".stars button.star");for(const a of t)a.addEventListener("click",o=>{pa=parseInt(o.currentTarget.getAttribute("data-rating")),Jl()}),a.addEventListener("mouseenter",o=>{const i=parseInt(o.currentTarget.getAttribute("data-rating"));Jl(i)}),a.addEventListener("mouseleave",()=>{Jl()})}const $v=new re({dialogId:"quoteRateModal",setup:c8}),d8=[{type:"leaderboard_atf",selectorId:"ad-result-wrapper"},{type:"med_rect_btf",selectorId:"ad-result-small-wrapper"}],u8=[{type:"leaderboard_atf",selectorId:"ad-result-wrapper"},{type:"med_rect_btf",selectorId:"ad-result-small-wrapper"},{type:"sky_btf",selectorId:"ad-vertical-right-wrapper"},{type:"sky_btf",selectorId:"ad-vertical-left-wrapper"}],f8=[{type:"leaderboard_atf",selectorId:"ad-result-wrapper"},{type:"med_rect_btf",selectorId:"ad-result-small-wrapper"},{type:"sky_btf",selectorId:"ad-vertical-right-wrapper"},{type:"sky_btf",selectorId:"ad-vertical-left-wrapper"},{type:"leaderboard_btf",selectorId:"ad-footer-wrapper"},{type:"med_rect_btf",selectorId:"ad-footer-small-wrapper"},{type:"leaderboard_btf",selectorId:"ad-about-1-wrapper"},{type:"med_rect_btf",selectorId:"ad-about-1-small-wrapper"},{type:"leaderboard_btf",selectorId:"ad-about-2-wrapper"},{type:"med_rect_btf",selectorId:"ad-about-2-small-wrapper"},{type:"leaderboard_btf",selectorId:"ad-settings-1-wrapper"},{type:"med_rect_btf",selectorId:"ad-settings-1-small-wrapper"},{type:"leaderboard_btf",selectorId:"ad-settings-2-wrapper"},{type:"med_rect_btf",selectorId:"ad-settings-2-small-wrapper"},{type:"leaderboard_btf",selectorId:"ad-settings-3-wrapper"},{type:"med_rect_btf",selectorId:"ad-settings-3-small-wrapper"},{type:"leaderboard_btf",selectorId:"ad-account-1-wrapper"},{type:"med_rect_btf",selectorId:"ad-account-1-small-wrapper"},{type:"leaderboard_btf",selectorId:"ad-account-2-wrapper"},{type:"med_rect_btf",selectorId:"ad-account-2-small-wrapper"}];let Pd=!1;function p8(){const e="1024888",t="74058";window.ramp={que:[],passiveMode:!0,forcePath:"320x50-test",onReady:()=>{Pd=!0,Bd()}};const a=document.getElementsByTagName("head")[0],o=document.createElement("script");o.setAttribute("async",!0),o.src=`//cdn.intergient.com/${e}/${t}/ramp.js`,a.appendChild(o),window._pwGA4PageviewId="".concat(Date.now()),window.dataLayer=window.dataLayer||[],window.gtag=window.gtag||function(){dataLayer.push(arguments)},gtag("js",new Date),gtag("config","G-KETCPNHRJF",{send_page_view:!1}),gtag("event","ramp_js",{send_to:"G-KETCPNHRJF",pageview_id:window._pwGA4PageviewId})}function Mv(){let e;r.ads==="result"?e=d8:r.ads==="on"?e=u8:r.ads==="sellout"&&(e=f8);const t=[];for(const a of e){const o=document.querySelector(`#${a.selectorId}`);o&&window.getComputedStyle(o).display!=="none"&&o.offsetParent!==null&&t.push(a)}return t}async function Bd(){if(Pd){if(X()==="test"&&!ce){ramp.destroyUnits("all");return}await ramp.destroyUnits("all"),await ramp.addUnits(Mv()),await ramp.displayUnits()}}async function m8(){}function g8(){Pd&&ramp.destroyUnits("all")}async function h8(){if(!Pd)return;const e=Mv();await ramp.addUnits(e),await ramp.displayUnits()}const b8=900;let _l=!0;const y8=1330;let El=!0,rl=!1,Rd,Ar;function Av(){p8(),setInterval(()=>{we||m8()},6e4),rl=!0}function v8(){bf(),_v(),w8()}function bf(){n("#ad-footer-wrapper").remove(),n("#ad-footer-small-wrapper").remove(),n("#ad-about-1-wrapper").remove(),n("#ad-about-1-small-wrapper").remove(),n("#ad-about-2-wrapper").remove(),n("#ad-about-2-small-wrapper").remove(),n("#ad-settings-1-wrapper").remove(),n("#ad-settings-1-small-wrapper").remove(),n("#ad-settings-2-wrapper").remove(),n("#ad-settings-2-small-wrapper").remove(),n("#ad-settings-3-wrapper").remove(),n("#ad-settings-3-small-wrapper").remove(),n("#ad-account-1-wrapper").remove(),n("#ad-account-1-small-wrapper").remove(),n("#ad-account-2-wrapper").remove(),n("#ad-account-2-small-wrapper").remove()}function _v(){n("#ad-vertical-right-wrapper").remove(),n("#ad-vertical-left-wrapper").remove()}function w8(){n("#ad-result-wrapper").remove(),n("#ad-result-small-wrapper").remove()}function C8(){}function Ev(e=!1){const t=_l;window.innerWidth>b8?_l=!0:_l=!1,!e&&(r.ads==="off"||!rl||t!==_l&&Bd())}function qv(e=!1){const t=El;window.innerWidth>y8?El=!0:El=!1,!e&&(r.ads==="off"||!rl||t!==El&&Bd())}async function Lm(){return new Promise(e=>{window.ramp===void 0&&(Rd=!0),e()})}async function $m(){return new Promise(e=>{if(Ar===void 0){Ar=!1,e();return}e()})}async function k8(){return r.ads==="off"?!1:rl?(await Lm(),await $m(),Rd||Ar?!1:Bd()):(Av(),!0)}async function S8(){if(r.ads!=="off"){if(rl||Av(),await Lm(),await $m(),Rd){n("#ad-result-wrapper .iconAndText .text").html(`
    Using an ad blocker? No worries
    <div class="smalltext">
      We understand ads can be annoying
      <br />
      You can
      <i>disable all ads</i>
      in the settings
    </div>
    `);return}if(Ar){n("#ad-result-wrapper .iconAndText .text").html(`
    Ads not working? Ooops
    <div class="smalltext">
      You may have a cookie popup blocker enabled - ads will not show without your consent
      <br />
      You can also 
      <i>disable all ads</i>
      in the settings if you wish
    </div>
    `);return}h8()}}function Wc(e){e?(n("#ad-vertical-left-wrapper").removeClass("testPage"),n("#ad-vertical-right-wrapper").removeClass("testPage"),n("#ad-footer-wrapper").removeClass("testPage"),n("#ad-footer-small-wrapper").removeClass("testPage")):(n("#ad-vertical-left-wrapper").addClass("testPage"),n("#ad-vertical-right-wrapper").addClass("testPage"),n("#ad-footer-wrapper").addClass("testPage"),n("#ad-footer-small-wrapper").addClass("testPage"))}function x8(){ramp.showCmpModal()}function T8(){g8()}const L8=Mt(500,C8),$8=Mt(500,Ev),M8=Mt(500,qv);n(window).on("resize",()=>{L8(),$8(),M8()});ge((e,t)=>{e==="ads"&&(t==="off"?v8():t==="result"?(bf(),_v()):t==="on"&&bf())});V2(()=>{});n(()=>{Ev(!0),qv()});window.onerror=function(e){};const mu={quotes:[],length:0,language:null,groups:[]};class A8{constructor(){this.quoteCollection=mu,this.quoteQueue=[],this.queueIndex=0}async getQuotes(t,a){const o=Wa(t);if(this.quoteCollection.language!==o){const{data:i,error:s}=await Wt(di(`quotes/${o}.json`));if(s){if(s instanceof Error&&(s?.message?.includes("404")||s?.message?.includes("Content is not JSON")))return mu;throw s}if(i.quotes===void 0||i.quotes.length===0)return mu;this.quoteCollection={quotes:[],length:i.quotes.length,groups:[],language:i.language},i.quotes.forEach(l=>{const c={text:l.text,britishText:l.britishText,source:l.source,length:l.length,id:l.id,language:i.language,group:0};this.quoteCollection.quotes.push(c)}),i.groups.forEach((l,c)=>{const d=l[0],u=l[1];this.quoteCollection.groups[c]=this.quoteCollection.quotes.filter(p=>p.length>=d&&p.length<=u?(p.group=c,!0):!1)}),a!==void 0&&this.updateQuoteQueue(a)}return this.quoteCollection}getQuoteById(t){return this.quoteCollection.quotes.find(o=>o.id===t)}updateQuoteQueue(t){this.quoteQueue=[],t.forEach(a=>{a<0||this.quoteCollection.groups[a]?.forEach(o=>{this.quoteQueue.push(o)})}),Gn(this.quoteQueue),this.queueIndex=0}getRandomQuote(){if(this.quoteQueue.length===0)return null;this.queueIndex>=this.quoteQueue.length&&(this.queueIndex=0,Gn(this.quoteQueue));const t=this.quoteQueue[this.queueIndex];return this.queueIndex+=1,t}getRandomFavoriteQuote(t){const a=S();if(!a)return null;const o=Wa(t),i=[],{favoriteQuotes:s}=a;if(s===void 0||(Object.keys(s).forEach(d=>{Wa(d)===o&&i.push(...s[d]??[])}),i.length===0))return null;const l=Sa(i);return this.getQuoteById(parseInt(l,10))??null}isQuoteFavorite({language:t,id:a}){const o=S();if(!o)return!1;const{favoriteQuotes:i}=o;if(i===void 0)return!1;const s=Wa(t);return Object.keys(i).find(c=>s!==Wa(c)?!1:(i[c]??[]).includes(a.toString()))!==void 0}async setQuoteFavorite(t,a){const o=S();if(!o)throw new Error("Snapshot is not available");if(a){const i=await T.users.addQuoteToFavorites({body:{language:t.language,quoteId:`${t.id}`}});if(i.status===200)o.favoriteQuotes===void 0&&(o.favoriteQuotes={}),o.favoriteQuotes[t.language]||(o.favoriteQuotes[t.language]=[]),o.favoriteQuotes[t.language]?.push(`${t.id}`);else throw new Error(i.body.message)}else{const i=await T.users.removeQuoteFromFavorites({body:{language:t.language,quoteId:`${t.id}`}});if(i.status===200){const s=o.favoriteQuotes?.[t.language]?.indexOf(`${t.id}`);o.favoriteQuotes?.[t.language]?.splice(s,1)}else throw new Error(i.body.message)}}}const ct=new A8;ge((e,t)=>{e==="quoteLength"&&ct.updateQuoteQueue(t)});let Iv=!1;function Sh(){return Iv}function _8(){Iv=!0,console.log("Glarses Mode On - test result will be hidden. You can check the stats in the console (here)"),console.log("To disable Glarses Mode refresh the page.")}function E8(){yf=!1,n("#result .stats .wpm .crown").css("opacity",0).addClass("hidden")}let yf=!1,Fv="normal";function q8(){return Fv}function Pv(){if(yf)return;yf=!0;const e=document.querySelector("#result .stats .wpm .crown");W(e,{opacity:[0,1],duration:G(125),onBegin:()=>{e.classList.remove("hidden")}})}function Bv(e){Fv=e;const t=n("#result .stats .wpm .crown");t.removeClass("ineligible"),t.removeClass("pending"),t.removeClass("error"),t.removeClass("warning"),t.addClass(e)}function I8(){n("#testConfig").removeClass("invisible"),n("#mobileTestConfigButton").removeClass("invisible")}function F8(){n("#testConfig").addClass("invisible"),n("#mobileTestConfigButton").addClass("invisible")}async function Rv(){n("#testConfig .mode .textButton").removeClass("active"),n("#testConfig .mode .textButton[mode='"+r.mode+"']").addClass("active"),n("#testConfig .puncAndNum").addClass("hidden"),n("#testConfig .spacer").addClass("hidden"),n("#testConfig .time").addClass("hidden"),n("#testConfig .wordCount").addClass("hidden"),n("#testConfig .customText").addClass("hidden"),n("#testConfig .quoteLength").addClass("hidden"),n("#testConfig .zen").addClass("hidden"),r.mode==="time"?(n("#testConfig .puncAndNum").removeClass("hidden").css({width:"",opacity:""}),n("#testConfig .leftSpacer").removeClass("hidden"),n("#testConfig .rightSpacer").removeClass("hidden"),n("#testConfig .time").removeClass("hidden"),Bo("time",r.time)):r.mode==="words"?(n("#testConfig .puncAndNum").removeClass("hidden").css({width:"",opacity:""}),n("#testConfig .leftSpacer").removeClass("hidden"),n("#testConfig .rightSpacer").removeClass("hidden"),n("#testConfig .wordCount").removeClass("hidden"),Bo("words",r.words)):r.mode==="quote"?(n("#testConfig .rightSpacer").removeClass("hidden"),n("#testConfig .quoteLength").removeClass("hidden"),Bo("quoteLength",r.quoteLength)):r.mode==="custom"&&(n("#testConfig .puncAndNum").removeClass("hidden").css({width:"",opacity:""}),n("#testConfig .leftSpacer").removeClass("hidden"),n("#testConfig .rightSpacer").removeClass("hidden"),n("#testConfig .customText").removeClass("hidden")),Bo("quoteLength",r.quoteLength),Bo("numbers",r.numbers),Bo("punctuation",r.punctuation)}async function P8(e,t){if(e===t)return;B8(t);let a;r.mode==="time"?a=r.time:r.mode==="words"?a=r.words:r.mode==="quote"&&(a=r.quoteLength),a!==void 0&&Bo(r.mode,a);const o={time:"time",words:"wordCount",custom:"customText",quote:"quoteLength",zen:"zen"},i=G(250),s=2,l={both:`inOut(${s})`,in:`in(${s})`,out:`out(${s})`},c={time:!0,words:!0,custom:!0,quote:!1,zen:!1},d=n("#testConfig .puncAndNum");if(c[t]!==c[e]){d.css({width:"unset",opacity:1}).removeClass("hidden");const M=Math.round(d[0]?.getBoundingClientRect().width??0);W(d[0],{width:[(c[e]?M:0)+"px",(c[t]?M:0)+"px"],opacity:{duration:i/2,delay:c[t]?i/2:0,from:c[e]?1:0,to:c[t]?1:0},duration:i,ease:l.both,onComplete:()=>{c[t]?d.css("width","unset"):d.addClass("hidden")}});const w=document.querySelector("#testConfig .leftSpacer");w.style.width="0.5em",w.style.opacity="1",w.classList.remove("hidden"),W(w,{width:[c[e]?"0.5em":0,c[t]?"0.5em":0],duration:i,ease:l.both,onComplete:()=>{c[t]?w.style.width="":w.classList.add("hidden")}})}const u=document.querySelector("#testConfig .rightSpacer");u.style.width="0.5em",u.style.opacity="1",u.classList.remove("hidden"),W(u,{width:[e==="zen"?"0px":"0.5em",t==="zen"?"0px":"0.5em"],duration:i,ease:l.both,onComplete:()=>{t==="zen"?u.classList.add("hidden"):u.style.width=""}});const p=n(`#testConfig .${o[t]}`),g=n(`#testConfig .${o[e]}`),m=Math.round(g[0]?.getBoundingClientRect().width??0);g.addClass("hidden"),p.removeClass("hidden");const h=Math.round(p[0]?.getBoundingClientRect().width??0);g.removeClass("hidden"),p.addClass("hidden");const C=(h-m)/2;await Rt(g[0],{opacity:[1,0],width:[m+"px",m+C+"px"],duration:i/2,ease:l.in}),g.css({opacity:1,width:"unset"}).addClass("hidden"),p.css({opacity:0,width:m+C+"px"}).removeClass("hidden"),await Rt(p[0],{opacity:[0,1],width:[m+C+"px",h+"px"],duration:i/2,ease:l.out})}function B8(e){n("#testConfig .mode .textButton").removeClass("active"),n("#testConfig .mode .textButton[mode='"+e+"']").addClass("active")}function Bo(e,t){if(e==="time"){n("#testConfig .time .textButton").removeClass("active");const a=[15,30,60,120].includes(t)?t:"custom";n("#testConfig .time .textButton[timeConfig='"+a+"']").addClass("active")}else if(e==="words"){n("#testConfig .wordCount .textButton").removeClass("active");const a=[10,25,50,100,200].includes(t)?t:"custom";n("#testConfig .wordCount .textButton[wordCount='"+a+"']").addClass("active")}else e==="quoteLength"?(n("#testConfig .quoteLength .textButton").removeClass("active"),ri(t,[0,1,2,3])?n("#testConfig .quoteLength .textButton[quotelength='all']").addClass("active"):t.forEach(a=>{n("#testConfig .quoteLength .textButton[quoteLength='"+a+"']").addClass("active")})):e==="numbers"?t===!1?n("#testConfig .numbersMode.textButton").removeClass("active"):n("#testConfig .numbersMode.textButton").addClass("active"):e==="punctuation"&&(t===!1?n("#testConfig .punctuationMode.textButton").removeClass("active"):n("#testConfig .punctuationMode.textButton").addClass("active"))}function R8(){n("#testConfig .quoteLength .favorite").removeClass("hidden")}function D8(){n("#testConfig .quoteLength .favorite").addClass("hidden")}let gu=!1;ge((e,t,a,o)=>{e==="fullConfigChange"&&(gu=!0),e==="fullConfigChangeFinished"&&(gu=!1,Rv()),!gu&&X()==="test"&&(e==="mode"?P8(o,t):["time","quoteLength","words","numbers","punctuation"].includes(e)&&t!==void 0&&Bo(e,t))});qa(e=>{e.type==="authStateChanged"&&(e.data.isUserSignedIn?R8():D8())});function Dd(e,t,a,o,i){const s=e==="words"&&(t>=1e3||t===0),l=e==="time"&&(a>=900||a===0),c=e==="custom"&&i,d=e==="custom"&&(o.limit.mode==="word"||o.limit.mode==="section")&&(o.limit.value>=1e3||o.limit.value===0),u=e==="custom"&&o.limit.mode==="time"&&(o.limit.value>=900||o.limit.value===0);return!(s||l||c||d||u)}let L,Da,Xl=!0,io,xn="";function W8(){Xl=!Xl,f(Xl?"on":"off",1),ce&&Mm().then(()=>{ue.update("resize")})}let So=[];async function Mm(){if(L.chartData==="toolong")return;const e=dt(r.typingSpeedUnit);ue.getScale("wpm").title.text=e.fullUnitString;let t=[];for(let u=1;u<=ti.length;u++)Gi&&u===ti.length?t.push(H(L.testDuration).toString()):t.push(u.toString());const a=[...L.chartData.wpm.map(u=>H(e.fromWpm(u)))],o=[...jr.map(u=>H(e.fromWpm(u)))],i=Math.max(...L.chartData.burst)*.25,l=[...ok(L.chartData.burst,1,Xl?i:0).map(u=>H(e.fromWpm(u)))];r.mode!=="time"&&Gi&&L.testDuration%1<.5&&(t.pop(),a.pop(),o.pop()),Da=Math.max(Math.max(...a),Math.max(...o),Math.max(...l));let c=0;r.startGraphsAtZero||(c=Math.min(Math.min(...a),Math.min(...o),Math.min(...l)),c=Math.floor(c/10)*10);const d=await jt("sub");if(r.funbox.length>0){let u="";for(const p of Mo())u+=p.name,p.functions?.getResultContent&&(u+="("+p.functions.getResultContent()+")"),u+=" ";u=u.trimEnd(),So.push({display:!0,id:"funbox-label",type:"line",scaleID:"wpm",value:ue.getScale("wpm").min,borderColor:"transparent",borderWidth:1,borderDash:[2,2],label:{backgroundColor:"transparent",font:{family:r.fontFamily.replace(/_/g," "),size:11,style:"normal",weight:ca.defaults.font.weight,lineHeight:ca.defaults.font.lineHeight},color:d,padding:3,borderRadius:3,position:"start",display:!0,content:`${u}`}})}ue.data.labels=t,ue.getDataset("wpm").data=a,ue.getDataset("wpm").label=r.typingSpeedUnit,ue.getScale("wpm").min=c,ue.getScale("wpm").max=Da,ue.getDataset("raw").data=o,ue.getScale("raw").min=c,ue.getScale("raw").max=Da,ue.getDataset("burst").data=l,ue.getScale("burst").min=c,ue.getScale("burst").max=Da,ue.getDataset("error").data=L.chartData.err,ue.getScale("error").max=Math.max(...L.chartData.err)}async function Dv(){const e=await ci(),a=(await gr(L.mode,L.mode2,L.punctuation??!1,L.numbers??!1,L.language,L.difficulty,L.lazyMode??!1,fr(L.funbox)))?.wpm??0;if(a===0)return;const o=dt(r.typingSpeedUnit),i=H(o.fromWpm(a)).toFixed(2);So.push({display:!0,type:"line",id:"lpb",scaleID:"wpm",value:i,borderColor:e.sub+"55",borderWidth:1,label:{backgroundColor:e.sub,font:{family:r.fontFamily.replace(/_/g," "),size:11,style:"normal",weight:ca.defaults.font.weight,lineHeight:ca.defaults.font.lineHeight},color:e.bg,padding:3,borderRadius:3,position:"center",content:` PB: ${i} `,display:!0}});const s=o.fromWpm(20);Da>=parseFloat(i)-s&&Da<=parseFloat(i)+s&&(Da=Math.round(parseFloat(i)+s)),ue.getScale("wpm").max=Da,ue.getScale("raw").max=Da,ue.getScale("burst").max=Da}function Wv(){let e=!1;if(L.wpm>=1e3&&(e=!0),n("#result .stats .wpm .top .text").text(r.typingSpeedUnit),e?n("#result .stats .wpm .bottom").text("Infinite"):n("#result .stats .wpm .bottom").text(D.typingSpeed(L.wpm)),n("#result .stats .raw .bottom").text(D.typingSpeed(L.rawWpm)),n("#result .stats .acc .bottom").text(L.acc===100?"100%":D.accuracy(L.acc)),r.alwaysShowDecimalPlaces){r.typingSpeedUnit!=="wpm"?(n("#result .stats .wpm .bottom").attr("aria-label",L.wpm.toFixed(2)+" wpm"),n("#result .stats .raw .bottom").attr("aria-label",L.rawWpm.toFixed(2)+" wpm")):(n("#result .stats .wpm .bottom").removeAttr("aria-label"),n("#result .stats .raw .bottom").removeAttr("aria-label"));let t=H(L.testDuration).toFixed(2)+"s";L.testDuration>61&&(t=Ye(H(L.testDuration))),n("#result .stats .time .bottom .text").text(t),n("#result .stats .acc .bottom").attr("aria-label",`${sa.correct} correct
${sa.incorrect} incorrect`)}else{const t={showDecimalPlaces:!0,suffix:` ${r.typingSpeedUnit}`};let a=D.typingSpeed(L.wpm,t),o=D.typingSpeed(L.rawWpm,t);r.typingSpeedUnit!=="wpm"&&(a+=" ("+L.wpm.toFixed(2)+" wpm)",o+=" ("+L.rawWpm.toFixed(2)+" wpm)"),n("#result .stats .wpm .bottom").attr("aria-label",a),n("#result .stats .raw .bottom").attr("aria-label",o),n("#result .stats .acc .bottom").attr("aria-label",`${L.acc===100?"100%":D.percentage(L.acc,{showDecimalPlaces:!0})}
${sa.correct} correct
${sa.incorrect} incorrect`).attr("data-balloon-break","")}}function z8(){n("#result .stats .consistency .bottom").text(D.percentage(L.consistency)),r.alwaysShowDecimalPlaces?n("#result .stats .consistency .bottom").attr("aria-label",D.percentage(L.keyConsistency,{showDecimalPlaces:!0,suffix:" key"})):n("#result .stats .consistency .bottom").attr("aria-label",`${L.consistency}% (${L.keyConsistency}% key)`)}function H8(){const e=H(L.afkDuration/L.testDuration*100);if(n("#result .stats .time .bottom .afk").text(""),e>0&&n("#result .stats .time .bottom .afk").text(e+"% afk"),n("#result .stats .time .bottom").attr("aria-label",`${L.afkDuration}s afk ${e}%`),r.alwaysShowDecimalPlaces){let t=H(L.testDuration).toFixed(2)+"s";L.testDuration>61&&(t=Ye(H(L.testDuration))),n("#result .stats .time .bottom .text").text(t)}else{let t=Math.round(L.testDuration)+"s";L.testDuration>61&&(t=Ye(Math.round(L.testDuration))),n("#result .stats .time .bottom .text").text(t),n("#result .stats .time .bottom").attr("aria-label",`${H(L.testDuration)}s (${L.afkDuration}s afk ${e}%)`)}}function O8(){n("#result .stats .time .bottom .timeToday").text(Y6())}function N8(){n("#result .stats .key .bottom").text(L.charStats[0]+"/"+L.charStats[1]+"/"+L.charStats[2]+"/"+L.charStats[3])}function Zl(e){Pv(),Bv(e)}function sr(e,t=!1){n("#result .stats .wpm .crown").attr("aria-label",e),n("#result .stats .wpm .crown").attr("data-balloon-length",t?"medium":"")}async function U8(e){if(r.mode==="quote"||e){vf();return}let t=0;const a=await zv();if(console.debug("Result can get PB:",a.value,a.reason??""),a.value){const o=await gr(r.mode,L.mode2,r.punctuation,r.numbers,r.language,r.difficulty,r.lazyMode,Mo()),i=o?.wpm??0;t=L.wpm-i,console.debug("Local PB",o,"diff",t),t<=0?(vf(),console.debug("Hiding crown")):(console.debug("Showing pending crown"),Zl("pending"),sr("+"+D.typingSpeed(t,{showDecimalPlaces:!0})))}else{const o=await gr(r.mode,L.mode2,r.punctuation,r.numbers,r.language,r.difficulty,r.lazyMode,[]),i=o?.wpm??0;t=L.wpm-i,console.debug("Local PB",o,"diff",t),t<=0?(console.debug("Showing warning crown"),Zl("warning"),sr(`This result is not eligible for a new PB (${a.reason})`,!0)):(console.debug("Showing ineligible crown"),Zl("ineligible"),sr(`You could've gotten a new PB (+${D.typingSpeed(t,{showDecimalPlaces:!0})}), but your config does not allow it (${a.reason})`,!0))}}function vf(){E8(),sr("")}function V8(){q8()==="pending"&&(Pv(),Bv("error"),sr("Local PB data is out of sync with the server - please refresh (pb mismatch)",!0))}async function zv(){const e=L.funbox,a=fr(L.funbox).every(l=>l?.canGetPb),o=e.length===0||a,i=r.stopOnError==="letter"&&L.acc<100,s=!L.bailedOut;return o&&!i&&s?{value:!0}:o?i?{value:!1,reason:"stop on letter"}:s?{value:!1,reason:"unknown"}:{value:!1,reason:"bailed out"}:{value:!1,reason:"funbox"}}function Hv(){if(hm())return;const e=getComputedStyle(document.body),t=[e.getPropertyValue("--main-color"),e.getPropertyValue("--text-color"),e.getPropertyValue("--sub-color")],a=Date.now()+125;(function o(){_g({particleCount:5,angle:60,spread:75,origin:{x:0},colors:t}),_g({particleCount:5,angle:120,spread:75,origin:{x:1},colors:t}),Date.now()<a&&requestAnimationFrame(o)})()}async function K8(e){const t=[],a=S()?.tags?.length??0;try{S()?.tags?.forEach(s=>{s.active===!0&&t.push(s)})}catch{}a===0?n("#result .stats .tags").addClass("hidden"):n("#result .stats .tags").removeClass("hidden"),t.length===0?n("#result .stats .tags .bottom").html("<div class='noTags'>no tags</div>"):n("#result .stats .tags .bottom").text(""),n("#result .stats .tags .editTagsButton").attr("data-result-id",""),n("#result .stats .tags .editTagsButton").attr("data-active-tag-ids",t.map(s=>s._id).join(",")),n("#result .stats .tags .editTagsButton").addClass("invisible");let o="start",i=15;for(const s of t){const l=await wy(s._id,r.mode,L.mode2,r.punctuation,r.numbers,r.language,r.difficulty,r.lazyMode);n("#result .stats .tags .bottom").append(`
      <div tagid="${s._id}" aria-label="PB: ${l}" data-balloon-pos="up">${s.display}<i class="fas fa-crown hidden"></i></div>
    `);const c=dt(r.typingSpeedUnit);if(r.mode!=="quote"&&!e&&(await zv()).value)if(l<L.wpm)await WS(s._id,r.mode,L.mode2,r.punctuation,r.numbers,r.language,r.difficulty,r.lazyMode,L.wpm,L.acc,L.rawWpm,L.consistency),n(`#result .stats .tags .bottom div[tagid="${s._id}"] .fas`).removeClass("hidden"),n(`#result .stats .tags .bottom div[tagid="${s._id}"]`).attr("aria-label","+"+H(L.wpm-l));else{const d=await ci();So.push({display:!0,type:"line",id:"tpb",scaleID:"wpm",value:c.fromWpm(l),borderColor:d.sub+"55",borderWidth:1,label:{backgroundColor:d.sub,font:{family:r.fontFamily.replace(/_/g," "),size:11,style:"normal",weight:ca.defaults.font.weight,lineHeight:ca.defaults.font.lineHeight},color:d.bg,padding:3,borderRadius:3,position:o,xAdjust:i,display:!0,content:`${s.display} PB: ${H(c.fromWpm(l)).toFixed(2)}`}}),o==="start"?(o="end",i=-15):(o="start",i=15)}}}function j8(e){let t="";t+=r.mode,r.mode==="time"?t+=" "+r.time:r.mode==="words"?t+=" "+r.words:r.mode==="quote"&&e?.group!==void 0&&(t+=" "+["short","medium","long","thicc"][e.group]);const a=ui("ignoresLanguage");r.mode!=="custom"&&!a&&(t+="<br>"+Aa(L.language)),r.punctuation&&(t+="<br>punctuation"),r.numbers&&(t+="<br>numbers"),r.blindMode&&(t+="<br>blind"),r.lazyMode&&(t+="<br>lazy"),r.funbox.length>0&&(t+="<br>"+r.funbox.map(o=>o.replace(/_/g," ")).join(", ")),r.difficulty==="expert"?t+="<br>expert":r.difficulty==="master"&&(t+="<br>master"),r.stopOnError!=="off"&&(t+=`<br>stop on ${r.stopOnError}`),n("#result .stats .testType .bottom").html(t)}function G8(e,t,a,o,i){let s="";if(e&&(s+=`<br>failed (${t})`),a&&(s+="<br>afk detected"),im){s+="<br>invalid";const l=[];(L.wpm<0||L.wpm>350&&L.mode!=="words"&&L.mode2!=="10"||L.wpm>420&&L.mode==="words"&&L.mode2==="10")&&l.push("wpm"),(L.rawWpm<0||L.rawWpm>350&&L.mode!=="words"&&L.mode2!=="10"||L.rawWpm>420&&L.mode==="words"&&L.mode2==="10")&&l.push("raw"),(L.acc<75||L.acc>100)&&l.push("accuracy"),l.length>0&&(s+=` (${l.join(",")})`)}o&&(s+="<br>repeated"),L.bailedOut&&(s+="<br>bailed out"),i&&(s+="<br>too short"),s===""?n("#result .stats .info").addClass("hidden"):(n("#result .stats .info").removeClass("hidden"),s=s.substring(4),n("#result .stats .info .bottom").html(s))}function Q8(e){if(r.mode==="quote"){if(e===null){console.error("Failed to update quote rating button: randomQuote is null");return}const t=S()?.quoteRatings?.[e.language]?.[e.id];fe(t)&&n(".pageTest #result #rateQuoteButton .icon").removeClass("far").addClass("fas"),Lv(e).then(a=>{n(".pageTest #result #rateQuoteButton .rating").text(a?.average?.toFixed(1)??"")}).catch(a=>{n(".pageTest #result #rateQuoteButton .rating").text("?")}),n(".pageTest #result #rateQuoteButton").css({opacity:0}).removeClass("hidden").css({opacity:1})}}function Y8(e){const t=n(".pageTest #result #favoriteQuoteButton .icon");if(r.mode!=="quote"||!A()){t.parent().addClass("hidden");return}if(e===null){console.error("Failed to update quote favorite button: randomQuote is null");return}io=r.mode==="quote"?e.language:void 0,xn=r.mode==="quote"?e.id.toString():"";const a=ct.isQuoteFavorite(e);t.removeClass(a?"far":"fas").addClass(a?"fas":"far"),t.parent().removeClass("hidden")}function J8(e){r.mode==="quote"?(n("#result .stats .source").removeClass("hidden"),n("#result .stats .source .bottom").html(e?.source??"Error: Source unknown")):n("#result .stats .source").addClass("hidden")}async function X8(e,t,a,o,i,s,l,c){So=[],L=structuredClone(e),vf(),n("#resultWordsHistory .words").empty(),n("#result #resultWordsHistory").addClass("hidden"),n("#retrySavingResultButton").addClass("hidden"),n(".pageTest #result #rateQuoteButton .icon").removeClass("fas").addClass("far"),n(".pageTest #result #rateQuoteButton .rating").text(""),n(".pageTest #result #rateQuoteButton").addClass("hidden"),n("#words").removeClass("blurred"),n("#wordsInput").trigger("blur"),n("#result .stats .time .bottom .afk").text(""),A()?n("#result .loginTip").addClass("hidden"):n("#result .loginTip").removeClass("hidden"),r.ads==="off"||r.ads==="result"?n("#result #watchVideoAdButton").addClass("hidden"):n("#result #watchVideoAdButton").removeClass("hidden"),Wv(),z8(),H8(),N8(),j8(l),J8(l),Y8(l),await U8(c),await Mm(),await Dv(),await K8(c),Ov(),G8(t,a,o,i,s),ue.options.plugins.annotation.annotations=So,ue.updateColors(),ue.resize(),n("#result .stats .tags").hasClass("hidden")&&n("#result .stats .info").hasClass("hidden")?n("#result .stats .infoAndTags").addClass("hidden"):n("#result .stats .infoAndTags").removeClass("hidden"),Sh()?(n("main #result .noStressMessage").remove(),n("main #result").prepend(`

      <div class='noStressMessage' style="
        text-align: center;
        grid-column: 1/3;
        font-size: 2rem;
        padding-bottom: 2rem;
      ">
      <i class="fas fa-check"></i>
      </div>

    `),n("main #result .stats").addClass("hidden"),n("main #result .chart").addClass("hidden"),n("main #result #resultWordsHistory").addClass("hidden"),n("main #result #resultReplay").addClass("hidden"),n("main #result .loginTip").addClass("hidden"),n("main #result #showWordHistoryButton").addClass("hidden"),n("main #result #watchReplayButton").addClass("hidden"),n("main #result #saveScreenshotButton").addClass("hidden"),console.log(`Test Completed: ${L.wpm} wpm ${L.acc}% acc ${L.rawWpm} raw ${L.consistency}% consistency`)):(n("main #result .stats").removeClass("hidden"),n("main #result .chart").removeClass("hidden"),A()||n("main #result .loginTip").removeClass("hidden"),n("main #result #showWordHistoryButton").removeClass("hidden"),n("main #result #watchReplayButton").removeClass("hidden"),n("main #result #saveScreenshotButton").removeClass("hidden")),F8(),jn(document.querySelector("#typingTest"),document.querySelector("#result"),250,async()=>{const d=document.querySelector("#result");d?.focus({preventScroll:!0}),Ib(d),S8(),M0(!1),n("#words").empty(),ue.resize()},async()=>{_a(!1);const d=Dd(r.mode,r.words,r.time,Co(),Xa()??!1);r.alwaysShowWordsHistory&&d&&!Sh()&&tm(!0),Wc(!0),qn()})}const wf=new pt({key:"resultChartDataVisibility",schema:q.object({raw:q.boolean(),burst:q.boolean(),errors:q.boolean(),pbLine:q.boolean(),tagPbLine:q.boolean()}).strict(),fallback:{raw:!0,burst:!0,errors:!0,pbLine:!0,tagPbLine:!0}});function Ov(e=!1){const t=wf.get();ue.getDataset("raw").hidden=!t.raw,ue.getDataset("burst").hidden=!t.burst,ue.getDataset("error").hidden=!t.errors;for(const i of So)i.id==="lpb"?i.display=t.pbLine:i.id==="tpb"&&(i.display=t.tagPbLine);e&&ue.update();const a=n(".pageTest #result .chart .chartLegend button"),o=So.some(i=>i.id==="tpb");for(const i of a){const s=n(i).data("id");if(s!=="raw"&&s!=="burst"&&s!=="errors"&&s!=="pbLine"&&s!=="tagPbLine")return;n(i).toggleClass("active",t[s]),s==="pbLine"?n(i).toggleClass("hidden",!A()):s==="tagPbLine"&&n(i).toggleClass("hidden",!A()||!o)}}function Z8(e,t){const a=[];if(e.length>0)for(const o of e)S()?.tags?.forEach(i=>{o===i._id&&a.push(i.display)});if(e.length===0)n(".pageTest #result .tags .bottom").html("<div class='noTags'>no tags</div>");else{n(".pageTest #result .tags .bottom div.noTags").remove();const o=n(".pageTest #result .tags .bottom div[tagid]"),i=[];o.each((l,c)=>{const d=n(c).attr("tagid");e.includes(d)?i.push(d):n(c).remove()});let s="";e.forEach((l,c)=>{i.includes(l)||(t.includes(l)?s+=`<div tagid="${l}" data-balloon-pos="up">${a[c]}<i class="fas fa-crown"></i></div>`:s+=`<div tagid="${l}">${a[c]}</div>`)}),n(".pageTest #result .tags .bottom").append(s),n(".pageTest #result .tags .top .editTagsButton").attr("active-tag-ids",e.join(","))}}n(".pageTest #result .chart .chartLegend button").on("click",e=>{const a=n(e.target).data("id");if(a!=="raw"&&a!=="burst"&&a!=="errors"&&a!=="pbLine"&&a!=="tagPbLine")return;const o=wf.get();o[a]=!o[a],wf.set(o),Ov(!0)});n(".pageTest #favoriteQuoteButton").on("click",async()=>{if(io===void 0||xn===""){f("Could not get quote stats!",-1);return}const e=n(".pageTest #favoriteQuoteButton .icon"),t=S();if(t)if(e.hasClass("fas")){Z();const a=await T.users.removeQuoteFromFavorites({body:{language:io,quoteId:xn}});if(N(),f(a.body.message,a.status===200?1:-1),a.status===200){e.removeClass("fas").addClass("far");const o=t.favoriteQuotes?.[io]?.indexOf(xn);t.favoriteQuotes?.[io]?.splice(o,1)}}else{Z();const a=await T.users.addQuoteToFavorites({body:{language:io,quoteId:xn}});N(),f(a.body.message,a.status===200?1:-1),a.status===200&&(e.removeClass("far").addClass("fas"),t.favoriteQuotes===void 0&&(t.favoriteQuotes={}),t.favoriteQuotes[io]||(t.favoriteQuotes[io]=[]),t.favoriteQuotes[io]?.push(xn))}});ge(async e=>{["typingSpeedUnit","startGraphsAtZero"].includes(e)&&ce&&(So=[],Wv(),await Mm(),await Dv(),Hn(),ue.options.plugins.annotation.annotations=So,ue.updateColors(),ue.resize())});const V={particles:[],rendering:!1},e9=1e3,t9=.05,a9=4,o9=.6,ql=1500,yn=.3,xh=[6,3],Il=10;function i9(){const e=document.createElement("canvas");return e.style.cssText="position:fixed;top:0;left:0;pointer-events:none;z-index:999999",e.height=window.innerHeight,e.width=window.innerWidth,window.addEventListener("resize",()=>{e.height=window.innerHeight,e.width=window.innerWidth}),document.body.appendChild(e),e}function n9(e,t,a){return{x:e,y:t,color:a,alpha:1,prev:{x:e,y:t},vel:{x:ql-Math.random()*ql*2,y:ql-Math.random()*ql*2}}}function s9(e){!V.canvas||!fe(V.deltaTime)||(e.prev.x=e.x,e.prev.y=e.y,e.x+=e.vel.x*V.deltaTime,e.y+=e.vel.y*V.deltaTime,e.x>V.canvas.width?(e.vel.x*=-yn,e.x=V.canvas.width-(e.x-V.canvas.width)*yn):e.x<0&&(e.vel.x*=-yn,e.x*=-yn),e.y>V.canvas.height?(e.vel.y*=-yn,e.y=V.canvas.height-(e.y-V.canvas.height)*yn):e.y<0&&(e.vel.y*=-1,e.y*=-1),e.vel.y+=e9*V.deltaTime,e.vel.x*=1-t9*V.deltaTime,e.alpha*=1-o9*V.deltaTime)}function r9(){V.caret=n("#caret"),V.canvas=i9(),V.context2d=V.canvas.getContext("2d")}function Nv(){if(!fe(V.lastFrame)||!V.context2d||!V.canvas)return;V.rendering=!0;const e=Date.now();V.deltaTime=(e-V.lastFrame)/1e3,V.lastFrame=e,V.context2d.clearRect(0,0,V.canvas.width,V.canvas.height);const t=[];for(const a of V.particles)a.alpha<.1||(s9(a),V.context2d.globalAlpha=a.alpha,V.context2d.strokeStyle=a.color,V.context2d.lineWidth=a9,V.context2d.beginPath(),V.context2d.moveTo(Math.round(a.prev.x),Math.round(a.prev.y)),V.context2d.lineTo(Math.round(a.x),Math.round(a.y)),V.context2d.stroke(),t.push(a));V.particles=t,V.particles.length&&!hm()?requestAnimationFrame(Nv):(V.context2d.clearRect(0,0,V.canvas.width,V.canvas.height),V.rendering=!1)}function Uv(e=!1){if(!fe(V.resetTimeOut))return;delete V.resetTimeOut,clearTimeout(V.resetTimeOut);const t=n(document.body);t.css("transition","all .25s, transform 0.8s"),t.css("transform","translate(0,0)"),setTimeout(()=>{t.css("transition","all .25s, transform .05s"),n("html").css("overflow","inherit"),n("html").css("overflow-y","scroll")},e?0:1e3)}function l9(){V.rendering||(V.lastFrame=Date.now(),Nv())}function c9(){const e=Math.floor(Math.random()*256).toString(16),t=Math.floor(Math.random()*256).toString(16),a=Math.floor(Math.random()*256).toString(16);return`#${e}${t}${a}`}async function Vv(e=!0,t=!1){if(r.monkeyPowerLevel==="off"||hm())return;if(r.blindMode&&(e=!0),["3","4"].includes(r.monkeyPowerLevel)){n("html").css("overflow","hidden");const i=[Math.round(Il-Math.random()*Il),Math.round(Il-Math.random()*Il)];n(document.body).css("transform",`translate(${i[0]}px, ${i[1]}px)`),fe(V.resetTimeOut)&&clearTimeout(V.resetTimeOut),V.resetTimeOut=setTimeout(Uv,2e3)}const a=V.caret?.offset(),o=[a?.left??0,(a?.top??0)+(V.caret?.height()??0)];for(let i=Math.round((xh[0]+Math.random()*xh[1])*(t?2:1));i>0;i--){const s=["2","4"].includes(r.monkeyPowerLevel)?c9():e?await jt("caret"):await jt("error");V.particles.push(n9(...o,s))}l9()}const d9={laborers:"labourers",industrialized:"industrialised",acclimatizing:"acclimatising",acclimatized:"acclimatised",behoove:"behove",reorganization:"reorganisation",galvanize:"galvanise",demagogism:"demagoguism",canceled:"cancelled",baptize:"baptise",revitalize:"revitalise",skeptical:"sceptical",piscine:"piscinae",ionization:"ionisation",chili:"chilli",dexterous:"dextrous",likable:"likeable",neutralize:"neutralise",meter:"metre",meters:"metres",centimeter:"centimetre",hurrah:"hooray",multicolor:"multicolour",actualization:"actualisation",fertilizing:"fertilising",enamor:"enamour",skepticism:"scepticism",authorize:"authorise",minimize:"minimise",bandoleer:"bandolier",rigor:"rigour",fledgling:"fledgeling",mesquite:"mesquit",fogy:"fogey",characterize:"characterise",wagonette:"waggonette",plagiarize:"plagiarise",kilometers:"kilometres",molt:"moult",leveler:"leveller",checkered:"chequered",vendor:"vender",candor:"candour",moralize:"moralise",denationalization:"denationalisation",anemia:"anaemia",caiman:"cayman",chitterlings:"chitlins",acclimated:"acclimatised",acclimate:"acclimatise",skillful:"skilful",enamored:"enamoured",watercolor:"watercolour",extemporization:"extemporisation",lackluster:"lacklustre",equalizer:"equaliser",cipher:"cypher",polarization:"polarisation",polymerization:"polymerisation",ionize:"ionise",anesthetic:"anaesthetic",aerie:"eyrie",lachrymal:"lacrimal",decimeter:"decimetre",rajah:"raja",modernize:"modernise",gasoline:"petrol",alphabetized:"alphabetised",saber:"sabre",burglarize:"burglarise",terrorize:"terrorise",enthrall:"enthral",mustachioed:"moustachioed",anesthesia:"anaesthesia",sepulcher:"sepulchre",caftan:"kaftan",organize:"organise",manikin:"mannikin",dexterously:"dextrously",artifact:"artefact",kilometer:"kilometre",mommy:"mummy",brant:"brent",hyena:"hyaena",fuze:"fuse",victimize:"victimise",jihad:"jehad",airplane:"aeroplane",laborer:"labourer",vaporware:"vapourware",worshiped:"worshipped",taboret:"tabouret",rationalize:"rationalise",whimsy:"whimsey",scandalize:"scandalise",categorization:"categorisation",centered:"centred",kerosene:"kerosine",specialize:"specialise",specialized:"specialised",cicatrix:"cicatrice",jailer:"jailor",unfavorable:"unfavourable",guerrilla:"guerilla",emphasize:"emphasise",wacky:"whacky",ionizing:"ionising",czarina:"tzarina",ratline:"ratlin",abolitionize:"abolitionise",subsidize:"subsidise",plowing:"ploughing",untrammeled:"untrammelled",worshiping:"worshipping",memorization:"memorisation",anglicize:"anglicise",finalize:"finalise",gases:"gasses",fertilization:"fertilisation",libeling:"libelling",kinesthetic:"kinaesthetic",immunization:"immunisation",coloration:"colouration",overdraft:"overdraught",lambaste:"lambast",unpasteurized:"unpasteurised",ascendance:"ascendence",jeweler:"jeweller",fervor:"fervour",jeopardize:"jeopardise",abridgment:"abridgement",monopolize:"monopolise",colorless:"colourless",colorlessness:"colourlessness",tumors:"tumours",jinni:"jinn",aluminum:"aluminium",salable:"saleable",bronco:"broncho",lupine:"lupin",linchpin:"lynchpin",mesmerize:"mesmerise",internationalization:"internationalisation",anapestic:"anapaestic",supersede:"supercede",europeanize:"europeanise",optimized:"optimised",botanize:"botanise",organizational:"organisational",heme:"haem",estivation:"aestivation",edema:"oedema",penalize:"penalise",peddler:"pedlar",biased:"biassed",aggrandize:"aggrandise",rationalizing:"rationalising",deputize:"deputise",centers:"centres",unicolor:"unicolour",hypnotized:"hypnotised",anglicized:"anglicised",initialization:"initialisation",topee:"topi",nightie:"nighty",tricolor:"tricolour",reorganize:"reorganise",barbecue:"barbeque",fertilized:"fertilised",synthesize:"synthesise",economize:"economise",colter:"coulter",paleontologist:"palaeontologist",acclimatize:"acclimatise",idealize:"idealise",fossilization:"fossilisation",lionize:"lionise",acclimating:"acclimatising",luster:"lustre",demeanor:"demeanour",unauthorized:"unauthorised",smolder:"smoulder",abettor:"abetter",jewelry:"jewellery",demoralization:"demoralisation",fullness:"fulness",neighbored:"neighboured",neighbor:"neighbour",neighbors:"neighbours",neighboring:"neighbouring",neighborly:"neighbourly",neighborhood:"neighbourhood",neighborhoods:"neighbourhoods",magnetizer:"magnetiser",appetizer:"appetiser",hebraizing:"hebraising",carbonization:"carbonisation",favorably:"favourably",favorite:"favourite",behavioral:"behavioural",cognizant:"cognisant",skeptic:"sceptic",fiber:"fibre",fibers:"fibres",labeled:"labelled",analyze:"analyse",disorganization:"disorganisation",concenter:"concentre",categorize:"categorise",novelization:"novelisation",proselytize:"proselytise",draftsman:"draughtsman",paralyze:"paralyse",ostracize:"ostracise",italicize:"italicise",micrometer:"micrometre",cognizance:"cognisance",saltpeter:"saltpetre",conceptualization:"conceptualisation",containerization:"containerisation",anapest:"anapaest",leukemia:"leukaemia",omelet:"omelette",industrialize:"industrialise",characterization:"characterisation",amortize:"amortise",mazurka:"mazourka",macadamize:"macadamise",stymie:"stymy",analog:"analogue",prizer:"priser",cauterize:"cauterise",dysmenorrhea:"dysmenorrhoea",hippie:"hippy",mechanization:"mechanisation",commercialize:"commercialise",unsavory:"unsavoury",somber:"sombre",esophageal:"oesophageal",iodized:"iodised",tyrannize:"tyrannise",liberalize:"liberalise",computerization:"computerisation",synthesizer:"synthesiser",fertilizes:"fertilises",airdrome:"aerodrome",uncivilized:"uncivilised",mold:"mould",nitrogenized:"nitrogenised",legalize:"legalise",tantalize:"tantalise",eulogize:"eulogise",depolarization:"depolarisation",fecal:"faecal",bastardize:"bastardise",summarize:"summarise",cony:"coney",authorization:"authorisation",colorful:"colourful",temporized:"temporised",adviser:"advisor",tendinitis:"tendonitis",crystallization:"crystallisation",humor:"humour",humorous:"humourous",chanty:"shanty",dyspnea:"dyspnoea",aging:"ageing",mousy:"mousey",succor:"succour",distill:"distil",decentralization:"decentralisation",cauterization:"cauterisation",specter:"spectre",snowplow:"snowplough",pediatrics:"paediatrics",discoloration:"discolouration",tumor:"tumour",empathize:"empathise",pawpaw:"papaya",aggrandizement:"aggrandisement",fontanel:"fontanelle",brunet:"brunette",rumor:"rumour",epaulet:"epaulette",glycerin:"glycerine",fraternize:"fraternise",latinize:"latinise",sniveling:"snivelling",pasteurize:"pasteurise",modernization:"modernisation",patronize:"patronise",totaled:"totalled",normalization:"normalisation",niter:"nitre",shoveler:"shoveller",flier:"flyer",equalization:"equalisation",meagerly:"meagrely",favoritism:"favouritism",libelous:"libellous",popularized:"popularised",armory:"armoury",humanization:"humanisation",minuscule:"miniscule",collectible:"collectable",tepee:"teepee",stabilization:"stabilisation",moldy:"mouldy",colonize:"colonise",idealized:"idealised",meager:"meagre",armorer:"armourer",vitalize:"vitalise",fossilized:"fossilised",antagonize:"antagonise",criticize:"criticise",liter:"litre",stigmatize:"stigmatise",theorize:"theorise",combated:"combatted",desalination:"desalinisation",evangelize:"evangelise",idolization:"idolisation",smoldering:"smouldering",commercialization:"commercialisation",laureled:"laurelled",hematology:"haematology",fulfill:"fulfil",disorganized:"disorganised",accouterments:"accoutrements",busses:"buses",utilize:"utilise",enroll:"enrol",goiter:"goitre",stylized:"stylised",diarrhea:"diarrhoea",hypothesize:"hypothesise",esthetic:"aesthetic",dishonor:"dishonour",victualer:"victualler",paleolithic:"palaeolithic",sanatorium:"sanitarium",feminization:"feminisation",flotation:"floatation",teetotaler:"teetotaller",feudalization:"feudalisation",visualize:"visualise",fertilize:"fertilise",czar:"tzar",nationalization:"nationalisation",septicemia:"septicaemia",organizer:"organiser",recrystallization:"recrystallisation",dolor:"dolour",agonizing:"agonising",romanization:"romanisation",synchronize:"synchronise",amorist:"amourist",agonized:"agonised",belabor:"belabour",caster:"castor",softy:"softie",apothegm:"apophthegm",demobilization:"demobilisation",agonizes:"agonises",misdemeanor:"misdemeanour",recognizable:"recognisable",asshole:"arsehole",brutalization:"brutalisation",chamois:"shammy",clamor:"clamour",fertilizer:"fertiliser",deodorization:"deodorisation",privatization:"privatisation",tidbit:"titbit",molding:"moulding",alleluia:"halleluiah",canonization:"canonisation",customize:"customise",customization:"customisations",customizer:"customiser",customizers:"customisers",customizes:"customises",customizing:"customising",popularize:"popularise",specialty:"speciality",meagerness:"meagreness",esophagus:"oesophagus",millimeter:"millimetre",harmonization:"harmonisation",atomizer:"atomiser",dieresis:"diaeresis",maneuver:"manoeuvre",capitalize:"capitalise",gynecologist:"gynaecologist",acclimation:"acclimatisation",generalize:"generalise",temporize:"temporise",premunire:"praemunire",estival:"aestival",selvage:"selvedge",brier:"briar",hyperesthesia:"hyperaesthesia",maximize:"maximise",draftsmen:"draughtsmen",colonization:"colonisation",capitalization:"capitalisation",tenia:"taenia",paleontology:"palaeontology",libeler:"libeller",arytenoid:"arytaenoid",wainscoting:"wainscotting",globalization:"globalisation",legalization:"legalisation",magnetization:"magnetisation",stabilize:"stabilise",mesmerized:"mesmerised",savory:"savoury",reconnoiter:"reconnoitre",bastardized:"bastardised",rancor:"rancour",checker:"chequer",industrialization:"industrialisation",epitomize:"epitomise",socialize:"socialise",externalization:"externalisation",chivy:"chivvy",optimize:"optimise",romanize:"romanise",vulcanize:"vulcanise",plow:"plough",memorize:"memorise",sterilization:"sterilisation",routing:"routeing",raveling:"ravelling",savor:"savour",harmonize:"harmonise",cannibalize:"cannibalise",vaporize:"vaporise",utilization:"utilisation",hybridization:"hybridisation",mechanize:"mechanise",arbor:"arbour",arbors:"arbours",licorice:"liquorice",counselor:"counsellor",orthopedic:"orthopaedic",lusterless:"lustreless",numskull:"numbskull",paleozoic:"palaeozoic",malodor:"malodour",amenorrhea:"amenorrhoea",criticized:"criticised",gonorrhea:"gonorrhoea",fossilize:"fossilise",revolutionize:"revolutionise",woolen:"woollen",dishabille:"deshabille",organdy:"organdie",asses:"arses",furor:"furore",paycheck:"paycheque",pulverize:"pulverise",dramatization:"dramatisation",yodeler:"yodeller",apologize:"apologise",apologized:"apologised",blond:"blonde",oxidize:"oxidise",extemporize:"extemporise",whiz:"whizz",edile:"aedile",appall:"appal",legitimize:"legitimise",urbanization:"urbanisation",magnetize:"magnetise",womanize:"womanise",orthopedics:"orthopaedics",cognize:"cognise",christianization:"christianisation",vocalize:"vocalise",individualization:"individualisation",hemoglobin:"haemoglobin",racket:"racquet",agonize:"agonise",aggrandizes:"aggrandises",accouter:"accoutre",mollusk:"mollusc",publicize:"publicise",fraternization:"fraternisation",odorless:"odourless",odor:"odour",odorous:"odourous",rationalization:"rationalisation",pretense:"pretence",louver:"louvre",kopeck:"kopek",lissome:"lissom",idealization:"idealisation",nosy:"nosey",stogie:"stogy",althea:"althaea",immobilization:"immobilisation",majolica:"maiolica",savior:"saviour",civilize:"civilise",granddad:"grandad",centralization:"centralisation",localization:"localisation",evangelization:"evangelisation",ruble:"rouble",pajamas:"pyjamas",sterilize:"sterilise",math:"maths",localize:"localise",hospitalization:"hospitalisation",scrutinize:"scrutinise",acclimatization:"acclimatisation",misbehavior:"misbehaviour",behavior:"behaviour",color:"colour",tire:{britishWord:"tyre",exceptPreviousWords:["will"]},gray:"grey",grays:"greys",theater:"theatre",amphitheater:"amphitheatre",center:"centre",realize:"realise",realizing:"realising",realization:"realisation",license:"licence",mom:"mum","mom'l":"mum'll",favor:"favour",favors:"favours",favorites:"favourites",analyzed:"analysed",characterized:"characterised",colored:"coloured",colors:"colours",counseling:"counselling",customized:"customised",defense:"defence",offense:"offence",enrollment:"enrolment",flavor:"flavour",flavors:"flavours",flavoring:"flavouring",harbor:"harbour",harbored:"harboured",honor:"honour",honors:"honours",labor:"labour",licensed:"licenced",licenses:"licences",licensing:"licencing",modeling:"modelling",optimization:"optimisation",organization:"organisation",organizations:"organisations",organized:"organised",organizing:"organising",pediatric:"paediatric",personalized:"personalised",practice:"practise",realized:"realised",recognize:"recognise",recognized:"recognised",specialties:"specialities",specializing:"specialising",theaters:"theatres",travelers:"travellers",traveler:"traveller",traveling:"travelling",authorized:"authorised",behaviors:"behaviours",traveled:"travelled",utilizing:"utilising",utilized:"utilised",honored:"honoured",specializes:"specialises",practicing:"practising",signaling:"signalling",analyzing:"analysing",recognizes:"recognises",organizers:"organisers",visualization:"visualisation",standardized:"standardised",favorable:"favourable",analyzer:"analyser",recognizing:"recognising",uncategorized:"uncategorised",categorized:"categorised",vapor:"vapour",synchronization:"synchronisation",synchronized:"synchronised",rumors:"rumours",coloring:"colouring",honorable:"honourable",generalized:"generalised",generalization:"generalisation",mobilize:"mobilise",armor:"armour",armored:"armoured",labeling:"labelling",endeavor:"endeavour",civilized:"civilised",civilization:"civilisation",parlor:"parlour",tranquilize:"tranquilise",tranquillized:"tranquillised",tranquillization:"tranquillisation",catalog:"catalogue",cataloger:"cataloguer",cataloging:"cataloguing",catalogs:"catalogues",cataloged:"catalogued",uncataloged:"uncatalogued",catalogers:"cataloguers",discolored:"discoloured",discolor:"discolour",encyclopedias:"encyclopaedias",endeavored:"endeavoured",endeavors:"endeavours",endeavoring:"endeavouring",judgments:"judgements",judgment:"judgement",paneling:"panelling",defenses:"defences",criticizing:"criticising",mustache:"moustache",emphasized:"emphasised",emphasizes:"emphasises",emphasizing:"emphasising",fetus:"foetus",programs:"programmes",yogurt:"yoghurt",valor:"valour",moisturize:"moisturise",moisturized:"moisturised",moisturizes:"moisturises",moisturizing:"moisturising",favoring:"favouring",marvelous:"marvellous"};async function Kv(e,t){if(e.includes('"')&&(e=e.replace(/"/g,"'")),e.includes("-"))return(await Promise.all(e.split("-").map(async a=>Kv(a,t)))).join("-");{const a=e.replace(/^[\W]+|[\W]+$/g,"").toLowerCase(),o=d9[a];if(o===void 0)return e;const[i,s]=typeof o=="string"?[o,[]]:[o.britishWord,o.exceptPreviousWords];return r.mode==="quote"&&s.includes(t)?e:e.replace(RegExp(`^(?:([\\W]*)(${a})([\\W]*))$`,"gi"),(l,c,d,u)=>c+(d.charAt(0)===d.charAt(0).toUpperCase()?d===d.toUpperCase()?i.toUpperCase():ln(i):i)+u)}}const u9=[["áàâäåãąą́āą̄ă","a"],["éèêëẽęę́ēę̄ėě","e"],["íìîïĩįį́īį̄ı","i"],["óòôöøõóōǫǫ́ǭő","o"],["úùûüŭũúūůű","u"],["ńň","n"],["çĉčć","c"],["řŕṛ","r"],["ďđḍ","d"],["ťțṭ","t"],["ṃ","m"],["æ","ae"],["œ","oe"],["ẅŵ","w"],["ĝğg̃","g"],["ĥ","h"],["ĵ","j"],["ńṇṅ","n"],["ŝśšșşṣ","s"],["ß","ss"],["żźž","z"],["ÿỹýÿŷ","y"],["łľĺ","l"],["أإآ","ا"],["َ",""],["ُ",""],["ِ",""],["ْ",""],["ً",""],["ٌ",""],["ٍ",""],["ّ",""],["ё","е"],["ά","α"],["έ","ε"],["ί","ι"],["ύ","υ"],["ό","ο"],["ή","η"],["ώ","ω"],["þ","th"]],f9=new Map(u9.flatMap(e=>[...e[0]].map(t=>[t,e[1]])));function p9(e,t){const a=e.toLowerCase(),o=new Map(t?.flatMap(d=>[...d[0]].map(u=>[u,d[1]]))??[]),i=f9.get(a[0]),s=o.get(a[0]),l=i!==void 0?[a[0],i]:void 0;return(s!==void 0?[a[0],s]:void 0)??l}function Th(e,t){if(!e)return e;const a=e.toUpperCase(),o=[...e].map((l,c)=>l===a[c]),i=[];let s=0;for(let l=0;l<e.length;l++){const c=l+s;if(c>=e.length)break;const d=e.slice(c),u=o.slice(c),p=p9(d,t);if(p!==void 0){for(let g=0;g<p[1].length;g++){const m=p[1][g],h=u[g]??!1;i.push(h?m.toUpperCase():m)}s+=p[0].length-1}else{const g=e[c],m=o[c];i.push(m?g.toUpperCase():g)}}return i.join("")}const jv=[["are",["aren't"]],["can",["can't"]],["could",["couldn't"]],["did",["didn't"]],["does",["doesn't"]],["do",["don't"]],["had",["hadn't"]],["has",["hasn't"]],["have",["haven't"]],["is",["isn't"]],["it",["it's","it'll"]],["i",["i'm","i'll","i've","i'd"]],["you",["you'll","you're","you've","you'd"]],["that",["that's","that'll","that'd"]],["must",["mustn't","must've"]],["there",["there's","there'll","there'd"]],["he",["he's","he'll","he'd"]],["she",["she's","she'll","she'd"]],["we",["we're","we'll","we'd"]],["they",["they're","they'll","they'd"]],["should",["shouldn't","should've"]],["was",["wasn't"]],["were",["weren't"]],["will",["won't"]],["would",["wouldn't","would've"]],["going",["goin'"]]];async function m9(e){return jv.find(t=>e.match(RegExp(`^([\\W]*${t[0]}[\\W]*)$`,"gi")))!==void 0}async function g9(e){const t=jv.find(o=>e.match(RegExp(`^([\\W]*${o[0]}[\\W]*)$`,"gi")));if(t===void 0)return e;const a=Sa(t[1]);return e.replace(RegExp(`^(?:([\\W]*)(${t[0]})([\\W]*))$`,"gi"),(o,i,s,l)=>i+(s.charAt(0)===s.charAt(0).toUpperCase()?h9(s)?a.toUpperCase():ln(a):a)+l)}function h9(e){return e==="I"?!1:e===e.toUpperCase()}const qt=Math.random;function b9(e){return/[?!.؟]/.test(e)}let vn="";async function y9(e,t,a,o){let i=t;const s=r.language.split("_")[0],l=_y(e),c=Ao("punctuateWord");if(c)return c.functions.punctuateWord(i);if(s!=="code"&&s!=="georgian"&&(a===0||b9(l))){if(i=ln(i),s==="turkish"&&(i=i.replace(/I/g,"İ")),s==="spanish"){const d=qt();d>.9?(i="¿"+i,vn="?"):d>.8&&(i="¡"+i,vn="!")}}else if(qt()<.1&&l!=="."&&l!==","&&a!==o-2||a===o-1)if(s==="spanish")(vn==="?"||vn==="!")&&(i+=vn,vn="");else{const d=qt();d<=.8?s==="kurdish"?i+=".":s==="nepali"||s==="bangla"||s==="hindi"?i+="।":s==="japanese"||s==="chinese"?i+="。":i+=".":d>.8&&d<.9?s==="french"?i="?":s==="arabic"||s==="persian"||s==="urdu"||s==="kurdish"?i+="؟":s==="greek"?i+=";":s==="japanese"||s==="chinese"?i+="？":i+="?":s==="french"?i="!":s==="japanese"||s==="chinese"?i+="！":i+="!"}else if(qt()<.01&&l!==","&&l!=="."&&s!=="russian")i=`"${i}"`;else if(qt()<.011&&l!==","&&l!=="."&&s!=="russian"&&s!=="ukrainian"&&s!=="slovak")i=`'${i}'`;else if(qt()<.012&&l!==","&&l!==".")if(s==="code"){const d=qt(),u=["()","{}","[]","<>"];r.language.startsWith("code_javascript")&&u.push("``");const p=Math.floor(d*u.length),g=u[p];i=`${g[0]}${i}${g[1]}`}else s==="japanese"||s==="chinese"?i=`（${i}）`:i=`(${i})`;else if(qt()<.013&&l!==","&&l!=="."&&l!==";"&&l!=="؛"&&l!==":"&&l!=="；"&&l!=="：")s==="french"?i=":":s==="chinese"?i+="：":i+=":";else if(qt()<.014&&l!==","&&l!=="."&&e!=="-")i="-";else if(qt()<.015&&l!==","&&l!=="."&&l!==";"&&l!=="؛"&&l!=="；"&&l!=="：")s==="french"?i=";":s==="greek"?i=".":s==="arabic"||s==="kurdish"?i+="؛":s==="chinese"?i+="；":i+=";";else if(qt()<.2&&l!==",")s==="arabic"||s==="urdu"||s==="persian"||s==="kurdish"?i+="،":s==="japanese"?i+="、":s==="chinese"?i+="，":i+=",";else if(qt()<.25&&s==="code"){const d=["{","}","[","]","(",")",";","=","+","%","/"],u=["{","}","[","]","(",")",";","=","+","%","/","/*","*/","//","!=","==","<=",">=","||","&&","<<",">>","%=","&=","*=","++","+=","--","-=","/=","^=","|="];r.language.startsWith("code_c")&&!r.language.startsWith("code_css")||r.language.startsWith("code_arduino")?i=Sa(u):r.language.startsWith("code_javascript")?i=Sa([...d,"`"]):i=Sa(d)}else qt()<.5&&s==="english"&&await m9(i)&&(i=await v9(i));return i.includes("	")&&(i=i.replace(/\t/g,""),i+="	"),i.includes(`
`)&&(i=i.replace(/\n/g,""),i+=`
`),i}async function v9(e){return g9(e)}function w9(){const e=Ao("getWordsFrequencyMode");if(e)return e.functions.getWordsFrequencyMode()}async function C9(){const e=[],t=Ao("pullSection");if(t){const a=await t.functions.pullSection(r.language);if(a===!1||a===void 0)throw Wn(t.name),new Error("Failed to pull section");for(const o of a.words){if(e.length>=r.words&&r.mode==="words")break;e.push(o)}}return e}function k9(e,t,a){const o=Ao("getWord");return o&&(e=o.functions.getWord(a,t)),e}function S9(e,t,a){for(const o of ft("alterText"))e=o.functions.alterText(e,t,a);return e}async function x9(e,t){return!r.britishEnglish||!r.language.includes("english")||r.mode==="quote"&&me?.britishText!==void 0&&me?.britishText!==""?e:await Kv(e,t)}function hu(e,t){if(Me&&Me instanceof Jp){const o=Me.wordsWithLanguage.get(e),i=o?Me.languageProperties.get(o):void 0,s=i&&!i.noLazyMode||r.mode==="custom";return r.lazyMode&&s&&i&&(e=Th(e,i.additionalAccents)),e}const a=!t.noLazyMode||r.mode==="custom";return r.lazyMode&&a&&(e=Th(e,t.additionalAccents)),e}function T9(){return Mo().flatMap(t=>t.properties??[]).find(t=>t.startsWith("wordOrder:"))?.split(":")[1]??"normal"}function L9(){if(r.mode==="zen")return 0;let e=100;const t=me;if(r.mode==="quote"&&t===null)throw new Qe("Random quote is null");const a=Mo().flatMap(o=>o.properties??[]).find(o=>o.startsWith("toPush:"))??"";return r.showAllLines&&(r.mode==="custom"&&(e=ye()),r.mode==="words"&&(e=r.words),r.mode==="quote"&&(e=t.textSplit.length)),r.mode==="words"&&r.words===0&&(e=100),r.mode==="custom"&&(ye()===0||ve()==="time"?e=100:e=ye()>100?100:ye()),a&&(e=+a.split(":")[1]),r.mode==="words"&&r.words!==0&&r.words<e&&(e=r.words),r.mode==="quote"&&t.textSplit.length<e&&(e=t.textSplit.length),r.mode==="custom"&&ve()==="word"&&ye()<e&&ye()!==0&&(e=ye()),e}async function $9(e,t){if(ba){if(Me===null)throw new Qe("Current wordset is null");return Nu(Gv),t==="reverse"?Me.words.reverse():Me.words}const a=e.name.startsWith("swiss_german")?"german":e.name;Z();const o=await ct.getQuotes(a,r.quoteLength);if(N(),o.length===0)throw rt("words"),new Qe(`No ${r.language.replace(/_\d*k$/g,"").replace(/_/g," ")} quotes found`);let i;if(r.quoteLength.includes(-2)&&r.quoteLength.length===1){const s=ct.getQuoteById(Bu);if(s===void 0)throw zn(),new Qe(`Quote ${Bu} does not exist`);i=s}else if(r.quoteLength.includes(-3)){const s=ct.getRandomFavoriteQuote(r.language);if(s===null)throw zn(),new Qe("No favorite quotes found");i=s}else{const s=ct.getRandomQuote();if(s===null)throw zn(),new Qe("No quotes found for selected quote length");i=s}if(i.language=Wa(r.language),i.text=i.text.replace(/ +/gm," "),i.text=i.text.replace(/( *(\r\n|\r|\n) *)/g,`
 `),i.text=i.text.replace(/…/g,"..."),i.text=i.text.trim(),i.britishText!==void 0&&i.britishText!==""&&r.britishEnglish?i.textSplit=i.britishText.split(" "):i.textSplit=i.text.split(" "),Nu(i),me===null)throw new Qe("Random quote is null");if(me.textSplit===void 0)throw new Qe("Random quote textSplit is undefined");return me.textSplit}let Me=null,wi=null,ec=!1,Gv=null;async function M9(e){ba||(Cf=[]),Gv=me,Nu(null),Mi=[],$i=0,rr=[],wi=e;const t={words:[],sectionIndexes:[],hasTab:!1,hasNewline:!1,allRightToLeft:e.rightToLeft,allLigatures:e.ligatures??!1};ec=L0("pullSection");const a=T9();console.debug("Word order",a);let o=e.words;r.mode==="custom"?o=Jr():r.mode==="quote"?o=await $9(e,a):r.mode==="zen"&&(o=[]);const i=r.mode==="custom"&&Ts(),s=L9();console.debug(`${i?"Section":"Word"} limit ${s}`),a==="reverse"&&(o=o.reverse());const l=Ao("withWords");if(l){const p=await l.functions.withWords(o);if(p instanceof Jp){const g=p;Me=g,t.allLigatures=Array.from(g.languageProperties.values()).some(m=>!!m.ligatures)}else Me=p}else Me=await Sx(o);if(console.debug("Wordset",Me),s===0)return t;let c=!1,d=0;for(;!c;){const p=await Qv(d,s,Qn(t.words,-1)??"",Qn(t.words,-2)??"");if(t.words.push(p.word),t.sectionIndexes.push(p.sectionIndex),i){const g=Mi.length===0&&$i>=s,m=t.words.length>=100;(g||m)&&(c=!0)}else t.words.length>=s&&(c=!0);d++}const u=me;if(r.mode==="quote"&&u===null)throw new Qe("Random quote is null");return t.hasTab=t.words.some(p=>p.includes("	"))||Me.words.some(p=>p.includes("	"))||r.mode==="quote"&&u.textSplit.some(p=>p.includes("	")),t.hasNewline=t.words.some(p=>p.includes(`
`))||Me.words.some(p=>p.includes(`
`))||r.mode==="quote"&&u.textSplit.some(p=>p.includes(`
`)),rr=[],t}let $i=0,Mi=[],rr=[],Cf=[];async function Qv(e,t,a,o){if(console.debug("Getting next word",{isRepeated:ba,currentWordset:Me,wordIndex:e,language:wi,wordsBound:t,previousWord:a,previousWord2:o}),Me===null)throw new Qe("Current wordset is null");if(wi===null)throw new Qe("Current language is null");if(ba&&r.mode!=="quote"){const p=Cf[e];if(p===void 0){let g=!1;if((r.mode==="time"||r.mode==="custom"&&ve()==="time"||r.mode==="custom"&&ve()==="word"&&e<ye()||r.mode==="custom"&&ve()==="section"&&$i<ye()||r.mode==="words"&&e<r.words)&&(g=!0),g)console.debug("Repeated word is undefined but random generation is allowed - getting random word");else throw new Qe("Repeated word is undefined")}else return console.debug("Repeated word: ",p),$i++,p}const i=w9()??"normal";let s=Me.randomWord(i);const l=a.replace(/[.?!":\-,]/g,"").toLowerCase(),c=o?.replace(/[.?!":\-,']/g,"").toLowerCase();if(Mi.length===0){const p=await C9();if(r.mode==="quote")s=Me.nextWord();else if(r.mode==="custom"&&Kl()==="repeat")s=Me.nextWord();else if(r.mode==="custom"&&Kl()==="random"&&(Me.length<4||Se.mode!==null))s=Me.randomWord(i);else if(r.mode==="custom"&&Kl()==="shuffle")s=Me.shuffledWord();else if(r.mode==="custom"&&ve()==="section"){s=Me.randomWord(i);const g=Qn(rr,-1),m=Qn(rr,-2);let h=0;for(;h<100&&(g===s||m===s);)h++,s=Me.randomWord(i)}else if(ec)s=p.join(" ");else{let g=0,m=s.split(" ")[0].toLowerCase(),h=hu(m,wi);for(;g<100&&(l===h||c===h||r.mode!=="custom"&&!r.punctuation&&s==="I"||r.mode!=="custom"&&!r.punctuation&&!r.language.startsWith("code")&&/[-=_+[\]{};'\\:"|,./<>?]/i.test(s)||r.mode!=="custom"&&!r.numbers&&/[0-9]/i.test(s));)g++,s=Me.randomWord(i),m=s.split(" ")[0],h=hu(m,wi)}s=s.replace(/ +/g," "),s=s.replace(/(^ )|( $)/g,""),s=k9(s,e,Me),Mi=[...s.split(" ")],rr.push(s),s=Mi.shift(),$i++}else s=Mi.shift();if(s===void 0)throw new Qe("Random word is undefined");if(s==="")throw new Qe("Random word is empty");if(/ /g.test(s))throw new Qe("Random word contains spaces");const d=L0("getWord");r.mode!=="custom"&&r.mode!=="quote"&&/[A-Z]/.test(s)&&!r.punctuation&&!r.language.startsWith("german")&&!r.language.startsWith("swiss_german")&&!r.language.startsWith("code")&&!r.language.startsWith("klingon")&&!ec&&!d&&(s=s.toLowerCase()),s=s.replace(/ +/gm," "),s=s.replace(/(^ )|( $)/gm,""),s=hu(s,wi),s=await x9(s,l),r.language.startsWith("swiss_german")&&(s=s.replace(/ß/g,"ss")),r.punctuation&&!wi.originalPunctuation&&!ec&&(s=await y9(a,s,e,t)),r.numbers&&qt()<.1&&(s=h0(4),r.language.startsWith("kurdish")?s=Eb(s):r.language.startsWith("nepali")?s=qb(s):r.language.startsWith("bangla")?s=ik(s):r.language.startsWith("hindi")&&(s=nk(s))),s=S9(s,e,t),console.debug("Word:",s);const u={word:s,sectionIndex:$i};return Cf.push(u),u}let Yv=0,Jv=0;async function A9(){const e=rn(r,me),[t,a]=(await vy(r.mode,e,r.punctuation,r.numbers,r.language,r.difficulty,r.lazyMode)).map(H);Yv=r.alwaysShowDecimalPlaces?t:Math.round(t),Jv=r.alwaysShowDecimalPlaces?a:Math.floor(a)}function _9(){return Yv}function E9(){return Jv}ge(e=>{["difficulty","blindMode","stopOnError","paceCaret","minWpm","minWpmCustomSpeed","minAcc","minAccCustom","minBurst","confidenceMode","layout","showAverage","typingSpeedUnit","quickRestart","customPolyglot","alwaysShowDecimalPlaces"].includes(e)&&Ot()});async function Ot(){n(".pageTest #testModesNotice").empty(),ba&&r.mode!=="quote"&&n(".pageTest #testModesNotice").append('<div class="textButton noInteraction" style="color:var(--error-color);"><i class="fas fa-sync-alt"></i>repeated</div>'),Ur||n(".pageTest #testModesNotice").append('<div class="textButton" commands="resultSaving" style="color:var(--error-color);"><i class="fas fa-save"></i>saving disabled</div>'),br&&(r.quickRestart==="esc"&&(n(".pageTest #testModesNotice").append('<div class="textButton noInteraction"><i class="fas fa-long-arrow-alt-right"></i>shift + tab to open commandline</div>'),n(".pageTest #testModesNotice").append('<div class="textButton noInteraction"><i class="fas fa-level-down-alt fa-rotate-90"></i>shift + esc to restart</div>')),r.quickRestart==="tab"&&n(".pageTest #testModesNotice").append('<div class="textButton noInteraction"><i class="fas fa-level-down-alt fa-rotate-90"></i>shift + tab to restart</div>')),(yr||r.funbox.includes("58008"))&&r.quickRestart==="enter"&&n(".pageTest #testModesNotice").append('<div class="textButton noInteraction"><i class="fas fa-level-down-alt fa-rotate-90"></i>shift + enter to restart</div>');const e=om(),t=Xa();r.mode==="custom"&&e!==""&&t&&n(".pageTest #testModesNotice").append(`<div class="textButton noInteraction"><i class="fas fa-book"></i>${lt(e)} (shift + enter to save progress)</div>`),It&&n(".pageTest #testModesNotice").append(`<div class="textButton noInteraction"><i class="fas fa-award"></i>${It.display}</div>`),r.mode==="zen"&&n(".pageTest #testModesNotice").append('<div class="textButton noInteraction"><i class="fas fa-poll"></i>shift + enter to finish zen </div>');const a=Jt().includes("polyglot");if(r.mode!=="zen"&&!a&&n(".pageTest #testModesNotice").append(`<button class="textButton" commands="languages"><i class="fas fa-globe-americas"></i>${Aa(r.language,r.mode==="quote")}</button>`),a){const i=r.customPolyglot.map(s=>Aa(s,!0)).join(", ");n(".pageTest #testModesNotice").append(`<button class="textButton" commandId="setCustomPolyglotCustom"><i class="fas fa-globe-americas"></i>${i}</button>`)}if(r.difficulty==="expert"?n(".pageTest #testModesNotice").append('<button class="textButton" commands="difficulty"><i class="fas fa-star-half-alt"></i>expert</button>'):r.difficulty==="master"&&n(".pageTest #testModesNotice").append('<button class="textButton" commands="difficulty"><i class="fas fa-star"></i>master</button>'),r.blindMode&&n(".pageTest #testModesNotice").append('<button class="textButton" commands="blindMode"><i class="fas fa-eye-slash"></i>blind</button>'),r.lazyMode&&n(".pageTest #testModesNotice").append('<button class="textButton" commands="lazyMode"><i class="fas fa-couch"></i>lazy</button>'),r.paceCaret!=="off"||r.repeatedPace&&Hi){const i=D.typingSpeed(Q?.wpm??0,{showDecimalPlaces:!1,suffix:` ${r.typingSpeedUnit}`});n(".pageTest #testModesNotice").append(`<button class="textButton" commands="paceCaretMode"><i class="fas fa-tachometer-alt"></i>${r.paceCaret==="average"?"average":r.paceCaret==="pb"?"pb":r.paceCaret==="tagPb"?"tag pb":r.paceCaret==="last"?"last":r.paceCaret==="daily"?"daily":"custom"} pace ${i}</button>`)}if(r.showAverage!=="off"){const i=_9(),s=E9();if(A()&&i>0){const l=["speed","both"].includes(r.showAverage)?D.typingSpeed(i,{suffix:` ${r.typingSpeedUnit}`}):"",c=["acc","both"].includes(r.showAverage)?D.accuracy(s,{suffix:" acc"}):"",d=`${l} ${c}`.trim();n(".pageTest #testModesNotice").append(`<button class="textButton" commands="showAverage"><i class="fas fa-chart-bar"></i>avg: ${d}</button>`)}}r.minWpm!=="off"&&n(".pageTest #testModesNotice").append(`<button class="textButton" commands="minWpm"><i class="fas fa-bomb"></i>min ${D.typingSpeed(r.minWpmCustomSpeed,{showDecimalPlaces:!1,suffix:` ${r.typingSpeedUnit}`})}</button>`),r.minAcc!=="off"&&n(".pageTest #testModesNotice").append(`<button class="textButton" commands="minAcc"><i class="fas fa-bomb"></i>min ${r.minAccCustom}% acc</button>`),r.minBurst!=="off"&&n(".pageTest #testModesNotice").append(`<button class="textButton" commands="minBurst"><i class="fas fa-bomb"></i>min ${D.typingSpeed(r.minBurstCustomSpeed,{showDecimalPlaces:!1})} ${r.typingSpeedUnit} burst ${r.minBurst==="flex"?"(flex)":""}</button>`),r.funbox.length>0&&n(".pageTest #testModesNotice").append(`<button class="textButton" commands="funbox"><i class="fas fa-gamepad"></i>${r.funbox.map(i=>i.replace(/_/g," ")).join(", ")}</button>`),r.confidenceMode==="on"&&n(".pageTest #testModesNotice").append('<button class="textButton" commands="confidenceMode"><i class="fas fa-backspace"></i>confidence</button>'),r.confidenceMode==="max"&&n(".pageTest #testModesNotice").append('<button class="textButton" commands="confidenceMode"><i class="fas fa-backspace"></i>max confidence</button>'),r.stopOnError!=="off"&&n(".pageTest #testModesNotice").append(`<button class="textButton" commands="stopOnError"><i class="fas fa-hand-paper"></i>stop on ${r.stopOnError}</button>`),r.layout!=="default"&&n(".pageTest #testModesNotice").append(`<button class="textButton" commands="layouts"><i class="fas fa-keyboard"></i>emulating ${r.layout.replace(/_/g," ")}</button>`),r.oppositeShiftMode!=="off"&&n(".pageTest #testModesNotice").append(`<button class="textButton" commands="oppositeShiftMode"><i class="fas fa-exchange-alt"></i>opposite shift${r.oppositeShiftMode==="keymap"?" (keymap)":""}</button>`);let o="";try{S()?.tags?.forEach(i=>{i.active===!0&&(o+=i.display+", ")}),o!==""&&n(".pageTest #testModesNotice").append(`<button class="textButton" commands="tags"><i class="fas fa-tag"></i>${o.substring(0,o.length-2)}</button>`)}catch{}}let tc;async function Ji(e,t){try{F2(tc,e,t)}catch{console.log("Analytics unavailable")}}function q9(){if(tc!==void 0){console.warn("Analytics already activated");return}console.log("Activating Analytics");try{tc=iS(),P2(tc,!0),n("body").append(`
    <script
    async
    src="https://www.googletagmanager.com/gtag/js?id=UA-165993088-1"
  ><\/script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {
      dataLayer.push(arguments);
    }
    gtag("js", new Date());

    gtag("config", "UA-165993088-1");
  <\/script>`)}catch(e){console.error(ie(e,"Failed to activate analytics"))}}const Xv=new pt({key:"prefersArabicLazyMode",schema:q.boolean(),fallback:!0});function I9(){return Xv.get()}function F9(e){Xv.set(e)}const zc=document.querySelector(".pageTest #testInitFailed"),Hc=document.querySelector(".pageTest #typingTest"),lr=document.querySelector(".pageTest #testInitFailed .error");function P9(){zc&&Hc&&(zc.classList.remove("hidden"),Hc.classList.add("hidden"))}function B9(){lr&&lr.classList.add("hidden")}function R9(e){lr&&(lr.classList.remove("hidden"),lr.innerText=e)}function D9(){zc&&Hc&&(B9(),zc.classList.add("hidden"),Hc.classList.remove("hidden"))}let _r="";const W9=document.getElementById("koInputVisual");let ga=null;function Zv(){ga=null}function z9(e){ga!==null&&(ga.uid=e,delete ga.hash,ga.hash=Nb(ga))}function H9(e){if(zi())return!1;A()?Ji("testStarted"):Ji("testStartedNoLogin"),Cp(!0),K6(),gf(_.list),F3(),Op(),Bp(),Dp(),Rp(),Zr(),vm(),k6();for(const t of ft("start"))t.functions.start();try{(r.paceCaret!=="off"||r.repeatedPace&&Hi)&&m4()}catch{}return B4(e),V6(),!0}function R(e={}){e={...{withSameWordset:!1,practiseMissed:!1,noAnim:!1,nosave:!1},...e},m5();const a=e.noAnim?0:G(125),o=T0("no_quit");if(we&&o){f("No quit funbox is active. Please finish the test.",0,{important:!0}),e.event?.preventDefault();return}if(zt||Vi){e.event?.preventDefault();return}if(X()==="test"&&!I4()&&(r.mode!=="zen"&&e.event?.preventDefault(),!Dd(r.mode,r.words,r.time,Co(),Xa()??!1))){let s="Use your mouse to confirm.";r.quickRestart==="tab"?s="Press shift + tab or use your mouse to confirm.":r.quickRestart==="esc"?s="Press shift + escape or use your mouse to confirm.":r.quickRestart==="enter"&&(s="Press shift + enter or use your mouse to confirm."),f(`Quick restart disabled in long tests. ${s}`,0,{duration:4,important:!0});return}if(we&&(ba&&(e.withSameWordset=!0),Ur)){gd(),bd(),hd();const s=el(performance.now()),l=um(s);let c=H(s-l);c<0&&(c=0),lm(c),rm();const d=H(tl());cm(d,c)}r.mode==="quote"&&me!==null&&r.language.startsWith(me.language)&&r.repeatQuotes==="typing"&&(we||_r!=="")&&(e.withSameWordset=!0),Se.mode!==null&&!e.withSameWordset&&!e.practiseMissed&&(f("Reverting to previous settings.",0),Se.punctuation!==null&&ei(Se.punctuation),Se.numbers!==null&&po(Se.numbers),Se.customText&&(wo(Se.customText.text),ya(Se.customText.limit.mode),Ua(Se.customText.limit.value),Ui(Se.customText.pipeDelimiter)),rt(Se.mode),fm()),Cr(),vm(),P4(),P3(),Ke.reset(),U4(),V4(),Yr(),Cp(!1),xm(),yd(),wd(),vd(),kd(),sl(),kp(!1),D3(),f4(),dv(),k.setKoreanStatus(!1),or(),ds(),a8(),h4(),Up(!1),ce&&(r.randomTheme!=="off"&&rv(),n5()),Xe()||rd();let i;ce?i=document.querySelector("#result"):i=document.querySelector("#typingTest"),my(!1),Hl(!0),W(i,{opacity:0,duration:a,onComplete:async()=>{n("#result").addClass("hidden"),n("#typingTest").css("opacity",0).removeClass("hidden"),n("#wordsInput").css({left:0}).val(" "),r.language.startsWith("korean")?(W9.innerText=" ",r.mode!=="zen"?n("#koInputVisualContainer").show():n("#koInputVisualContainer").hide()):n("#koInputVisualContainer").hide(),_a(!1),X()==="test"&&Wc(!1),I8(),T8(),await j4(),kf=0,_r="";let s=!1;if(r.repeatedPace&&e.withSameWordset&&(s=!0),uy(e.withSameWordset??!1),gS(s),D9(),py(!0),!await Sf()){Hl(!1);return}await Ac();for(const u of ft("restart"))u.functions.restart();r.showAverage!=="off"?A9().then(()=>{Ot()}):Ot(),n("#wordsInput").is(":focus")&&$s(),Ki(!0);const d=document.querySelector("#typingTest");W(d,{opacity:[0,1],onBegin:()=>{d.classList.remove("hidden")},duration:a,onComplete:()=>{X3(),H3(),K3(),N3(),S4(),Cr(),Hl(!1)}})}}),Kp()}let zs=null,Tn,kf=0;async function Sf(){if(console.debug("Initializing test"),kf++,kf>3)return zs&&(Mp(zs),R9(`${zs.name}: ${zs.message}`)),P9(),Hl(!1),py(!1),_a(!1),!1;Uv(),xm(),_.reset(),hS(0),k.resetHistory(),k.current="",Z();const{data:e,error:t}=await Wt(ai(r.language));if(N(),t&&f(ie(t,"Failed to load language"),-1),!e||e.name!==r.language)return await Sf();X()==="test"&&await K0(),r.mode==="quote"&&r.quoteLength.includes(-3)&&!A()&&zn();const a=!e.noLazyMode||r.mode==="custom";if(Jt().includes("polyglot")){const h=r.customPolyglot.map(async C=>{const{data:M,error:w}=await Wt(ai(C));return w&&f(ie(w,`Failed to load language: ${C}`),-1),M}),y=(await Promise.all(h)).filter(C=>C!==null).some(C=>!C.noLazyMode);r.lazyMode&&!y?(Tn=!0,f("None of the selected polyglot languages support lazy mode.",0,{important:!0}),An(!1,!0)):Tn&&y&&An(!0,!0)}else r.lazyMode&&!a?(Tn=!0,f("This language does not support lazy mode.",0,{important:!0}),An(!1,!0)):Tn&&!e.noLazyMode&&An(!0,!0);!r.lazyMode&&!e.noLazyMode&&(Tn=!1),r.mode==="custom"&&console.debug("Custom text",Co()),console.log("Inializing test",{language:{...e,words:`${e.words.length} words`},customText:{...Co(),text:`${Jr().length} words`},mode:r.mode,mode2:rn(r,null),funbox:r.funbox,currentQuote:me});let o=!1,i=!1,s,l,c=[],d=[];try{const m=await M9(e);c=m.words,d=m.sectionIndexes,o=m.hasTab,i=m.hasNewline,{allRightToLeft:s,allLigatures:l}=m}catch(m){return N(),(m instanceof Qe||m instanceof Error)&&(zs=m),console.error(m),m instanceof Qe?m.message.length>0&&f(m.message,0,{important:!0}):f(ie(m,"Failed to generate words"),-1,{important:!0}),await Sf()}const u=Ip;let p=!1;for(const m of c)/\d/g.test(m)&&!p&&(p=!0);$3(p),T3(o),L3(i),u!==p&&Fc();for(let m=0;m<c.length;m++)_.push(c[m],d[m]);r.keymapMode==="next"&&r.mode!=="zen"&&Ho(Qn([..._.getCurrent()],0)),qc(_.getCurrent()),T4(l??e.ligatures??!1);const g=s??e.rightToLeft??!1;return x4(g),yS(g),vS(ui("reverseDirection")),y4(),console.debug("Test initialized with words",c),console.debug("Test initialized with section indexes",d),!0}function Am(){return r.mode==="words"&&_.length>=r.words&&r.words>0||r.mode==="custom"&&ve()==="word"&&_.length>=ye()&&ye()!==0||r.mode==="quote"&&_.length>=(me?.textSplit?.length??0)||r.mode==="custom"&&ve()==="section"&&$i>=ye()&&Mi.length===0&&ye()!==0}async function Lh(){if(r.mode==="zen"){q0();return}let e=100;const a=(Mo().flatMap(i=>i.properties??[]).find(i=>i.startsWith("toPush:"))??"")?.split(":")[1];if(a!==void 0&&(e=+a-1),_.length-k.getHistory().length>e){console.debug("Not adding word, enough words already");return}if(Am()){console.debug("Not adding word, all words generated");return}const o=Ao("pullSection");if(o&&_.length-le<20){const i=await o.functions.pullSection(r.language);if(i===!1){f("Error while getting section. Please try again later",-1),Wn(o.name),R();return}if(i===void 0)return;let s=0;for(let l=0;l<i.words.length;l++){const c=i.words[l];if(s>=r.words&&r.mode==="words")break;s++,_.push(c,l),ph(c)}}try{const i=await Qv(_.length,e,_.get(_.length-1),_.get(_.length-2));_.push(i.word,i.sectionIndex),ph(i.word)}catch(i){$r("fail","word generation error"),f(ie(i,"Error while getting next word. Please try again later"),-1,{important:!0})}}const Ai={completedEvent:null,canRetry:!1};async function O9(){const{completedEvent:e}=Ai;if(e===null){f("Could not retry saving the result as the result no longer exists.",0,{duration:5,important:!0});return}Ai.canRetry&&(Ai.canRetry=!1,n("#retrySavingResultButton").addClass("hidden"),Qa(!0),f("Retrying to save..."),await ew(e,!0))}function N9(e,t){let a=H(he.spacing.first-ji);(a<0||r.mode==="zen")&&(a=0);let o=H(As-he.spacing.last);(o<0||r.mode==="zen")&&(o=0);const i=Zs(t),s=Wl(t);let l=H(Zd(i/s)),c=he.spacing.array.slice();c.length>0&&(c=c.slice(0,c.length-1));let d=H(Zd(Zs(c)/Wl(c)));(!l||isNaN(l))&&(l=0),(!d||isNaN(d))&&(d=0);const u=[];for(const K of Gr)u.push(K.count??0);const p={wpm:ti,burst:t,err:u},g=Zs(p.wpm??[]),m=Wl(p.wpm??[]),h=H(Zd(g/m)),y=isNaN(h)?0:h;let C;if(r.mode==="custom"){const K=Co();C={textLen:K.text.length,mode:K.mode,pipeDelimiter:K.pipeDelimiter,limit:K.limit}}const M=[];for(const K of S()?.tags??[])K.active===!0&&M.push(K._id);const w=parseFloat(e.time.toString()),F=um(w);let I=r.language;r.mode==="quote"&&(I=Wa(r.language));const P=me?.group??-1,U={wpm:e.wpm,rawWpm:e.wpmRaw,charStats:[e.correctChars+e.correctSpaces,e.incorrectChars,e.extraChars,e.missedChars],charTotal:e.allChars,acc:e.acc,mode:r.mode,mode2:rn(r,me),quoteLength:P,punctuation:r.punctuation,numbers:r.numbers,lazyMode:r.lazyMode,timestamp:Date.now(),language:I,restartCount:nm,incompleteTests:sm,incompleteTestSeconds:Ec<0?0:H(Ec),difficulty:r.difficulty,blindMode:r.blindMode,tags:M,keySpacing:he.spacing.array,keyDuration:he.duration.array,keyOverlap:H(so.total),lastKeyToEnd:o,startToFirstKey:a,consistency:l,wpmConsistency:y,keyConsistency:d,funbox:r.funbox,bailedOut:ki,chartData:p,customText:C,testDuration:w,afkDuration:F,stopOnLetter:r.stopOnError==="letter"};return U.mode!=="custom"&&delete U.customText,U.mode!=="quote"&&delete U.quoteLength,U}async function Xi(e=!1){if(!we)return;M0(!0);const t=performance.now();gh(t),ba&&r.mode==="quote"&&uy(!1),await ke(1),k.current.length!==0&&(k.pushHistory(),Ke.pushHistory(),gf(k.getHistory())),r.mode==="zen"&&gf(k.getHistory()),E3(t);const a=(t-he.spacing.last)/1e3;if((r.mode==="zen"||ki)&&a<7&&gh(he.spacing.last),my(!0),Cp(!1),xm(),Yr(),yd(),wd(),vd(),kd(),$s(),vm(),dv(),Ot(),Ta.length!==k.getHistory()?.length){const w=O0();Qy(w)}(r.mode==="zen"||ki)&&D4();const o=H4();if(o.time%1!==0&&r.mode!=="time"&&R4(),d4(o.wpm),Gi&&!e){const w=dm();jy(w.wpm),Gy(w.raw),gd(),bd(),hd()}const i=Ni.map(w=>Math.round(w/5*60));if(r.mode!=="time"&&Gi&&o.time%1>=.5){const w=1/(o.time%1);i[i.length-1]=Math.round(i[i.length-1]*w)}const s=N9(o,i);console.debug("Completed event object",s);function l(w){return typeof w=="number"?isNaN(w)?1:0:typeof w>"u"?1:typeof w=="object"&&w!==null?Object.values(w).reduce((F,I)=>F+l(I),0):0}let c=!1;l(s)>0&&(console.log(s),f("Failed to build result object: One of the fields is undefined or NaN",-1),c=!0);const d=structuredClone(s);let p=Qr.slice(-5).every(w=>w);ki&&(p=!1);const g=parseInt(d.mode2);let m=!1;const h=(Sr-kr)/1e3;if(r.mode==="time"&&!ki&&(s.testDuration<h-.1||s.testDuration>h+.1)&&s.testDuration<=120?(f("Test invalid - inconsistent test duration",0),console.error("Test duration inconsistent",s.testDuration,h),Tl(),c=!0):e?(f(`Test failed - ${_r}`,0,{duration:1}),c=!0):p?(f("Test invalid - AFK detected",0),c=!0):ba?(f("Test invalid - repeated",0),c=!0):d.testDuration<1||r.mode==="time"&&g<15&&g>0||r.mode==="time"&&g===0&&d.testDuration<15||r.mode==="words"&&g<10&&g>0||r.mode==="words"&&g===0&&d.testDuration<15||r.mode==="custom"&&(ve()==="word"||ve()==="section")&&ye()<10||r.mode==="custom"&&ve()==="time"&&ye()<15||r.mode==="zen"&&d.testDuration<15?(f("Test invalid - too short",0),m=!0,c=!0):d.wpm<0||d.wpm>350&&d.mode!=="words"&&d.mode2!=="10"||d.wpm>420&&d.mode==="words"&&d.mode2==="10"?(f("Test invalid - wpm",0),Tl(),c=!0):d.rawWpm<0||d.rawWpm>350&&d.mode!=="words"&&d.mode2!=="10"||d.rawWpm>420&&d.mode==="words"&&d.mode2==="10"?(f("Test invalid - raw",0),Tl(),c=!0):(!S()?.lbOptOut&&(d.acc<75||d.acc>100)||S()?.lbOptOut===!0&&(d.acc<50||d.acc>100))&&(f("Test invalid - accuracy",0),Tl(),c=!0),ba){const w=d.testDuration,F=d.afkDuration;let I=H(w-F);I<0&&(I=0);const P=d.acc;lm(I),rm(),cm(P,I)}const y=om(),C=Xa();if(r.mode==="custom"&&y!==""&&C)if(ki||k.getHistory().length<_.length){const w=k.getHistory()?.length,F=Wp(y)+w;ju(y,F),f("Long custom text progress saved",1,{duration:5,important:!0});let I=Tc(y,!0);I=I.slice(F),wo(I)}else{ju(y,0);const w=Tc(y,!0);wo(w),f("Long custom text completed",1,{duration:5,important:!0})}if(Q6(d.testDuration-d.afkDuration),O8(),A()?n(".pageTest #result #reportQuoteButton").removeClass("hidden"):(n(".pageTest #result #rateQuoteButton").addClass("hidden"),n(".pageTest #result #reportQuoteButton").addClass("hidden"),Ji("testCompletedNoLogin"),c||(ga=d),c=!0),n("#result .stats .dailyLeaderboard").addClass("hidden"),F4(structuredClone(d)),Xe()||rd(),await X8(d,e,_r,p,ba,m,me,c),d.chartData!=="toolong"&&delete d.chartData.unsmoothedRaw,d.testDuration>122&&(d.chartData="toolong",d.keySpacing="toolong",d.keyDuration="toolong"),d.wpm===0&&!e&&d.testDuration>=5){const w=Math.round(d.testDuration),F=[`Congratulations. You just wasted ${w} seconds of your life by typing nothing. Be proud of yourself.`,`Bravo! You've managed to waste ${w} seconds and accomplish exactly zero. A true productivity icon.`,`That was ${w} seconds of absolutely legendary idleness. History will remember this moment.`,`Wow, ${w} seconds of typing... nothing. Bold. Mysterious. Completely useless.`,`Thank you for those ${w} seconds of utter nothingness. The keyboard needed the break.`,`A breathtaking display of inactivity. ${w} seconds of absolutely nothing. Powerful.`,`You just gave ${w} seconds of your life to the void. And the void says thanks.`,`Stunning. ${w} seconds of intense... whatever that wasn't. Keep it up, champ.`,`Is it performance art? A protest? Or just ${w} seconds of glorious nothing? We may never know.`,`You typed nothing for ${w} seconds. And in that moment, you became legend.`];Hv(),f(Sa(F),0,{customTitle:"Nice",duration:15,important:!0})}if(c){Ji("testCompletedInvalid");return}const M=tt();if(M){if(H0(),d.uid=M.uid,Q8(me),Qa(!0),!d.bailedOut){const w=Z6(d);w!==null&&(d.challenge=w)}d.hash=Nb(d),await ew(d,!1)}}async function ew(e,t){if(!Ur){f("Result not saved: disabled by user",-1,{duration:3,customTitle:"Notice",important:!0}),Qa(!1);return}if(!Xe()){f("Result not saved: offline",-1,{duration:2,customTitle:"Notice",important:!0}),Qa(!1),Ai.canRetry=!0,n("#retrySavingResultButton").removeClass("hidden"),t||(Ai.completedEvent=e);return}const a=await T.results.add({body:{result:e}});if(Qa(!1),a.status!==200){[460,461,463,464,465,466].includes(a.status)||(Ai.canRetry=!0,n("#retrySavingResultButton").removeClass("hidden"),t||(Ai.completedEvent=e)),console.log("Error saving result",e),a.body.message==="Old key data format"&&(a.body.message="Old key data format. Please refresh the page to download the new update. If the problem persists, please contact support."),/"result\..+" is (not allowed|required)/gi.test(a.body.message)&&(a.body.message="Looks like your result data is using an incorrect schema. Please refresh the page to download the new update. If the problem persists, please contact support."),f("Failed to save result: "+a.body.message,-1);return}const o=a.body.data;n("#result .stats .tags .editTagsButton").attr("data-result-id",o.insertedId),n("#result .stats .tags .editTagsButton").removeClass("invisible");const i={};if(o.xp!==void 0){const l=S()?.xp??0;$y(l,o.xp,ce?o.xpBreakdown:void 0),i.xp=o.xp}if(o.streak!==void 0&&(i.streak=o.streak),o.insertedId!==void 0){const l=structuredClone(e);l._id=o.insertedId,o.isPb!==void 0&&o.isPb&&(l.isPb=!0),i.result=l}Ji("testCompleted"),o.isPb!==void 0&&o.isPb?(await gr(e.mode,e.mode2,e.punctuation,e.numbers,e.language,e.difficulty,e.lazyMode,fr(e.funbox))!==void 0&&Hv(),Zl("normal"),i.isPb=!0):V8();const s=document.querySelector("#result .stats .dailyLeaderboard");o.dailyLeaderboardRank===void 0?s.classList.add("hidden"):(s.classList.remove("hidden"),s.style.maxWidth="13rem",W(s,{opacity:[0,1],duration:G(250)}),n("#result .stats .dailyLeaderboard .bottom").html(D.rank(o.dailyLeaderboardRank,{fallback:""}))),n("#retrySavingResultButton").addClass("hidden"),t&&f("Result saved",1,{important:!0}),ky(i)}function cr(e){if(_r=e,gd(),bd(),hd(),Xi(!0),!Ur)return;const t=el(performance.now()),a=um(t);let o=H(t-a);o<0&&(o=0),lm(o),rm();const i=H(tl());cm(i,o)}n(".pageTest").on("click","#testModesNotice .textButton.restart",()=>{R()});n(".pageTest").on("click","#testInitFailed button.restart",()=>{R()});n(".pageTest").on("click","#restartTestButton",()=>{te(),!Vi&&(we&&r.repeatQuotes==="typing"&&r.mode==="quote"?R({withSameWordset:!0}):R())});n(".pageTest").on("click","#retrySavingResultButton",O9);n(".pageTest").on("click","#nextTestButton",()=>{te(),R()});n(".pageTest").on("click","#restartTestButtonWithSameWordset",()=>{if(r.mode==="zen"){f("Repeat test disabled in zen mode");return}te(),R({withSameWordset:!0})});n(".pageTest").on("click","#testConfig .mode .textButton",e=>{if(zt||n(e.currentTarget).hasClass("active"))return;const t=n(e.currentTarget).attr("mode")??"time";t!==void 0&&rt(t)&&(te(),R())});n(".pageTest").on("click","#testConfig .wordCount .textButton",e=>{if(zt)return;const t=n(e.currentTarget).attr("wordCount")??"15";t!=="custom"&&Oi(parseInt(t))&&(te(),R())});n(".pageTest").on("click","#testConfig .time .textButton",e=>{if(zt)return;const t=n(e.currentTarget).attr("timeConfig")??"10";t!=="custom"&&uo(parseInt(t))&&(te(),R())});n(".pageTest").on("click","#testConfig .quoteLength .textButton",e=>{if(zt)return;const t=n(e.currentTarget).attr("quoteLength");if(t==="all")zn()&&(te(),R());else{const a=parseInt(t??"1");if(a!==-2){let o=[];e.shiftKey?o=[...r.quoteLength,a]:o=[a],fd(o,!1)&&(te(),R())}}});n(".pageTest").on("click","#testConfig .punctuationMode.textButton",()=>{zt||ei(!r.punctuation)&&(te(),R())});n(".pageTest").on("click","#testConfig .numbersMode.textButton",()=>{zt||po(!r.numbers)&&(te(),R())});n("header").on("click","nav #startTestButton, #logo",()=>{X()==="test"&&R()});ge((e,t,a)=>{X()==="test"&&(e==="language"&&(t?.startsWith("arabic")&&I9()&&An(!0,!0),R()),e==="difficulty"&&!a&&R(),e==="customLayoutfluid"&&r.funbox.includes("layoutfluid")&&R(),e==="keymapMode"&&t==="next"&&r.mode!=="zen"&&setTimeout(()=>{Ho(Qn([..._.getCurrent()],0))},0)),e==="lazyMode"&&!a&&(r.language.startsWith("arabic")&&F9(t),t===!1&&(Tn=!1))});x6((e,t)=>{e==="fail"&&t!==void 0&&cr(t),e==="finish"&&Xi()});function xf(){return r.mode==="custom"&&Xa()===!0||r.mode==="custom"&&(ve()==="word"||ve()==="section")&&(Ku().value>=5e3||Ku().value===0)||r.mode==="custom"&&ve()==="time"&&(ye()>=3600||ye()===0)||r.mode==="words"&&r.words>=5e3||r.words===0||r.mode==="time"&&(r.time>=3600||r.time===0)||r.mode==="zen"}const U9={title:"Are you sure...",list:[{id:"bailOutNo",display:"Nevermind",available:()=>xf()},{id:"bailOutForSure",display:"Yes, I am sure",exec:()=>{kp(!0),Xi()},available:()=>xf()}]},V9=[{id:"bailOut",display:"Bail out...",icon:"fa-running",subgroup:U9,visible:!1,available:()=>xf()}],K9=[{id:"addQuoteToFavorite",display:"Add current quote to favorite",icon:"fa-heart",available:()=>{const e=me;return A()&&e!==null&&r.mode==="quote"&&!ct.isQuoteFavorite(e)},exec:async()=>{try{Z(),await ct.setQuoteFavorite(me,!0),N(),f("Quote added to favorites",1)}catch(e){N();const t=ie(e,"Failed to add quote to favorites");f(t,-1)}}},{id:"removeQuoteFromFavorite",display:"Remove current quote from favorite",icon:"fa-heart-broken",available:()=>{const e=me;return A()&&e!==null&&r.mode==="quote"&&ct.isQuoteFavorite(e)},exec:async()=>{try{Z(),await ct.setQuoteFavorite(me,!1),N(),f("Quote removed from favorites",1)}catch(e){N();const t=ie(e,"Failed to remove quote from favorites");f(t,-1)}}}],j9={title:"Result saving...",list:[{id:"setResultSavingOff",display:"off",alias:"disabled incognito",exec:()=>{Wg(!1),Ot()}},{id:"setResultSavingOn",display:"on",alias:"enabled incognito",exec:()=>{Wg(!0),Ot()}}]},tw=[{id:"setResultSaving",display:"Result saving...",icon:"fa-save",alias:"results",subgroup:j9}];class _m{constructor(t,a){this.inputElement=t,n(this.inputElement).wrap('<div class="inputAndIndicator"></div>'),this.parentElement=n(this.inputElement).parent(".inputAndIndicator"),this.options=a,this.currentStatus=null;let o='<div class="statusIndicator">';for(const[i,s]of Object.entries(a))o+=`
      <div
        class="indicator level${s.level} hidden"
        data-option-id="${i}"
        
        ${(s.message?.length??0)>27?'data-balloon-length="large"':""}
        data-balloon-pos="left"
        ${s.message??""?`aria-label="${s.message}"`:""}
      >
        <i class="fas fa-fw ${s.icon} ${s.spinIcon?"fa-spin":""}"></i>
      </div>
      `;o+="</div>",this.parentElement.append(o)}hide(){this.parentElement.find(".statusIndicator div").addClass("hidden"),this.currentStatus=null,n(this.inputElement).css("padding-right","0.5em")}show(t,a){this.hide(),this.currentStatus=t;const o=this.parentElement.find(`[data-option-id="${t}"]`);o.removeClass("hidden"),a!==void 0&&a!==""&&(a.length>20?o.attr("data-balloon-length","large"):o.removeAttr("data-balloon-length"),o.attr("aria-label",a)),n(this.inputElement).css("padding-right","2.1em"),this.parentElement.attr("data-indicator-status",t)}get(){return this.currentStatus}}function G9(e,t){return e<=0?t:Mt(e,t)}function aw(e,t,a){let o=t.isValid!==void 0?G9(t.debounceDelay??250,async(i,s,l)=>{const c=await t.isValid?.(l);i.value===s&&(c===!0?e({status:"success"}):typeof c=="object"&&"warning"in c?e({status:"warning",errorMessage:c.warning}):e({status:"failed",errorMessage:c}))}):void 0;return async i=>{const s=i.target,l=s.value;let c=l;if(a!==void 0&&(c=a(l)),e({status:"checking"}),t.schema!==void 0){const d=t.schema.safeParse(c);if(!d.success){e({status:"failed",errorMessage:d.error.errors.map(u=>u.message).join(", ")});return}}if(o===void 0){e({status:"success"}),s.oninput?.(i);return}await o(s,l,c),s.oninput?.(i)}}function Fa(e,t){const a=new _m(e,{success:{icon:"fa-check",level:1},failed:{icon:"fa-times",level:-1},warning:{icon:"fa-exclamation-triangle",level:1},checking:{icon:"fa-circle-notch",spinIcon:!0,level:0}});let o={status:"checking"};const s=aw(c=>{o=c,c.status==="failed"||c.status==="warning"?a.show(c.status,c.errorMessage):a.show(c.status),t.callback?.(c)},t,"inputValueConvert"in t?t.inputValueConvert:void 0);e.addEventListener("input",s);const l=e;return l.getValidationResult=()=>o,l.setValue=c=>{e.value=c??"",c===null?(a.hide(),o={status:"checking"}):e.dispatchEvent(new Event("input"))},l.triggerValidation=()=>{e.dispatchEvent(new Event("input"))},l}function Ln({input:e,configName:t,validation:a}){if(e===null)throw new Error(`Failed to find input element for ${t}`);const o=a!==void 0&&"inputValueConvert"in a?a.inputValueConvert:void 0;let i="checking";if(a!==void 0){const c=Hr.shape[t];Fa(e,{schema:a.schema?c:void 0,isValid:a.isValid,inputValueConvert:o,callback:d=>{i=d.status}})}let s;const l=()=>{if(e.value===""&&(a?.resetIfEmpty??!0)&&(e.value=new String(r[t]).toString(),e.dispatchEvent(new Event("input"))),i==="failed"){e.parentElement?.classList.add("hasError"),s!==null&&clearTimeout(s),s=setTimeout(()=>{e.parentElement?.classList.remove("hasError")},500);return}const c=o?.(e.value)??e.value;if(r[t]===c)return;$(t,c,!1)&&f("Saved",1,{duration:1})};e.addEventListener("keypress",c=>{c.key==="Enter"&&l()}),e.addEventListener("focusout",c=>l())}class B{constructor(t,a,o,i){this.configName=t,this.mode=o,this.configFunction=a,this.setCallback=i?.setCallback,this.updateCallback=i?.updateCallback,this.validation=i?.validation;const s=l=>{let c=l;return this.validation!==void 0&&"inputValueConvert"in this.validation&&(c=this.validation.inputValueConvert(l)),c==="true"&&(c=!0),c==="false"&&(c=!1),c};if(this.mode==="select"){const l=document.querySelector(`.pageSettings .section[data-config-name=${this.configName}] select`);if(l===null)throw new Error(`Failed to find select element for ${t}`);if(l.hasAttribute("multiple"))throw new Error("multi-select dropdowns not supported. Config: "+this.configName);l.addEventListener("change",c=>{const d=n(c.target);d.hasClass("disabled")||d.hasClass("no-auto-handle")||this.setValue(d.val())}),this.elements=[l]}else if(this.mode==="button"){const l=document.querySelectorAll(`
        .pageSettings .section[data-config-name=${this.configName}] .buttons button, .pageSettings .section[data-config-name=${this.configName}] .inputs button`);if(l.length===0)throw new Error(`Failed to find a button element for ${t}`);for(const c of l)c.addEventListener("click",d=>{if(c.classList.contains("disabled")||c.classList.contains("no-auto-handle"))return;let u=c.getAttribute("data-config-value");if(u===null||u===""){console.error(`Failed to handle settings button click for ${t}: data-${t} is missing or empty.`),f("Button is missing data property. Please report this.",-1);return}let p=s(u);this.setValue(p)});this.elements=Array.from(l)}else if(this.mode==="input"){const l=document.querySelector(`
        .pageSettings .section[data-config-name=${this.configName}] .inputs .inputAndButton input`);if(l===null)throw new Error(`Failed to find input element for ${t}`);let c;this.validation!==void 0&&(c={schema:this.validation.schema??!1,isValid:this.validation.isValid,inputValueConvert:"inputValueConvert"in this.validation?this.validation.inputValueConvert:void 0}),Ln({input:l,configName:this.configName,validation:c}),this.elements=[l]}else if(this.mode==="range"){const l=document.querySelector(`.pageSettings .section[data-config-name=${this.configName}] input[type=range]`);if(l===null)throw new Error(`Failed to find range element for ${t}`);const c=Mt(250,d=>{this.setValue(d)});l.addEventListener("input",d=>{if(l.classList.contains("disabled")||l.classList.contains("no-auto-handle"))return;const u=parseFloat(l.value);this.updateUI(u),c(u)}),this.elements=[l]}else this.elements=[];if(this.elements.length===0||this.elements===void 0)throw new Error(`Failed to find elements for ${t} with mode ${o}`);this.updateUI()}setValue(t){if(r[this.configName]===t)return!1;const a=this.configFunction(t);return this.updateUI(),this.setCallback&&this.setCallback(),a}updateUI(t){const a=t??r[this.configName];if(this.mode==="select"){const o=this.elements?.[0];if(!o)return;const i=o.slim;if(i!==void 0){const s=i.getSelected()[0]??null;a!==s&&i.setSelected(a)}else o.value!==a&&(o.value=a)}else if(this.mode==="button")for(const o of this.elements){let s=o.getAttribute("data-config-value");s==="true"&&(s=!0),s==="false"&&(s=!1),s!==a?o.classList.remove("active"):o.classList.add("active")}else if(this.mode==="range"){const o=this.elements?.[0],i=document.querySelector(`.pageSettings .section[data-config-name='${this.configName}'] .value`);if(o==null||i===null)return;o.value=a,i.textContent=`${a.toFixed(1)}`}this.updateCallback&&this.updateCallback()}}const ow=new pt({key:"activeTags",schema:q.array(zb),fallback:[]});function qs(){const e=[];S()?.tags?.forEach(t=>{t.active===!0&&e.push(t._id)}),ow.set(e)}function Q9(e=!1){const t=S();t&&(t.tags=t.tags?.map(a=>(a.active=!1,a)),at(t),Ot(),e||qs())}function Y9(e,t,a=!1){const o=S();o&&(o.tags=o.tags?.map(i=>(i._id===e&&(i.active=t),i)),at(o),Ot(),a||qs())}function Em(e,t=!1){S()?.tags?.forEach(a=>{a._id===e&&(a.active===void 0?a.active=!0:a.active=!a.active)}),Ot(),t||qs()}function J9(){const e=ow.get();for(const t of e)Em(t,!0);qs()}qa(e=>{e.type==="snapshotUpdated"&&e.data.isInitial&&J9()});async function iw(e){const t=S();if(!t)return;const a=t.presets?.find(o=>o._id===e);if(a!==void 0){if($h(a)?await es({...structuredClone(r),...a.config}):await es(a.config),(!$h(a)||a.settingGroups?.includes("behavior"))&&(Q9(!0),a.config.tags)){for(const o of a.config.tags)Y9(o,!0,!1);qs()}R(),f("Preset applied",1,{duration:2}),xs()}}function $h(e){return e.settingGroups!==void 0&&e.settingGroups!==null}async function X9(e){const t=S();if(!t)return;const a=t.presets?.find(o=>o._id===e);if(a===void 0){f("Preset not found",0);return}return a}function nw(){let e=r.theme;r.randomTheme!=="off"&&r.randomTheme!=="custom"&&ze!==null&&(e=ze),document.querySelectorAll(".pageSettings .section.themes .theme").forEach(t=>{t.classList.remove("active")}),document.querySelector(`.pageSettings .section.themes .theme[theme='${e}']`)?.classList.add("active")}function ms(e,t,a=!1,o=!1){if(a){const d=e.find("input.color").attr("id");d===void 0&&console.error("Could not find color ID!"),!o&&d!==void 0&&document.documentElement.style.setProperty(d,t);const u=e.find("label");u.val(t),u.attr("value",t),u.attr("for")!=="--bg-color"&&u.css("background-color",t),e.find("input.input").val(t),e.find("input.color").attr("value",t),e.find("input.color").val(t);return}const i=[{rule:/\b[0-9]{1,3},\s?[0-9]{1,3},\s?[0-9]{1,3}\s*\b/,start:"rgb(",end:")"},{rule:/\b[A-Z, a-z, 0-9]{6}\b/,start:"#",end:""},{rule:/\b[0-9]{1,3},\s?[0-9]{1,3}%,\s?[0-9]{1,3}%?\s*\b/,start:"hsl(",end:")"}];t=t.replace("°","");for(const d of i)if(t.match(d.rule)){t=d.start+t+d.end;break}t=t.replace("##","#"),n(".colorConverter").css("color",t);const s=px(n(".colorConverter").css("color"));if(s===void 0)return;t=s;const l=e.find("input.color").attr("id");l===void 0&&console.error("Could not find color ID!"),!o&&l!==void 0&&document.documentElement.style.setProperty(l,t);const c=e.find("label");c.val(t),c.attr("value",t),c.attr("for")!=="--bg-color"&&c.css("background-color",t),e.find("input.input").val(t),e.find("input.color").attr("value",t),e.find("input.color").val(t)}async function sw(){const e=document.querySelector(".pageSettings .section.themes .favThemes.buttons"),t=document.querySelector(".pageSettings .section.themes .allThemes.buttons");if(e===null||t===null){const l="Failed to fill preset theme buttons: favThemes or allThemes element not found";f(l,-1),Mp(new Error(l)),console.error(l,{favThemesEl:e,themesEl:t});return}e.innerHTML="",t.innerHTML="";let a="",o="",i=r.theme;r.randomTheme!=="off"&&r.randomTheme!=="custom"&&ze!==null&&(i=ze);const s=m6;if(r.favThemes.length>0){e.style.marginBottom="1rem";for(const l of s)if(r.favThemes.includes(l.name)){const c=i===l.name?"active":"";a+=`<div class="theme button ${c}" theme='${l.name}' style="background: ${l.bgColor}; color: ${l.mainColor};outline: 0 solid ${l.mainColor};">
          <div class="favButton active"><i class="fas fa-star"></i></div>
          <div class="text">${l.name.replace(/_/g," ")}</div>
          <div class="themeBubbles" style="background: ${l.bgColor};outline: 0.25rem solid ${l.bgColor};">
            <div class="themeBubble" style="background: ${l.mainColor}"></div>
            <div class="themeBubble" style="background: ${l.subColor}"></div>
            <div class="themeBubble" style="background: ${l.textColor}"></div>
          </div>
          </div>
          `}e.innerHTML=a}else e.style.marginBottom="0";for(const l of s){if(r.favThemes.includes(l.name))continue;const c=i===l.name?"active":"";o+=`<div class="theme button ${c}" theme='${l.name}' style="background: ${l.bgColor}; color: ${l.mainColor};outline: 0 solid ${l.mainColor};">
      <div class="favButton"><i class="far fa-star"></i></div>
      <div class="text">${l.name.replace(/_/g," ")}</div>
      <div class="themeBubbles" style="background: ${l.bgColor};outline: 0.25rem solid ${l.bgColor};">
        <div class="themeBubble" style="background: ${l.mainColor}"></div>
        <div class="themeBubble" style="background: ${l.subColor}"></div>
        <div class="themeBubble" style="background: ${l.textColor}"></div>
      </div>
      </div>
      `}t.innerHTML=o}async function Wd(){const e=n(".pageSettings .section.themes .allCustomThemes.buttons").empty(),t=n(".pageSettings .section.themes .addCustomThemeButton"),a=n(".pageSettings .section.themes .tabContent.customTheme #saveCustomThemeButton");if(!A()){a.text("save"),t.addClass("hidden"),e.css("margin-bottom","0");return}a.text("save as new"),t.removeClass("hidden");const o=S()?.customThemes??[];o.length===0?e.css("margin-bottom","0"):e.css("margin-bottom","1rem");for(const i of o){const s=i.colors[0],l=i.colors[1];e.append(`<div class="customTheme button" customThemeId='${i._id}' 
      style="color:${l};background:${s}">
      <div class="editButton"><i class="fas fa-pen"></i></div>
      <div class="text">${i.name.replace(/_/g," ")}</div>
      <div class="delButton"><i class="fas fa-trash fa-fw"></i></div>
      </div>`)}}function Z9(e=!1){n(".pageSettings .section.themes .tabContainer .customTheme .colorPicker").each((t,a)=>{const o=r.customThemeColors[ko.indexOf(n(a).find("input.color").attr("id"))];ms(n(a),o,!1,e)})}function e7(e){if(r.favThemes.includes(e))yc(r.favThemes.filter(t=>t!==e));else{const t=r.favThemes;t.push(e),yc(t)}xs()}function t7(){const e=[];for(const t of ko)e.push(n(`.pageSettings .tabContent.customTheme #${t}[type='color']`).attr("value"));Xn(e),f("Custom theme saved",1)}function a7(){n(".pageSettings .section.themes .tabs button").removeClass("active"),n(`.pageSettings .section.themes .tabs button[data-tab="${r.customTheme?"custom":"preset"}"]`).addClass("active"),r.customTheme?jn(document.querySelector('.pageSettings [tabContent="preset"]'),document.querySelector('.pageSettings [tabContent="custom"]'),250):jn(document.querySelector('.pageSettings [tabContent="custom"]'),document.querySelector('.pageSettings [tabContent="preset"]'),250)}async function o7(){await sw(),nw()}n(".pageSettings .section.themes .tabs button").on("click",e=>{n(".pageSettings .section.themes .tabs button").removeClass("active");const t=n(e.currentTarget);t.addClass("active"),t.attr("data-tab")==="preset"?mo(!1):mo(!0)});n(".pageSettings").on("click"," .section.themes .customTheme.button",e=>{if(n(e.target).hasClass("delButton")||n(e.target).hasClass("editButton"))return;const t=n(e.currentTarget).attr("customThemeId")??"",a=S()?.customThemes?.find(o=>o._id===t);if(a===void 0){console.error("Could not find custom theme in snapshot for id ",t);return}Xn(a.colors)});n(".pageSettings").on("click",".section.themes .theme .favButton",e=>{const t=n(e.currentTarget).parents(".theme.button").attr("theme");t!==void 0?e7(t):console.error("Could not find the theme attribute attached to the button clicked!")});n(".pageSettings").on("click",".section.themes .theme.button",e=>{const t=n(e.currentTarget).attr("theme");!n(e.target).hasClass("favButton")&&t!==void 0&&Ep(t)});n(".pageSettings .section.themes .tabContainer .customTheme input[type=color]").on("input",e=>{const t=n(e.currentTarget).attr("id"),a=n(e.currentTarget).val();ms(n(".colorPicker #"+t).parent(),a,!0)});n(".pageSettings .section.themes .tabContainer .customTheme input[type=color]").on("change",e=>{const t=n(e.currentTarget).attr("id"),a=n(e.currentTarget).val();ms(n(".colorPicker #"+t).parent(),a)});n(".pageSettings .section.themes .tabContainer .customTheme input.input").on("blur",e=>{if(e.target.id==="name")return;const t=n(e.currentTarget).attr("id"),a=n(e.currentTarget).val();ms(n(".colorPicker #"+t).parent(),a)}).on("keypress",function(e){if(e.target.id!=="name"&&e.code==="Enter"){n(this).attr("disabled","disabled");const t=n(e.currentTarget).attr("id"),a=n(e.currentTarget).val();ms(n(".colorPicker #"+t).parent(),a),n(this).removeAttr("disabled")}});n(".pageSettings #loadCustomColorsFromPreset").on("click",async()=>{await iv(r.theme),ko.forEach(t=>{document.documentElement.style.setProperty(t,"")}),av();const e=await ci();ko.forEach(t=>{let a;t==="--bg-color"?a=e.bg:t==="--main-color"?a=e.main:t==="--sub-color"?a=e.sub:t==="--sub-alt-color"?a=e.subAlt:t==="--caret-color"?a=e.caret:t==="--text-color"?a=e.text:t==="--error-color"?a=e.error:t==="--error-extra-color"?a=e.errorExtra:t==="--colorful-error-color"?a=e.colorfulError:t==="--colorful-error-extra-color"&&(a=e.colorfulErrorExtra),ms(n(".colorPicker #"+t).parent(),a)})});n(".pageSettings #saveCustomThemeButton").on("click",async()=>{if(t7(),A()){const e={name:"custom",colors:r.customThemeColors};Z(),await IS(e),N()}Wd()});ge(e=>{e==="theme"&&X()==="settings"&&nw(),e==="favThemes"&&X()==="settings"&&sw()});const ro={mode:"import",value:""};function rw(e,t){ro.mode=e,ro.value="",Tf.show({focusFirstInput:"focusAndSelect",beforeAnimation:async a=>{a.querySelector("input").value=ro.value,ro.mode==="export"?(a.querySelector("button")?.classList.add("hidden"),a.querySelector("input")?.setAttribute("readonly","true")):ro.mode==="import"&&(a.querySelector("button")?.classList.remove("hidden"),a.querySelector("input")?.removeAttribute("readonly"))}})}const Tf=new re({dialogId:"importExportSettingsModal",setup:async e=>{e.querySelector("input")?.addEventListener("input",t=>{ro.value=t.target.value}),e?.addEventListener("submit",async t=>{if(t.preventDefault(),ro.mode==="import"){if(ro.value===""){Tf.hide();return}await zy(ro.value),Tf.hide()}})}});async function Ks(){}class to{constructor(t){this.id=t.id,this.display=t.display,this.element=t.element,this.pathname=t.path,this.loadingOptions=t.loadingOptions,this.beforeHide=t.beforeHide??Ks,this.afterHide=t.afterHide??Ks,this._beforeShow=t.beforeShow??Ks,this.afterShow=t.afterShow??Ks}async beforeShow(t){await this._beforeShow?.(t)}}class qm extends to{constructor(t){super(t),this.urlSchema=t.urlParamsSchema,this._beforeShow=t.beforeShow??Ks}readUrlParams(){const t=new URLSearchParams(window.location.search),a=u2({schema:this.urlSchema,input:t});if(a.success)return a.data}setUrlParams(t){const a=f2({schema:this.urlSchema,data:t}),o=`${window.location.pathname}?${a.toString()}`;window.history.replaceState({},"",o)}async beforeShow(t){const a=this.readUrlParams();await this._beforeShow?.({...t,urlParams:a})}}const Oc=wk._def.values,lo={Roboto_Mono:{fileName:"RobotoMono-Regular.woff2"},Noto_Naskh_Arabic:{fileName:"NotoNaskhArabic-Regular.woff2"},Source_Code_Pro:{fileName:"SourceCodePro-Regular.woff2"},IBM_Plex_Sans:{fileName:"IBMPlexSans-SemiBold.woff2",weight:600},Inconsolata:{fileName:"Inconsolata-Regular.woff2"},Fira_Code:{fileName:"FiraCode-Regular.woff2"},JetBrains_Mono:{fileName:"JetBrainsMono-Regular.woff2"},Roboto:{fileName:"Roboto-Regular.woff2"},Montserrat:{fileName:"Montserrat-Regular.woff2"},Titillium_Web:{fileName:"TitilliumWeb-Regular.woff2"},Lexend_Deca:{fileName:"LexendDeca-Regular.woff2"},Comic_Sans_MS:{display:"Helvetica",systemFont:!0},Oxygen:{fileName:"Oxygen-Regular.woff2"},Nunito:{fileName:"Nunito-Bold.woff2",weight:700},Itim:{fileName:"Itim-Regular.woff2"},Courier:{systemFont:!0},Comfortaa:{fileName:"Comfortaa-Regular.woff2"},Coming_Soon:{fileName:"ComingSoon-Regular.woff2"},Atkinson_Hyperlegible:{fileName:"AtkinsonHyperlegible-Regular.woff2"},Lato:{fileName:"Lato-Regular.woff2"},Lalezar:{fileName:"Lalezar-Regular.woff2"},Boon:{display:"Boon (ไทย)",fileName:"Boon-Regular.woff2"},Open_Dyslexic:{fileName:"OpenDyslexic-Regular.woff2"},Ubuntu:{fileName:"Ubuntu-Regular.woff2"},Ubuntu_Mono:{fileName:"UbuntuMono-Regular.woff2"},Georgia:{systemFont:!0},Cascadia_Mono:{fileName:"CascadiaMono-Regular.woff2"},IBM_Plex_Mono:{fileName:"IBMPlexMono-Regular.woff2"},Overpass_Mono:{fileName:"OverpassMono-Regular.woff2"},Hack:{fileName:"Hack-Regular.woff2"},CommitMono:{fileName:"CommitMono-Regular.woff2"},Mononoki:{fileName:"Mononoki-Regular.woff2"},Parkinsans:{fileName:"Parkinsans-Regular.woff2"},Geist:{fileName:"Geist-Medium.woff2"},Sarabun:{fileName:"Sarabun-Bold.woff2"},Kanit:{fileName:"Kanit-Regular.woff2"},Geist_Mono:{fileName:"GeistMono-Medium.woff2"},Iosevka:{fileName:"Iosevka-Regular.woff2"},Proto:{display:"0xProto",fileName:"0xProto-Regular.woff2"}},zd=document.querySelector(".pageSettings .section[data-config-name='customBackgroundSize']"),Lf=zd?.querySelector(".usingLocalImage"),Mh=zd?.querySelector(".separator"),$f=zd?.querySelector(".uploadContainer"),Ah=zd?.querySelector(".inputAndButton");async function i7(e){return new Promise((t,a)=>{const o=new FileReader;o.onload=()=>t(o.result),o.onerror=a,o.readAsDataURL(e)})}async function Er(){await Je.hasFile("LocalBackgroundFile")?(Lf?.classList.remove("hidden"),Mh?.classList.add("hidden"),$f?.classList.add("hidden"),Ah?.classList.add("hidden")):(Lf?.classList.add("hidden"),Mh?.classList.remove("hidden"),$f?.classList.remove("hidden"),Ah?.classList.remove("hidden"))}Lf?.querySelector("button")?.addEventListener("click",async()=>{await Je.deleteFile("LocalBackgroundFile"),await Er(),await fs()});$f?.querySelector("input[type='file']")?.addEventListener("change",async e=>{const t=e.target,a=t.files?.[0];if(!a)return;if(!a.type.match(/image\/(jpeg|jpg|png|gif|webp)/)){f("Unsupported image format",0),t.value="";return}const o=await i7(a);await Je.storeFile("LocalBackgroundFile",o),await Er(),await fs(),t.value=""});const Hd=document.querySelector(".pageSettings .section[data-config-name='fontFamily']"),Mf=Hd?.querySelector(".usingLocalFont"),_h=Hd?.querySelector(".separator"),Af=Hd?.querySelector(".uploadContainer"),Eh=Hd?.querySelector(".buttons");async function n7(e){return new Promise((t,a)=>{const o=new FileReader;o.onload=()=>t(o.result),o.onerror=a,o.readAsDataURL(e)})}async function qr(){await Je.hasFile("LocalFontFamilyFile")?(Mf?.classList.remove("hidden"),_h?.classList.add("hidden"),Af?.classList.add("hidden"),Eh?.classList.add("hidden")):(Mf?.classList.add("hidden"),_h?.classList.remove("hidden"),Af?.classList.remove("hidden"),Eh?.classList.remove("hidden"))}Mf?.querySelector("button")?.addEventListener("click",async()=>{await Je.deleteFile("LocalFontFamilyFile"),await qr(),await Tr()});Af?.querySelector("input[type='file']")?.addEventListener("change",async e=>{const t=e.target,a=t.files?.[0];if(!a)return;if(!a.type.match(/font\/(woff|woff2|ttf|otf)/)&&!a.name.match(/\.(woff|woff2|ttf|otf)$/i)){f("Unsupported font format, must be woff, woff2, ttf or otf.",0),t.value="";return}const o=await n7(a);await Je.storeFile("LocalFontFamilyFile",o),await qr(),await Tr(),t.value=""});const lw=document.querySelector("#pageSettings .section.fpsLimit"),_f=lw.querySelector("button[data-fpsLimit='native']"),gs=Fa(lw.querySelector('input[type="number"]'),{schema:hv,inputValueConvert:e=>parseInt(e,10)});function Im(){const e=_6();e>=1e3?(gs.setValue(null),_f.classList.add("active")):(gs.value=e.toString(),_f.classList.remove("active"))}function cw(e){A6(e)&&f("FPS limit updated",0),Im()}function dw(){if(gs.getValidationResult().status!=="success")return;const e=parseInt(gs.value,10);cw(e)}_f.addEventListener("click",()=>{cw(1e3),Im()});gs.addEventListener("keypress",e=>{e.key==="Enter"&&dw()});gs.addEventListener("focusout",e=>dw());let qh=!1,ac,oc;const E={},s7=Ck.or(q.enum(["resetSettings","updateCookiePreferences","importexportSettings","theme","presets","tags"])),r7=q.object({highlight:s7}).partial();async function l7(){E.smoothCaret=new B("smoothCaret",t3,"button"),E.codeUnindentOnBackspace=new B("codeUnindentOnBackspace",a3,"button"),E.difficulty=new B("difficulty",no,"button"),E.quickRestart=new B("quickRestart",n3,"button"),E.showAverage=new B("showAverage",U5,"button"),E.keymapMode=new B("keymapMode",fa,"button",{updateCallback:()=>{r.keymapMode==="off"?(n(".pageSettings .section[data-config-name='keymapStyle']").addClass("hidden"),n(".pageSettings .section[data-config-name='keymapLayout']").addClass("hidden"),n(".pageSettings .section[data-config-name='keymapLegendStyle']").addClass("hidden"),n(".pageSettings .section[data-config-name='keymapShowTopRow']").addClass("hidden"),n(".pageSettings .section[data-config-name='keymapSize']").addClass("hidden")):(n(".pageSettings .section[data-config-name='keymapStyle']").removeClass("hidden"),n(".pageSettings .section[data-config-name='keymapLayout']").removeClass("hidden"),n(".pageSettings .section[data-config-name='keymapLegendStyle']").removeClass("hidden"),n(".pageSettings .section[data-config-name='keymapShowTopRow']").removeClass("hidden"),n(".pageSettings .section[data-config-name='keymapSize']").removeClass("hidden"))}}),E.keymapStyle=new B("keymapStyle",m3,"button"),E.keymapLayout=new B("keymapLayout",Ti,"select"),E.keymapLegendStyle=new B("keymapLegendStyle",p3,"button"),E.keymapShowTopRow=new B("keymapShowTopRow",g3,"button"),E.keymapSize=new B("keymapSize",pd,"range"),E.showKeyTips=new B("showKeyTips",e3,"button"),E.freedomMode=new B("freedomMode",s3,"button",{setCallback:()=>{E.confidenceMode?.updateUI()}}),E.strictSpace=new B("strictSpace",z5,"button"),E.oppositeShiftMode=new B("oppositeShiftMode",H5,"button"),E.confidenceMode=new B("confidenceMode",r3,"button",{setCallback:()=>{E.freedomMode?.updateUI(),E.stopOnError?.updateUI()}}),E.indicateTypos=new B("indicateTypos",l3,"button"),E.hideExtraLetters=new B("hideExtraLetters",j5,"button"),E.blindMode=new B("blindMode",x5,"button"),E.quickEnd=new B("quickEnd",P5,"button"),E.repeatQuotes=new B("repeatQuotes",R5,"button"),E.ads=new B("ads",B5,"button"),E.alwaysShowWordsHistory=new B("alwaysShowWordsHistory",q5,"button"),E.britishEnglish=new B("britishEnglish",f3,"button"),E.singleListCommandLine=new B("singleListCommandLine",I5,"button"),E.capsLockWarning=new B("capsLockWarning",F5,"button"),E.flipTestColors=new B("flipTestColors",D5,"button"),E.showOutOfFocusWarning=new B("showOutOfFocusWarning",$5,"button"),E.colorfulMode=new B("colorfulMode",W5,"button"),E.startGraphsAtZero=new B("startGraphsAtZero",o3,"button"),E.autoSwitchTheme=new B("autoSwitchTheme",Dy,"button"),E.randomTheme=new B("randomTheme",u3,"button"),E.stopOnError=new B("stopOnError",By,"button",{setCallback:()=>{E.confidenceMode?.updateUI()}}),E.soundVolume=new B("soundVolume",k5,"range"),E.playTimeWarning=new B("playTimeWarning",S5,"button",{setCallback:()=>{r.playTimeWarning!=="off"&&Rc()}}),E.playSoundOnError=new B("playSoundOnError",w5,"button",{setCallback:()=>{r.playSoundOnError!=="off"&&il()}}),E.playSoundOnClick=new B("playSoundOnClick",C5,"button",{setCallback:()=>{r.playSoundOnClick!=="off"&&Ea("KeyQ")}}),E.showAllLines=new B("showAllLines",Ou,"button"),E.paceCaret=new B("paceCaret",M5,"button"),E.repeatedPace=new B("repeatedPace",A5,"button"),E.minWpm=new B("minWpm",_5,"button"),E.minAcc=new B("minAcc",E5,"button"),E.minBurst=new B("minBurst",Vl,"button"),E.smoothLineScroll=new B("smoothLineScroll",i3,"button"),E.lazyMode=new B("lazyMode",An,"button"),E.layout=new B("layout",Do,"select"),E.language=new B("language",Zn,"select"),E.fontSize=new B("fontSize",h3,"input",{validation:{schema:!0,inputValueConvert:Number}}),E.maxLineWidth=new B("maxLineWidth",b3,"input",{validation:{schema:!0,inputValueConvert:Number}}),E.caretStyle=new B("caretStyle",O5,"button"),E.paceCaretStyle=new B("paceCaretStyle",N5,"button"),E.timerStyle=new B("timerStyle",G5,"button"),E.liveSpeedStyle=new B("liveSpeedStyle",Q5,"button"),E.liveAccStyle=new B("liveAccStyle",Y5,"button"),E.liveBurstStyle=new B("liveBurstStyle",J5,"button"),E.highlightMode=new B("highlightMode",Si,"button"),E.tapeMode=new B("tapeMode",V5,"button"),E.tapeMargin=new B("tapeMargin",K5,"input",{validation:{schema:!0,inputValueConvert:Number}}),E.timerOpacity=new B("timerOpacity",Z5,"button"),E.timerColor=new B("timerColor",X5,"button"),E.fontFamily=new B("fontFamily",Ry,"button",{updateCallback:()=>{const e=n(".pageSettings .section[data-config-name='fontFamily'] .buttons button[data-config-value='custom']");n(".pageSettings .section[data-config-name='fontFamily'] .buttons .active").length===0?(e.addClass("active"),e.text(`Custom (${r.fontFamily.replace(/_/g," ")})`)):e.text("Custom")}}),E.alwaysShowDecimalPlaces=new B("alwaysShowDecimalPlaces",T5,"button"),E.typingSpeedUnit=new B("typingSpeedUnit",L5,"button"),E.customBackgroundSize=new B("customBackgroundSize",Wy,"button")}async function c7(){if(qh)return;new Ge({select:".pageSettings .section[data-config-name='language'] select",data:Ih(i=>i===r.language),settings:{searchPlaceholder:"search"}});const e=i=>({value:i,text:i.replace(/_/g," ")});new Ge({select:".pageSettings .section[data-config-name='layout'] select",data:[{text:"off",value:"default"},...Oc.filter(i=>i!=="korean").map(e)]}),new Ge({select:".pageSettings .section[data-config-name='keymapLayout'] select",data:[{text:"emulator sync",value:"overrideSync"},...Oc.map(e)]}),new Ge({select:".pageSettings .section[data-config-name='autoSwitchThemeInputs'] select.light",data:Fh(i=>i.name===r.themeLight),events:{afterChange:i=>{c3(i[0]?.value)}}}),new Ge({select:".pageSettings .section[data-config-name='autoSwitchThemeInputs'] select.dark",data:Fh(i=>i.name===r.themeDark),events:{afterChange:i=>{d3(i[0]?.value)}}});const t=document.querySelector(".pageSettings .section[data-config-name='funbox'] .buttons");let a="";for(const i of gp())i.name==="mirror"?a+=`<button class="funbox" data-funbox-name="mirror" data-config-value='${i.name}' aria-label="${i.description}" data-balloon-pos="up" data-balloon-length="fit" style="transform:scaleX(-1);">${i.name.replace(/_/g," ")}</button>`:i.name==="upside_down"?a+=`<button class="funbox" data-funbox-name="upside_down" data-config-value='${i.name}' aria-label="${i.description}" data-balloon-pos="up" data-balloon-length="fit" style="transform:scaleX(-1) scaleY(-1); z-index:1;">${i.name.replace(/_/g," ")}</button>`:i.name==="underscore_spaces"?a+=`<button class="funbox" data-funbox-name="underscore_spaces" data-config-value='${i.name}' aria-label="${i.description}" data-balloon-pos="up" data-balloon-length="fit">${i.name}</button>`:a+=`<button class="funbox" data-funbox-name="${i.name}" data-config-value='${i.name}' aria-label="${i.description}" data-balloon-pos="up" data-balloon-length="fit">${i.name.replace(/_/g," ")}</button>`;t.innerHTML=a;const o=document.querySelector(".pageSettings .section[data-config-name='fontFamily'] .buttons");if(o.innerHTML===""){let i="";for(const s of et(lo).sort((l,c)=>(lo[l].display??l.replace(/_/g," ")).localeCompare(lo[c].display??c.replace(/_/g," ")))){const l=lo[s];let c=s.replace(/_/g," ");l.systemFont||(c+=" Preview");const d=r.fontFamily===s?" active":"",u=l.display??s.replace(/_/g," ");i+=`<button class="${d}" style="font-family:'${c}'" data-config-value="${s}">${u}</button>`}i+='<button class="no-auto-handle" data-config-value="custom"">Custom</button>',o.innerHTML=i}ac=new Ge({select:".pageSettings .section[data-config-name='customLayoutfluid'] select",settings:{keepOrder:!0,minSelected:2},events:{afterChange:i=>{const s=i.map(l=>l.value);ur(s,r.customLayoutfluid)||v3(s)}}}),oc=new Ge({select:".pageSettings .section[data-config-name='customPolyglot'] select",settings:{minSelected:2},data:Ih(i=>r.customPolyglot.includes(i)),events:{afterChange:i=>{const s=i.map(l=>l.value);ri(s,r.customPolyglot)||w3(s)}}}),Ln({input:document.querySelector(".pageSettings .section[data-config-name='minWpm'] input"),configName:"minWpmCustomSpeed",validation:{schema:!0,inputValueConvert:i=>dt(r.typingSpeedUnit).toWpm(new Number(i).valueOf())}}),Ln({input:document.querySelector(".pageSettings .section[data-config-name='minAcc'] input"),configName:"minAccCustom",validation:{schema:!0,inputValueConvert:Number}}),Ln({input:document.querySelector(".pageSettings .section[data-config-name='minBurst'] input"),configName:"minBurstCustomSpeed",validation:{schema:!0,inputValueConvert:i=>dt(r.typingSpeedUnit).toWpm(new Number(i).valueOf())}}),Ln({input:document.querySelector(".pageSettings .section[data-config-name='paceCaret'] input"),configName:"paceCaretCustomSpeed",validation:{schema:!0,inputValueConvert:Number}}),Ln({input:document.querySelector(".pageSettings .section[data-config-name='customBackgroundSize'] input[type='text']"),configName:"customBackground",validation:{schema:!0,resetIfEmpty:!1}}),hs(!0),await l7(),await Wd(),hs(!1),qh=!0}function uw(){n(".pageSettings .section.needsAccount").addClass("hidden")}function fw(){n(".pageSettings .section.needsAccount").removeClass("hidden"),mw(),gw()}function pw(){const e=document.querySelectorAll(".pageSettings .section[data-config-name='funbox'] button");for(const t of e){t.classList.remove("active"),t.classList.remove("disabled");const a=t.getAttribute("data-config-value"),o=t.getAttribute("data-funbox-name");a===null||o===null||(r.funbox.includes(o)?t.classList.add("active"):zr(Jt(),o)||t.classList.add("disabled"))}}function mw(){if(A()&&S()){const e=n(".pageSettings .section.tags .tagsList").empty();S()?.tags?.forEach(t=>{e.append(`

      <div class="buttons tag" data-id="${t._id}" data-name="${t.name}" data-display="${t.display}">
        <button class="tagButton ${t.active?"active":""}" active="${t.active}">
          ${t.display}
        </button>
        <button class="clearPbButton" aria-label="clear tags personal bests" data-balloon-pos="left" >
          <i class="fas fa-crown fa-fw"></i>
        </button>
        <button class="editButton" aria-label="rename tag" data-balloon-pos="left" >
          <i class="fas fa-pen fa-fw"></i>
        </button>
        <button class="removeButton" aria-label="remove tag"  data-balloon-pos="left" >
          <i class="fas fa-trash fa-fw"></i>
        </button>
      </div>

      `)}),n(".pageSettings .section.tags").removeClass("hidden")}else n(".pageSettings .section.tags").addClass("hidden")}function gw(){if(A()&&S()){const e=n(".pageSettings .section.presets .presetsList").empty();S()?.presets?.forEach(t=>{e.append(`
      <div class="buttons preset" data-id="${t._id}" data-name="${t.name}" data-display="${t.display}">
        <button class="presetButton">${t.display}</button>
        <button class="editButton">
          <i class="fas fa-pen fa-fw"></i>
        </button>
        <button class="removeButton">
          <i class="fas fa-trash fa-fw"></i>
        </button>
      </div>
      
      `)}),n(".pageSettings .section.presets").removeClass("hidden")}else n(".pageSettings .section.presets").addClass("hidden")}async function hw(){const e=r.customBackground!==""||await Je.hasFile("LocalBackgroundFile"),t=n(".customBackground img").is(":visible");e&&t?n(".pageSettings .section[data-config-name='customBackgroundFilter']").removeClass("hidden"):n(".pageSettings .section[data-config-name='customBackgroundFilter']").addClass("hidden")}async function fo(e={}){if(X()!=="settings")return;r.showKeyTips?n(".pageSettings .tip").removeClass("hidden"):n(".pageSettings .tip").addClass("hidden");for(const s of Object.values(E))"updateUI"in s&&s.updateUI();mw(),gw(),pw(),await ke(0),a7(),Z9(!0),await Er(),await hw(),await qr(),Im();const t=(s,l,c)=>{if(e.eventKey===void 0||e.eventKey===s){const d=document.querySelector(l);if(d===null)throw new Error("Unknown input element "+l);d.value=new String(c).toString(),d.dispatchEvent(new Event("input"))}};t("paceCaret",".pageSettings .section[data-config-name='paceCaret'] input.customPaceCaretSpeed",dt(r.typingSpeedUnit).fromWpm(r.paceCaretCustomSpeed)),t("minWpmCustomSpeed",".pageSettings .section[data-config-name='minWpm'] input.customMinWpmSpeed",dt(r.typingSpeedUnit).fromWpm(r.minWpmCustomSpeed)),t("minAccCustom",".pageSettings .section[data-config-name='minAcc'] input.customMinAcc",r.minAccCustom),t("minBurstCustomSpeed",".pageSettings .section[data-config-name='minBurst'] input.customMinBurst",dt(r.typingSpeedUnit).fromWpm(r.minBurstCustomSpeed)),r.autoSwitchTheme?n(".pageSettings .section[data-config-name='autoSwitchThemeInputs']").removeClass("hidden"):n(".pageSettings .section[data-config-name='autoSwitchThemeInputs']").addClass("hidden"),t("fontSize",".pageSettings .section[data-config-name='fontSize'] input",r.fontSize),t("maxLineWidth",".pageSettings .section[data-config-name='maxLineWidth'] input",r.maxLineWidth),t("keymapSize",".pageSettings .section[data-config-name='keymapSize'] input",r.keymapSize),t("tapeMargin",".pageSettings .section[data-config-name='tapeMargin'] input",r.tapeMargin),t("customBackground",".pageSettings .section[data-config-name='customBackgroundSize'] input[type='text']",r.customBackground),A()?fw():uw(),ov();const a=window.navigator.userAgent.toLowerCase(),o=a.includes("mac")&&!a.includes("firefox")?"cmd":"ctrl",i=r.quickRestart==="esc"?"tab":"esc";n(".pageSettings .tip").html(`
    tip: You can also change all these settings quickly using the
    command line (<key>${i}</key> or <key>${o}</key> + <key>shift</key> + <key>p</key>)`),ac!==void 0&&!ur(ac.getSelected(),r.customLayoutfluid)&&ac.setData(d7()),oc!==void 0&&!ri(oc.getSelected(),r.customPolyglot)&&oc.setSelected(r.customPolyglot)}function bw(e){vw(void 0);const t=n(`.pageSettings .settingsGroup.${e}`);t.stop(!0,!0).slideToggle(250).toggleClass("slideup"),t.hasClass("slideup")?n(`.pageSettings .sectionGroupTitle[group=${e}]`).addClass("rotateIcon"):n(`.pageSettings .sectionGroupTitle[group=${e}]`).removeClass("rotateIcon")}n(".pageSettings .section[data-config-name='funbox'] .buttons").on("click","button",e=>{const t=n(e.currentTarget).attr("data-config-value");V0(t),pw()});n(".pageSettings .section.tags").on("click",".tagsList .tag .tagButton",e=>{const t=e.currentTarget,a=n(t).parent(".tag").attr("data-id");Em(a),n(t).toggleClass("active")});n(".pageSettings .section.presets").on("click",".presetsList .preset .presetButton",async e=>{const t=e.currentTarget,a=n(t).parent(".preset").attr("data-id");await iw(a),fo()});n("#importSettingsButton").on("click",()=>{rw("import")});n("#exportSettingsButton").on("click",()=>{const e=JSON.stringify(r);navigator.clipboard.writeText(e).then(function(){f("JSON Copied to clipboard",0)},function(){rw("export")})});n(".pageSettings .sectionGroupTitle").on("click",e=>{bw(n(e.currentTarget).attr("group"))});n(".pageSettings .section[data-config-name='keymapSize'] .inputAndButton button.save").on("click",()=>{pd(parseFloat(n(".pageSettings .section[data-config-name='keymapSize'] .inputAndButton input").val()))&&f("Saved",1,{duration:1})});n(".pageSettings .section[data-config-name='keymapSize'] .inputAndButton input").on("focusout",()=>{pd(parseFloat(n(".pageSettings .section[data-config-name='keymapSize'] .inputAndButton input").val()))&&f("Saved",1,{duration:1})});n(".pageSettings .section[data-config-name='keymapSize'] .inputAndButton input").on("keypress",e=>{e.key==="Enter"&&pd(parseFloat(n(".pageSettings .section[data-config-name='keymapSize'] .inputAndButton input").val()))&&f("Saved",1,{duration:1})});n(".pageSettings .quickNav .links a").on("click",e=>{const t=e.target.innerText;n(`.pageSettings .settingsGroup.${t}`).hasClass("slideup")&&bw(t)});let yw=!1;function hs(e){yw=e}function Ih(e){return Yp.map(t=>({label:t,options:k0[t]?.map(a=>({text:Aa(a),value:a,selected:e(a)}))}))}function d7(){const e=r.customLayoutfluid;return[...e,...Oc.filter(t=>!e.includes(t))].map(t=>({text:t.replace(/_/g," "),value:t,selected:e.includes(t)}))}function Fh(e){return ol.map(t=>({value:t.name,text:t.name.replace(/_/g," "),selected:e(t)}))}function vw(e){if(e===void 0){const a=document.querySelector(".section.highlight");a!==null&&a.classList.remove("highlight");return}const t=document.querySelector(`[data-config-name="${e}"] .groupTitle,[data-section-id="${e}"] .groupTitle`);t!==null&&setTimeout(()=>{t.scrollIntoView({block:"center",behavior:"auto"}),t.parentElement?.classList.remove("highlight"),t.parentElement?.classList.add("highlight")},250)}n(".pageSettings .section .groupTitle button").on("click",e=>{const t=e.target.parentElement?.parentElement,a=t?.dataset?.configName??t?.dataset?.sectionId;a!==void 0&&(ww.setUrlParams({highlight:a}),navigator.clipboard.writeText(window.location.toString()).then(()=>{f("Link copied to clipboard",1)}).catch(o=>{const i=ie(o,"Failed to copy to clipboard");f(i,-1)}))});ge((e,t)=>{e==="fullConfigChange"&&hs(!0),e==="fullConfigChangeFinished"&&hs(!1),e==="themeLight"?n(`.pageSettings .section[data-config-name='autoSwitchThemeInputs'] select.light option[value="${t}"]`).attr("selected","true"):e==="themeDark"&&n(`.pageSettings .section[data-config-name='autoSwitchThemeInputs'] select.dark option[value="${t}"]`).attr("selected","true"),!(yw||e==="saveToLocalStorage")&&X()==="settings"&&e!=="theme"&&(e==="customBackground"?hw():fo({eventKey:e}))});qa(e=>{e.type==="authStateChanged"&&(e.data.isUserSignedIn?fw():uw())});const ww=new qm({id:"settings",element:n(".page.pageSettings"),path:"/settings",urlParamsSchema:r7,afterHide:async()=>{yt("pageSettings")},beforeShow:async e=>{Ht("pageSettings","main"),await Hy,await c7(),await fo(),await o7(),vw(e.urlParams?.highlight)}});n(async()=>{Nt("pageSettings")});const u7={_id:"default",name:"defaults",pb:{no:!0,yes:!0},difficulty:{normal:!0,expert:!0,master:!0},mode:{words:!0,time:!0,quote:!0,zen:!0,custom:!0},words:{10:!0,25:!0,50:!0,100:!0,custom:!0},time:{15:!0,30:!0,60:!0,120:!0,custom:!0},quoteLength:{short:!0,medium:!0,long:!0,thicc:!0},punctuation:{on:!0,off:!0},numbers:{on:!0,off:!0},date:{last_day:!1,last_week:!1,last_month:!1,last_3months:!1,all:!0},tags:{none:!0},language:Object.fromEntries(Qp.map(e=>[e,!0])),funbox:{none:!0,...Object.fromEntries(kk().map(e=>[e,!0]))}},Tt=structuredClone(u7);function Fm(e){try{const t={};for(const a of et(Tt))if(a==="_id"){let o=e[a]??Tt[a];(o==="default-result-filters-id"||o==="")&&(o="default"),t[a]=o}else a==="name"?t[a]=e[a]??Tt[a]:t[a]={...Tt[a],...e[a]};return t}catch{return Tt}}const Cw=new pt({key:"resultFilters",schema:uc,fallback:Tt,migrate:(e,t)=>_b(e)?Fm(xp(uc.partial().strip(),e)):Tt}),f7=new Set(["language","funbox","tags"]),co={};let Y=Tt;function xo(){Cw.set(Y)}async function p7(){try{Y=Fm(Cw.get());const e={none:!1};Object.keys(Tt.tags).forEach(t=>{Y.tags[t]!==void 0?e[t]=Y.tags[t]:e[t]=!0}),Y.tags=e,xo()}catch{console.log("error in loading result filters"),Y=Tt,xo()}}async function Pm(){const e=document.querySelector(".pageAccount .presetFilterButtons"),t=document.querySelector(".pageAccount .presetFilterButtons .filterBtns");if(!e||!t)return;t.innerHTML="";const a=S()?.filterPresets??[];if(a.length>0){let o="";for(const i of a)o+=`<div class="filterPresets">
      <div class="select-filter-preset button" data-id="${i._id}">${i.name.replace(/_/g," ")}</div>
      <div class="button delete-filter-preset" data-id="${i._id}">
        <i class="fas fa-fw fa-trash"></i>
      </div>
    </div>`;t.innerHTML=o,e.classList.remove("hidden")}else e.classList.add("hidden")}async function m7(e){const t=S()?.filterPresets.find(a=>a._id===e);t&&(Y=x7(t),xo(),_o()),n(".pageAccount .group.presetFilterButtons .filterBtns .filterPresets .select-filter-preset").removeClass("active"),n(`.pageAccount .group.presetFilterButtons .filterBtns .filterPresets .select-filter-preset[data-id=${e}]`).addClass("active")}function g7(e){const t=S();t&&at({...t,filterPresets:[...t.filterPresets,structuredClone(e)]})}async function h7(e){e=e.replace(/ /g,"_"),Z();const t=await T.users.addResultFilterPreset({body:{...Y,name:e}});return N(),t.status===200?(g7({...Y,name:e,_id:t.body.data}),Pm(),1):(console.log("error creating filter preset: "+t.body.message),0)}function b7(e){const t=S();if(!t)return;const a=[...t.filterPresets],o=a.findIndex(i=>i._id===e);o>-1&&a.splice(o,1),at({...t,filterPresets:a})}async function y7(e){Z();const t=await T.users.removeResultFilterPreset({params:{presetId:e}});N(),t.status===200?(b7(e),Pm(),Rm(),f("Filter preset deleted",1)):(f("Error deleting filter preset: "+t.body.message,-1),console.log("error deleting filter preset",t.body.message))}function Bm(){n(".pageAccount .group.presetFilterButtons .filterBtns .filterPresets .select-filter-preset").removeClass("active")}function bs(){return Y}function Ef(e){return Y[e]}function De(e,t){return Y[e][t]}function kw(e,t,a){Y[e][t]=a}function Ka(e,t){Object.keys(Ef(e)).forEach(a=>{Y[e][a]=t})}function v7(){const e=S();e!==void 0&&e.tags.forEach(t=>{Tt.tags[t._id]=!0})}function Rm(){Y=Tt,xo()}function _o(){const e={};for(const o of et(bs()))if(!(o==="_id"||o==="name")){e[o]={all:!0,array:[]};for(const i of et(Ef(o))){const s=e[o];if(s===void 0)continue;const l=De(o,i);if(l===!0?s.array?.push(i):s.all!==void 0&&(s.all=!1),f7.has(o)){const c=n(`.pageAccount .group.filterButtons .filterGroup[group="${o}"] option[value="${i}"]`);l===!0?c.prop("selected",!0):c.prop("selected",!1)}else{let c;o==="date"?c=n(`.pageAccount .group.topFilters .filterGroup[group="${o}"] button[filter="${i}"]`):c=n(`.pageAccount .group.filterButtons .filterGroup[group="${o}"] button[filter="${i}"]`),l===!0?c.addClass("active"):c.removeClass("active")}}}for(const[o,i]of Object.entries(co)){const s=i,l=Ef(o),c=Object.values(l).every(p=>p===!0),d=s.store.getData(),u=n(`.pageAccount .group.filterButtons .filterGroup[group="${o}"] option[value="all"]`);if(c){u.prop("selected",!0);for(const p of d)"value"in p&&(p.value==="all"?p.selected=!0:p.selected=!1);s.store.setData(d),s.render.renderValues()}else u.prop("selected",!1);for(const p of d)"value"in p&&(l[p.value]===!0?p.selected=!0:(!c||p.value!=="all")&&(p.selected=!1));setTimeout(()=>{s.store.setData(d),c||s.render.renderValues(),s.render.renderOptions(d)},0)}function t(o){let i="";return i+="<div class='group'>",o==="difficulty"?i+='<span aria-label="Difficulty" data-balloon-pos="up"><i class="fas fa-fw fa-star"></i>':o==="mode"?i+='<span aria-label="Mode" data-balloon-pos="up"><i class="fas fa-fw fa-bars"></i>':o==="punctuation"?i+='<span aria-label="Punctuation" data-balloon-pos="up"><i class="fas fa-fw fa-at"></i>':o==="numbers"?i+='<span aria-label="Numbers" data-balloon-pos="up"><i class="fas fa-fw fa-hashtag"></i>':o==="words"?i+='<span aria-label="Words" data-balloon-pos="up"><i class="fas fa-fw fa-font"></i>':o==="time"?i+='<span aria-label="Time" data-balloon-pos="up"><i class="fas fa-fw fa-clock"></i>':o==="date"?i+='<span aria-label="Date" data-balloon-pos="up"><i class="fas fa-fw fa-calendar"></i>':o==="tags"?i+='<span aria-label="Tags" data-balloon-pos="up"><i class="fas fa-fw fa-tags"></i>':o==="language"?i+='<span aria-label="Language" data-balloon-pos="up"><i class="fas fa-fw fa-globe-americas"></i>':o==="funbox"&&(i+='<span aria-label="Funbox" data-balloon-pos="up"><i class="fas fa-fw fa-gamepad"></i>'),e[o]?.all?i+="all":o==="tags"?i+=e.tags?.array?.map(s=>{if(s==="none")return s;const l=S();if(l===void 0)return s;const c=l.tags?.find(d=>d._id===s);return c!==void 0?l.tags?.find(d=>d._id===s)?.display:c}).join(", "):i+=e[o]?.array?.join(", ").replace(/_/g," "),i+="</span></div>",i}let a="";a+=t("date"),a+='<div class="spacer"></div>',a+=t("mode"),a+='<div class="spacer"></div>',e.mode?.array?.includes("time")&&(a+=t("time"),a+='<div class="spacer"></div>'),e.mode?.array?.includes("words")&&(a+=t("words"),a+='<div class="spacer"></div>'),a+=t("difficulty"),a+='<div class="spacer"></div>',a+=t("punctuation"),a+='<div class="spacer"></div>',a+=t("numbers"),a+='<div class="spacer"></div>',a+=t("language"),a+='<div class="spacer"></div>',a+=t("funbox"),a+='<div class="spacer"></div>',a+=t("tags"),setTimeout(()=>{n(".pageAccount .group.chart .above").html(a)},0)}function w7(e,t){Bm();try{e==="date"&&Ka("date",!1);const o=!Y[e][t];Y[e][t]=o,xo()}catch(a){f("Something went wrong toggling filter. Reverting to defaults.",0),console.log("toggling filter error"),console.error(a),Rm(),_o()}}n(".pageAccount .filterButtons .buttonsAndTitle .buttons, .pageAccount .group.topFilters .buttonsAndTitle.testDate .buttons").on("click","button",e=>{const t=n(e.target).parents(".buttons").attr("group"),a=n(e.target).attr("filter");n(e.target).hasClass("allFilters")?(et(bs()).forEach(o=>{o==="_id"||o==="name"||Ka(o,!0)}),Ka("date",!1),Y.date.all=!0):n(e.target).hasClass("noFilters")?et(bs()).forEach(o=>{o==="_id"||o==="name"||o!=="date"&&Ka(o,!1)}):n(e.target).is("button")&&(e.shiftKey?(Ka(t,!1),Y[t][a]=!0):w7(t,a)),_o(),xo()});n(".pageAccount .topFilters button.allFilters").on("click",()=>{Bm(),console.log(bs()),et(bs()).forEach(e=>{e==="_id"||e==="name"||Ka(e,!0)}),Ka("date",!1),Y.date.all=!0,_o(),xo()});n(".pageAccount .topFilters button.currentConfigFilter").on("click",()=>{if(Bm(),et(bs()).forEach(e=>{e==="_id"||e==="name"||Ka(e,!1)}),Y.pb.no=!0,Y.pb.yes=!0,Y.difficulty[r.difficulty]=!0,Y.mode[r.mode]=!0,r.mode==="time")if([15,30,60,120].includes(r.time)){const e=`${r.time}`;Y.time[e]=!0}else Y.time.custom=!0;else if(r.mode==="words")if([10,25,50,100,200].includes(r.words)){const e=`${r.words}`;Y.words[e]=!0}else Y.words.custom=!0;else r.mode==="quote"&&["short","medium","long","thicc"].forEach((t,a)=>{r.quoteLength.includes(a)?Y.quoteLength[t]=!0:Y.quoteLength[t]=!1});if(r.punctuation?Y.punctuation.on=!0:Y.punctuation.off=!0,r.numbers?Y.numbers.on=!0:Y.numbers.off=!0,r.mode==="quote"&&/english.*/.test(r.language)?Y.language.english=!0:Y.language[r.language]=!0,r.funbox.length===0)Y.funbox.none=!0;else for(const e of r.funbox)Y.funbox[e]=!0;Y.tags.none=!0,S()?.tags?.forEach(e=>{e.active===!0&&(Y.tags.none=!1,Y.tags[e._id]=!0)}),Y.date.all=!0,_o(),xo()});n(".pageAccount .topFilters button.toggleAdvancedFilters").on("click",()=>{n(".pageAccount .filterButtons").slideToggle(250),n(".pageAccount .topFilters button.toggleAdvancedFilters").toggleClass("active")});function qf(e,t=0){const a=co[e];if(a===void 0)return;const o=a.render.content.list,i=o.children.item(t);o.scrollTop=i.offsetTop-o.offsetTop}function If(e,t,a){const o=t.some(s=>s.value==="all"),i=a.some(s=>s.value==="all");o?i?t.length<a.length&&(t=t.filter(s=>s.value!=="all")):t=t.filter(s=>s.value==="all"):i&&(t=[]),Ka(e,!1);for(const s of t){if(s.value==="all"){Ka(e,!0);break}kw(e,s.value,!0)}return _o(),xo(),Sw(),!1}let Sw=()=>{};function C7(){const e=S();if(e===void 0)return;const t=e.tags.filter(i=>Tt.tags[i._id]===void 0);if(t.length>0){const i=Object.values(Y.tags).every(s=>s);Tt.tags={...Tt.tags,...Object.fromEntries(t.map(s=>[s._id,!0]))},Y.tags={...Y.tags,...Object.fromEntries(t.map(s=>[s._id,i]))}}const a=document.querySelector(".pageAccount .content .filterButtons .buttonsAndTitle.tags .select select");if(!(a instanceof HTMLElement))return;let o="";o+="<option value='all'>all</option>",o+="<option value='none'>no tag</option>";for(const i of e.tags)o+=`<option value="${i._id}" filter="${i.name}">${i.display}</option>`;a.innerHTML=o}let Ph=!1;async function k7(e){const t=S();S7(t),!Ph&&(Sw=e,co.language=new Ge({select:".pageAccount .content .filterButtons .buttonsAndTitle.languages .select .languageSelect",data:[{value:"all",text:"all"},...Qp.map(a=>({value:a,text:Aa(a),filter:a}))],settings:{showSearch:!0,placeholderText:"select a language",allowDeselect:!0,closeOnSelect:!1},events:{beforeChange:(a,o)=>If("language",a,o),beforeOpen:()=>{qf("language")}}}),co.funbox=new Ge({select:".pageAccount .content .filterButtons .buttonsAndTitle.funbox .select .funboxSelect",data:[{value:"all",text:"all"},{value:"none",text:"no funbox"},...gp().map(a=>({value:a.name,text:a.name.replace(/_/g," "),filter:a.name}))],settings:{showSearch:!0,placeholderText:"select a funbox",allowDeselect:!0,closeOnSelect:!1},events:{beforeChange:(a,o)=>If("funbox",a,o),beforeOpen:()=>{qf("funbox")}}}),Pm(),Ph=!0)}function S7(e){const t=n(".pageAccount .content .filterButtons .buttonsAndTitle.tags");if(e.tags.length===0)t.addClass("hidden"),co.tags&&(co.tags.destroy(),delete co.tags),kw("tags","none",!0);else if(t.removeClass("hidden"),C7(),!co.tags){const a=document.querySelector(".pageAccount .content .filterButtons .buttonsAndTitle.tags .select .tagsSelect");a&&(co.tags=new Ge({select:a,settings:{showSearch:!0,placeholderText:"select a tag",allowDeselect:!0,closeOnSelect:!1},events:{beforeChange:(o,i)=>If("tags",o,i),beforeOpen:()=>{qf("tags")}}}))}}n(".group.presetFilterButtons .filterBtns").on("click",".filterPresets .delete-filter-preset",e=>{y7(n(e.currentTarget).data("id"))});function x7(e){return Fm(xp(uc.partial().strip(),structuredClone(e)))}qa(e=>{e.type==="snapshotUpdated"&&e.data.isInitial&&(v7(),p7())});function T7(e){let t=[];for(let i=1;i<=e.wpm.length;i++)t.push(i.toString());e.wpm=e.wpm.slice(0,e.burst.length),e.err=e.err.slice(0,e.burst.length),t=t.slice(0,e.burst.length),Ut.data.labels=t,Ut.getDataset("wpm").data=e.wpm,Ut.getDataset("burst").data=e.burst,Ut.getDataset("error").data=e.err;const a=Math.max(Math.max(...e.wpm),Math.max(...e.burst)),o=Math.min(Math.min(...e.wpm),Math.min(...e.burst));Ut.getScale("wpm").max=Math.round(a),Ut.getScale("burst").max=Math.round(a),r.startGraphsAtZero?(Ut.getScale("wpm").min=0,Ut.getScale("burst").min=0):(Ut.getScale("wpm").min=Math.round(o),Ut.getScale("burst").min=Math.round(o)),Ut.updateColors()}function L7(e){T7(e),$7.show()}const $7=new re({dialogId:"miniResultChartModal"});function M7(e){const t=e?"Profile":"Account",o=e?"":`<div class="buttonGroup"><button
  class="showAllButton"
  data-balloon-pos="left"
  aria-label="Show all personal bests"
>
  <i class="fas fa-ellipsis-v"></i>
</button></div>`;n(`.page${t} .profile .pbsWords`).html(`
      <div class="group">
      <div class="quick">
        <div class="test">10 words</div>
        <div class="wpm">-</div>
        <div class="acc">-</div>
      </div>
    </div>
    <div class="group">
      <div class="quick">
        <div class="test">25 words</div>
        <div class="wpm">-</div>
        <div class="acc">-</div>
      </div>
    </div>
    <div class="group">
      <div class="quick">
        <div class="test">50 words</div>
        <div class="wpm">-</div>
        <div class="acc">-</div>
      </div>
    </div>
    <div class="group">
      <div class="quick">
        <div class="test">100 words</div>
        <div class="wpm">-</div>
        <div class="acc">-</div>
      </div>
    </div>
    ${o}
  `),n(`.page${t} .profile .pbsTime`).html(`
      <div class="group">
      <div class="quick">
        <div class="test">15 seconds</div>
        <div class="wpm">-</div>
        <div class="acc">-</div>
      </div>
    </div>
    <div class="group">
      <div class="quick">
        <div class="test">30 seconds</div>
        <div class="wpm">-</div>
        <div class="acc">-</div>
      </div>
    </div>
    <div class="group">
      <div class="quick">
        <div class="test">60 seconds</div>
        <div class="wpm">-</div>
        <div class="acc">-</div>
      </div>
    </div>
    <div class="group">
      <div class="quick">
        <div class="test">120 seconds</div>
        <div class="wpm">-</div>
        <div class="acc">-</div>
      </div>
    </div>
    ${o}
  `)}function Ff(e,t=!1){if(M7(t),e===void 0)return;let a="";const o=t?"Profile":"Account";n(`.page${o} .profile .pbsTime`).html(""),n(`.page${o} .profile .pbsWords`).html("");const i=["15","30","60","120"],s=["10","25","50","100"];i.forEach(c=>{a+=Bh(e,"time",c)});const l=t?"":`<div class="buttonGroup"><button
      class="showAllButton"
      data-balloon-pos="left"
      aria-label="Show all personal bests"
    >
      <i class="fas fa-ellipsis-v"></i>
    </button></div>`;n(`.page${o} .profile .pbsTime`).append(a+l),a="",s.forEach(c=>{a+=Bh(e,"words",c)}),n(`.page${o} .profile .pbsWords`).append(a+l)}function Bh(e,t,a){let o="",i="";const s=`${a} ${t==="time"?"seconds":"words"}`,l=r.typingSpeedUnit;try{const c=(e[t][a]??[]).sort((u,p)=>p.wpm-u.wpm)[0];if(c===void 0)throw new Error("No PB data found");const d=new Date(c.timestamp);c.timestamp!==void 0&&c.timestamp>0&&(i=J(d,"dd MMM yyyy")),o=`<div class="quick">
      <div class="test">${s}</div>
      <div class="wpm">${D.typingSpeed(c.wpm,{showDecimalPlaces:!1})}</div>
      <div class="acc">${D.accuracy(c.acc,{showDecimalPlaces:!1})}</div>
    </div>
    <div class="fullTest">
      <div>${s}</div>
      <div>${D.typingSpeed(c.wpm,{suffix:` ${l}`})}</div>
      <div>${D.typingSpeed(c.raw,{suffix:" raw"})}</div>
      <div>${D.accuracy(c.acc,{suffix:" acc"})}</div>
      <div>${D.percentage(c.consistency,{suffix:" con"})}</div>
      <div>${i}</div>
    </div>`}catch{o=`<div class="quick">
    <div class="test">${s}</div>
    <div class="wpm">-</div>
    <div class="acc">-</div>
  </div>`}return`
  <div class="group">
  ${o}
  </div>
  `}const xw={1:{id:1,name:"Developer",description:"I made this",icon:"fa-laptop",color:"white",customStyle:"animation: rgb-bg 10s linear infinite; background: linear-gradient(45deg in hsl longer hue, hsl(330, 90%, 30%) 0%, hsl(250, 90%, 30%) 100%);"},2:{id:2,name:"Collaborator",description:"I helped make this",icon:"fa-code",color:"white",customStyle:"animation: rgb-bg 10s linear infinite; background: linear-gradient(45deg in hsl longer hue, hsl(330, 90%, 30%) 0%, hsl(250, 90%, 30%) 100%);"},3:{id:3,name:"Server Mod",description:"Discord server moderator",icon:"fa-hammer",color:"white",customStyle:"animation: rgb-bg 10s linear infinite; background: linear-gradient(45deg in hsl longer hue, hsl(330, 90%, 30%) 0%, hsl(250, 90%, 30%) 100%);"},4:{id:4,name:"OG Account",description:"First 1000 users on the site",icon:"fa-baby",color:"var(--bg-color)",background:"var(--main-color)"},5:{id:5,name:"OG Discordian",description:"First 1000 Discord server members",icon:"fa-baby",color:"var(--bg-color)",background:"var(--main-color)"},6:{id:6,name:"Supporter",description:"Donated money",icon:"fa-heart",color:"var(--text-color)",background:"var(--sub-color)"},7:{id:7,name:"Sugar Daddy",description:"Donated a lot of money",icon:"fa-gem",color:"var(--bg-color)",background:"var(--main-color)"},8:{id:8,name:"Monkey Supporter",description:"Donated more money",icon:"fa-heart",color:"var(--bg-color)",background:"var(--main-color)"},9:{id:9,name:"White Hat",description:"Reported critical vulnerabilities on the site",icon:"fa-user-secret",color:"var(--bg-color)",background:"var(--main-color)"},10:{id:10,name:"Bug Hunter",description:"Reported or helped track down bugs on the site",icon:"fa-bug",color:"var(--text-color)",background:"var(--sub-color)"},11:{id:11,name:"Content Creator",description:"Verified content creator",icon:"fa-video",color:"var(--text-color)",background:"var(--sub-color)"},12:{id:12,name:"Contributor",description:"Contributed to the site",icon:"fa-hands-helping",color:"var(--text-color)",background:"var(--sub-color)"},13:{id:13,name:"Mythical",description:"Yes, I'm actually this fast",icon:"fa-rocket",color:"white",customStyle:"animation: rgb-bg 10s linear infinite; background: linear-gradient(45deg in hsl longer hue, hsl(330, 90%, 30%) 0%, hsl(250, 90%, 30%) 100%);"},14:{id:14,name:"All Year Long",description:"Reached a streak of 365 days",icon:"fa-fire",color:"var(--bg-color)",background:"var(--main-color)"},15:{id:15,name:"Insane",description:"I typed for 69 hours straight",icon:"fa-bomb",color:"white",background:"#093d79",customStyle:"animation: gold-shimmer 10s cubic-bezier(0.5, 0, 0.5, 1) infinite; background: linear-gradient(90deg, rgb(8 31 84) 0%, rgb(18 134 158) 100%); background-size: 200% 200%;"},16:{id:16,name:"Perfection",description:"Longest test with zero mistakes - 4 hours and 1 minute",icon:"fa-bullseye",color:"white",customStyle:"animation: gold-shimmer 10s cubic-bezier(0.5, -0.15, 0.5, 1.15) infinite; background: linear-gradient(45deg, #b8860b 0%, #daa520 25%, #ffd700 50%, #daa520 75%, #b8860b 100%); background-size: 200% 200%;"},17:{id:17,name:"Phineas",description:"Ferb, I know what we're gonna do today...",icon:"fa-sun",color:"white",customStyle:"animation: rgb-bg 10s linear infinite; background: linear-gradient(45deg in hsl longer hue, hsl(330, 90%, 30%) 0%, hsl(250, 90%, 30%) 100%);"}};function ys(e,t=!1,a=!1,o=!1){const i=xw[e];if(!i&&!o)return"";let s="";i?.background!==void 0&&(s+=`background: ${i.background};`),i?.color!==void 0&&(s+=`color: ${i.color};`),i?.customStyle!==void 0&&(s+=i.customStyle);const l=i?.name??"Badge Name Missing",c=i?.description??"Badge Description Missing",d=(t?l+": ":"")+c;let u="";a||(u=`aria-label="${d}" data-balloon-pos="right"`);let p="";i?.icon!==void 0?p=`<i class="fas ${t?"fa-fw":""} ${i.icon}"></i>`:p='<i class="fas fa-question"></i>';const g=`<div class="text">${l}</div>`;return`<div class="badge" ${u} style="${s}">${p}${t?"":g}</div>`}function A7(e){return xw[e]}async function Nc(e,t){const a=e.charAt(0).toUpperCase()+e.slice(1),o=n(`.page${a} .profile`),i=n(`.page${a} .profile .details`);o.attr("uid",t.uid??""),o.attr("name",t.name??"");const s=t.banned===!0;if(i===void 0||t===void 0||t.name===void 0||t.addedAt===void 0)return;if(i.find(".avatarAndName .avatar").replaceWith(Kr(t,{size:256})),t.inventory?.badges&&!s){let I="",P="";for(const U of t.inventory.badges)U.selected===!0?I=ys(U.id):P+=ys(U.id,!0);i.find(".badges").empty().append(I),i.find(".allBadges").empty().append(P)}i.find(".name").text(t.name),i.find(".userFlags").html(Ss({...t,isFriend:$p(t.uid)})),t.lbOptOut===!0&&(e==="profile"?o.find(".lbOptOutReminder").removeClass("hidden").text("Note: This account has opted out of the leaderboards, meaning their results aren't verified by the anticheat system and may not be legitimate."):o.find(".lbOptOutReminder").addClass("hidden")),setTimeout(()=>{Dm(e)},10);const c="Joined "+J(t.addedAt??0,"dd MMM yyyy"),d=new Date(t.addedAt),u=Mn(new Date,d),p=`${u} day${u!==1?"s":""} ago`;i.find(".joined").text(c).attr("aria-label",p);let g="";if(t.streak&&t?.streak>1?(i.find(".streak").text(`Current streak: ${t.streak} ${t.streak===1?"day":"days"}`),g=`Longest streak: ${t.maxStreak} ${t.maxStreak===1?"day":"days"}`):(i.find(".streak").text(""),g=""),e==="account"){const P=S()?.results?.[0],U=t.streakHourOffset,K=1e3*60*60*24;let ne=yl(U)+K;ne<Date.now()&&(ne+=K);const _e=Vb(ne);if(console.debug("Streak hour offset"),console.debug("date.now()",Date.now(),new Date(Date.now())),console.debug("dayInMilis",K),console.debug("difTarget",new Date(yl(U)+K)),console.debug("timeDif",_e),console.debug("DateTime.getCurrentDayTimestamp()",yl(),new Date(yl())),console.debug("profile.streakHourOffset",U),P!==void 0){const He=Sk(P.timestamp,U),Pe=xk(P.timestamp,U);console.debug("lastResult.timestamp",P.timestamp,new Date(P.timestamp)),console.debug("isToday",He),console.debug("isYesterday",Pe);const Oe=fe(U)?`(${U>0?"+":""}${U} offset)`:"";He?(g+=`
Claimed today: yes`,g+=`
Come back in: ${_e} ${Oe}`):Pe?(g+=`
Claimed today: no`,g+=`
Streak lost in: ${_e} ${Oe}`):(g+=`
Streak lost ${_e} ${Oe} ago`,g+=`
It will be removed from your profile on the next result save`),console.debug(g),U===void 0&&(g+=`

If the streak reset time doesn't line up with your timezone, you can change it in Account Settings > Account > Set streak hour offset.`)}}i.find(".streak").attr("aria-label",g).attr("data-balloon-break","");const{completedPercentage:m,restartRatio:h}=Fb(t.typingStats),y=i.find(".typingStats");y.find(".started .value").text(t.typingStats?.startedTests??0),y.find(".completed .value").text(t.typingStats?.completedTests??0).attr("data-balloon-pos","up").attr("aria-label",`${m}% (${h} restarts per completed test)`),y.find(".timeTyping .value").text(Ye(Math.round(t.typingStats?.timeTyping??0),!0,!0));let C=!1,M=!1,w=!1;if(!s&&(C=!!(t.details?.bio??""),i.find(".bio .value").text(t.details?.bio??""),M=!!(t.details?.keyboard??""),i.find(".keyboard .value").text(t.details?.keyboard??""),t.details?.socialProfiles?.github!==void 0&&t.details?.socialProfiles?.github!==""||t.details?.socialProfiles?.twitter!==void 0&&t.details?.socialProfiles?.twitter!==""||t.details?.socialProfiles?.website!==void 0&&t.details?.socialProfiles?.website!=="")){w=!0;const I=i.find(".socials .value");I.empty();const P=t.details?.socialProfiles.github??"";P&&I.append(`<a href='https://github.com/${lt(P)}/' target="_blank" rel="nofollow me" aria-label="${lt(P)}" data-balloon-pos="up" class="textButton"><i class="fab fa-fw fa-github"></i></a>`);const U=t.details?.socialProfiles.twitter??"";U&&I.append(`<a href='https://x.com/${lt(U)}' target="_blank" rel="nofollow me" aria-label="${lt(U)}" data-balloon-pos="up" class="textButton"><i class="fab fa-fw fa-twitter"></i></a>`);const K=t.details?.socialProfiles.website??"",ne=/^https?:\/\/(?:www\.)?([^/]+)/,_e=K?.match(ne)?.[1]??K;K&&I.append(`<a href='${lt(K)}' target="_blank" rel="nofollow me" aria-label="${lt(_e??"")}" data-balloon-pos="up" class="textButton"><i class="fas fa-fw fa-globe"></i></a>`)}if(Tw(e,t.xp??0),s)o.find(".leaderboardsPositions").addClass("hidden");else{o.find(".leaderboardsPositions").removeClass("hidden");const I=t.allTimeLbs?.time?.["15"]?.english??null,P=t.allTimeLbs?.time?.["60"]?.english??null;I===null&&P===null?o.find(".leaderboardsPositions").addClass("hidden"):(I!==null&&(o.find(".leaderboardsPositions .group.t15 .pos").text(D.rank(I?.rank)),o.find(".leaderboardsPositions .group.t15 .topPercentage").text(Tg(I))),P!==null&&(o.find(".leaderboardsPositions .group.t60 .pos").text(D.rank(P?.rank)),o.find(".leaderboardsPositions .group.t60 .topPercentage").text(Tg(P))))}t.uid===tt()?.uid?o.find(".userReportButton").addClass("hidden"):o.find(".userReportButton").removeClass("hidden");const F=C||M;C?i.find(".bio").removeClass("hidden"):i.find(".bio").addClass("hidden"),M?i.find(".keyboard").removeClass("hidden"):i.find(".keyboard").addClass("hidden"),F?(i.find(".bioAndKeyboard").removeClass("hidden"),i.find(".sep2").removeClass("hidden")):(i.find(".bioAndKeyboard").addClass("hidden"),i.find(".sep2").addClass("hidden")),w?(i.find(".socials").removeClass("hidden"),i.find(".sep3").removeClass("hidden")):(i.find(".socials").addClass("hidden"),i.find(".sep3").addClass("hidden")),i.removeClass("none"),i.removeClass("bioAndKey"),i.removeClass("soc"),i.removeClass("both"),!w&&!F?i.addClass("none"):w&&!F?i.addClass("soc"):!w&&F?i.addClass("bioAndKey"):w&&F&&i.addClass("both"),_7()}function Tw(e,t,a=!1){const o=e.charAt(0).toUpperCase()+e.slice(1),i=n(`.page${o} .profile`),s=n(`.page${o} .profile .details .levelAndBar`);if(s==null||a&&e==="profile"&&tt()?.uid!==i.attr("uid"))return;const l=Jn(t),c=l.levelMaxXp,d=l.levelCurrentXp;s.find(".level").text(l.level).attr("aria-label",`${Ns(t)} total xp`),s.find(".xp").text(`${Ns(d)}/${Ns(c)}`).attr("aria-label",`${Ns(c-d)} xp until next level`),s.find(".xpBar .bar").css("width",`${d/c*100}%`),s.find(".xpBar").attr("aria-label",`${(d/c*100).toFixed(2)}%`)}function Dm(e){if(/^((?!chrome|android).)*safari/i.test(navigator.userAgent))return;let a;if(e==="account"?a=n(".pageAccount .profile .details"):e==="profile"&&(a=n(".pageProfile .profile .details")),!a)return;const o=a.find(".user"),i=o.parent()[0],s=o[0],l=pr(2);if(!s||!i)return;s.style.fontSize="10px";const c=i.clientWidth,d=s.clientWidth,p=c/d*10,g=Math.min(Math.max(p,10),l);s.style.fontSize=`${g}px`}function _7(){const e=tt()?.uid,t=document.querySelector(".profile")?.getAttribute("uid"),a=document.querySelector(".profile .addFriendButton"),o=e===t,i=S()?.connections[t]!==void 0;!Ma()?.connections.enabled||e===void 0||o?a?.classList.add("hidden"):i?a?.classList.add("disabled"):(a?.classList.remove("disabled"),a?.classList.remove("hidden"))}const E7=Ub(1e3,()=>{const e=X();e&&["account","profile"].includes(e)&&Dm(e)});n(window).on("resize",()=>{E7()});function Pf(){n(".pageAccount .resultBatches").addClass("hidden")}function q7(){n(".pageAccount .resultBatches").removeClass("hidden")}async function I7(){const e=S()?.results;if(e===void 0){console.error("(Result batches) Results are missing but they should be available at the time of drawing the account page?"),Pf();return}F7();const t=S()?.typingStats?.completedTests??0,a=Math.round(e.length/t*100),o=Ma()?.results.limits??{regularUser:0,premiumUser:0},i=S()?.isPremium?o.premiumUser:o.regularUser,s=Math.round(e?.length/i*100),l=n(".pageAccount .resultBatches .bars"),c={downloaded:{fill:l.find(".downloaded .fill"),rightText:l.find(".downloaded.rightText")},limit:{fill:l.find(".limit .fill"),rightText:l.find(".limit.rightText")}};c.downloaded.fill.css("width",Math.min(a,100)+"%"),c.downloaded.rightText.text(`${e?.length} / ${t} (${a}%)`);const d=await ci();c.limit.fill.css({width:Math.min(s,100)+"%",background:aa(d.sub,d.error,Iu(s,50,100,0,1))}),c.limit.rightText.text(`${e?.length} / ${i} (${s}%)`),n(".pageAccount .resultBatches > .text").text(""),e.length>=t&&(Bf(),Rh("all results loaded")),e.length>=i&&(Bf(),Rh("limit reached"))}function Bf(){n(".pageAccount .resultBatches button").prop("disabled",!0)}function F7(){n(".pageAccount .resultBatches button").prop("disabled",!1)}function Rh(e){n(".pageAccount .resultBatches button").text(e)}function P7(){if(!(S()?.isPremium??!1)){Pf();return}const t=S()?.typingStats?.completedTests??0,a=Ma()?.results.maxBatchSize??0;if(t<=a){Pf();return}q7()}let Io;function Lw(e,t,a){if(t===void 0){Wm(e);return}e.classList.remove("hidden"),e.querySelector(".yearSelect")!==null&&(Io=Aw(e),Mw(e,"current",Bb(a?.getFullYear())??2022)),R7(e,t.firstDayOfWeek),$w(e,t)}function Wm(e){e?.classList.add("hidden"),e?.querySelector(".activity")?.replaceChildren()}function $w(e,t){const a=e.querySelector(".activity");if(a===null)return;if(a.innerHTML="",t===void 0){Dh([]),e.querySelector(".nodata")?.classList.remove("hidden");return}Dh(t.getMonths()),e.querySelector(".nodata")?.classList.add("hidden");const o=e.querySelector(".title");o!==null&&(o.innerHTML=t.getTotalTests()+" tests");for(const i of t.getDays()){const s=document.createElement("div");s.setAttribute("data-level",i.level),i.label!==void 0&&(s.setAttribute("aria-label",i.label),s.setAttribute("data-balloon-pos","up")),a.appendChild(s)}}function Mw(e,t,a){const o=new Date().getFullYear(),i=[{text:"last 12 months",value:"current",selected:t==="current"}];for(let l=o;l>=a;l--)(i.length<2||Ma()?.users.premium.enabled&&S()?.isPremium)&&i.push({text:l.toString(),value:l.toString(),selected:l===t});const s=Aw(e);s.setData(i),i.length>1?s.enable():s.disable()}function Dh(e){const t=document.querySelector(".testActivity .months");t!==null&&(t.innerHTML=e.map(a=>`<div style="grid-column: span ${a.weeks}">${a.text}</div>`).join(""))}function Aw(e){return Io!==void 0||(Io=new Ge({select:e.querySelector(".yearSelect"),settings:{showSearch:!1},events:{afterChange:async t=>{Io?.disable();const a=t[0]?.value,o=await VS(a);$w(e,o),(Io?.getData()??[]).length>1&&Io?.enable()}}})),Io}const B7=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"];function R7(e,t){const a=[];for(let i=0;i<7;i++)a.push(i%2!==t%2?B7[(t+i)%7]:void 0);const o=i=>{const s=i!==void 0?l=>l.substring(0,i):l=>l;return a.map(l=>l!==void 0?`<div><div class="text">${s(l)}</div></div>`:"<div></div>").join("")};e.querySelector(".daysFull").innerHTML=o(),e.querySelector(".days").innerHTML=o(3)}const D7=q.object({property:q.string(),descending:q.boolean()});class _w{constructor(t){if(this.data=[],this.table=n(t.table),this.table===void 0)throw new Error(`No element found for ${t.table}`);this.buildRow=t.buildRow,t.data!==void 0&&this.setData(t.data),"persistence"in t&&t.persistence!==void 0?(this.persistence=t.persistence,this.sort=this.persistence.get(),this.doSort()):"initialSort"in t&&t.initialSort!==void 0&&(this.sort=t.initialSort,this.doSort());for(const a of this.table.find("td[data-sort-property]"))a.classList.add("sortable"),a.setAttribute("type","button"),a.onclick=o=>{const i=o.currentTarget,s=i.dataset.sortProperty,l=i.dataset.sortDefaultDirection==="desc";if(s===void 0)return;let c=this.sort;c===void 0||s!==c.property?c={property:s,descending:l}:c.descending=!c?.descending,this.setSort(c),this.updateBody()}}setSort(t){this.sort={...this.sort,...t},this.persistence?.set(this.sort),this.doSort()}setData(t){this.data=t.map(a=>({source:a})),this.doSort()}doSort(){if(this.sort===void 0)return;const{property:t,descending:a}=this.sort;this.table.find("thead td").removeClass("headerSorted"),this.table.find("thead td").children("i").remove(),this.table.find(`thead td[data-sort-property="${t}"]`).addClass("headerSorted").append(`<i class="fas ${a?"fa-sort-down":"fa-sort-up"} aria-hidden="true"></i>`),this.data.sort((o,i)=>{const s=Wh(o.source,t),l=Wh(i.source,t);let c=0;return s===void 0&&l!==void 0?a?1:-1:s!==void 0&&l===void 0?a?-1:1:(typeof s=="string"&&typeof l=="string"&&(c=s.localeCompare(l)),typeof s=="number"&&typeof l=="number"&&(c=s-l),a?-c:c)})}updateBody(){const t=this.table.find("tbody");t.empty(),t.append(this.getData().map(a=>(a.element===void 0&&(a.element=this.buildRow(a.source)),a.element)))}getData(){return this.data}}function Wh(e,t){return t.split(".").reduce((a,o)=>a?.[o],e)}class W7 extends _w{constructor(t){super(t),this.limit=t.limit}getData(){return this.data.slice(0,this.limit)}setLimit(t){this.limit=t}}let mt=!1;function z7(){mt=!mt,mt&&console.log("filterDebug is on")}let Gt=[],js=0,Rf,Zi;function zm(e){if(Gt===void 0||Gt.length===0)return;let t;fe(e)&&e>js?t=Math.ceil(e/10)*10:t=js+10,js=t,js>=Gt.length?n(".pageAccount .loadMoreButton").addClass("hidden"):n(".pageAccount .loadMoreButton").removeClass("hidden"),Zi.setLimit(t),Zi.updateBody()}function H7(e){let t=e.difficulty;t===void 0&&(t="normal");let a=`<span aria-label="${e.language?.replace("_"," ")}" data-balloon-pos="up"><i class="fas fa-fw fa-globe-americas"></i></span>`;t==="normal"?a+=`<span aria-label="${e.difficulty}" data-balloon-pos="up"><i class="far fa-fw fa-star"></i></span>`:t==="expert"?a+=`<span aria-label="${e.difficulty}" data-balloon-pos="up"><i class="fas fa-fw fa-star-half-alt"></i></span>`:t==="master"&&(a+=`<span aria-label="${e.difficulty}" data-balloon-pos="up"><i class="fas fa-fw fa-star"></i></span>`),e.punctuation&&(a+='<span aria-label="punctuation" data-balloon-pos="up"><i class="fas fa-fw fa-at"></i></span>'),e.numbers&&(a+='<span aria-label="numbers" data-balloon-pos="up"><i class="fas fa-fw fa-hashtag"></i></span>'),e.blindMode&&(a+='<span aria-label="blind mode" data-balloon-pos="up"><i class="fas fa-fw fa-eye-slash"></i></span>'),e.lazyMode&&(a+='<span aria-label="lazy mode" data-balloon-pos="up"><i class="fas fa-fw fa-couch"></i></span>'),e.funbox!==void 0&&e.funbox.length>0&&(a+=`<span aria-label="${e.funbox.map(h=>h.replace(/_/g," ")).join(", ")}" data-balloon-pos="up"><i class="fas fa-gamepad"></i></span>`),e.chartData==="toolong"||e.testDuration>122?a+='<span class="miniResultChartButton disabled" aria-label="Graph history is not available for long tests" data-balloon-pos="up"><i class="fas fa-fw fa-chart-line"></i></span>':a+='<span class="miniResultChartButton" aria-label="View graph" data-balloon-pos="up"><i class="fas fa-fw fa-chart-line"></i></span>';let o="no tags";e.tags!==void 0&&e.tags.length>0&&(o="",e.tags.forEach(h=>{S()?.tags?.forEach(y=>{h===y._id&&(o+=y.display+", ")})}),o=o.substring(0,o.length-2));let i;e.tags===void 0?i="[]":i=JSON.stringify(e.tags);const s=e.tags!==void 0&&e.tags.length>0,l=e.tags!==void 0&&e.tags.length>1?"fa-tags":"fa-tag",c=`<button class="textButton resultEditTagsButton ${s?"active":""}" data-result-id="${e._id}" data-tags='${i}' aria-label="${o}" data-balloon-pos="up"><i class="fas fa-fw ${l}"></i></button>`;let d="";e.isPb?d='<i class="fas fa-fw fa-crown"></i>':d="";const u=e.charStats.join("/"),p=e.mode==="custom"?"":e.mode2,g=new Date(e.timestamp),m=document.createElement("tr");return m.classList.add("resultRow"),m.dataset.id=e._id,m.innerHTML=`
    <td>${d}</td>
    <td>${D.typingSpeed(e.wpm,{showDecimalPlaces:!0})}</td>
    <td>${D.typingSpeed(e.rawWpm,{showDecimalPlaces:!0})}</td>
    <td>${D.percentage(e.acc,{showDecimalPlaces:!0})}</td>
    <td>${D.percentage(e.consistency,{showDecimalPlaces:!0})}</td>
    <td>${u}</td>
    <td>${e.mode} ${p}</td>
    <td class="infoIcons">${a}</td>
    <td>${c}</td>
    <td>${J(g,"dd MMM yyyy")}<br>
    ${J(g,"HH:mm")}
    </td>
    `,m}async function O7(){await z.updateColors(),await ke(0),await Oo.updateColors(),await ke(0),await On.updateColors(),await ke(0)}function N7(){Zi.setData([]),Zi.updateBody(),On.getDataset("count").data=[],Oo.getDataset("count").data=[],Oo.getDataset("avgWpm").data=[],z.getDataset("wpm").data=[],z.getDataset("pb").data=[],z.getDataset("acc").data=[],z.getDataset("wpmAvgTen").data=[],z.getDataset("accAvgTen").data=[],z.getDataset("wpmAvgHundred").data=[],z.getDataset("accAvgHundred").data=[]}let Fl=0,Et=[],wn=[];async function Ew(){console.log("updating account page"),Vr();const e=S();if(!e)return;Ff(e.personalBests),Nc("account",e),Lw(Rf,e.testActivity,new Date(e.addedAt)),I7(),Et=[],wn=[];const t=[];js=0;let a=0,o="",i=0,s=0,l=0,c=0,d=0,u=0,p=0,g=0;const m={total:0,count:0,last10Total:0,last10Count:0,max:0};let h=0;Fl=0;let y=0,C=0,M=0,w=0;const F={},I=[],P=dt(r.typingSpeedUnit);Gt=[],n(".pageAccount .history table tbody").empty(),S()?.results?.forEach(v=>{try{if(!De("pb",v.isPb?"yes":"no")){mt&&console.log("skipping result due to pb filter",v);return}let it=v.difficulty;if(it===void 0&&(it="normal"),!De("difficulty",it)){mt&&console.log("skipping result due to difficulty filter",v);return}if(!De("mode",v.mode)){mt&&console.log("skipping result due to mode filter",v);return}if(v.mode==="time"){let Ne="custom";if(["15","30","60","120"].includes(`${v.mode2}`)&&(Ne=`${v.mode2}`),!De("time",Ne)){mt&&console.log("skipping result due to time filter",v);return}}else if(v.mode==="words"){let Ne="custom";if(["10","25","50","100","200"].includes(`${v.mode2}`)&&(Ne=`${v.mode2}`),!De("words",Ne)){mt&&console.log("skipping result due to word filter",v);return}}if(v.quoteLength!==null){let Ne;if(v.quoteLength===0?Ne="short":v.quoteLength===1?Ne="medium":v.quoteLength===2?Ne="long":v.quoteLength===3&&(Ne="thicc"),Ne!==void 0&&!De("quoteLength",Ne)){mt&&console.log("skipping result due to quoteLength filter",v);return}}let mi=De("language",v.language);if(v.language==="english_expanded"&&De("language","english_1k")&&(mi=!0),!mi){mt&&console.log("skipping result due to language filter",v);return}let gl="off";if(v.punctuation&&(gl="on"),!De("punctuation",gl)){mt&&console.log("skipping result due to punctuation filter",v);return}let hl="off";if(v.numbers&&(hl="on"),!De("numbers",hl)){mt&&console.log("skipping result due to numbers filter",v);return}if(v.funbox===void 0||v.funbox.length===0){if(!De("funbox","none")){mt&&console.log("skipping result due to funbox filter",v);return}}else{let Ne=0;for(const _t of v.funbox)if(De("funbox",_t)){Ne++;break}if(Ne===0){mt&&console.log("skipping result due to funbox filter",v);return}}let oo=!0;if(v.tags===void 0||v.tags.length===0)(S()?.tags?.length??0)>0?De("tags","none")&&(oo=!1):oo=!1;else{const Ne=S()?.tags?.map(_t=>_t._id);if(Ne===void 0)return;v.tags.forEach(_t=>{oo&&(Ne?.includes(_t)?De("tags",_t)&&(oo=!1):De("tags","none")&&(oo=!1))})}if(oo){mt&&console.log("skipping result due to tag filter",v);return}const gi=Math.abs(v.timestamp-Date.now())/1e3;let bl=!0;if((De("date","all")||De("date","last_day")&&gi<=86400||De("date","last_week")&&gi<=604800||De("date","last_month")&&gi<=2592e3||De("date","last_3months")&&gi<=7776e3)&&(bl=!1),bl){mt&&console.log("skipping result due to date filter",v);return}Gt.push(v)}catch(it){f("Something went wrong when filtering. Resetting filters.",0),console.log(v),console.error(it),Rm(),_o(),vs();return}h+=Math.round(v.wpm/60*v.testDuration);const Ue=new Date(v.timestamp);Ue.setSeconds(0),Ue.setMinutes(0),Ue.setHours(0),Ue.setMilliseconds(0);const $e=Ue.getTime(),Xt=F[$e];Xt!==void 0?(Xt.amount++,Xt.restarts+=v.restartCount??0,Xt.time+=v.testDuration+(v.incompleteTestSeconds??0)-(v.afkDuration??0),v.wpm>Xt.maxWpm&&(Xt.maxWpm=v.wpm),Xt.totalWpm+=v.wpm,Xt.totalAcc+=v.acc,Xt.totalCon+=v.consistency??0):F[$e]={amount:1,restarts:v.restartCount??0,time:v.testDuration+(v.incompleteTestSeconds??0)-(v.afkDuration??0),maxWpm:v.wpm,totalWpm:v.wpm,totalAcc:v.acc,totalCon:v.consistency??0};const ml=P.histogramDataBucketSize,pn=Math.floor(Math.round(P.fromWpm(v.wpm))/ml);if(I.length<=pn)for(let it=I.length;it<=pn;it++)I.push(0);I[pn]++;let Ce=0;if(v.testDuration===void 0&&v.mode2!=="custom"&&v.mode2!=="zen"?v.mode==="time"?Ce=parseInt(v.mode2):v.mode==="words"&&(Ce=parseInt(v.mode2)/v.wpm*60):Ce=parseFloat(v.testDuration),v.incompleteTestSeconds!==void 0?Ce+=v.incompleteTestSeconds:v.restartCount!==void 0&&v.restartCount>0&&(Ce+=Ce/4*v.restartCount),Fl+=Ce,c<10&&(c++,d+=v.wpm,g+=v.acc,v.consistency!==void 0&&(M+=v.consistency)),l++,v.consistency!==void 0&&(w++,C+=v.consistency,v.consistency>y&&(y=v.consistency)),v.rawWpm!==null&&(m.last10Count<10&&(m.last10Count++,m.last10Total+=v.rawWpm),m.total+=v.rawWpm,m.count++,v.rawWpm>m.max&&(m.max=v.rawWpm)),v.acc>u&&(u=v.acc),p+=v.acc,v.restartCount!==void 0&&(i+=v.restartCount),Et.push({x:Gt.length,y:H(P.fromWpm(v.wpm)),wpm:H(P.fromWpm(v.wpm)),acc:v.acc,mode:v.mode,mode2:v.mode2,punctuation:v.punctuation,language:v.language,timestamp:v.timestamp,difficulty:v.difficulty,raw:H(P.fromWpm(v.rawWpm)),isPb:v.isPb??!1}),t.push(v.wpm),wn.push({x:Gt.length,y:v.acc,errorRate:100-v.acc}),v.wpm>a)if(a=v.wpm,v.mode==="custom")o=v.mode;else{const it=v.punctuation?",<br>with punctuation":"",mi=v.numbers?",<br>with numbers":"";o=v.mode+" "+v.mode2+it+mi}s+=v.wpm}),Zi.setData(Gt),n(".pageAccount .group.history table thead tr td:nth-child(2)").text(r.typingSpeedUnit),await ke(0),zm();const U=[],K=[],ne=P.historyStepSize;for(const v of Object.keys(F)){const Ue=parseInt(v),$e=F[Ue];$e!==void 0&&(U.push({x:Ue,y:$e.time/60,amount:$e.amount,restarts:$e.restarts,maxWpm:H(P.fromWpm($e.maxWpm)),avgWpm:H($e.totalWpm/$e.amount),avgAcc:H($e.totalAcc/$e.amount),avgCon:H($e.totalCon/$e.amount)}),K.push({x:Ue,y:H(P.fromWpm($e.totalWpm)/$e.amount)}))}const He=Oo.options.scales.avgWpm;He.title.text="Average "+r.typingSpeedUnit,He.ticks.stepSize=ne,Oo.getDataset("count").data=U,Oo.getDataset("avgWpm").data=K;const Pe=[],Oe=[],ee=P.histogramDataBucketSize,Le=ee-(ee<=1?.01:1);I.forEach((v,Ue)=>{const $e=Ue*ee;Oe.push(`${$e} - ${$e+Le}`),Pe.push({x:$e,y:v})}),On.data.labels=Oe,On.getDataset("count").data=Pe;const ot=z.options.scales.wpm;if(ot.title.text=P.fullUnitString,Et.length>0){let v=0;const Ue=[];for(let Ce=Et.length-1;Ce>=0;Ce--){const it=Et[Ce];it.y>v&&(v=it.y,Ue.push(it))}Ue.push({x:1,y:Kn(Ue)?.y});const $e=[],Xt=[],ml=[],pn=[];for(let Ce=0;Ce<Et.length;Ce++){const it=Et.slice(Ce,Ce+10),mi=wn.slice(Ce,Ce+10),gl=it.reduce((_t,{y:hi})=>_t+hi,0)/it.length,hl=mi.reduce((_t,{y:hi})=>_t+hi,0)/mi.length;$e.push({x:Ce+1,y:gl}),Xt.push({x:Ce+1,y:hl});const oo=Et.slice(Ce,Ce+100),gi=wn.slice(Ce,Ce+100),bl=oo.reduce((_t,{y:hi})=>_t+hi,0)/oo.length,Ne=gi.reduce((_t,{y:hi})=>_t+hi,0)/gi.length;ml.push({x:Ce+1,y:bl}),pn.push({x:Ce+1,y:Ne})}z.getDataset("wpm").data=Et,z.getDataset("pb").data=Ue,z.getDataset("acc").data=wn,z.getDataset("wpmAvgTen").data=$e,z.getDataset("accAvgTen").data=Xt,z.getDataset("wpmAvgHundred").data=ml,z.getDataset("accAvgHundred").data=pn,z.getScale("x").max=Et.length+1}const vt=Et.map(v=>v.y),Pa=Math.min(...vt),Eo=Math.max(...vt),jC=isFinite(Pa)?Pa:0,xg=isFinite(Eo)?Eo:0,pl=Math.floor(xg)+(ne-Math.floor(xg)%ne);if(ot.max=pl,ot.ticks.stepSize=ne,z.getScale("pb").max=pl,z.getScale("wpmAvgTen").max=pl,z.getScale("wpmAvgHundred").max=pl,r.startGraphsAtZero)z.getScale("wpm").min=0,z.getScale("pb").min=0,z.getScale("wpmAvgTen").min=0,z.getScale("wpmAvgHundred").min=0;else{const v=Math.floor(jC/ne)*ne;z.getScale("wpm").min=v,z.getScale("pb").min=v,z.getScale("wpmAvgTen").min=v,z.getScale("wpmAvgHundred").min=v}Et===void 0||Et.length===0?(n(".pageAccount .group.noDataError").removeClass("hidden"),n(".pageAccount .group.chart").addClass("hidden"),n(".pageAccount .group.dailyActivityChart").addClass("hidden"),n(".pageAccount .group.histogramChart").addClass("hidden"),n(".pageAccount .group.aboveHistory").addClass("hidden"),n(".pageAccount .group.history").addClass("hidden"),n(".pageAccount .triplegroup.stats").addClass("hidden"),n(".pageAccount .group.estimatedWordsTyped").addClass("hidden")):(n(".pageAccount .group.noDataError").addClass("hidden"),n(".pageAccount .group.chart").removeClass("hidden"),n(".pageAccount .group.dailyActivityChart").removeClass("hidden"),n(".pageAccount .group.histogramChart").removeClass("hidden"),n(".pageAccount .group.aboveHistory").removeClass("hidden"),n(".pageAccount .group.history").removeClass("hidden"),n(".pageAccount .triplegroup.stats").removeClass("hidden"),n(".pageAccount .group.estimatedWordsTyped").removeClass("hidden")),n(".pageAccount .timeTotalFiltered .val").text(Ye(Math.round(Fl),!0,!0));const fn=r.typingSpeedUnit;n(".pageAccount .highestWpm .title").text(`highest ${fn}`),n(".pageAccount .highestWpm .val").text(D.typingSpeed(a)),n(".pageAccount .averageWpm .title").text(`average ${fn}`),n(".pageAccount .averageWpm .val").text(D.typingSpeed(s/l)),n(".pageAccount .averageWpm10 .title").text(`average ${fn} (last 10 tests)`),n(".pageAccount .averageWpm10 .val").text(D.typingSpeed(d/c)),n(".pageAccount .highestRaw .title").text(`highest raw ${fn}`),n(".pageAccount .highestRaw .val").text(D.typingSpeed(m.max)),n(".pageAccount .averageRaw .title").text(`average raw ${fn}`),n(".pageAccount .averageRaw .val").text(D.typingSpeed(m.total/m.count)),n(".pageAccount .averageRaw10 .title").text(`average raw ${fn} (last 10 tests)`),n(".pageAccount .averageRaw10 .val").text(D.typingSpeed(m.last10Total/m.last10Count)),n(".pageAccount .highestWpm .mode").html(o),n(".pageAccount .testsTaken .val").text(l),n(".pageAccount .highestAcc .val").text(D.accuracy(u)),n(".pageAccount .avgAcc .val").text(D.accuracy(p/l)),n(".pageAccount .avgAcc10 .val").text(D.accuracy(g/c)),C===0||C===void 0?(n(".pageAccount .avgCons .val").text("-"),n(".pageAccount .avgCons10 .val").text("-")):(n(".pageAccount .highestCons .val").text(D.percentage(y)),n(".pageAccount .avgCons .val").text(D.percentage(C/w)),n(".pageAccount .avgCons10 .val").text(D.percentage(M/Math.min(c,w)))),n(".pageAccount .testsStarted .val").text(`${l+i}`),n(".pageAccount .testsCompleted .val").text(`${l}(${Math.floor(l/(l+i)*100)}%)`),n(".pageAccount .testsCompleted .avgres").text(`
    ${(i/l).toFixed(1)} restarts per completed test
  `);const GC=Gt.map(v=>v.wpm).reverse(),Xd=G2(GC);if(Xd){const Ue=(Xd[1][1]-Xd[0][1])*(3600/Fl),$e=Ue>0?"+":"";n(".pageAccount .group.chart .below .text").text(`Speed change per hour spent typing: ${$e+D.typingSpeed(Ue,{showDecimalPlaces:!0})} ${r.typingSpeedUnit}`)}n(".pageAccount .estimatedWordsTyped .val").text(h),(Et.length||wn.length)&&(r6(),z.options.animation=!1,z.update(),delete z.options.animation),await ke(0),Oo.update(),On.update(),_a(!1),n(".page.pageAccount").css("height","unset"),setTimeout(()=>{Dm("account")},0)}async function Hm(e){const t=await Lp(e);if(!t&&!Xe()){f("Could not get results - you are offline",-1,{duration:5});return}J6(),t&&_o()}async function vs(){await Hm();try{await ke(0),await Ew()}catch(e){console.error(e),f(`Something went wrong: ${e}`,-1)}}function U7(e,t){const a=[];if(t.length>0)for(const i of t)S()?.tags?.forEach(s=>{i===s._id&&a.push(s.display)});const o=n(`.pageAccount .resultEditTagsButton[data-result-id='${e}']`);o.attr("data-tags",JSON.stringify(t)),t.length>0?(o.attr("aria-label",a.join(", ")),o.addClass("active"),t.length>1?o.html('<i class="fas fa-fw fa-tags"></i>'):o.html('<i class="fas fa-fw fa-tag"></i>')):(o.attr("aria-label","no tags"),o.removeClass("active"),o.html('<i class="fas fa-fw fa-tag"></i>'))}n(".pageAccount button.toggleResultsOnChart").on("click",()=>{const e=[...r.accountChart];e[0]=e[0]==="on"?"off":"on",ud(e)});n(".pageAccount button.toggleAccuracyOnChart").on("click",()=>{const e=[...r.accountChart];e[1]=e[1]==="on"?"off":"on",ud(e)});n(".pageAccount button.toggleAverage10OnChart").on("click",()=>{const e=[...r.accountChart];e[2]=e[2]==="on"?"off":"on",ud(e)});n(".pageAccount button.toggleAverage100OnChart").on("click",()=>{const e=[...r.accountChart];e[3]=e[3]==="on"?"off":"on",ud(e)});n(".pageAccount .loadMoreButton").on("click",()=>{zm()});n(".pageAccount #accountHistoryChart").on("click",()=>{const e=J0;if(zm(e),window===void 0)return;const t=Gt[e]?._id;if(t===void 0)throw new Error("Cannot find result for index "+e);const a=n(`.resultRow[data-id="${t}"`);n(".resultRow").removeClass("active"),a[0]?.scrollIntoView({block:"center"}),a.addClass("active")});n(".pageAccount").on("click",".miniResultChartButton",async e=>{const t=n(e.currentTarget),a=t.parents("tr").data("id");if(t.hasClass("loading")||t.hasClass("disabled"))return;const o=Gt.find(s=>s._id===a);if(o===void 0)return;let i=o.chartData;if(i===void 0){t.addClass("loading"),t.attr("aria-label",null),t.html('<i class="fas fa-fw fa-spin fa-circle-notch"></i>'),Z();const s=await T.results.getById({params:{resultId:o._id}});if(N(),t.html('<i class="fas fa-fw fa-chart-line"></i>'),t.removeClass("loading"),s.status!==200){f("Error fetching result: "+s.body.message,-1);return}i=s.body.data.chartData,o.chartData=i;const l=S()?.results?.find(c=>c._id===o._id);if(l!==void 0&&(l.chartData=o.chartData),s.body.data.chartData==="toolong"){t.attr("aria-label","Graph history is not available for long tests"),t.attr("data-baloon-pos","up"),t.addClass("disabled"),f("Graph history is not available for long tests",0);return}}t.attr("aria-label","View graph"),L7(i)});n(".pageAccount .group.topFilters, .pageAccount .filterButtons").on("click","button",()=>{setTimeout(()=>{vs()},0)});n(".pageAccount .group.presetFilterButtons").on("click",".filterBtns .filterPresets .select-filter-preset",async e=>{await m7(n(e.target).data("id")),vs()});n(".pageAccount .content .group.aboveHistory .exportCSV").on("click",()=>{sk(Gt)});n(".pageAccount .profile").on("click",".details .copyLink",()=>{const e=S();if(!e)return;const{name:t}=e,a=`${location.origin}/profile/${t}`;navigator.clipboard.writeText(a).then(function(){f("URL Copied to clipboard",0)},function(){alert("Failed to copy using the Clipboard API. Here's the link: "+a)})});n(".pageAccount button.loadMoreResults").on("click",async()=>{const e=S()?.results?.length??0;Z(),Bf(),await Hm(e),await Ew(),N()});ge(e=>{X()==="account"&&e==="typingSpeedUnit"&&vs()});const V7=new to({id:"account",element:n(".page.pageAccount"),path:"/account",loadingOptions:{loadingMode:()=>S()?.results===void 0?"sync":"none",loadingPromise:async()=>{if(S()===null)throw new Error("Looks like your account data didn't download correctly. Please refresh the page.<br>If this error persists, please contact support.");return Hm()},style:"bar",keyframes:[{percentage:90,durationMs:2e3,text:"Downloading results..."}]},afterHide:async()=>{N7(),yt("pageAccount")},beforeShow:async()=>{Ht("pageAccount","main");const e=S();await k7(vs),_o(),await ke(0),Rf=document.querySelector(".page.pageAccount .testActivity"),Mw(Rf,"current",e!==void 0?new Date(e.addedAt).getFullYear():2020),Zi===void 0&&(Zi=new W7({limit:10,table:".pageAccount .content .history table",data:Gt,buildRow:t=>H7(t),initialSort:{property:"timestamp",descending:!0}})),await vs().then(()=>{O7(),n(".pageAccount .content .accountVerificatinNotice").remove(),tt()?.emailVerified===!1&&n(".pageAccount .content").prepend('<div class="accountVerificatinNotice"><i class="fas icon fa-exclamation-triangle"></i><p>Your email address is still not verified</p><button class="sendVerificationEmail">resend verification email</button></div>'),P7()})}});n(()=>{Nt("pageAccount")});let Uc=!1;function qw(){n(".scrollToTopButton").addClass("invisible"),Uc=!1}function K7(){n(".scrollToTopButton").removeClass("invisible"),Uc=!0}n(document).on("click",".scrollToTopButton",()=>{n(".scrollToTopButton").addClass("invisible"),window.scrollTo({top:0,behavior:rk()?"instant":"smooth"})});n(window).on("scroll",()=>{if(X()==="test")return;const t=window.scrollY;!Uc&&t>100?K7():Uc&&t<100&&qw()});const j7=new to({id:"test",element:n(".page.pageTest"),path:"/",beforeHide:async()=>{n("#wordsInput").trigger("focusout")},afterHide:async()=>{te(),R({noAnim:!0}),qn(),Ot(),Wc(!0)},beforeShow:async()=>{Wc(!1),H0(),te(),R({noAnim:!0}),Rv(),Fc(),qw()}});function G7(){n(".pageAbout .contributors").empty(),n(".pageAbout .supporters").empty(),Nn.getDataset("count").data=[],Nn.updateColors()}let Vc,Ro;function Q7(){if(Vc){Nn.updateColors();const e=X7(Vc);Nn.data.labels=e.labels,Nn.getDataset("count").data=e.data}if(Ro){const e=Math.round(Ro.timeTyping),t=hp({start:0,end:e*1e3});n(".pageAbout #totalTimeTypingStat .val").text(t.years?.toString()??""),n(".pageAbout #totalTimeTypingStat .valSmall").text("years"),n(".pageAbout #totalTimeTypingStat").attr("aria-label",tu(Math.round(e/3600))+" hours");const a=Pg(Ro.testsStarted);n(".pageAbout #totalStartedTestsStat .val").text(a.rounded<10?a.roundedTo2:a.rounded),n(".pageAbout #totalStartedTestsStat .valSmall").text(a.orderOfMagnitude),n(".pageAbout #totalStartedTestsStat").attr("aria-label",tu(Ro.testsStarted)+" tests");const o=Pg(Ro.testsCompleted);n(".pageAbout #totalCompletedTestsStat .val").text(o.rounded<10?o.roundedTo2:o.rounded),n(".pageAbout #totalCompletedTestsStat .valSmall").text(o.orderOfMagnitude),n(".pageAbout #totalCompletedTestsStat").attr("aria-label",tu(Ro.testsCompleted)+" tests")}}async function Y7(){if(Vc&&Ro)return;if(!Xe()){f("Cannot update all time stats - offline",0);return}const e=await T.public.getSpeedHistogram({query:{language:"english",mode:"time",mode2:"60"}});e.status===200?Vc=e.body.data:f(`Failed to get global speed stats for histogram: ${e.body.message}`,-1);const t=await T.public.getTypingStats();t.status===200?Ro=t.body.data:f(`Failed to get global typing stats: ${e.body.message}`,-1)}async function J7(){const{data:e,error:t}=await Wt(cx());t&&f(ie(t,"Failed to get supporters"),-1);const{data:a,error:o}=await Wt(dx());o&&f(ie(o,"Failed to get contributors"),-1),Y7().then(()=>{Q7()});const i=document.querySelector(".pageAbout .supporters");let s="";for(const d of e??[])s+=`<div>${lt(d)}</div>`;i&&(i.innerHTML=s);const l=document.querySelector(".pageAbout .contributors");let c="";for(const d of a??[])c+=`<div>${lt(d)}</div>`;l&&(l.innerHTML=c)}function X7(e){const t=[],a=[],o=Object.keys(e).sort((i,s)=>parseInt(i,10)-parseInt(s,10));for(const[i,s]of o.entries()){const l=o[i+1],c=parseInt(s,10);if(t.push({x:c,y:e[c]}),a.push(`${c} - ${c+9}`),l!==void 0&&c+10!==parseInt(l,10))for(let d=c+10;d<parseInt(l,10);d+=10)t.push({x:d,y:0}),a.push(`${d} - ${d+9}`)}return{data:t,labels:a}}const Z7=new to({id:"about",element:n(".page.pageAbout"),path:"/about",afterHide:async()=>{G7(),yt("pageAbout")},beforeShow:async()=>{Ht("pageAbout","main"),J7()}});n(()=>{Nt("pageAbout")});const eT=["gmaill.com","gamil.com","gmali.com","gnail.com","gmil.com","gamail.com","hotmai.com","gmial.com","hotmal.com","yaho.com","outlokk.com","gmil.com","hotmial.com","yahooo.com","otulook.com","gamil.com","hotnail.com","yaoo.com","outlok.com","gmail.cmo","hotmail.cmo","yahho.com","outloook.com","gmaail.com","hottmail.com","yaho.com","outllok.com","gmai.com","hotmil.com","yhaoo.com","outlookk.com","gmil.com","htmial.com","yaahoo.com","otlook.com","gamail.com","hotnail.com","yaoho.com","outlok.com","gemail.com","hotmiall.com","yahhoo.com","outloookk.com","gmal.com","hottmail.com","yahio.com","outlokkk.com",".comm",".con",".cmo",".coom",".cim",".vom","-online.de","-tonline.de","acor.de","aecor.de","ahoo.de","al.com","ao.com","aol.cm","aol.con","aol.ocm","aol.om","aoll.com","apl.com","arco.de","arocr.de","aror.de","feenet.de","freeenet.de","freeent.de","freeet.de","freemet.de","freeneet.de","freent.de","frenet.de","gm.de","gm.net","gm.xde","gmc.de","gmx.ded","gmx.dw","gmxx.de","gmy.de","gx.de","hmx.de","homail.de","hotmai.de","hotmal.de","@mx.de","mx.net","@otmail.com","r-online.de","rcor.de","reenet.de","t--online.de","t-0nline.de","t-nline.de","t-oline.de","t-omline.de","t-onine.de","t-onlien.de","t-onliine.de","t-onlin.de","t-onlinde.de","t-onlinr.de","t-onlione.de","t-onlline.de","t-onlne.de","t-onlone.de","t.-online.de","t.online.de","tonline.de","wb.de","we.de","web.ded","web.dw","wed.de","weeb.de","wen.de","wweb.de","yaho.de","yahooo.de","yaoo.de","yhoo.de","yahhoo.de","icoud.com","icloud.cim","icloud.con","icloud.ocm","icloud.om","icloud.cm"];function Od(e,t){return async a=>{const o=await e(a);if(o.status<=299)return t?.check?.(o.body.data)??!0;let i;return o.status<=499?i=t?.on4xx??(s=>s):i=t?.on5xx??"Server unavailable. Please try again later.",typeof i=="function"?i(o.body.message):i}}let Yo={};function Om(){n(".page.pageLogin .register.side button").prop("disabled",!1)}function ll(){n(".page.pageLogin .register.side button").prop("disabled",!0)}function Za(){n(".pageLogin input").prop("disabled",!1),n(".pageLogin button").prop("disabled",!1)}function Nm(){n(".pageLogin input").prop("disabled",!0),n(".pageLogin button").prop("disabled",!0)}function Um(){n(".pageLogin .preloader").removeClass("hidden")}function Ya(){n(".pageLogin .preloader").addClass("hidden")}function Iw(){return Yo.name!==void 0&&Yo.email!==void 0&&Yo.password!==void 0}const en=()=>{Iw()?Om():ll()};function tT(){return Iw()?Yo:!1}const zh=document.querySelector(".page.pageLogin .register.side input.usernameInput");Fa(zh,{schema:Or,isValid:Od(async e=>T.users.getNameAvailability({params:{name:e}}),{check:e=>e.available||"Name not available"}),debounceDelay:1e3,callback:e=>{Yo.name=e.status==="success"?zh.value:void 0,en()}});let ic=null,Hh=!1;const nc=Fa(document.querySelector(".page.pageLogin .register.side input.emailInput"),{schema:fc,isValid:async e=>{if(/@.*(student|education|school|\.edu$|\.edu\.|\.ac\.|\.sch\.)/i.test(e))return{warning:"Some education emails will fail to receive our messages, or disable the account as soon as you graduate. Consider using a personal email address."};if(eT.some(o=>e.endsWith(o)))return{warning:"Please check your email address, it may contain a typo."};if(ic&&ic.isDisposableEmail!==void 0)try{if(ic.isDisposableEmail(e))return{warning:"Using a temporary email may cause issues with logging in, password resets and support. Consider using a permanent email address. Don't worry, we don't send spam."}}catch{}return!0},debounceDelay:0,callback:e=>{e.status==="success"&&Fw.dispatchEvent(new Event("input"))}});nc.addEventListener("focus",async()=>{if(!Hh){Hh=!0;try{ic=await Nr(()=>import("./vendor.DVxhWSpD.js").then(e=>e.i),__vite__mapDeps([2,3,1]))}catch{}}});const Fw=document.querySelector(".page.pageLogin .register.side input.verifyEmailInput");Fa(Fw,{isValid:async e=>nc.value===e?!0:"verify email not matching email",debounceDelay:0,callback:e=>{Yo.email=nc.getValidationResult().status==="success"&&e.status==="success"?nc.value:void 0,en()}});const bu=Fa(document.querySelector(".page.pageLogin .register.side .passwordInput"),{schema:Hb,callback:e=>{e.status==="success"&&Pw.dispatchEvent(new Event("input"))}}),Pw=document.querySelector(".page.pageLogin .register.side .verifyPasswordInput");Fa(Pw,{isValid:async e=>bu.value===e?!0:"verify password not matching password",debounceDelay:0,callback:e=>{Yo.password=bu.getValidationResult().status==="success"&&e.status==="success"?bu.value:void 0,en()}});const aT=new to({id:"login",element:n(".page.pageLogin"),path:"/login",afterHide:async()=>{Ya(),yt("pageLogin")},beforeShow:async()=>{Ht("pageLogin","main"),Yo={},n(".pageLogin input").val(""),n(".pageLogin .register .indicator").addClass("hidden"),Za(),ll()}});n(()=>{Nt("pageLogin")});const cl=n(".page.pageLoading"),Nd=cl.find(".bar"),Vm=cl.find(".error"),Km=cl.find(".spinner"),Ud=cl.find(".text");async function Df(e,t){await Rt(Nd[0]?.querySelector(".fill"),{width:e+"%",duration:t})}function Kc(e){Ud.removeClass("hidden").html(e)}function oT(){Nd.addClass("hidden"),Vm.addClass("hidden"),Km.removeClass("hidden"),Ud.addClass("hidden")}function iT(){Nd.addClass("hidden"),Km.addClass("hidden"),Vm.removeClass("hidden"),Ud.addClass("hidden")}async function nT(){Nd.removeClass("hidden"),Vm.addClass("hidden"),Km.addClass("hidden"),Ud.addClass("hidden")}const Ci=new to({id:"loading",element:cl,path:"/",afterHide:async()=>{yt("pageLoading")},beforeShow:async()=>{Ht("pageLoading","main")}}),sT=ks.recaptchaSiteKey,ho={};function jm(){if(!("grecaptcha"in window))throw new Error("grecaptcha is not defined");return window.grecaptcha}function tn(){return"grecaptcha"in window}function Is(e,t,a){if(ho[t]!==void 0&&ho[t]!==null)return;const o=jm().render(e,{sitekey:sT,callback:a});ho[t]=o}function To(e){ho[e]===void 0||ho[e]===null||jm().reset(ho[e])}function dl(e){return ho[e]===void 0||ho[e]===null?"":jm().getResponse(ho[e])}class Ir{constructor(t,a){this.textareaElement=t,this.maxLength=a,this.textareaElement.attr("maxlength",this.maxLength.toString()),this.textareaElement.parent().hasClass("textareaWithCounter")||n(this.textareaElement).wrap('<div class="textareaWithCounter"></div>'),this.parentElement=n(this.textareaElement).parent(".textareaWithCounter"),this.parentElement.find(".char-counter").length===0?(this.counterElement=n('<span class="char-counter"></span>'),this.parentElement.append(this.counterElement)):this.counterElement=this.parentElement.find(".char-counter"),this.updateCounter(),this.textareaElement.on("input",()=>this.updateCounter())}updateCounter(){const t=this.maxLength,a=this.textareaElement.val().length,o=t-a;this.counterElement.text(`${a}/${t}`);const i=o/this.maxLength*100;this.counterElement.removeClass("warning"),this.counterElement.removeClass("error"),i===0?this.counterElement.addClass("error"):i<10&&this.counterElement.addClass("warning")}setMaxLength(t){this.maxLength=t,this.updateCounter()}}const jc={userUid:void 0,lbOptOut:void 0};let Wf;async function rT(e){if(!A()){f("You must be logged in to submit a report",0);return}if(!tn()){f("Could not show user report popup: Captcha is not available. This could happen due to a blocked or failed network request. Please refresh the page or contact support if this issue persists.",-1);return}Bw.show({mode:"dialog",focusFirstInput:!0,beforeAnimation:async t=>{Is(t.querySelector(".g-recaptcha"),"userReportModal");const{name:a}=e;jc.userUid=e.uid,jc.lbOptOut=e.lbOptOut,t.querySelector(".user").textContent=a,t.querySelector(".reason").value="Inappropriate name",t.querySelector(".comment").value="",Wf=new Ge({select:t.querySelector(".reason"),settings:{showSearch:!1,contentLocation:t}})}}),new Ir(n("#userReportModal .comment"),250)}async function lT(){Bw.hide()}async function cT(){const e=dl("userReportModal");if(!e){f("Please complete the captcha");return}const t=n("#userReportModal .reason").val(),a=n("#userReportModal .comment").val(),o=e;if(!t){f("Please select a valid report reason");return}if(!a){f("Please provide a comment");return}if(t==="Suspected cheating"&&jc.lbOptOut){f("You cannot report this user for suspected cheating as they have opted out of the leaderboards.",0,{duration:10});return}const i=a.length-250;if(i>0){f(`Report comment is ${i} character(s) too long`);return}Z();const s=await T.users.report({body:{uid:jc.userUid,reason:t,comment:a,captcha:o}});if(N(),s.status!==200){f("Failed to report user: "+s.body.message,-1);return}f("Report submitted. Thank you!",1),lT()}const Bw=new re({dialogId:"userReportModal",setup:async e=>{e.querySelector("button")?.addEventListener("click",()=>{cT()})},cleanup:async()=>{Wf?.destroy(),Wf=void 0,To("userReportModal")}});function Pl({tagname:e,classes:t,attributes:a,innerHTML:o}){let i=`<${e}`;return t!==void 0&&(i+=` class="${t.join(" ")}"`),a!==void 0&&(i+=" "+Object.entries(a).filter(s=>s[1]!==void 0).sort((s,l)=>s[0].localeCompare(l[0])).map(s=>s[1]===!0?`${s[0]}`:`${s[0]}="${s[1]}"`).join(" ")),o!==void 0?i+=`>${o}</${e}>`:i+=" />",i}class de{constructor(t){this.parameters=[],this.id=t.id,this.execFn=t.execFn,this.title=t.title,this.inputs=t.inputs??[],this.text=t.text,this.textAllowHtml=t.textAllowHtml??!1,this.wrapper=Hs.getWrapper(),this.element=Hs.getModal(),this.modal=Hs,this.buttonText=t.buttonText,this.beforeInitFn=t.beforeInitFn,this.beforeShowFn=t.beforeShowFn,this.canClose=t.canClose??!0,this.onlineOnly=t.onlineOnly??!1,this.hideCallsExec=t.hideCallsExec??!1,this.showLabels=t.showLabels??!1}reset(){this.element.innerHTML=`
    <div class="title"></div>
    <div class="inputs"></div>
    <div class="text"></div>
    <button type="submit" class="submitButton"></button>`}init(){const t=n(this.element);t.find("input").val(""),this.reset(),t.attr("data-popup-id",this.id),t.find(".title").text(this.title),this.textAllowHtml?t.find(".text").html(this.text??""):t.find(".text").text(this.text??""),this.initInputs(),this.buttonText===""?t.find(".submitButton").remove():(t.find(".submitButton").text(this.buttonText),this.updateSubmitButtonState()),(this.text??"")===""?t.find(".text").addClass("hidden"):t.find(".text").removeClass("hidden")}initInputs(){const t=n(this.element);if(this.inputs.every(i=>i.hidden)||this.inputs.length===0){t.find(".inputs").addClass("hidden");return}const o=t.find(".inputs");this.showLabels&&o.addClass("withLabel"),this.inputs.forEach((i,s)=>{const l=`${this.id}_${s}`;this.showLabels&&!i.hidden&&o.append(`<label for="${l}">${i.label??""}</label>`);const c=i.type==="textarea"?"textarea":"input",d=i.hidden?["hidden"]:void 0,u={id:l,placeholder:i.placeholder??"",autocomplete:"off"};if(i.type!=="textarea"&&(u.value=i.initVal?.toString()??"",u.type=i.type),!i.hidden&&!i.optional&&(u.required=!0),i.disabled&&(u.disabled=!0),i.type==="textarea")o.append(Pl({tagname:c,classes:d,attributes:u,innerHTML:i.initVal}));else if(i.type==="checkbox"){let m=Pl({tagname:c,classes:d,attributes:u});i.description!==void 0&&(m+=`<span>${i.description}</span>`),this.showLabels?m=`<div>${m}</div>`:m=`
          <label class="checkbox">
            ${m}
            <div>${i.label}</div>
          </label>
        `,o.append(m)}else if(i.type==="range")o.append(`
          <div>
            ${Pl({tagname:c,classes:d,attributes:{...u,min:i.min.toString(),max:i.max.toString(),step:i.step?.toString(),oninput:"this.nextElementSibling.innerHTML = this.value"}})}
            <span>${i.initVal??""}</span>
          </div>
          `);else{switch(i.type){case"text":case"password":case"email":break;case"datetime-local":{i.min!==void 0&&(u.min=J(i.min,"yyyy-MM-dd'T'HH:mm:ss")),i.max!==void 0&&(u.max=J(i.max,"yyyy-MM-dd'T'HH:mm:ss")),i.initVal!==void 0&&(u.value=J(i.initVal,"yyyy-MM-dd'T'HH:mm:ss"));break}case"date":{i.min!==void 0&&(u.min=J(i.min,"yyyy-MM-dd")),i.max!==void 0&&(u.max=J(i.max,"yyyy-MM-dd")),i.initVal!==void 0&&(u.value=J(i.initVal,"yyyy-MM-dd"));break}case"number":{u.min=i.min?.toString(),u.max=i.max?.toString();break}}o.append(Pl({tagname:c,classes:d,attributes:u}))}const p=document.querySelector("#"+u.id),g=p.oninput;if(p.oninput=m=>{g&&g.call(p,m),i.oninput?.(m),this.updateSubmitButtonState()},i.currentValue=()=>p.type==="checkbox"?p.checked?"true":"false":p.value,i.validation!==void 0){const m={schema:i.validation.schema??void 0,isValid:i.validation.isValid!==void 0?async h=>i.validation.isValid(h,this):void 0,callback:h=>{i.hasError=h.status!=="success",this.updateSubmitButtonState()},debounceDelay:i.validation.debounceDelay};Fa(p,m)}}),t.find(".inputs").removeClass("hidden")}exec(){if(!this.canClose)return;if(this.hasMissingRequired()){f("Please fill in all fields",0);return}if(this.hasValidationErrors()){f("Please solve all validation errors",0);return}this.disableInputs(),Z();const t=this.inputs.map(a=>a.currentValue());this.execFn(this,...t).then(a=>{N(),(a.showNotification??!0)&&f(a.message,a.status,a.notificationOptions),a.status===1||a.alwaysHide?this.hide(!0,a.hideOptions).then(()=>{a.afterHide&&a.afterHide()}):(this.enableInputs(),n(n("#simpleModal").find("input")[0]).trigger("focus"))})}disableInputs(){n("#simpleModal input").prop("disabled",!0),n("#simpleModal button").prop("disabled",!0),n("#simpleModal textarea").prop("disabled",!0),n("#simpleModal .checkbox").addClass("disabled")}enableInputs(){n("#simpleModal input").prop("disabled",!1),n("#simpleModal button").prop("disabled",!1),n("#simpleModal textarea").prop("disabled",!1),n("#simpleModal .checkbox").removeClass("disabled")}show(t=[],a){if(this.onlineOnly&&!Xe()){f("You are offline",0,{duration:2});return}Fr=this,this.parameters=t,Hs.show({focusFirstInput:!0,...a,beforeAnimation:async()=>{this.beforeInitFn?.(this),this.init(),this.beforeShowFn?.(this)}})}async hide(t,a){this.canClose&&(this.hideCallsExec&&!t?this.exec():(Fr=null,await Hs.hide(a)))}hasMissingRequired(){return this.inputs.filter(t=>t.hidden!==!0&&t.optional!==!0).some(t=>t.currentValue()===void 0||t.currentValue()==="")}hasValidationErrors(){return this.inputs.some(t=>t.hasError===!0)}updateSubmitButtonState(){const t=this.element.querySelector(".submitButton");t!==null&&(this.hasMissingRequired()||this.hasValidationErrors()?t.disabled=!0:t.disabled=!1)}}function Oh(){if(Fr){Fr.hide();return}}let Fr=null;const Hs=new re({dialogId:"simpleModal",setup:async e=>{e.addEventListener("submit",t=>{t.preventDefault(),Fr?.exec()})},customEscapeHandler:e=>{Oh()},customWrapperClickHandler:e=>{Oh()}}),dT=n(".page.pageFriends");let In,Ja,Ca;function Gm(e){const t=tt();if(t===null)throw new Error("expected to be authenticated in getReceiverUid");return t.uid===e.initiatorUid?e.receiverUid:e.initiatorUid}async function Rw(e){const t=await T.connections.create({body:{receiverName:e}});if(t.status!==200)return`Friend request failed: ${t.body.message}`;{const a=S();if(a!==void 0){const o=Gm(t.body.data);a.connections[o]=t.body.data.status,Qm()}return!0}}const uT=new de({id:"addFriend",title:"Add a friend",inputs:[{placeholder:"user name",type:"text",initVal:"",validation:{schema:Or,isValid:Od(async e=>T.users.getNameAvailability({params:{name:e}}),{check:e=>!e.available||"Unknown user"}),debounceDelay:1e3}}],buttonText:"request",onlineOnly:!0,execFn:async(e,t)=>{const a=await Rw(t);if(a===!0)return{status:1,message:`Request sent to ${t}`};let o=-1,i="Unknown error";return a.includes("already exists")?(o=0,i=`You are already friends with ${t}`):a.includes("request already sent")?(o=0,i=`You have already sent a friend request to ${t}`):a.includes("blocked by initiator")?(o=0,i=`You have blocked ${t}`):a.includes("blocked by receiver")&&(o=0,i=`${t} has blocked you`),{status:o,message:i,alwaysHide:!0}}}),fT=new de({id:"confirmUnfriend",title:"Remove friend",buttonText:"remove friend",text:"Are you sure you want to remove as a friend?",beforeInitFn:e=>{e.text=`Are you sure you want to remove ${e.parameters[1]} as a friend?`},execFn:async e=>{const t=e.parameters[0],a=await T.connections.delete({params:{id:t}});return a.status!==200?{status:-1,message:a.body.message}:(Ca=Ca?.filter(o=>o.connectionId!==t),In?.setData(Ca??[]),In?.updateBody(),{status:1,message:"Friend removed"})}});async function pT(){const e=await T.connections.get({query:{status:"pending",type:"incoming"}});e.status!==200?(f("Error getting connections: "+e.body.message,-1),Ja=void 0):(Ja=e.body.data,KS(Ja))}function Qm(){if(n(".pageFriends .pendingRequests").addClass("hidden"),Ja===void 0||Ja.length===0)n(".pageFriends .pendingRequests").addClass("hidden");else{n(".pageFriends .pendingRequests").removeClass("hidden");const e=Ja.map(t=>`<tr data-id="${t._id}" data-receiver-uid="${Gm(t)}">
        <td><a href="${location.origin}/profile/${t.initiatorUid}?isUid" router-link>${t.initiatorName}</a></td>
        <td>
          <span data-balloon-pos="up" aria-label="since ${J(t.lastModified,"dd MMM yyyy HH:mm")}">
            ${zw(t.lastModified)} ago
          <span>
        </td>
        <td class="actions">
          <button class="accepted" aria-label="accept" data-balloon-pos="up">
            <i class="fas fa-check fa-fw"></i>
          </button> 
          <button class="rejected" aria-label="reject" data-balloon-pos="up">
            <i class="fas fa-times fa-fw"></i>
          </button> 
          <button class="blocked" aria-label="block" data-balloon-pos="up">
            <i class="fas fa-shield-alt fa-fw"></i>
          </button>
        </td>
      </tr>`).join(`
`);n(".pageFriends .pendingRequests tbody").html(e)}}async function Dw(){const e=await T.users.getFriends();e.status!==200?(f("Error getting friends: "+e.body.message,-1),Ca=void 0):Ca=e.body.data}function Ww(){n(".pageFriends .friends .nodata").addClass("hidden"),n(".pageFriends .friends table").addClass("hidden"),n(".pageFriends .friends .error").addClass("hidden"),Ca===void 0||Ca.length===0?(n(".pageFriends .friends table").addClass("hidden"),n(".pageFriends .friends .nodata").removeClass("hidden")):(n(".pageFriends .friends table").removeClass("hidden"),n(".pageFriends .friends .nodata").addClass("hidden"),In===void 0?In=new _w({table:".pageFriends .friends table",data:Ca,buildRow:mT,persistence:new pt({key:"friendsListSort",schema:D7,fallback:{property:"name",descending:!1}})}):In.setData(Ca),In.updateBody())}function mT(e){const t=Jn(e.xp??0),a=Fb(e),o=Nh(e.top15),i=Nh(e.top60),s=document.createElement("tr");s.dataset.connectionId=e.connectionId;const l=e.uid===tt()?.uid;let c="";return l?s.classList.add("me"):c=`<button class="remove">
            <i class="fas fa-user-times fa-fw"></i>
          </button>`,s.innerHTML=`<tr>
        <td>
          <div class="avatarNameBadge">
            <div class="avatarPlaceholder"></div>
              <a href="${location.origin}/profile/${e.uid}?isUid" class="entryName" uid=${e.uid} router-link>${e.name}</a>            <div class="flagsAndBadge">
            ${Ss(e)}
              ${fe(e.badgeId)?ys(e.badgeId):""}
            </div>
          </div>
        </td>
        <td><span data-balloon-pos="up" aria-label="${e.lastModified!==void 0?"since "+J(e.lastModified,"dd MMM yyyy HH:mm"):""}">${e.lastModified!==void 0?zw(e.lastModified,"short"):"-"}</span></td>
        <td><span aria-label="total xp: ${fe(e.xp)?Ns(e.xp):""}" data-balloon-pos="up">
          ${t.level}
        </span></td>
        <td><span aria-label="${a.completedPercentage}% (${a.restartRatio} restarts per completed test)" data-balloon-pos="up">${e.completedTests}/${e.startedTests}</span></td>
        <td>${Ye(Math.round(e.timeTyping??0),!0,!0)}</td>
        <td><span aria-label="${Uh(e.streak?.maxLength,"max streak")}" data-balloon-pos="up">
          ${Uh(e.streak?.length)} 
        </span></td>
        <td class="small"><span aria-label="${o?.details}" data-balloon-pos="up" data-balloon-break="">${o?.wpm??"-"}<div class="sub">${o?.acc??"-"}</div><span></td>
        <td class="small"><span aria-label="${i?.details}" data-balloon-pos="up" data-balloon-break="">${i?.wpm??"-"}<div class="sub">${i?.acc??"-"}</div></span></td>
  <td class="actions">
  ${c}
            
        </td>
      </tr>`,s.querySelector(".avatarPlaceholder")?.replaceWith(Kr(e)),s}function zw(e,t){if(e===void 0)return"";let a="";const o=hp({start:e,end:Date.now()});return t===void 0||t==="full"?a=Kb(o,{format:["years","months","days","hours","minutes"]}):a=jb(e),a!==""?a:"less then a minute"}function Nh(e){if(e===void 0)return;const t={wpm:D.typingSpeed(e.wpm,{showDecimalPlaces:!0}),acc:D.percentage(e.acc,{showDecimalPlaces:!0}),raw:D.typingSpeed(e.raw,{showDecimalPlaces:!0}),con:D.percentage(e.consistency,{showDecimalPlaces:!0}),details:""};return t.details=[`${Aa(e.language)}`,`${t.wpm} wpm`,`${t.acc} acc`,`${t.raw} raw`,`${t.con} con`,`${J(e.timestamp,"dd MMM yyyy")}`].join(`
`),t}function Uh(e,t){return e===1?"-":fe(e)?`${t!==void 0?t+" ":""}${e} days`:"-"}n(".pageFriends button.friendAdd").on("click",()=>{uT.show(void 0,{})});n(".pageFriends .pendingRequests table").on("click",async e=>{const t=Array.from(e.target.classList).find(s=>["accepted","rejected","blocked"].includes(s));if(t===void 0)return;const a=e.target.closest("tr"),o=a.dataset.id;if(o===void 0)throw new Error("Cannot find id of target.");a.querySelectorAll("button").forEach(s=>s.disabled=!0),Z();const i=t==="rejected"?await T.connections.delete({params:{id:o}}):await T.connections.update({params:{id:o},body:{status:t}});if(N(),i.status!==200)f(`Cannot update friend request: ${i.body.message}`,-1);else{Ja=Ja?.filter(l=>l._id!==o),Qm();const s=S();if(s){const l=a.dataset.receiverUid;if(l===void 0)throw new Error("Cannot find receiverUid of target.");t==="rejected"?delete s.connections[l]:s.connections[l]=t,at(s)}t==="blocked"&&f("User has been blocked",0),t==="accepted"&&f("Request accepted",1),t==="rejected"&&f("Request rejected",0),t==="accepted"&&(Hw(),await Dw(),Ww(),Ow())}});n(".pageFriends .friends table").on("click",async e=>{const t=Array.from(e.target.classList).find(i=>["remove"].includes(i));if(t===void 0)return;const a=e.target.closest("tr"),o=a.dataset.connectionId;if(o===void 0)throw new Error("Cannot find id of target.");if(t==="remove"){const i=a.querySelector("a.entryName")?.textContent??"";fT.show([o,i],{})}});function Hw(){document.querySelector(".friends .spinner")?.classList.remove("hidden")}function Ow(){document.querySelector(".friends .spinner")?.classList.add("hidden")}function Vh(){Qm(),Ww()}const gT=new to({id:"friends",display:"Friends",element:dT,path:"/friends",loadingOptions:{loadingMode:()=>tt()?Ca!==void 0&&Ja!==void 0?{mode:"async",beforeLoading:Hw,afterLoading:()=>{Ow(),Vh()}}:"sync":"none",loadingPromise:async()=>{if(await Tp,!Ma()?.connections.enabled)throw new Error("Connectins are disabled.");await Promise.all([pT(),Dw()])},style:"bar",keyframes:[{percentage:50,durationMs:1500,text:"Downloading friends..."},{percentage:50,durationMs:1500,text:"Downloading friend requests..."}]},afterHide:async()=>{yt("pageFriends")},beforeShow:async()=>{Ht("pageFriends","main"),Vh()}});n(()=>{Nt("pageFriends")});qa(e=>{e.type==="authStateChanged"&&!e.data.isUserSignedIn&&(Ja=void 0,Ca=void 0)});const hT=gy();function Kh(){n(".page.pageProfile .error").addClass("hidden"),n(".page.pageProfile .preloader").removeClass("hidden"),n(".page.pageProfile .profile").html(`
      <div class="details none">
        <div class="avatarAndName">
          <div class="avatar"></div>
          <div>
             <div class="user">
              <div class="name">-</div>
              <div class="userFlags"></div>
            </div>
            <div class="badges"></div>
            <div class="allBadges"></div>
            <div class="joined" data-balloon-pos="up">-</div>
	          <div class="streak" data-balloon-pos="up">-</div>
          </div>
          <div class="levelAndBar">
            <div class="level" data-balloon-pos="up">-</div>
            <div class="xpBar" data-balloon-pos="up">
              <div class="bar" style="width: 0%;"></div>
            </div>
            <div class="xp" data-balloon-pos="up">-/-</div>
          </div>
        </div>
        <div class="separator sep1"></div>
        <div class="typingStats vertical">
          <div class="started">
            <div class="title">tests started</div>
            <div class="value">-</div>
          </div>
          <div class="completed">
            <div class="title">tests completed</div>
            <div class="value">-</div>
          </div>
          <div class="timeTyping">
            <div class="title">time typing</div>
            <div class="value">-</div>
          </div>
        </div>
        <div class="separator sep2 hidden"></div>

        <div class="bioAndKeyboard vertical hidden">
          <div class="bio">
            <div class="title">bio</div>
            <div class="value">-</div>
          </div>
          <div class="keyboard hidden">
            <div class="title">keyboard</div>
            <div class="value">-</div>
          </div>
        </div>
        <div class="separator sep3 hidden"></div>

        <div class="socials big hidden">
          <div class="title">socials</div>
          <div class="value">-</div>
        </div>
        <div class="buttonGroup">
          <button
            class="userReportButton hidden"
            data-balloon-pos="left"
            aria-label="Report user"
          >
            <i class="fas fa-flag"></i>
          </button>
          <button
            class="addFriendButton hidden"
            data-balloon-pos="left"
            aria-label="Send friend request"
          >
            <i class="fas fa-user-plus"></i>
          </button>
        </div>
      </div>
      <div class="leaderboardsPositions">
        <div class="title">All-Time English Leaderboards</div>
        <div class="group t15">
          <div class="testType">15 seconds</div>
          <div class="pos">-</div>
          <div class="topPercentage">-</div>
        </div>
        <div class="group t60">
          <div class="testType">60 seconds</div>
          <div class="pos">-</div>
          <div class="topPercentage">-</div>
        </div>
      </div>
      <div class="pbsWords">
        <div class="group">
          <div class="quick">
            <div class="test">10 words</div>
            <div class="wpm">-</div>
            <div class="acc">-</div>
          </div>
        </div>
        <div class="group">
          <div class="quick">
            <div class="test">25 words</div>
            <div class="wpm">-</div>
            <div class="acc">-</div>
          </div>
        </div>
        <div class="group">
          <div class="quick">
            <div class="test">50 words</div>
            <div class="wpm">-</div>
            <div class="acc">-</div>
          </div>
        </div>
        <div class="group">
          <div class="quick">
            <div class="test">100 words</div>
            <div class="wpm">-</div>
            <div class="acc">-</div>
          </div>
        </div>
      </div>
      <div class="pbsTime">
        <div class="group">
          <div class="quick">
            <div class="test">15 seconds</div>
            <div class="wpm">-</div>
            <div class="acc">-</div>
          </div>
        </div>
        <div class="group">
          <div class="quick">
            <div class="test">30 seconds</div>
            <div class="wpm">-</div>
            <div class="acc">-</div>
          </div>
        </div>
        <div class="group">
          <div class="quick">
            <div class="test">60 seconds</div>
            <div class="wpm">-</div>
            <div class="acc">-</div>
          </div>
        </div>
        <div class="group">
          <div class="quick">
            <div class="test">120 seconds</div>
            <div class="wpm">-</div>
            <div class="acc">-</div>
          </div>
        </div>
      </div><div class="lbOptOutReminder hidden"></div>
      `);const e=document.querySelector(".page.pageProfile .testActivity");e!==null&&Wm(e)}async function bT(e){const t=lk("isUid");if(e.data)n(".page.pageProfile .preloader").addClass("hidden"),await Nc("profile",e.data),Ff(e.data.personalBests,!0);else if(e.uidOrName!==void 0&&e.uidOrName!==""){const a=await T.users.getProfile({params:{uidOrName:e.uidOrName},query:{isUid:t}});if(n(".page.pageProfile .preloader").addClass("hidden"),a.status===404){const o=t?"User not found":`User ${e.uidOrName} not found`;n(".page.pageProfile .preloader").addClass("hidden"),n(".page.pageProfile .error").removeClass("hidden"),n(".page.pageProfile .error .message").text(o)}else if(a.status===200){const o=a.body.data;window.history.replaceState(null,"",`/profile/${o.name}`),await Nc("profile",o),Ff(o.personalBests,!0);const i=document.querySelector(".page.pageProfile .testActivity");if(o.testActivity!==void 0){const s=new tr(o.testActivity.testsByDays,new Date(o.testActivity.lastDay),hT);Lw(i,s);const l=i.querySelector(".top .title");l.innerHTML=l?.innerHTML+" in last 12 months"}else Wm(i)}else{f("Failed to load profile: "+a.body.message,-1);return}}else f("Missing update parameter!",-1)}n(".page.pageProfile").on("click",".profile .userReportButton",()=>{const e=n(".page.pageProfile .profile").attr("uid")??"",t=n(".page.pageProfile .profile").attr("name")??"",a=(n(".page.pageProfile .profile").attr("lbOptOut")??"false")==="true";rT({uid:e,name:t,lbOptOut:a})});n(".page.pageProfile").on("click",".profile .addFriendButton",async()=>{const e=n(".page.pageProfile .profile").attr("name")??"",t=await Rw(e);t===!0?(f(`Request sent to ${e}`),n(".profile .details .addFriendButton").addClass("disabled")):f(t,-1)});const yT=new to({id:"profile",element:n(".page.pageProfile"),path:"/profile",afterHide:async()=>{yt("pageProfile"),Kh()},beforeShow:async e=>{Ht("pageProfile","main");const t=e?.params?.uidOrName??"";t?(n(".page.pageProfile .preloader").removeClass("hidden"),n(".page.pageProfile .search").addClass("hidden"),n(".page.pageProfile .content").removeClass("hidden"),Kh(),bT({uidOrName:t,data:e?.data})):(n(".page.pageProfile .preloader").addClass("hidden"),n(".page.pageProfile .search").removeClass("hidden"),n(".page.pageProfile .content").addClass("hidden"))}});Nt("pageProfile");const vT=new to({id:"profileSearch",element:n(".page.pageProfileSearch"),path:"/profile",afterHide:async()=>{yt("pageProfileSearch")},beforeShow:async()=>{Ht("pageProfileSearch","main"),n(".page.pageProfileSearch input").val("")},afterShow:async()=>{n(".page.pageProfileSearch input").trigger("focus")}}),wT=new to({id:"404",element:n(".page.page404"),path:"/404",afterHide:async()=>{yt("page404")},beforeShow:async()=>{Ht("page404","main")}});Nt("page404");const CT=q.enum(["allTime","weekly","daily"]),yu="EEEE, do MMMM yyyy",jh="EEEE, do MMMM yyyy HH:mm",b={loading:!0,updating:!1,type:"allTime",mode:"time",mode2:"15",data:null,userData:null,page:0,pageSize:50,friendsOnly:!1,title:"All-time English Time 15 Leaderboard",scrollToUserAfterFill:!1,goToUserPage:!1},Nw=q.object({type:CT,mode:Ob.optional(),mode2:q.string().optional(),language:Wb.optional(),yesterday:q.boolean().optional(),lastWeek:q.boolean().optional(),friendsOnly:q.boolean().optional()}),kT=Nw.extend({page:q.number(),goToUserPage:q.boolean()}).partial(),Uw=new pt({key:"leaderboardSelector",schema:Nw,fallback:{type:"allTime",mode2:"15"}}),Jo={allTime:{time:{15:["english"],60:["english"]}},daily:{}};function Fs(){const e=b.type==="allTime"?"All-time":b.type==="weekly"?"Weekly XP":"Daily",t=b.friendsOnly?"Friends ":"",a=b.type!=="weekly"?$t(b.language):"",o=b.type!=="weekly"?` ${$t(b.mode)} ${b.mode2}`:"";if(b.title=`${e} ${a} ${o} ${t}Leaderboard`,n(".page.pageLeaderboards .bigtitle >.text").text(b.title),n(".page.pageLeaderboards .bigtitle .subtext").addClass("hidden"),n(".page.pageLeaderboards .bigtitle button").addClass("hidden"),n(".page.pageLeaderboards .bigtitle .subtext .divider").addClass("hidden"),b.type==="daily"){n(".page.pageLeaderboards .bigtitle .subtext").removeClass("hidden"),n(".page.pageLeaderboards .bigtitle button[data-action='toggleYesterday']").removeClass("hidden"),n(".page.pageLeaderboards .bigtitle .subtext .divider").removeClass("hidden"),b.yesterday?n(".page.pageLeaderboards .bigtitle button[data-action='toggleYesterday']").html(`
        <i class="fas fa-forward"></i>
            show today
        `):n(".page.pageLeaderboards .bigtitle button[data-action='toggleYesterday']").html(`
        <i class="fas fa-backward"></i>
            show yesterday
        `);let i=p2(new Na);b.yesterday&&(i=m2(i)),Zh(J(i,yu)+" UTC",Bl(i),Bl(Gb(i)))}else if(b.type==="weekly"){n(".page.pageLeaderboards .bigtitle .subtext").removeClass("hidden"),n(".page.pageLeaderboards .bigtitle button[data-action='toggleLastWeek']").removeClass("hidden"),n(".page.pageLeaderboards .bigtitle .subtext .divider").removeClass("hidden"),b.lastWeek?n(".page.pageLeaderboards .bigtitle button[data-action='toggleLastWeek']").html(`
        <i class="fas fa-forward"></i>
            show this week
        `):n(".page.pageLeaderboards .bigtitle button[data-action='toggleLastWeek']").html(`
        <i class="fas fa-backward"></i>
            show last week
        `);let i=g2(new Na,{weekStartsOn:1});b.lastWeek&&(i=h2(i,7));const s=Qb(i,{weekStartsOn:1}),l=`${J(i,yu)} - ${J(s,yu)} UTC`;Zh(l,Bl(i),Bl(s))}}async function cn(e=!1){e?(b.updating=!0,b.error=void 0):(b.loading=!0,b.error=void 0,b.data=null,b.userData=null),eo();const t=(s,l,c)=>({rank:async()=>l({query:{...c,friendsOnly:b.friendsOnly||void 0}}),data:async()=>s({query:{...c,page:b.page,pageSize:b.pageSize,friendsOnly:b.friendsOnly||void 0}})});let a;if(b.type==="allTime")a=t(T.leaderboards.get,T.leaderboards.getRank,{language:"english",mode:"time",mode2:b.mode2});else if(b.type==="daily")a=t(T.leaderboards.getDaily,T.leaderboards.getDailyRank,{language:b.language,mode:b.mode,mode2:b.mode2,daysBefore:b.yesterday?1:void 0});else if(b.type==="weekly")a=t(T.leaderboards.getWeeklyXp,T.leaderboards.getWeeklyXpRank,{weeksBefore:b.lastWeek?1:void 0});else throw new Error("unknown state type");if((!A()||b.userData!==null)&&(a.rank=void 0),b.goToUserPage&&a.rank!==void 0){b.goToUserPage=!1;const s=await a.rank();s!==void 0&&s.status===200&&s.body.data!==null&&(b.userData=s.body.data,b.page=Math.floor((b.userData.rank-1)/b.pageSize),fi()),a.rank=void 0}const[o,i]=await Promise.all([a.data(),a.rank?.()]);o.status===200?(b.data=o.body.data.entries,b.count=o.body.data.count,b.pageSize=o.body.data.pageSize,b.type==="daily"&&(b.minWpm=o.body.data.minWpm)):(b.data=null,o.status===404?b.error="No leaderboard found":(b.error="Something went wrong",f("Failed to get leaderboard: "+o.body.message,-1))),b.userData===null&&i!==void 0&&(i.status===200?i.body.data!==null&&(b.userData=i.body.data):(b.userData=null,b.error="Something went wrong",f("Failed to get rank: "+i.body.message,-1))),b.loading=!1,b.updating=!1,eo(),!e&&A()&&Vw()}function ST(){const e=n(".page.pageLeaderboards .titleAndButtons .jumpButtons");e.find("button").removeClass("active");const t=Math.ceil(b.count/b.pageSize);if(t<=1?e.find("button").addClass("disabled"):e.find("button").removeClass("disabled"),b.page===0?(e.find("button[data-action='previousPage']").addClass("disabled"),e.find("button[data-action='firstPage']").addClass("disabled")):(e.find("button[data-action='previousPage']").removeClass("disabled"),e.find("button[data-action='firstPage']").removeClass("disabled")),A()){const a=e.find("button[data-action='userPage']");if(!b.userData)a.addClass("disabled");else{const o=Math.floor((b.userData.rank-1)/b.pageSize);b.page===o?a.addClass("disabled"):a.removeClass("disabled")}}b.page>=t-1?e.find("button[data-action='nextPage']").addClass("disabled"):e.find("button[data-action='nextPage']").removeClass("disabled")}function xT(e,t=!1){const a={wpm:D.typingSpeed(e.wpm,{showDecimalPlaces:!0}),acc:D.percentage(e.acc,{showDecimalPlaces:!0}),raw:D.typingSpeed(e.raw,{showDecimalPlaces:!0}),con:D.percentage(e.consistency,{showDecimalPlaces:!0})},o=document.createElement("tr");return t&&o.classList.add("me"),o.dataset.uid=e.uid,o.innerHTML=`
      <td>${ws(e.friendsRank)}</td>
      <td>${ws(e.rank)}</td>
      <td>
        <div class="avatarNameBadge">
          <div class="avatarPlaceholder"></div>
          <a href="${location.origin}/profile/${e.uid}?isUid" class="entryName" uid=${e.uid} router-link>${e.name}</a>
          <div class="flagsAndBadge">
            ${Ss({...e,isFriend:$p(e.uid)})}
            ${fe(e.badgeId)?ys(e.badgeId):""}
          </div>
        </div>
      </td>
      <td class="stat narrow">
      ${a.wpm}
        <div class="sub">${a.acc}</div>
      </td>
      </td>
      <td class="stat narrow rawAndConsistency">
      ${a.raw}
        <div class="sub">${a.con}</div>
      </td>
      <td class="stat wide">${a.wpm}</td>
      <td class="stat wide">${a.acc}</td>
      <td class="stat wide">${a.raw}</td>
      <td class="stat wide">${a.con}</td>
      <td class="date">${J(e.timestamp,"dd MMM yyyy")}<div class="sub">${J(e.timestamp,"HH:mm")}</div></td>
    
  `,o.querySelector(".avatarPlaceholder")?.replaceWith(Kr(e)),o}function TT(e,t=!1){const a=jb(e.lastActivityTimestamp,{addSuffix:!0}),o=document.createElement("tr");return t&&o.classList.add("me"),o.dataset.uid=e.uid,o.innerHTML=`
      <td>${ws(e.friendsRank)}</td>
      <td>${ws(e.rank)}</td>
      <td>
        <div class="avatarNameBadge">
          <div class="avatarPlaceholder"></div>
          <a href="${location.origin}/profile/${e.uid}?isUid" class="entryName" uid=${e.uid} router-link>${e.name}</a>
          <div class="flagsAndBadge">
            ${Ss({...e,isFriend:$p(e.uid)})}
            ${fe(e.badgeId)?ys(e.badgeId):""}
          </div>
        </div>
      </td>
      <td class="stat wide">${e.totalXp<1e3?e.totalXp:mc(e.totalXp)}</td>
      <td class="stat wide">${Ye(Math.round(e.timeTypedSeconds),!0,!0,":")}</td>
      <td class="stat narrow">
      ${e.totalXp<1e3?e.totalXp:mc(e.totalXp)}
      <div class="sub">${Ye(Math.round(e.timeTypedSeconds),!0,!0,":")}</td>
      </td>
      <td class="date" data-balloon-pos="left"  aria-label="${a}">
        ${J(e.lastActivityTimestamp,"dd MMM yyyy")}
        <div class="sub">
          ${J(e.lastActivityTimestamp,"HH:mm")}
        </div>
      </td>
    </tr>
  `,o.querySelector(".avatarPlaceholder")?.replaceWith(Kr(e)),o}function LT(){const e=n(".page.pageLeaderboards table tbody");if(e.empty(),b.friendsOnly?e.parent().addClass("friendsOnly"):e.parent().removeClass("friendsOnly"),n(".page.pageLeaderboards table thead").addClass("hidden"),b.type==="allTime"||b.type==="daily"?n(".page.pageLeaderboards table thead.allTimeAndDaily").removeClass("hidden"):b.type==="weekly"&&n(".page.pageLeaderboards table thead.weekly").removeClass("hidden"),b.data===null||b.data.length===0){e.append('<tr><td colspan="7" class="empty">No data</td></tr>'),n(".page.pageLeaderboards table").removeClass("hidden");return}if(b.type==="allTime"||b.type==="daily")for(const t of b.data){const a=tt()?.uid===t.uid;e.append(xT(t,a))}else if(b.type==="weekly")for(const t of b.data){const a=tt()?.uid===t.uid;e.append(TT(t,a))}n(".page.pageLeaderboards table").removeClass("hidden")}function Gh(){if(b.type!=="allTime"||b.userData===null)return null;const e=S()?.lbMemory?.time?.[b.mode2]?.english??0,t=b.userData.rank,a=e-t;return a!==0&&zS("time",b.mode2,"english",t,!0),a}function Vw(){if(A()&&S()?.lbOptOut===!0){n(".page.pageLeaderboards .bigUser").html('<div class="warning">You have opted out of the leaderboards.</div>');return}if(A()&&S()?.banned===!0){n(".page.pageLeaderboards .bigUser").html('<div class="warning">Your account is banned</div>');return}const e=Ma()?.leaderboards.minTimeTyping??7200;if(A()&&(S()?.typingStats?.timeTyping??0)<e){n(".page.pageLeaderboards .bigUser").html(`<div class="warning">Your account must have ${Kb(hp({start:0,end:e*1e3}))} typed to be placed on the leaderboard.</div>`);return}if(A()&&b.type==="daily"&&b.userData===null){let t="Not qualified";b.yesterday||(t+=` (min speed required: ${D.typingSpeed(b.minWpm,{showDecimalPlaces:!0,suffix:` ${r.typingSpeedUnit}`})})`),n(".page.pageLeaderboards .bigUser").html(`<div class="warning">${t}</div>`);return}if(A()&&b.userData===null){n(".page.pageLeaderboards .bigUser").html('<div class="warning">Not qualified</div>');return}if(b.data!==null){if(b.type==="allTime"||b.type==="daily"){if(!b.userData||!b.count){n(".page.pageLeaderboards .bigUser").addClass("hidden"),n(".page.pageLeaderboards .tableAndUser > .divider").removeClass("hidden");return}const t=b.userData,a=b.friendsOnly?t.friendsRank:t.rank;let i=`Top ${(a/b.count*100).toFixed(2)}%`;a===1&&(i="GOAT");const s=Gh();let l;s===null?l="":s===0?l=" ( = since you last checked)":s>0?l=` (<i class="fas fa-fw fa-angle-up"></i>${Math.abs(s)} since you last checked
      )`:l=` (<i class="fas fa-fw fa-angle-down"></i>${Math.abs(s)} since you last checked
        )`;const c={wpm:D.typingSpeed(t.wpm,{showDecimalPlaces:!0}),acc:D.percentage(t.acc,{showDecimalPlaces:!0}),raw:D.typingSpeed(t.raw,{showDecimalPlaces:!0}),con:D.percentage(t.consistency,{showDecimalPlaces:!0})},d=`
          <div class="rank">${ws(a)}</div>
        <div class="userInfo">
          <div class="top">You (${i})</div>
          <div class="bottom">${l}</div>
        </div>
        <div class="stat wide">
          <div class="title">${r.typingSpeedUnit}</div>
          <div class="value">${c.wpm}</div>
        </div>
        <div class="stat wide">
          <div class="title">accuracy</div>
          <div class="value">${c.acc}</div>
        </div>
        <div class="stat wide">
          <div class="title">raw</div>
          <div class="value">${c.raw}</div>
        </div>
        <div class="stat wide">
          <div class="title">consistency</div>
          <div class="value">${c.con}</div>
        </div>
        <div class="stat wide">
          <div class="title">date</div>
          <div class="value">${J(t.timestamp,"dd MMM yyyy HH:mm")}</div>
        </div>


        <div class="stat narrow">
          <div>${c.wpm}</div>
          <div class="sub">${c.acc}</div>
        </div>
        <div class="stat narrow rawAndConsistency">
          <div>${c.raw}</div>
          <div class="sub">${c.con}</div>
        </div>
        <div class="stat narrow">
          <div>${J(t.timestamp,"dd MMM yyyy")}</div>
          <div class="sub">${J(t.timestamp,"HH:mm")}</div>
        </div>
        `;n(".page.pageLeaderboards .bigUser").html(d)}else if(b.type==="weekly"){if(!b.userData||!b.count){n(".page.pageLeaderboards .bigUser").addClass("hidden");return}const t=b.userData,a=b.friendsOnly?t.friendsRank:t.rank;let i=`Top ${(a/b.count*100).toFixed(2)}%`;a===1&&(i="GOAT");const s=Gh();let l;s===null?l="":s===0?l=" ( = since you last checked)":s>0?l=` (<i class="fas fa-fw fa-angle-up"></i>${Math.abs(s)} since you last checked
      )`:l=` (<i class="fas fa-fw fa-angle-down"></i>${Math.abs(s)} since you last checked
        )`;const c={xp:t.totalXp<1e3?t.totalXp:mc(t.totalXp),time:Ye(Math.round(t.timeTypedSeconds),!0,!0,":")},d=`
          <div class="rank">${ws(a)}</div>
        <div class="userInfo">
          <div class="top">You (${i})</div>
          <div class="bottom">${l}</div>
        </div>
        <div class="stat wide">
          <div class="title">xp gained</div>
          <div class="value">${c.xp}</div>
        </div>
        <div class="stat wide">
          <div class="title">time typed</div>
          <div class="value">${c.time}</div>
        </div>
        <div class="stat narrow">
          <div>${c.xp}</div>
          <div class="sub">${c.time}</div>
        </div>
        <div class="stat wide">
          <div class="title">last activity</div>
          <div class="value">${J(t.lastActivityTimestamp,"dd MMM yyyy HH:mm")}</div>
        </div>
        <div class="stat narrow">
          <div>${J(t.lastActivityTimestamp,"dd MMM yyyy")}</div>
          <div class="sub">${J(t.lastActivityTimestamp,"HH:mm")}</div>
        </div>
        `;n(".page.pageLeaderboards .bigUser").html(d)}n(".page.pageLeaderboards .bigUser").removeClass("hidden"),n(".page.pageLeaderboards .tableAndUser > .divider").addClass("hidden")}}function eo(){if(n(".page.pageLeaderboards .loading").addClass("hidden"),n(".page.pageLeaderboards .updating").addClass("invisible"),n(".page.pageLeaderboards .error").addClass("hidden"),b.error!==void 0){n(".page.pageLeaderboards .error").removeClass("hidden"),n(".page.pageLeaderboards .error p").text(b.error),Xh();return}if(b.updating){Jh(),n(".page.pageLeaderboards .updating").removeClass("invisible");return}else if(b.loading){Jh(),n(".page.pageLeaderboards .bigUser").addClass("hidden"),n(".page.pageLeaderboards .titleAndButtons").addClass("hidden"),n(".page.pageLeaderboards .loading").removeClass("hidden"),n(".page.pageLeaderboards table").addClass("hidden");return}else Xh();if(A()?n(".page.pageLeaderboards .needAuth").removeClass("hidden"):n(".page.pageLeaderboards .needAuth").addClass("hidden"),b.data===null){f("Data is null");return}n(".page.pageLeaderboards .titleAndButtons").removeClass("hidden"),ST(),ET(),LT();for(const e of document.querySelectorAll(".page.pageLeaderboards .wide.speedUnit, .page.pageLeaderboards .narrow.speedUnit span"))e.innerHTML=r.typingSpeedUnit;b.scrollToUserAfterFill&&(document.querySelector(".tableAndUser .me")?.scrollIntoView({block:"center"}),b.scrollToUserAfterFill=!1)}function ul(){$T(),MT(),AT(),_T()}function $T(){const e=n(".page.pageLeaderboards .buttonGroup.typeButtons");e.find("button").removeClass("active"),e.find(`button[data-type=${b.type}]`).addClass("active")}function MT(){const e=n(".page.pageLeaderboards .buttonGroup.friendsOnlyButtons");if(A()&&(Ma()?.connections.enabled??!1))e.removeClass("hidden");else{e.addClass("hidden"),b.friendsOnly=!1;return}const t=n(".page.pageLeaderboards .buttonGroup.friendsOnlyButtons .everyone"),a=n(".page.pageLeaderboards .buttonGroup.friendsOnlyButtons .friendsOnly");b.friendsOnly?(a.addClass("active"),t.removeClass("active")):(a.removeClass("active"),t.addClass("active"))}function AT(){if(b.type!=="allTime"&&b.type!=="daily"){n(".page.pageLeaderboards .buttonGroup.modeButtons").addClass("hidden");return}n(".page.pageLeaderboards .buttonGroup.modeButtons").removeClass("hidden");const e=n(".page.pageLeaderboards .buttonGroup.modeButtons");e.find("button").removeClass("active"),e.find(`button[data-mode=${b.mode}][data-mode2=${b.mode2}]`).addClass("active"),n(".page.pageLeaderboards .buttonGroup.modeButtons button").addClass("hidden");for(const t of Object.keys(Jo[b.type]))for(const a of Object.keys(Jo[b.type][t]))n(`.page.pageLeaderboards .buttonGroup.modeButtons button[data-mode="${t}"][data-mode2="${a}"]`).removeClass("hidden")}function _T(){if(b.type!=="daily"){n(".page.pageLeaderboards .buttonGroup.languageButtons").addClass("hidden");return}n(".page.pageLeaderboards .buttonGroup.languageButtons").removeClass("hidden");const e=n(".page.pageLeaderboards .buttonGroup.languageButtons");e.find("button").removeClass("active"),e.find(`button[data-language=${b.language}]`).addClass("active"),n(".page.pageLeaderboards .buttonGroup.languageButtons button").addClass("hidden");for(const t of Jo[b.type][b.mode]?.[b.mode2]??[])n(`.page.pageLeaderboards .buttonGroup.languageButtons button[data-language="${t}"]`).removeClass("hidden")}let zf;function Qh(){if(b.type==="daily"){const e=Eg(new Date,Gb(new Na));n(".page.pageLeaderboards .titleAndButtons .timer").text("Next reset in: "+Ye(e,!0))}else if(b.type==="allTime"){const e=new Date,t=14-e.getMinutes()%15,a=60-e.getSeconds(),o=t*60+a;n(".page.pageLeaderboards .titleAndButtons .timer").text("Next update in: "+Ye(o,!0))}else if(b.type==="weekly"){const e=Qb(new Na,{weekStartsOn:1}),t=Eg(new Date,e);n(".page.pageLeaderboards .titleAndButtons .timer").text("Next reset in: "+Ye(t,!0,!0,":",!0,!0))}}function ET(){let e=!0;(b.type==="daily"&&b.yesterday||b.type==="weekly"&&b.lastWeek)&&(e=!1),e?n(".page.pageLeaderboards .titleAndButtons .timer").removeClass("invisible"):n(".page.pageLeaderboards .titleAndButtons .timer").addClass("invisible")}function qT(){Qh(),zf=setInterval(()=>{Qh()},1e3)}function IT(){clearInterval(zf),zf=void 0,n(".page.pageLeaderboards .titleAndButtons .timer").text("-")}function Yh(e){return e.startsWith("(")?e.slice(1,-1).split("|"):[e]}async function FT(){const e=Ma()?.dailyLeaderboards.validModeRules;if(e===void 0)throw new Error("cannot load server configuration for dailyLeaderboards.validModeRules");const t=e.flatMap(a=>{const o=Yh(a.language);return Yh(a.mode2).map(s=>({mode:a.mode,mode2:s,languages:o}))});Jo.daily=t.reduce((a,{mode:o,mode2:i,languages:s})=>{let l=a[o];l===void 0&&(l={},a[o]=l);let c=l[i];return c===void 0&&(c=[],l[i]=c),c.push(...s),a},{})}function Vd(){if(b.type==="weekly")return;const e=Jo[b.type];let t=e[b.mode];if(t===void 0){const o=Object.keys(e).sort()[0];if(o===void 0)throw new Error(`no valid leaderboard config for type ${b.type}`);b.mode=o,t=e[b.mode]}let a=t[b.mode2];if(a===void 0){const o=Object.keys(t).sort((i,s)=>parseInt(i)-parseInt(s))[0];if(o===void 0)throw new Error(`no valid leaderboard config for type ${b.type} and mode ${b.mode}`);b.mode2=o,a=t[b.mode2]}if(a===void 0||a.length<1)throw new Error(`Daily leaderboard config not valid for mode:${b.mode} mode2:${b.mode2}`);a.includes(b.language)||(b.language=a.sort()[0])}async function PT(){const t=Array.from(new Set(Object.values(Jo).flatMap(i=>Object.keys(i)))).sort().flatMap(i=>{const s=Array.from(new Set(Object.values(Jo).flatMap(c=>Object.keys(c[i]??{})))).sort((c,d)=>parseInt(c)-parseInt(d)),l=i==="time"?"fas fa-clock":"fas fa-align-left";return s.map(c=>`<button data-mode="${i}" data-mode2="${c}">
      <i class="${l}"></i>
       ${i} ${c}
    </button>`)});n(".modeButtons").html('<div class="divider"></div>'+t.join(`
`));const o=Array.from(new Set(Object.values(Jo).flatMap(i=>Object.values(i)).flatMap(i=>Object.values(i)).flatMap(i=>i))).sort().map(i=>`<button data-language="${i}">
          <i class="fas fa-globe"></i>
          ${i}
        </button>`);n(".languageButtons").html('<div class="divider"></div>'+o.join(`
`))}function Jh(){n(".page.pageLeaderboards button").prop("disabled",!0)}function Xh(){n(".page.pageLeaderboards button").prop("disabled",!1)}function BT(e){e<0||e===b.page||Kw("goToPage",e)}function Kw(e,t){if(e==="firstPage")b.page=0;else if(e==="previousPage"&&b.page>0){const a=Math.ceil(b.count/b.pageSize);b.page>a?b.page=a-1:b.page-=1}else if(e==="nextPage")b.page+=1;else if(e==="goToPage"&&t!==void 0)b.page=t;else if(e==="userPage"){if(A()){const a=b.userData?.rank;if(fe(a)){const o=Math.floor((a-1)/b.pageSize);if(b.page===o)return;b.page=o,b.scrollToUserAfterFill=!0}}}else return;fi(),cn(!0),eo()}function RT(e){b.type==="daily"&&e==="toggleYesterday"?b.yesterday=!b.yesterday:b.type==="weekly"&&e==="toggleLastWeek"&&(b.lastWeek=!b.lastWeek),fi(),cn(),eo(),Fs()}function fi(){if(b.goToUserPage)return;const e={};e.type=b.type,b.type==="allTime"?e.mode2=b.mode2:b.type==="daily"?(e.mode=b.mode,e.language=b.language,e.mode2=b.mode2,b.yesterday&&(e.yesterday=!0)):b.type==="weekly"&&b.lastWeek&&(e.lastWeek=!0),e.page=b.page+1,b.friendsOnly&&(e.friendsOnly=!0),jw.setUrlParams(e),Uw.set(b)}function DT(e){if(e===void 0){Object.assign(b,Uw.get());return}e.type!==void 0&&(b.type=e.type),b.friendsOnly=e.friendsOnly??!1,b.type==="allTime"?e.mode2!==void 0&&(b.mode2=e.mode2):b.type==="daily"?(e.language!==void 0&&(b.language=e.language),e.mode2!==void 0&&(b.mode2=e.mode2),e.mode!==void 0&&(b.mode=e.mode),e.yesterday!==void 0&&(b.yesterday=e.yesterday)):b.type==="weekly"&&e.lastWeek!==void 0&&(b.lastWeek=e.lastWeek),e.page!==void 0&&(b.page=e.page-1,b.page<0&&(b.page=0)),e.goToUserPage===!0&&(b.goToUserPage=!0)}function Bl(e){return b2(e,new Date().getTimezoneOffset())}function Zh(e,t,a){const o=`local time 
`+J(t,jh)+` - 
`+J(a,jh),i=n(".page.pageLeaderboards .bigtitle .subtext > .text");i.text(`${e}`),i.attr("aria-label",o)}function ws(e){return e===void 0?"":e===1?'<i class="fas fa-fw fa-crown"></i>':e.toString()}n(".page.pageLeaderboards .jumpButtons button").on("click",function(){const e=n(this).data("action");e!=="goToPage"&&Kw(e)});n(".page.pageLeaderboards .bigtitle button").on("click",function(){const e=n(this).data("action");RT(e)});n(".page.pageLeaderboards .buttonGroup.typeButtons").on("click","button",function(){const e=n(this).data("type");b.type!==e&&(b.type=e,b.type==="daily"&&(b.language="english",b.yesterday=!1),b.type==="weekly"&&(b.lastWeek=!1),Vd(),b.data=null,b.page=0,cn(),Fs(),ul(),eo(),fi())});n(".page.pageLeaderboards .buttonGroup.modeButtons").on("click","button",function(){const e=n(this).attr("data-mode"),t=n(this).attr("data-mode2");if(e!==void 0&&t!==void 0&&(b.type==="allTime"||b.type==="daily")){if(b.mode===e&&b.mode2===t)return;b.mode=e,b.mode2=t,b.page=0}else return;Vd(),b.data=null,cn(),ul(),Fs(),eo(),fi()});n(".page.pageLeaderboards .buttonGroup.languageButtons").on("click","button",function(){const e=n(this).attr("data-language");if(e!==void 0&&b.type==="daily"){if(b.language===e)return;b.language=e,b.page=0}else return;Vd(),b.data=null,cn(),ul(),Fs(),eo(),fi()});n(".page.pageLeaderboards .buttonGroup.friendsOnlyButtons").on("click","button",()=>{b.friendsOnly=!b.friendsOnly,b.page=0,cn(),Fs(),ul(),eo(),fi()});const jw=new qm({id:"leaderboards",element:n(".page.pageLeaderboards"),path:"/leaderboards",urlParamsSchema:kT,afterHide:async()=>{yt("pageLeaderboards"),IT()},beforeShow:async e=>{await Tp,Ht("pageLeaderboards","main"),await FT(),await PT(),DT(e.urlParams),Vd(),qT(),Fs(),eo(),ul(),fi(),cn(!1)},afterShow:async()=>{}});n(async()=>{Nt("pageLeaderboards")});ge(e=>{X()==="leaderboards"&&e==="typingSpeedUnit"&&(eo(),Vw())});function WT(){if(!Xe()){f("You are offline",0,{duration:2});return}Pr.show({focusFirstInput:!0,beforeAnimation:async e=>{S()?.streakHourOffset!==void 0?(e.querySelector("input")?.remove(),e.querySelector(".preview")?.remove(),e.querySelector("button")?.remove(),e.querySelector(".text").textContent="You have already set your streak hour offset."):(e.querySelector("input").value="0",Gw())}})}function Gw(){const e=parseInt(Pr.getModal().querySelector("input")?.value,10),t=Pr.getModal().querySelector(".preview"),a=new Date;a.setUTCHours(0),a.setUTCMinutes(0),a.setUTCSeconds(0),a.setUTCMilliseconds(0);const o=new Date;o.setUTCHours(0),o.setUTCMinutes(0),o.setUTCSeconds(0),o.setUTCMilliseconds(0),o.setHours(o.getHours()- -1*e),t.innerHTML=`
    <div class="row"><div>Current local reset time:</div><div>${a.toLocaleTimeString()}</div></div>
    <div class="row"><div>New local reset time:</div><div>${o.toLocaleTimeString()}</div></div>
  `}function zT(){Pr.hide()}async function HT(){const e=parseInt(Pr.getModal().querySelector("input")?.value,10);if(isNaN(e)){f("Streak hour offset must be a number",0);return}if(e<-11||e>12){f("Streak hour offset must be between -11 and 12",0);return}Z();const t=await T.users.setStreakHourOffset({body:{hourOffset:e}});if(N(),t.status!==200)f("Failed to set streak hour offset: "+t.body.message,-1);else{f("Streak hour offset set",1);const a=S();a.streakHourOffset=e,at(a),zT()}}const Pr=new re({dialogId:"streakHourOffsetModal",setup:async e=>{e.querySelector("input")?.addEventListener("input",()=>{Gw()}),e.querySelector("button")?.addEventListener("click",()=>{HT()})}}),OT=new de({id:"editApeKey",title:"Edit Ape key",inputs:[{type:"text",placeholder:"name",initVal:""}],buttonText:"edit",onlineOnly:!0,execFn:async(e,t)=>{const a=await T.apeKeys.save({params:{apeKeyId:e.parameters[0]??""},body:{name:t}});return a.status!==200?{status:-1,message:"Failed to update key: "+a.body.message}:{status:1,message:"Key updated",hideOptions:{clearModalChain:!0}}}}),NT=new de({id:"deleteApeKey",title:"Delete Ape key",text:"Are you sure?",buttonText:"delete",onlineOnly:!0,execFn:async e=>{const t=await T.apeKeys.delete({params:{apeKeyId:e.parameters[0]??""}});return t.status!==200?{status:-1,message:"Failed to delete key: "+t.body.message}:(Ym?.(),{status:1,message:"Key deleted",hideOptions:{clearModalChain:!0}})}}),UT=new de({id:"viewApeKey",title:"Ape key",inputs:[{type:"textarea",disabled:!0,placeholder:"key",initVal:""}],textAllowHtml:!0,text:`
    This is your new Ape Key. Please keep it safe. You will only see it once!<br><br>
    <strong>Note:</strong> Ape Keys are disabled by default, you need to enable them before they can be used.`,buttonText:"close",hideCallsExec:!0,execFn:async e=>({status:1,message:"Key generated",showNotification:!1,hideOptions:{clearModalChain:!0}}),beforeInitFn:e=>{e.inputs[0].initVal=e.parameters[0]},beforeShowFn:e=>{e.canClose=!1,n("#simpleModal textarea").css("height","110px"),n("#simpleModal .submitButton").addClass("hidden"),setTimeout(()=>{e.canClose=!0,n("#simpleModal .submitButton").removeClass("hidden")},5e3)}}),VT=new de({id:"generateApeKey",title:"Generate new Ape key",inputs:[{type:"text",placeholder:"Name",initVal:""}],buttonText:"generate",onlineOnly:!0,execFn:async(e,t)=>{const a=await T.apeKeys.add({body:{name:t,enabled:!1}});if(a.status!==200)return{status:-1,message:"Failed to generate key: "+a.body.message};const o=a.body.data,i=e.modal.getPreviousModalInChain();return Ym?.(),{status:1,message:"Key generated",hideOptions:{clearModalChain:!0,animationMode:"modalOnly"},afterHide:()=>{UT.show([o.apeKey],{modalChain:i,animationMode:"modalOnly"})}}}});let Gc={};const Qw=n("#pageAccountSettings .tab[data-tab='apeKeys']");async function KT(){if(!A())return!1;jT();const e=await T.apeKeys.get();return e.status!==200?e.body.message==="You have lost access to ape keys, please contact support"?(Jw=!0,Xw(),!1):(f("Error getting ape keys: "+e.body.message,-1),!1):(Gc=e.body.data,!0)}function jT(){const e=Qw.find("table tbody");e.empty(),e.append("<tr><td colspan='6' style='text-align: center;font-size:1rem;'><i class='fas fa-spin fa-circle-notch'></i></td></tr>")}function Yw(){const e=Gc;if(e==null)return;const t=Qw.find("table tbody");t.empty();const a=Object.keys(e);if(a.length===0){t.append("<tr><td colspan='6' style='text-align: center;'>No keys found</td></tr>");return}a.forEach(o=>{const i=e[o];t.append(`
      <tr keyId="${o}">
        <td>
          <button class="textButton toggleActive" style="font-size: 1.25rem">
            ${i.enabled?'<i class="fas fa-fw fa-check-square"></i>':'<i class="far fa-fw fa-square"></i>'}
          </button>
        </td>
        <td>${i.name}</td>
        <td>${J(new Date(i.createdOn),"dd MMM yyyy HH:mm")}</td>
        <td>${J(new Date(i.modifiedOn),"dd MMM yyyy HH:mm")}</td>
        <td>${i.lastUsedOn===-1?"-":J(new Date(i.lastUsedOn),"dd MMM yyyy HH:mm")}</td>
        <td>
          <div class="keyButtons">
            <button class="editButton">
              <i class="fas fa-fw fa-pen"></i>
            </button>
            <button class="deleteButton">
              <i class="fas fa-fw fa-trash-alt"></i>
            </button>
          </div>
        </td>
      </tr>
    `)});for(const o of t.find("tr")){const i=o.getAttribute("keyid");o.querySelector("button.toggleActive")?.addEventListener("click",s=>{GT(i)}),o.querySelector("button.deleteButton")?.addEventListener("click",s=>{NT.show([i],{})}),o.querySelector("button.editButton")?.addEventListener("click",s=>{OT.show([i],{})})}}async function GT(e){const t=Gc?.[e];if(!t||Gc===void 0)return;Z();const a=await T.apeKeys.save({params:{apeKeyId:e},body:{enabled:!t.enabled}});if(N(),a.status!==200){f("Failed to update key: "+a.body.message,-1);return}t.enabled=!t.enabled,Yw(),t.enabled?f("Key active",1):f("Key inactive",1)}let Ym,Jw=!1;async function Xw(e){if(Jw){n(".pageAccountSettings .tab[data-tab='apeKeys'] table").remove(),n(".pageAccountSettings .section.apeKeys .buttons").remove(),n(".pageAccountSettings .section.apeKeys .lostAccess").removeClass("hidden");return}Ym=e,await KT(),Yw()}n(".pageAccountSettings").on("click","#generateNewApeKey",()=>{VT.show([],{})});let Wi=[];const Jm=n("#pageAccountSettings .tab[data-tab='blockedUsers']");async function QT(){if(JT(),!A())return Wi=[],!1;const e=await T.connections.get({query:{status:"blocked",type:"incoming"}});return e.status!==200?(Wi=[],f("Error getting blocked users: "+e.body.message,-1),!1):(Wi=e.body.data,!0)}async function YT(){await QT(),Zw()}function JT(){const e=Jm.find("table tbody");e.empty(),e.append("<tr><td colspan='3' style='text-align: center;font-size:1rem;'><i class='fas fa-spin fa-circle-notch'></i></td></tr>")}function Zw(){const e=Jm.find("table tbody");if(e.empty(),Wi.length===0){e.append("<tr><td colspan='3' style='text-align: center;'>No blocked users</td></tr>");return}const t=Wi.map(a=>`
    <tr data-id="${a._id}" data-uid="${Gm(a)}">
       <td><a href="${location.origin}/profile/${a.initiatorUid}?isUid" router-link>${a.initiatorName}</a></td>
       <td>${J(new Date(a.lastModified),"dd MMM yyyy HH:mm")}</td>
       <td>
         <button class="delete">
           <i class="fas fa-fw fa-trash-alt"></i>
         </button>
       </td>
    </tr>
    `);e.append(t.join())}Jm.on("click","table button.delete",async e=>{const t=e.target.closest("tr"),a=t.dataset.id;if(a===void 0)throw new Error("Cannot find id of target.");t.querySelectorAll("button").forEach(i=>i.disabled=!0);const o=await T.connections.delete({params:{id:a}});if(o.status!==200)f(`Cannot unblock user: ${o.body.message}`,-1);else{Wi=Wi.filter(s=>s._id!==a),Zw();const i=S();if(i){const s=t.dataset.uid;if(s===void 0)throw new Error("Cannot find uid of target.");delete i.connections[s],My()}}});const oe=n(".page.pageAccountSettings"),XT=q.object({tab:q.enum(["authentication","account","apeKeys","dangerZone","blockedUsers"])}),ZT=XT.partial(),Xo={tab:"account"};function eL(){oe.find(".section.passwordAuthSettings button").addClass("hidden"),oe.find(".section.googleAuthSettings button").addClass("hidden"),oe.find(".section.githubAuthSettings button").addClass("hidden");const e=tt();if(e===null)return;const t=e.providerData.some(i=>i.providerId==="password"),a=e.providerData.some(i=>i.providerId==="google.com"),o=e.providerData.some(i=>i.providerId==="github.com");t?(oe.find(".section.passwordAuthSettings #emailPasswordAuth").removeClass("hidden"),oe.find(".section.passwordAuthSettings #passPasswordAuth").removeClass("hidden"),(a||o)&&oe.find(".section.passwordAuthSettings #removePasswordAuth").removeClass("hidden")):oe.find(".section.passwordAuthSettings #addPasswordAuth").removeClass("hidden"),a?(oe.find(".section.googleAuthSettings #removeGoogleAuth").removeClass("hidden"),t||o?oe.find(".section.googleAuthSettings #removeGoogleAuth").removeClass("disabled"):oe.find(".section.googleAuthSettings #removeGoogleAuth").addClass("disabled")):oe.find(".section.googleAuthSettings #addGoogleAuth").removeClass("hidden"),o?(oe.find(".section.githubAuthSettings #removeGithubAuth").removeClass("hidden"),t||a?oe.find(".section.githubAuthSettings #removeGithubAuth").removeClass("disabled"):oe.find(".section.githubAuthSettings #removeGithubAuth").addClass("disabled")):oe.find(".section.githubAuthSettings #addGithubAuth").removeClass("hidden")}function tL(){if(!A())oe.find(".section.discordIntegration").addClass("hidden");else{if(!S())return;oe.find(".section.discordIntegration").removeClass("hidden"),S()?.discordId===void 0?(oe.find(".section.discordIntegration .buttons").removeClass("hidden"),oe.find(".section.discordIntegration .info").addClass("hidden")):(oe.find(".section.discordIntegration .buttons").addClass("hidden"),oe.find(".section.discordIntegration .info").removeClass("hidden"))}}function e1(){jn(oe.find(".tab.active")[0],oe.find(`.tab[data-tab="${Xo.tab}"]`)[0],250,async()=>{},async()=>{oe.find(".tab").removeClass("active"),oe.find(`.tab[data-tab="${Xo.tab}"]`).addClass("active")}),oe.find("button").removeClass("active"),oe.find(`button[data-tab="${Xo.tab}"]`).addClass("active")}function aL(){oe.find(".section.optOutOfLeaderboards .optedOut").addClass("hidden"),oe.find(".section.optOutOfLeaderboards .buttons").removeClass("hidden"),oe.find(".section.setStreakHourOffset .info").addClass("hidden"),oe.find(".section.setStreakHourOffset .buttons").removeClass("hidden");const e=S();if(e?.lbOptOut===!0&&(oe.find(".section.optOutOfLeaderboards .optedOut").removeClass("hidden"),oe.find(".section.optOutOfLeaderboards .buttons").addClass("hidden")),e?.streakHourOffset!==void 0){oe.find(".section.setStreakHourOffset .info").removeClass("hidden");const t=e?.streakHourOffset>0?"+":"";oe.find(".section.setStreakHourOffset .info span").text(t+e?.streakHourOffset),oe.find(".section.setStreakHourOffset .buttons").addClass("hidden")}}function pi(){X()==="accountSettings"&&(eL(),tL(),aL(),Xw(pi),YT(),e1(),Xm.setUrlParams(Xo))}n(".page.pageAccountSettings").on("click",".tabs button",e=>{Xo.tab=n(e.target).data("tab"),e1(),Xm.setUrlParams(Xo)});n(".page.pageAccountSettings .section.discordIntegration .getLinkAndGoToOauth").on("click",()=>{Z(),T.users.getDiscordOAuth().then(e=>{e.status===200?window.open(e.body.data.url,"_self"):f("Failed to get OAuth from discord: "+e.body.message,-1)})});n(".page.pageAccountSettings #setStreakHourOffset").on("click",()=>{WT()});qa(e=>{e.type==="authConfigUpdated"&&pi()});const Xm=new qm({id:"accountSettings",display:"Account Settings",element:oe,path:"/account-settings",urlParamsSchema:ZT,afterHide:async()=>{yt("pageAccountSettings")},beforeShow:async e=>{e.urlParams?.tab!==void 0&&(Xo.tab=e.urlParams.tab),Ht("pageAccountSettings","main"),oe.find(`.tab[data-tab="${Xo.tab}"]`).addClass("active"),pi()}});n(()=>{Nt("pageAccountSettings")});function oL(){const e=document.querySelector('meta[property="og:url"]'),t=window.location.href;if(e)e.setAttribute("content",t);else{const a=document.createElement("meta");a.setAttribute("property","og:url"),a.content=t,document.head.appendChild(a)}}function iL(e){if(e.id==="test")Lg();else{const t=e.display??ln(e.id);Lg(`${t} | Monkeytype`)}}async function nL({loadingOptions:e,totalDuration:t}){Ci.element.removeClass("hidden").css("opacity",0),await Ci.beforeShow({});const a=e.length,o=100/a;Rt(Ci.element[0],{opacity:"1",duration:t/2});for(let i=0;i<e.length;i++){const s=o*i,l=e[i];l.style==="bar"?(await nT(),i===0&&(await Df(0,0),Kc(""))):oT(),l.style==="bar"?(await sL(l,a,s),Df(100,125),Kc("Done")):await l.loadingPromise()}await Rt(Ci.element[0],{opacity:"0",duration:t/2}),await Ci.afterHide(),Ci.element.addClass("hidden")}let Wo=null;async function sL(e,t,a){let o=e.loadingPromise();const i=new AbortController;Wo=i;const s=(async()=>{for(const l of e.keyframes){if(i.signal.aborted)break;l.text!==void 0&&Kc(l.text),await Df(a+l.percentage/t,l.durationMs)}})();await Promise.race([s,(async()=>{await o,i.abort()})()]),await o,Wo===i&&(Wo=null)}async function ta(e,t={}){if(t={...{force:!1},...t},zi()&&!t.force)return console.debug(`change page to ${e} stopped, page transition is true`),!1;if(!t.force&&X()===e)return console.debug(`change page ${e} stoped, page already active`),!1;console.log(`changing page ${e}`);const o={loading:Ci,test:j7,settings:ww,about:Z7,account:V7,login:aT,profile:yT,profileSearch:vT,friends:gT,404:wT,accountSettings:Xm,leaderboards:jw},i=o[X()],s=o[e],l=G(250);eu(!0),n(".page").removeClass("active"),await i?.beforeHide?.(),i.element.removeClass("hidden").css("opacity",1),await Rt(i.element[0],{opacity:"0",duration:l/2}),i.element.addClass("hidden"),await i?.afterHide();const c=s.loadingOptions?.loadingMode();try{let d=[];t.loadingOptions?.loadingMode()==="sync"&&d.push(t.loadingOptions),s.loadingOptions?.loadingMode()==="sync"&&d.push(s.loadingOptions),d.length>0&&await nL({loadingOptions:d,totalDuration:l}),Wo&&(Wo=null)}catch(d){return Wo&&(Wo.abort(),Wo=null),o.loading.element.addClass("active"),sh(o.loading.id),_a(!1),iT(),Kc(`Failed to load the ${s.id} page: ${d instanceof Error?d.message:String(d)}`),eu(!1),!1}return iL(s),sh(s.id),oL(),_a(!1),await s?.beforeShow({params:t.params,data:t.data}),typeof c=="object"&&c.mode==="async"&&(c.beforeLoading(),s?.loadingOptions?.loadingPromise().then(()=>{c.afterLoading()})),s.element.removeClass("hidden").css("opacity",0),await Rt(s.element[0],{opacity:"1",duration:l/2}),s.element.addClass("active"),await s?.afterShow(),eu(!1),k8(),!0}function rL(e){return new RegExp("^"+e.replace(/\//g,"\\/").replace(/:\w+/g,"(.+)")+"$")}function lL(e){const t=e.result.slice(1),o=Array.from(e.route.path.matchAll(/:(\w+)/g)).map(i=>i[1]).map((i,s)=>[i,t[s]]);return Object.fromEntries(o)}const cL={path:"404",load:async(e,t)=>{await ta("404",t)}},dL=[{path:"/",load:async(e,t)=>{await ta("test",t)}},{path:"/verify",load:async(e,t)=>{await ta("test",t)}},{path:"/leaderboards",load:async(e,t)=>{await ta("leaderboards",t)}},{path:"/about",load:async(e,t)=>{await ta("about",t)}},{path:"/settings",load:async(e,t)=>{await ta("settings",t)}},{path:"/login",load:async(e,t)=>{if(!na()){await Ie("/",t);return}if(A()){await Ie("/account",t);return}await ta("login",t)}},{path:"/account",load:async(e,t)=>{if(!na()){await Ie("/",t);return}if(!A()){await Ie("/login",t);return}await ta("account",t)}},{path:"/account-settings",load:async(e,t)=>{if(!na()){await Ie("/",t);return}if(!A()){await Ie("/login",t);return}await ta("accountSettings",t)}},{path:"/profile",load:async(e,t)=>{await ta("profileSearch",t)}},{path:"/profile/:uidOrName",load:async(e,t)=>{await ta("profile",{...t,force:!0,params:{uidOrName:e.uidOrName},data:t.data})}},{path:"/friends",load:async(e,t)=>{if(!na()){await Ie("/",t);return}if(!A()){await Ie("/login",t);return}await ta("friends",t)}}];async function Ie(e=window.location.pathname+window.location.search+window.location.hash,t={}){if(!t.force&&(zt||Vi||zi())){console.debug(`navigate: ${e} ignored, page is busy (testRestarting: ${zt}, resultCalculating: ${Vi}, pageTransition: ${zi()})`);return}const a=T0("no_quit");if(we&&a){f("No quit funbox is active. Please finish the test.",0,{important:!0});return}e=e.replace(/\/$/,""),e===""&&(e="/");const o=new URL(window.location.href),i=new URL(e,window.location.origin);o.pathname+o.search+o.hash!==i.pathname+i.search+i.hash&&history.pushState(null,"",e),await t1(t)}async function t1(e={}){const a=dL.map(o=>({route:o,result:location.pathname.match(rL(o.path))})).find(o=>o.result!==null);if(a===void 0){await cL.load({},{force:!0});return}await a.route.load(lL(a),e)}window.addEventListener("popstate",()=>{t1()});document.addEventListener("DOMContentLoaded",()=>{document.body.addEventListener("click",e=>{const t=e?.target;t.matches("[router-link]")&&t?.href&&(e.preventDefault(),Ie(t.href))})});const uL=[{id:"viewTypingPage",display:"View Typing Page",alias:"navigate go to start begin type test",icon:"fa-keyboard",exec:()=>{Ie("/")}},{id:"viewLeaderboards",display:"View Leaderboards",alias:"navigate go to",icon:"fa-crown",exec:()=>{Ie("/leaderboards")}},{id:"viewAbout",display:"View About Page",alias:"navigate go to",icon:"fa-info",exec:()=>{Ie("/about")}},{id:"viewSettings",display:"View Settings Page",alias:"navigate go to",icon:"fa-cog",exec:()=>{Ie("/settings")}},{id:"viewAccount",display:"View Account Page",alias:"navigate go to stats",icon:"fa-user",exec:()=>{A()?Ie("/account"):Ie("/login")}},{id:"toggleFullscreen",display:"Toggle Fullscreen",icon:"fa-expand",exec:()=>{ck()}}],Uo={missed:"words",slow:!1},Cn="#practiseWordsModal .modal";function vu(){n(`${Cn} .group[data-id="missed"] button`).removeClass("active"),n(`${Cn} .group[data-id="missed"] button[value="${Uo.missed}"]`).addClass("active"),n(`${Cn} .group[data-id="slow"] button`).removeClass("active"),n(`${Cn} .group[data-id="slow"] button[value="${Uo.slow}"]`).addClass("active"),Uo.missed==="off"&&!Uo.slow?n(`${Cn} .start`).prop("disabled",!0):n(`${Cn} .start`).prop("disabled",!1)}async function fL(e){for(const t of e.querySelectorAll(".group[data-id='missed'] button"))t.addEventListener("click",a=>{Uo.missed=a.target.value,vu()});for(const t of e.querySelectorAll(".group[data-id='slow'] button"))t.addEventListener("click",a=>{Uo.slow=a.target.value==="true",vu()});e.querySelector(".start")?.addEventListener("click",()=>{eb()}),e.addEventListener("submit",t=>{t.preventDefault(),eb()}),vu()}function a1(e){o1.show(e)}function pL(e=!1){o1.hide({clearModalChain:e})}function eb(){lf(Uo.missed,Uo.slow),pL(!0),R({practiseMissed:!0})}const o1=new re({dialogId:"practiseWordsModal",setup:fL});let i1=!1,Hf=!1;function tb(){N(),n("#ad-result-wrapper").removeClass("hidden"),n("#ad-result-small-wrapper").removeClass("hidden"),n("#testConfig").removeClass("hidden"),n(".pageTest .screenshotSpacer").remove(),n("#notificationCenter").removeClass("hidden"),n("#commandLineMobileButton").removeClass("hidden"),n(".pageTest .ssWatermark").addClass("hidden"),n(".pageTest .ssWatermark").text("monkeytype.com"),n(".pageTest .buttons").removeClass("hidden"),n("noscript").removeClass("hidden"),n("#nocss").removeClass("hidden"),n("header, footer").removeClass("invisible"),n("#result").removeClass("noBalloons"),n(".wordInputHighlight").removeClass("hidden"),n(".highlightContainer").removeClass("hidden"),Hf&&n("#cookiesModal").removeClass("hidden"),i1&&n("#resultReplay").removeClass("hidden"),A()||n(".pageTest .loginTip").removeClass("hidden"),document.querySelector("html").style.scrollBehavior="smooth";for(const e of ft("applyGlobalCSS"))e.functions.applyGlobalCSS()}let ab=!1;async function n1(){const{domToCanvas:e}=await Nr(async()=>{const{domToCanvas:g}=await import("./vendor.DVxhWSpD.js").then(m=>m.af);return{domToCanvas:g}},__vite__mapDeps([2,3,1]));Z(!0),n("#resultReplay").hasClass("hidden")||(i1=!0,sl()),(dk("#cookiesModal")||document.contains(document.querySelector("#cookiesModal")))&&(Hf=!0);const t=new Date(Date.now());n("#resultReplay").addClass("hidden"),n(".pageTest .ssWatermark").removeClass("hidden");const a=S(),o=[J(t,"dd MMM yyyy HH:mm"),"monkeytype.com"];if(a?.name!==void 0){const g=`${a?.name}${Ss(a,{iconsOnly:!0})}`;o.unshift(g)}n(".pageTest .ssWatermark").html(o.map(g=>`<span>${g}</span>`).join("<span class='pipe'>|</span>")),n(".pageTest .buttons").addClass("hidden"),n("#notificationCenter").addClass("hidden"),n("#commandLineMobileButton").addClass("hidden"),n(".pageTest .loginTip").addClass("hidden"),n("noscript").addClass("hidden"),n("#nocss").addClass("hidden"),n("#ad-result-wrapper").addClass("hidden"),n("#ad-result-small-wrapper").addClass("hidden"),n("#testConfig").addClass("hidden"),n(".pageTest .screenshotSpacer").remove(),n(".page.pageTest").prepend("<div class='screenshotSpacer'></div>"),n("header, footer").addClass("invisible"),n("#result").addClass("noBalloons"),n(".wordInputHighlight").addClass("hidden"),n(".highlightContainer").addClass("hidden"),Hf&&n("#cookiesModal").addClass("hidden");for(const g of ft("clearGlobal"))g.functions.clearGlobal();document.querySelector("html").style.scrollBehavior="auto",window.scrollTo({top:0,behavior:"auto"});const i=n("#result .wrapper");if(!i.length)return console.error("Result wrapper not found for screenshot"),f("Screenshot target element not found",-1),tb(),null;await ke(50);const s=i.offset()?.left??0,l=i.offset()?.top??0,c=i.outerWidth(!0),d=i.outerHeight(!0),u=pr(2),p=pr(2);try{const g=document.documentElement,{scrollWidth:m,clientWidth:h,scrollHeight:y,clientHeight:C}=g,M=Math.max(m,h),w=Math.max(y,C),F=await e(g,{backgroundColor:await jt("bg"),scale:window.devicePixelRatio??1,style:{width:`${M}px`,height:`${w}px`,overflow:"hidden"},fetch:{requestInit:{mode:"cors",credentials:"omit"},bypassingCache:!0},filter:vt=>{if(!(vt instanceof HTMLElement))return!0;const Pa=getComputedStyle(vt);return!(vt.classList.contains("hidden")||Pa.display==="none")},onCloneEachNode:vt=>{if(vt instanceof HTMLElement){const Pa=vt;if(Pa.classList.contains("customBackground")){Pa.style.zIndex="0",Pa.style.width=`${M}px`,Pa.style.height=`${w}px`;const Eo=Pa.querySelector("img");Eo&&(window.innerWidth<=720?(Eo.style.transform="translateY(20vh)",Eo.style.height="100%"):(Eo.style.width="100%",Eo.style.height="100%"))}}}}),I=F.width/M,P=c+u*2,U=d+p*2,K=Math.round(P*I),ne=Math.round(U*I),_e=Math.ceil(P*I),He=Math.ceil(U*I),Pe=document.createElement("canvas");Pe.width=K,Pe.height=ne;const Oe=Pe.getContext("2d");if(!Oe)return f("Failed to get canvas context for screenshot",-1),null;Oe.imageSmoothingEnabled=!0,Oe.imageSmoothingQuality="high";const ee=Math.max(0,Math.floor((s-u)*I)),Le=Math.max(0,Math.floor((l-p)*I)),At=Math.min(_e,F.width-ee),ot=Math.min(He,F.height-Le);return Oe.drawImage(F,ee,Le,At,ot,0,0,Pe.width,Pe.height),Pe}catch(g){return f(ie(g,"Error creating screenshot canvas"),-1),null}finally{tb()}}async function s1(){const e=await n1();e&&e.toBlob(async t=>{if(!t){f("Failed to generate image data (blob is null)",-1);return}try{const a=new ClipboardItem(Object.defineProperty({},t.type,{value:t,enumerable:!0}));await navigator.clipboard.write([a]),f("Copied screenshot to clipboard",1,{duration:2})}catch(a){console.error("Error saving image to clipboard",a),navigator.userAgent.toLowerCase().includes("firefox")&&!ab&&(ab=!0,f("On Firefox you can enable the asyncClipboard.clipboardItem permission in about:config to enable copying straight to the clipboard",0,{duration:10})),f("Could not copy screenshot to clipboard. Opening in new tab instead (make sure popups are allowed)",0,{duration:5});try{const o=URL.createObjectURL(t);window.open(o)}catch(o){f("Failed to open screenshot in new tab",-1),console.error("Error opening blob URL:",o)}}})}async function mL(){const e=await n1();return e?new Promise(t=>{e.toBlob(a=>{a?t(a):(f("Failed to convert canvas to Blob for download",-1),t(null))},"image/png")}):null}async function r1(){try{const e=await mL();if(!e){f("Failed to generate screenshot data",-1);return}const t=URL.createObjectURL(e),a=document.createElement("a");a.href=t;const o=new Date().toISOString().replace(/[:.]/g,"-");a.download=`monkeytype-result-${o}.png`,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(t),f("Screenshot download started",1)}catch(e){console.error("Error downloading screenshot:",e),f("Failed to download screenshot",-1)}}n(".pageTest").on("click","#saveScreenshotButton",e=>{e.shiftKey?r1():s1(),n("#saveScreenshotButton i").removeClass("fas fa-download").addClass("far fa-image")});n(document).on("keydown",e=>{ce&&X()==="test"&&e.key==="Shift"&&n("#result #saveScreenshotButton i").removeClass("far fa-image").addClass("fas fa-download")});n(document).on("keyup",e=>{ce&&X()==="test"&&e.key==="Shift"&&n("#result #saveScreenshotButton i").removeClass("fas fa-download").addClass("far fa-image")});const gL={title:"Practice words...",list:[{id:"practiseWordsMissed",display:"missed",exec:()=>{lf("words",!1),R({practiseMissed:!0})}},{id:"practiseWordsSlow",display:"slow",exec:()=>{lf("off",!0),R({practiseMissed:!0})}},{id:"practiseWordsCustom",display:"custom...",opensModal:!0,exec:e=>{a1({animationMode:"modalOnly",modalChain:e.commandlineModal})}}]},hL=[{id:"nextTest",display:"Next test",alias:"restart start begin type test typing",icon:"fa-chevron-right",available:()=>ce,exec:()=>{R()}},{id:"repeatTest",display:"Repeat test",icon:"fa-sync-alt",exec:()=>{R({withSameWordset:!0})},available:()=>ce},{id:"practiseWords",display:"Practice words...",icon:"fa-exclamation-triangle",subgroup:gL,available:()=>ce},{id:"toggleWordHistory",display:"Toggle word history",icon:"fa-align-left",exec:()=>{tm()},available:()=>ce},{id:"copyScreenshot",display:"Copy screenshot to clipboard",icon:"fa-copy",alias:"copy image clipboard",exec:()=>{setTimeout(()=>{s1()},500)},available:()=>ce},{id:"downloadScreenshot",display:"Download screenshot",icon:"fa-download",alias:"save image download file",exec:()=>{setTimeout(async()=>{r1()},500)},available:()=>ce},{id:"copyWordsToClipboard",display:"Copy words to clipboard",icon:"fa-copy",exec:()=>{const e=(r.mode==="zen"?k.getHistory():_.list.slice(0,k.getHistory().length)).join(" ");navigator.clipboard.writeText(e).then(()=>{f("Copied to clipboard",1)},()=>{f("Failed to copy!",-1)})},available:()=>ce}];let Of=!1;function l1(e){document.documentElement.style.setProperty("--font",'"'+e.replaceAll(/_/g," ")+'", "Roboto Mono", "Vazirmatn"'),$d(),Of=!0}function Nf(){Of&&(l1(r.fontFamily),Of=!1)}function bL(){const e=window.navigator.userAgent.toLowerCase(),t=e.includes("mac")&&!e.includes("firefox")?"cmd":"ctrl",a=r.quickRestart==="esc"?"tab":"esc";n("footer .keyTips").html(`
    ${r.quickRestart==="off"?"<key>tab</key> + <key>enter</key>":`<key>${r.quickRestart}</key>`} - restart test<br>
    <key>${a}</key> or <key>${t}</key>+<key>shift</key>+<key>p</key> - command line`)}window.addEventListener("beforeunload",e=>{Dd(r.mode,r.words,r.time,Co(),Xa()??!1)||we&&(e.preventDefault(),e.returnValue="")});const yL=Mt(250,()=>{X()==="test"&&!ce&&(r.tapeMode!=="off"?Ad():(F0(),$d()),setTimeout(()=>{Zp(),Ki(),Zy()},250))}),vL=Ub(250,()=>{Yr()});n(window).on("resize",()=>{vL(),yL()});ge(async e=>{e==="quickRestart"&&bL(),e==="showKeyTips"&&(r.showKeyTips?n("footer .keyTips").removeClass("hidden"):n("footer .keyTips").addClass("hidden")),e==="fontFamily"&&await Tr()});const wL={punctuation:{subgroup:{options:"fromSchema",afterExec:()=>{R()}}},numbers:{subgroup:{options:"fromSchema",afterExec:()=>{R()}}},words:{alias:"words",subgroup:{options:[10,25,50,100],afterExec:()=>{te(),R()}},input:{inputValueConvert:Number,afterExec:()=>{te(),R()}}},time:{subgroup:{options:[15,30,60,120],afterExec:()=>{te(),R()}},input:{inputValueConvert:Number,afterExec:()=>{te(),R()}}},mode:{subgroup:{options:"fromSchema",afterExec:()=>{te(),R()}}},quoteLength:{alias:"quotes",subgroup:{options:[[0,1,2,3],[0],[1],[2],[3],[-3]],configValueMode:()=>"include",isAvailable:e=>{if(e[0]===-3)return A},display:e=>ri(e,[0,1,2,3])?"all":{0:"short",1:"medium",2:"long",3:"thicc","-3":"favorite"}[e[0]],afterExec:()=>{R()}}},language:{subgroup:{options:"fromSchema",display:e=>Aa(e)}},difficulty:{subgroup:{options:"fromSchema"}},quickRestart:{subgroup:{options:"fromSchema"}},repeatQuotes:{subgroup:{options:"fromSchema"}},blindMode:{subgroup:{options:"fromSchema"}},alwaysShowWordsHistory:{subgroup:{options:"fromSchema"}},singleListCommandLine:{subgroup:{options:"fromSchema"}},minWpm:{display:"Minimum speed...",alias:"wpm",subgroup:{options:["off"]},input:{configValue:"custom",display:"custom...",secondKey:"minWpmCustomSpeed",inputValueConvert:e=>{let t=Number(e);return t=dt(r.typingSpeedUnit).toWpm(t),t}}},minAcc:{display:"Minimum accuracy...",subgroup:{options:["off"]},input:{configValue:"custom",display:"custom...",secondKey:"minAccCustom",inputValueConvert:e=>Number(e)}},britishEnglish:{subgroup:{options:"fromSchema",afterExec:()=>{R()}}},customLayoutfluid:{input:{defaultValue:()=>r.customLayoutfluid.join(" "),inputValueConvert:e=>e.trim().split(" ")}},customPolyglot:{input:{defaultValue:()=>r.customPolyglot.join(" "),inputValueConvert:e=>e.trim().split(" "),afterExec:()=>{X()==="test"&&R()}}},freedomMode:{subgroup:{options:"fromSchema"}},strictSpace:{subgroup:{options:"fromSchema"}},oppositeShiftMode:{subgroup:{options:"fromSchema",afterExec:()=>{Ot()}}},stopOnError:{subgroup:{options:"fromSchema"}},confidenceMode:{subgroup:{options:"fromSchema"}},quickEnd:{subgroup:{options:"fromSchema"}},indicateTypos:{subgroup:{options:"fromSchema"}},hideExtraLetters:{subgroup:{options:"fromSchema"}},lazyMode:{subgroup:{options:"fromSchema",afterExec:()=>R()}},layout:{subgroup:{options:"fromSchema",display:e=>e==="default"?"off":e.replace(/_/g," "),afterExec:()=>R()}},codeUnindentOnBackspace:{subgroup:{options:"fromSchema"}},soundVolume:{subgroup:{options:[.1,.5,1],display:e=>new Map([[.1,"quiet"],[.5,"medium"],[1,"loud"]]).get(e)??"custom...",afterExec:()=>Ea},input:{inputValueConvert:Number}},playSoundOnClick:{alias:"play",display:"Sound on click...",subgroup:{options:"fromSchema",display:e=>({off:"off",1:"click",2:"beep",3:"pop",4:"nk creams",5:"typewriter",6:"osu",7:"hitmarker",8:"sine",9:"sawtooth",10:"square",11:"triangle",12:"pentatonic",13:"wholetone",14:"fist fight",15:"rubber keys"})[e],hover:e=>{e!=="off"&&L6(e)},afterExec:()=>{Ea()}}},playSoundOnError:{alias:"play",display:"Sound on error...",subgroup:{options:"fromSchema",display:e=>({off:"off",1:"damage",2:"triangle",3:"square",4:"punch miss"})[e],hover:e=>{e!=="off"&&$6(e)},afterExec:()=>{il()}}},playTimeWarning:{alias:"sound",subgroup:{options:"fromSchema",display:e=>e==="off"?"off":`${e} second${e!=="1"?"s":""}`,afterExec:e=>{e!=="off"&&Rc()},hover:e=>{e!=="off"&&Rc()}}},smoothCaret:{subgroup:{options:"fromSchema"}},caretStyle:{subgroup:{options:"fromSchema",isVisible:e=>!["banana","carrot","monkey"].includes(e)}},paceCaret:{display:"Pace caret mode...",subgroup:{options:["off","pb","tagPb","last","average","daily"],afterExec:()=>{R()}},input:{secondKey:"paceCaretCustomSpeed",configValue:"custom",inputValueConvert:e=>{let t=Number(e);return t=dt(r.typingSpeedUnit).toWpm(t),t},afterExec:()=>{R()}}},repeatedPace:{subgroup:{options:"fromSchema"}},paceCaretStyle:{subgroup:{options:"fromSchema",isVisible:e=>!["banana","carrot","monkey"].includes(e)}},liveSpeedStyle:{subgroup:{options:"fromSchema"},alias:"wpm"},liveAccStyle:{subgroup:{options:"fromSchema"},alias:"wpm"},liveBurstStyle:{subgroup:{options:"fromSchema"},alias:"wpm"},timerStyle:{display:"Live progress style...",subgroup:{options:"fromSchema"},alias:"timer"},timerColor:{display:"Live progress color...",alias:"timer speed wpm burst acc",subgroup:{options:"fromSchema",alias:()=>"timer"}},timerOpacity:{display:"Live progress opacity...",alias:"timer speed wpm burst acc",subgroup:{options:"fromSchema",alias:()=>"timer"}},highlightMode:{subgroup:{options:"fromSchema"}},tapeMode:{subgroup:{options:"fromSchema"}},tapeMargin:{input:{inputValueConvert:Number}},smoothLineScroll:{subgroup:{options:"fromSchema"}},showAllLines:{subgroup:{options:"fromSchema"}},typingSpeedUnit:{subgroup:{options:"fromSchema",isVisible:e=>e!=="wph"}},alwaysShowDecimalPlaces:{subgroup:{options:"fromSchema"}},startGraphsAtZero:{subgroup:{options:"fromSchema"}},maxLineWidth:{input:{alias:"page",inputValueConvert:Number}},fontSize:{input:{inputValueConvert:Number}},fontFamily:{subgroup:{options:et(lo).sort((e,t)=>(lo[e]?.display??e.replace(/_/g," ")).localeCompare(lo[t]?.display??t.replace(/_/g," "))),display:e=>lo[e]?.display??e.replaceAll(/_/g," "),customData:e=>{const t=lo[e];return t===void 0?{}:{name:e.replaceAll(/_/g," "),isSystem:t.systemFont===!0,display:t.display}},hover:e=>l1(e)}},keymapMode:{alias:"keyboard",subgroup:{options:"fromSchema",alias:e=>e==="react"?"flash":""}},keymapStyle:{subgroup:{options:"fromSchema"},alias:"keyboard"},keymapLegendStyle:{subgroup:{options:"fromSchema"},alias:"keyboard"},keymapSize:{input:{alias:"keyboard",inputValueConvert:Number}},keymapLayout:{alias:"keyboard",subgroup:{options:"fromSchema",alias:e=>e==="overrideSync"?"default":"",display:e=>e==="overrideSync"?"emulator sync":e.replace(/_/g," "),afterExec:()=>R()}},keymapShowTopRow:{subgroup:{options:"fromSchema"},alias:"keyboard"},customTheme:{subgroup:{options:"fromSchema"}},flipTestColors:{subgroup:{options:"fromSchema"}},colorfulMode:{subgroup:{options:"fromSchema"}},customBackground:{input:{}},customBackgroundSize:{subgroup:{options:"fromSchema"}},randomTheme:{subgroup:{options:"fromSchema",isAvailable:e=>e==="custom"?A:void 0}},showKeyTips:{subgroup:{options:"fromSchema"},display:"Key tips..."},showOutOfFocusWarning:{subgroup:{options:"fromSchema"},display:"Out of focus warning..."},capsLockWarning:{subgroup:{options:"fromSchema"}},showAverage:{subgroup:{options:"fromSchema"}},monkeyPowerLevel:{alias:"powermode",isVisible:!1,subgroup:{options:"fromSchema",display:e=>({off:"off",1:"mellow",2:"high",3:"ultra",4:"over 9000"})[e]}},monkey:{subgroup:{options:"fromSchema"}},ads:{subgroup:{options:"fromSchema"}}};function Uf(e){if(e instanceof q.ZodLiteral)return[e.value];if(e instanceof q.ZodEnum)return e.options;if(e instanceof q.ZodBoolean)return[!0,!1];if(e instanceof q.ZodUnion)return e.options.flatMap(Uf).filter(t=>t!==void 0)}function Ee(e){const t=Py[e],a=wL[e],o=Hr.shape[e];return CL(e,t,a,o)}function CL(e,t,a,o){if(a==null)throw new Error(`No commandline metadata found for config key "${e}".`);let i;if("subgroup"in a&&a.subgroup!==void 0&&(i=kL(e,a.display,a.alias,a.subgroup,t,o)),"input"in a&&a.input!==void 0){const s=a.input,l=xL({key:"secondKey"in s?s.secondKey:e,isPartOfSubgruop:"subgroup"in a,inputProps:s,configMeta:t,schema:"secondKey"in s?Hr.shape[s.secondKey]:o});if(i===void 0)return l;i.subgroup?.list.push(l)}if(i===void 0)throw new Error(`Nothing returned for config key "${e}". This is a bug in the commandline metadata.`);return i}function kL(e,t,a,o,i,s){if(o===null)throw new Error(`No commandline metadata found for config key "${e}".`);const l=t??`${$t(i?.displayString??e)}...`;let c=o.options??Uf(s);if(c==="fromSchema"&&(c=Uf(s)),c===void 0)throw new Error(`Unsupported schema type for key "${e}": ${s._def.typeName}`);const d=c.map(u=>SL(e,u,o));return d.sort((u,p)=>u.configValue==="off"||u.configValue===!1?-1:p.configValue==="off"||p.configValue===!1?1:0),{id:`change${$t(e)}`,display:l,icon:i?.icon??"fa-cog",subgroup:{title:l,configKey:e,list:d},alias:a}}function SL(e,t,{afterExec:a,hover:o,display:i,alias:s,configValueMode:l,isVisible:c,isAvailable:d,customData:u}){const p=t;let g=i?.(t);return g===void 0&&(t===!0?g="on":t===!1?g="off":g=t.toString()),{id:`set${$t(e)}${$t(p.toString())}`,display:g,configValueMode:l?.(t),alias:s?.(t)??void 0,configValue:p,visible:c?.(t)??void 0,available:d?.(t)??void 0,exec:()=>{$(e,p),a?.(p)},hover:o!==void 0?()=>{o?.(p)}:void 0,customData:u?.(p)??void 0}}function xL({key:e,isPartOfSubgruop:t,inputProps:a,configMeta:o,schema:i}){const s=a?.validation??{schema:!0},l=a?.display??(t?"custom...":`${$t(o.displayString??e)}...`),c={id:`set${$t(e)}Custom`,defaultValue:a?.defaultValue??(()=>r[e]?.toString()??""),configValue:a!==void 0&&"configValue"in a?a.configValue??void 0:void 0,display:l,alias:a?.alias??void 0,input:!0,icon:o.icon??"fa-cog",exec:({input:d})=>{d!==void 0&&($(e,d),a?.afterExec?.(d))},hover:a?.hover};return a?.inputValueConvert!==void 0&&(c.inputValueConvert=a.inputValueConvert),c.validation={schema:s.schema===!0?i:void 0,isValid:s.isValid},c}const TL=Ee("customBackground"),LL={id:"customBackground",display:"Custom background...",icon:"fa-image",subgroup:{title:"Custom background...",list:[TL,{id:"customLocalBackground",display:"Local background...",icon:"fa-file-import fa-fw",alias:"upload background",available:async()=>!await Je.hasFile("LocalBackgroundFile"),exec:async()=>{const e=document.createElement("input");e.type="file",e.accept="image/*",e.style.display="none",document.body.appendChild(e);const t=()=>{document.body.removeChild(e)};e.onchange=async a=>{const o=a.target.files?.[0];if(!o){t();return}if(!o.type.match(/image\/(jpeg|jpg|png|gif|webp)/)){f("Unsupported image format",0),t();return}const i=new FileReader;i.onload=async s=>{const l=s.target?.result;try{await Je.storeFile("LocalBackgroundFile",l),await fs(),await Er()}catch(c){f("Error uploading background: "+c.message,0)}t()},i.onerror=t,i.readAsDataURL(o)},e.click()}},{id:"removeLocalBackground",display:"Remove local background",icon:"fa-trash",alias:"remove background",available:async()=>await Je.hasFile("LocalBackgroundFile"),exec:async()=>{try{await Je.deleteFile("LocalBackgroundFile"),await fs(),await Er()}catch(e){f("Error removing background: "+e.message,0)}}}]}},$L=[LL],Vf=Ee("fontFamily");Vf.subgroup&&Vf.subgroup.list.push({id:"customFont",display:"Custom font...",icon:"fa-font",alias:"custom font options",subgroup:{title:"Custom font...",list:[{id:"customFontName",display:"Custom name...",icon:"fa-font",alias:"custom font name",input:!0,defaultValue:()=>r.fontFamily.replace(/_/g," "),exec:({input:e})=>{if(e===void 0||e==="")return;const t=e.replaceAll(/ /g,"_");Ry(t)}},{id:"customLocalFont",display:"Local font...",icon:"fa-file-import fa-fw",alias:"upload font",available:async()=>!await Je.hasFile("LocalFontFamilyFile"),exec:async()=>{const e=document.createElement("input");e.type="file",e.accept="font/woff,font/woff2,font/ttf,font/otf",e.style.display="none",document.body.appendChild(e);const t=()=>{document.body.removeChild(e)};e.onchange=async a=>{const o=a.target.files?.[0];if(!o){t();return}if(!o.type.match(/font\/(woff|woff2|ttf|otf)/)&&!o.name.match(/\.(woff|woff2|ttf|otf)$/i)){f("Unsupported font format, must be woff, woff2, ttf or otf.",0),t();return}const i=new FileReader;i.onload=async s=>{const l=s.target?.result;try{await Je.storeFile("LocalFontFamilyFile",l),await Tr(),await qr()}catch(c){f("Error uploading font: "+c.message,0)}t()},i.onerror=t,i.readAsDataURL(o)},e.click()}},{id:"removeLocalFont",display:"Remove local font",icon:"fa-trash",alias:"remove font",available:async()=>await Je.hasFile("LocalFontFamilyFile"),exec:async()=>{try{await Je.deleteFile("LocalFontFamilyFile"),await qr(),await Tr()}catch(e){f("Error removing font: "+e.message,0)}}}]}});const ML=[Vf],AL={title:"Custom background filter...",configKey:"customBackgroundFilter",list:[{id:"setCustomBackgroundBlur",display:"blur...",icon:"fa-image",input:!0,defaultValue:()=>r.customBackgroundFilter[0].toString(),exec:({input:e})=>{if(e===void 0||e==="")return;const t=r.customBackgroundFilter;t[0]=parseFloat(e),_n(t)}},{id:"setCustomBackgroundBrightness",display:"brightness...",icon:"fa-image",input:!0,defaultValue:()=>r.customBackgroundFilter[1].toString(),exec:({input:e})=>{if(e===void 0||e==="")return;const t=r.customBackgroundFilter;t[1]=parseFloat(e),_n(t)}},{id:"setCustomBackgroundSaturation",display:"saturation...",icon:"fa-image",input:!0,defaultValue:()=>r.customBackgroundFilter[2].toString(),exec:({input:e})=>{if(e===void 0||e==="")return;const t=r.customBackgroundFilter;t[2]=parseFloat(e),_n(t)}},{id:"setCustomBackgroundOpacity",display:"opacity...",icon:"fa-image",input:!0,defaultValue:()=>r.customBackgroundFilter[3].toString(),exec:({input:e})=>{if(e===void 0||e==="")return;const t=r.customBackgroundFilter;t[3]=parseFloat(e),_n(t)}}]},_L=[{id:"setCustomBackgroundFilter",display:"Custom background filter...",icon:"fa-image",subgroup:AL}],EL=[{id:"addThemeToFavorite",display:"Add current theme to favorite",icon:"fa-star",available:()=>!r.customTheme&&!r.favThemes.includes(ze??r.theme),exec:()=>{const{theme:e,favThemes:t,customTheme:a}=r,o=ze??e;!a&&!t.includes(o)&&yc([...t,o])}},{id:"removeThemeFromFavorite",display:"Remove current theme from favorite",icon:"fa-star",iconType:"regular",available:()=>!r.customTheme&&r.favThemes.includes(ze??r.theme),exec:()=>{const{theme:e,favThemes:t,customTheme:a}=r,o=ze??e;!a&&t.includes(o)&&yc([...t.filter(i=>i!==o)])}}],Kf=e=>e.replaceAll(" ","_"),ob=async e=>{const t=Tk.safeParse(Kf(e));return t.success?!0:t.error.errors.map(a=>a.message).join(", ")},qL={add:new de({id:"addTag",title:"Add new tag",inputs:[{placeholder:"tag name",type:"text",validation:{isValid:ob,debounceDelay:0}}],onlineOnly:!0,buttonText:"add",execFn:async(e,t)=>{const a=Kf(t),o=await T.users.createTag({body:{tagName:a}});return o.status!==200?{status:-1,message:"Failed to add tag: "+o.body.message.replace(a,t)}:(S()?.tags?.push({display:t,name:o.body.data.name,_id:o.body.data._id,personalBests:{time:{},words:{},quote:{},zen:{},custom:{}}}),fo(),{status:1,message:"Tag added"})}}),edit:new de({id:"editTag",title:"Edit tag",inputs:[{placeholder:"tag name",type:"text",validation:{isValid:ob,debounceDelay:0}}],onlineOnly:!0,buttonText:"save",beforeInitFn:e=>{e.inputs[0].initVal=e.parameters[0]},execFn:async(e,t)=>{const a=Kf(t),o=e.parameters[1],i=await T.users.editTag({body:{tagId:o,newName:a}});return i.status!==200?{status:-1,message:"Failed to edit tag: "+i.body.message}:(S()?.tags?.forEach(s=>{s._id===o&&(s.name=a,s.display=t)}),fo(),{status:1,message:"Tag updated"})}}),remove:new de({id:"removeTag",title:"Delete tag",onlineOnly:!0,buttonText:"delete",beforeInitFn:e=>{e.text=`Are you sure you want to delete tag ${e.parameters[0]} ?`},execFn:async e=>{const t=e.parameters[1],a=await T.users.deleteTag({params:{tagId:t}});return a.status!==200?{status:-1,message:"Failed to remove tag: "+a.body.message}:(S()?.tags?.forEach((o,i)=>{o._id===t&&S()?.tags?.splice(i,1)}),fo(),{status:1,message:"Tag removed"})}}),clearPb:new de({id:"clearTagPb",title:"Clear personal bests",onlineOnly:!0,buttonText:"clear",beforeInitFn:e=>{e.text=`Are you sure you want to clear personal bests for tag ${e.parameters[0]} ?`},execFn:async e=>{const t=e.parameters[1],a=await T.users.deleteTagPersonalBest({params:{tagId:t}});return a.status!==200?{status:-1,message:"Failed to clear tag pb: "+a.body.message}:(fo(),{status:1,message:"Tag PB cleared"})}})};function Gs(e,t,a,o){const i={modalChain:o,focusFirstInput:"focusAndSelect"};e!=="add"&&(a===void 0||t===void 0)||qL[e].show([a??"",t??""],i)}const Qs={title:"Tags...",list:[],beforeList:()=>{IL()}},c1=[{id:"changeTags",display:"Tags...",icon:"fa-tag",subgroup:Qs,available:()=>A()}];function IL(){const e=S();if(Qs.list=[],e!==void 0&&e.tags!==void 0&&e.tags.length>0){Qs.list.push({id:"clearTags",display:"Clear tags",icon:"fa-times",sticky:!0,exec:async()=>{const t=S();t&&(t.tags=t.tags?.map(a=>(a.active=!1,a)),at(t),(r.paceCaret==="average"||r.paceCaret==="tagPb"||r.paceCaret==="daily")&&await Ac(),Ot(),qs())}});for(const t of e.tags)Qs.list.push({id:"toggleTag"+t._id,display:t.display,sticky:!0,active:()=>S()?.tags?.find(a=>a._id===t._id)?.active??!1,exec:async()=>{Em(t._id),(r.paceCaret==="average"||r.paceCaret==="tagPb"||r.paceCaret==="daily")&&await Ac(),Ot()}})}Qs.list.push({id:"createTag",display:"Create tag",icon:"fa-plus",shouldFocusTestUI:!1,opensModal:!0,exec:({commandlineModal:t})=>{Gs("add",void 0,void 0,t)}})}const jf={title:"Custom themes list...",beforeList:()=>PL(),list:[]},FL=[{id:"setCustomThemeId",display:"Custom themes...",icon:"fa-palette",subgroup:jf,available:()=>A()}];function PL(){if(!A())return;jf.list=[];const e=S();if(e&&e.customThemes!==void 0&&e.customThemes?.length!==0)for(const t of e.customThemes)jf.list.push({id:"setCustomThemeId"+t._id,display:t.name.replace(/_/gi," "),configValue:t._id,hover:()=>{gm("custom",t.colors)},exec:()=>{mo(!0),Xn(t.colors)}})}const pe={presetType:"full",checkboxes:new Map(sd.options.map(e=>[e,!0])),setPresetToCurrent:!1};let Fo=null;function sc(e,t,a){if(!Xe()){f("You are offline",0,{duration:2});return}u1.show({focusFirstInput:!0,beforeAnimation:async()=>{n("#editPresetModal .modal .text").addClass("hidden"),DL(),Fo||(Fo=Fa(document.querySelector("#editPresetModal .modal input"),{schema:Mk})),e==="add"?(n("#editPresetModal .modal").attr("data-action","add"),n("#editPresetModal .modal .popupTitle").html("Add new preset"),n("#editPresetModal .modal .submit").html("add"),Fo?.setValue(null),Fo?.parentElement?.classList.remove("hidden"),n("#editPresetModal .modal input").removeClass("hidden"),n("#editPresetModal .modal label.changePresetToCurrentCheckbox").addClass("hidden"),n("#editPresetModal .modal .inputs").removeClass("hidden"),n("#editPresetModal .modal .presetType").removeClass("hidden"),n("#editPresetModal .modal .presetNameTitle").removeClass("hidden"),pe.presetType="full"):e==="edit"&&t!==void 0&&a!==void 0?(n("#editPresetModal .modal").attr("data-action","edit"),n("#editPresetModal .modal").attr("data-preset-id",t),n("#editPresetModal .modal .popupTitle").html("Edit preset"),n("#editPresetModal .modal .submit").html("save"),Fo?.setValue(a),Fo?.parentElement?.classList.remove("hidden"),n("#editPresetModal .modal input").removeClass("hidden"),n("#editPresetModal .modal label.changePresetToCurrentCheckbox").removeClass("hidden"),n("#editPresetModal .modal .presetNameTitle").removeClass("hidden"),pe.setPresetToCurrent=!1,await d1()):e==="remove"&&t!==void 0&&a!==void 0&&(n("#editPresetModal .modal").attr("data-action","remove"),n("#editPresetModal .modal").attr("data-preset-id",t),n("#editPresetModal .modal .popupTitle").html("Delete preset"),n("#editPresetModal .modal .submit").html("delete"),n("#editPresetModal .modal input").addClass("hidden"),n("#editPresetModal .modal label.changePresetToCurrentCheckbox").addClass("hidden"),n("#editPresetModal .modal .text").removeClass("hidden"),n("#editPresetModal .modal .deletePrompt").text(`Are you sure you want to delete the preset ${a}?`),n("#editPresetModal .modal .inputs").addClass("hidden"),n("#editPresetModal .modal .presetType").addClass("hidden"),n("#editPresetModal .modal .presetNameTitle").addClass("hidden"),Fo?.parentElement?.classList.add("hidden")),Zm()}})}async function BL(e){for(const a of pe.checkboxes.keys())pe.checkboxes.set(a,!1);const t=await X9(e);if(t===void 0){f("Preset not found",-1);return}if(t.settingGroups===void 0||t.settingGroups===null){pe.presetType="full";for(const a of pe.checkboxes.keys())pe.checkboxes.set(a,!0)}else pe.presetType="partial",t.settingGroups.forEach(a=>pe.checkboxes.set(a,!0));pe.setPresetToCurrent=!1,Zm()}function RL(){sd.options.forEach(t=>{const a=n(`#editPresetModal .modal .checkboxList .checkboxTitlePair[data-id="${t}"] input`);a.on("change",o=>{pe.checkboxes.set(t,a.prop("checked"))})});const e=n("#editPresetModal .modal .changePresetToCurrentCheckbox input");e.on("change",async()=>{pe.setPresetToCurrent=e.prop("checked"),await d1()})}function DL(){function e(a){return a.replace(/([a-z])([A-Z])/g,"$1 $2")}const t=n("#editPresetModal .modal .inputs .checkboxList").empty();sd.options.forEach(a=>{const o=e(a),i=`<label class="checkboxTitlePair" data-id="${a}">
              <input type="checkbox" />
              <div class="title">${o}</div>
              </label>`;t.append(i)});for(const a of pe.checkboxes.keys())pe.checkboxes.set(a,!0);RL()}function Zm(){sd.options.forEach(e=>{n(`#editPresetModal .modal .checkboxList .checkboxTitlePair[data-id="${e}"] input`).prop("checked",pe.checkboxes.get(e))}),n("#editPresetModal .modal .presetType button").removeClass("active"),n(`#editPresetModal .modal .presetType button[value="${pe.presetType}"]`).addClass("active"),n("#editPresetModal .modal .partialPresetGroups").removeClass("hidden"),pe.presetType==="full"&&n("#editPresetModal .modal .partialPresetGroups").addClass("hidden")}async function d1(){if(n("#editPresetModal .modal label.changePresetToCurrentCheckbox input").prop("checked",pe.setPresetToCurrent),pe.setPresetToCurrent){const e=n("#editPresetModal .modal").attr("data-preset-id");await BL(e),n("#editPresetModal .modal .inputs").removeClass("hidden"),n("#editPresetModal .modal .presetType").removeClass("hidden")}else n("#editPresetModal .modal .inputs").addClass("hidden"),n("#editPresetModal .modal .presetType").addClass("hidden")}function WL(){u1.hide()}async function zL(){const e=n("#editPresetModal .modal").attr("data-action"),t=n("#editPresetModal .modal input").val(),a=t.replaceAll(" ","_"),o=n("#editPresetModal .modal").attr("data-preset-id"),i=n("#editPresetModal .modal label input").prop("checked"),s=S()?.presets??[];if(e===void 0)return;if(["add","edit"].includes(e)&&pe.presetType==="partial"&&Array.from(pe.checkboxes.values()).every(d=>!d)){f("At least one setting group must be active while saving partial presets",0);return}if(e==="add"||e==="edit"){if(a.replace(/^_+|_+$/g,"").length===0){f("Preset name cannot be empty",0);return}if(Fo?.getValidationResult().status==="failed"){f("Preset name is not valid",0);return}}if(WL(),Z(),e==="add"){const d=ib(),u=wu(),p=await T.presets.add({body:{name:a,config:d,...pe.presetType==="partial"&&{settingGroups:u}}});p.status!==200||p.body.data===null?f("Failed to add preset: "+p.body.message.replace(a,t),-1):(f("Preset added",1,{duration:2}),s.push({name:a,config:d,...pe.presetType==="partial"&&{settingGroups:u},display:t,_id:p.body.data.presetId}))}else if(e==="edit"){const d=s.find(m=>m._id===o);if(d===void 0){f("Preset not found",-1);return}const u=ib(),p=pe.presetType==="partial"?wu():null,g=await T.presets.save({body:{_id:o,name:a,...i&&{config:u,settingGroups:p}}});g.status!==200?f("Failed to edit preset: "+g.body.message,-1):(f("Preset updated",1),d.name=a,d.display=a.replace(/_/g," "),i&&(d.config=u,pe.presetType==="partial"?d.settingGroups=wu():d.settingGroups=null))}else if(e==="remove"){const d=await T.presets.delete({params:{presetId:o}});d.status!==200?f("Failed to remove preset: "+d.body.message,-1):(f("Preset removed",1),s.forEach((u,p)=>{u._id===o&&s.splice(p,1)}))}fo(),N()}function HL(e){return $k[e]}function OL(e){const t={},a=$a();return Object.keys(a).filter(o=>{const i=HL(o);return i===null?!1:pe.checkboxes.get(i)===!0}).forEach(o=>{const i=o,s=e[i]!==void 0?e[i]:a[i];t[i]=s}),t}function wu(){return Array.from(pe.checkboxes.entries()).filter(([,e])=>e).map(([e])=>e)}function ib(){const e=pe.presetType==="partial"?OL(Xg()):Xg(),a=(S()?.tags??[]).filter(i=>i.active).map(i=>i._id),o=pe.presetType==="full"||pe.checkboxes.get("behavior")===!0;return{...e,...o&&{tags:a}}}async function NL(e){e.addEventListener("submit",t=>{t.preventDefault(),zL()}),Lk.options.forEach(t=>{const a=e.querySelector(`.presetType button[value="${t}"]`);a!==null&&a.addEventListener("click",()=>{pe.presetType=t,Zm()})})}const u1=new re({dialogId:"editPresetModal",setup:NL}),rc={title:"Presets...",list:[],beforeList:()=>{VL()}},UL=[{visible:!1,id:"applyPreset",display:"Presets...",icon:"fa-sliders-h",subgroup:rc,available:()=>A()}];function VL(){const e=S();rc.list=[],!(!e?.presets||e.presets.length===0)&&(e.presets.forEach(t=>{const a=t.display;rc.list.push({id:"applyPreset"+t._id,display:a,exec:async()=>{hs(!0),await iw(t._id),hs(!1),fo(),Ot()}})}),rc.list.push({id:"createPreset",display:"Create preset",icon:"fa-plus",exec:()=>{sc("add")}}))}const f1=[{id:"changeFunboxNone",display:"none",configValue:"none",alias:"off",sticky:!0,exec:()=>{te(),K4([])&&R()}}];for(const e of gp())f1.push({id:"changeFunbox"+e.name,display:e.name.replace(/_/g," "),available:()=>{const t=Jt();return t.includes(e.name)?!0:zr(t,e.name)},sticky:!0,alias:e.alias,configValue:e.name,configValueMode:"include",exec:()=>{V0(e.name),te(),R()}});const KL={title:"Funbox...",configKey:"funbox",list:f1},p1=[{id:"changeFunbox",display:"Funbox...",alias:"fun box",icon:"fa-gamepad",subgroup:KL}],Gf=e=>r.favThemes.includes(e.name),m1=e=>({id:"changeTheme"+ln(e.name),display:e.name.replace(/_/g," "),configValue:e.name,customData:{mainColor:e.mainColor,bgColor:e.bgColor,subColor:e.subColor,textColor:e.textColor,isFavorite:Gf(e)},hover:()=>{gm(e.name)},exec:()=>{Ep(e.name)}}),g1=e=>[...e.filter(Gf),...e.filter(Ak(Gf))],Qf={title:"Theme...",configKey:"theme",list:g1(ol).map(e=>m1(e))},h1=[{id:"changeTheme",display:"Theme...",icon:"fa-palette",subgroup:Qf}];function jL(e){Qf.list=[],Qf.list=g1(e).map(t=>m1(t))}ge((e,t)=>{if(e==="favThemes")try{jL(ol)}catch(a){console.error(ie(a,"Failed to update themes commands"))}});const b1={title:"Load challenge...",list:[]},y1=[{id:"loadChallenge",display:"Load challenge...",icon:"fa-award",subgroup:b1}];function GL(e){e.forEach(t=>{b1.list.push({id:"loadChallenge"+ln(t.name),display:t.display,exec:async()=>{await Ie("/"),await xv(t.name),R({nosave:!0})}})})}const v1={homeKeys:{display:"home keys",getIncludeString:e=>{const t=e.keys.row3.slice(0,4),a=e.keys.row3.slice(6,10);return[...t,...a]},getExcludeString:e=>{const t=e.keys.row2,a=e.keys.row4,o=e.keys.row3.slice(10),i=e.keys.row3.slice(4,6);return[...t,...i,...o,...a]}},leftHand:{display:"left hand",getIncludeString:e=>{const t=e.keys.row2.slice(0,5),a=e.keys.row3.slice(0,5),o=e.keys.row4.slice(0,5);return[...t,...a,...o]},getExcludeString:e=>{const t=e.keys.row2.slice(5),a=e.keys.row3.slice(5),o=e.keys.row4.slice(5);return[...t,...a,...o]}},rightHand:{display:"right hand",getIncludeString:e=>{const t=e.keys.row2.slice(5),a=e.keys.row3.slice(5),o=e.keys.row4.slice(4);return[...t,...a,...o]},getExcludeString:e=>{const t=e.keys.row2.slice(0,5),a=e.keys.row3.slice(0,5),o=e.keys.row4.slice(0,4);return[...t,...a,...o]}},homeRow:{display:"home row",getIncludeString:e=>e.keys.row3,getExcludeString:e=>{const t=e.keys.row2,a=e.keys.row4;return[...t,...a]}},topRow:{display:"top row",getIncludeString:e=>e.keys.row2,getExcludeString:e=>{const t=e.keys.row3,a=e.keys.row4;return[...t,...a]}},bottomRow:{display:"bottom row",getIncludeString:e=>e.keys.row4,getExcludeString:e=>{const t=e.keys.row2,a=e.keys.row3;return[...t,...a]}}};async function QL(){n("#wordFilterModal .languageInput").empty(),n("#wordFilterModal .layoutInput").empty(),n("wordFilterModal .presetInput").empty(),Qp.forEach(e=>{const t=e.replace(/_/gi," ");n("#wordFilterModal .languageInput").append(`
        <option value=${e}>${t}</option>
      `)});for(const e of Oc){const t=e.replace(/_/gi," ");n("#wordFilterModal .layoutInput").append(`
      <option value=${e}>${t}</option>
    `)}for(const[e,t]of Object.entries(v1))n("#wordFilterModal .presetInput").append(`<option value=${e}>${t.display}</option>`)}let Yf,Jf,Xf;async function YL(e){Un.show({...e,beforeAnimation:async t=>{Yf=new Ge({select:"#wordFilterModal .languageInput",settings:{contentLocation:t}}),Jf=new Ge({select:"#wordFilterModal .layoutInput",settings:{contentLocation:Un.getModal()}}),Xf=new Ge({select:"#wordFilterModal .presetInput",settings:{contentLocation:Un.getModal()}}),n("#wordFilterModal .loadingIndicator").removeClass("hidden"),w1()}})}function JL(e){Un.hide({...e})}async function XL(e){let t=n("#wordFilterModal .wordIncludeInput").val();t=$g(t?.trim()),t=t.replace(/\s+/gi,"|");const a=new RegExp(t,"i");let o=n("#wordFilterModal .wordExcludeInput").val();o=$g(o.trim()),o=o.replace(/\s+/gi,"|");const i=new RegExp(o,"i"),s=[],{data:l,error:c}=await Wt(ai(e));if(c)return f(ie(c,"Failed to filter language words"),-1),[];const d=n("#wordFilterModal .wordMaxInput").val(),u=n("#wordFilterModal .wordMinInput").val();let p,g;d===""?p=999:p=parseInt(d),u===""?g=1:g=parseInt(u);for(const m of l.words){const h=a.test(m),y=i.test(m);(h&&!y||h&&o==="")&&m.length<=p&&m.length>=g&&s.push(m)}return s}async function nb(e){const t=n("#wordFilterModal .languageInput").val(),a=await XL(t);if(a.length===0){f("No words found",0),w1();return}const o=a.join(Ts()?"|":" ");JL({modalChainData:{text:o,set:e}})}function sb(){for(const e of Un.getModal().querySelectorAll("button"))e.setAttribute("disabled","true")}function w1(){for(const e of Un.getModal().querySelectorAll("button"))e.removeAttribute("disabled")}async function ZL(){await QL(),n("#wordFilterModal button.generateButton").on("click",async()=>{const e=n("#wordFilterModal .presetInput").val(),t=n("#wordFilterModal .layoutInput").val(),a=v1[e];if(a===void 0){f(`Preset ${e} not found`,-1);return}const o=await Bi(t);n("#wordIncludeInput").val(a.getIncludeString(o).map(i=>i[0]).join(" ")),n("#wordExcludeInput").val(a.getExcludeString(o).map(i=>i[0]).join(" "))}),n("#wordFilterModal button.addButton").on("click",()=>{n("#wordFilterModal .loadingIndicator").removeClass("hidden"),sb(),setTimeout(()=>{nb(!1)},0)}),n("#wordFilterModal button.setButton").on("click",()=>{n("#wordFilterModal .loadingIndicator").removeClass("hidden"),sb(),setTimeout(()=>{nb(!0)},0)})}async function e$(){Yf?.destroy(),Jf?.destroy(),Xf?.destroy(),Yf=void 0,Jf=void 0,Xf=void 0}const Un=new re({dialogId:"wordFilterModal",setup:ZL,cleanup:e$}),rb={alphas:{display:"a-z",characters:"abcdefghijklmnopqrstuvwxyz".split("")},numbers:{display:"0-9",characters:"0123456789".split("")},special:{display:"symbols",characters:"!@#$%^&*()_+-=[]{}|;:',.<>?/`~".split("")},bigrams:{display:"bigrams",characters:["th","he","in","er","an","re","on","at","en","nd","ed","es","or","te","st","ar","ou","it","al","as"]},trigrams:{display:"trigrams",characters:["the","and","ing","ion","tio","ent","ati","for","her","ter","ate","ver","all","con","res","are","rea","int"]}};async function t$(e){C1.show({...e,beforeAnimation:async t=>{new Ge({select:"#customGeneratorModal .presetInput",settings:{contentLocation:t}})}})}function a$(){const e=n("#customGeneratorModal .presetInput").val();if(e!==void 0&&e!==""&&rb[e]){const t=rb[e];n("#customGeneratorModal .characterInput").val(t.characters.join(" "))}}function o$(e){C1.hide({...e})}function i$(){const e=n("#customGeneratorModal .characterInput").val(),t=parseInt(n("#customGeneratorModal .minLengthInput").val())||2,a=parseInt(n("#customGeneratorModal .maxLengthInput").val())||5,o=parseInt(n("#customGeneratorModal .wordCountInput").val())||100;if(!e||e.trim()==="")return f("Character set cannot be empty",0),[];const i=e.trim().split(/\s+/),s=[];for(let l=0;l<o;l++){const c=Math.floor(Math.random()*(a-t+1))+t;let d="";for(let u=0;u<c;u++){const p=i[Math.floor(Math.random()*i.length)];d+=p}s.push(d)}return s}async function lb(e){const t=i$();if(t.length===0)return;const a=t.join(Ts()?"|":" ");o$({modalChainData:{text:a,set:e}})}async function n$(e){e.querySelector(".setButton")?.addEventListener("click",()=>{lb(!0)}),e.querySelector(".addButton")?.addEventListener("click",()=>{lb(!1)}),e.querySelector(".generateButton")?.addEventListener("click",()=>{a$()})}const C1=new re({dialogId:"customGeneratorModal",setup:n$});let{promise:k1,resolve:lc}=Lo();async function s$(){if(!tn()){f("Could not show register popup: Captcha is not available. This could happen due to a blocked or failed network request. Please refresh the page or contact support if this issue persists.",-1),lc(void 0);return}await S1.show({mode:"dialog",beforeAnimation:async e=>{({promise:k1,resolve:lc}=Lo()),To("register"),Is(e.querySelector(".g-recaptcha"),"register",t=>{lc(t),Zf()})}})}function Zf(e=!1){e&&lc(void 0),S1.hide()}const S1=new re({dialogId:"registerCaptchaModal",customEscapeHandler:async()=>{Zf(!0)},customWrapperClickHandler:async()=>{Zf(!0)}}),eg=new B2,tg=new R2;async function x1(){if(!na()){f("Authentication uninitialized",-1,{duration:3});return}Z(),n(".sendVerificationEmail").prop("disabled",!0);const e=await T.users.verificationEmail();n(".sendVerificationEmail").prop("disabled",!1),e.status!==200?(N(),f("Failed to request verification email: "+e.body.message,-1)):(N(),f("Verification email sent",1))}async function r$(){try{console.log("getting account data");const e=await qS();if(e===!1)throw new Error("Snapshot didn't initialize due to lacking authentication even though user is authenticated");GS(e.uid,e.name),e.needsToChangeName&&qi("You need to update your account name. <a class='openNameChange'>Click here</a> to change it and learn more about why.",-1,void 0,!0,void 0,!0);const t=JSON.stringify(r)===JSON.stringify(e.config);if(r===void 0||!t){console.log("no local config or local and db configs are different - applying db"),await es(e.config),xs(!0);for(const a of ft("applyGlobalCSS"))a.functions.applyGlobalCSS()}return!0}catch(e){if(console.error(e),Za(),n("header nav .view-account").css("opacity",1),e instanceof Sn)e.responseCode===429&&(f("Doing so will save you bandwidth, make the next test be ready faster and will not sign you out (which could mean your new personal best would not save to your account).",0,{duration:0}),f("You will run into this error if you refresh the website to restart the test. It is NOT recommended to do that. Instead, use tab + enter or just tab (with quick tab mode enabled) to restart the test.",0,{duration:0})),f("Failed to get user data: "+e.message,-1);else{const t=ie(e,"Failed to get user data");f(t,-1)}return!1}}async function T1(e){if(!await r$()){dn();return}cd({type:"snapshotUpdated",data:{isInitial:!0}})}async function L1(e,t){console.debug("account controller ready");let a=Promise.resolve();e&&(console.debug(`auth state changed, user ${t?"true":"false"}`),console.debug(t),t?a=T1():at(void 0)),(!e||!t)&&QS(),await Ie(void 0,{force:!0,loadingOptions:{loadingMode:()=>t!==null?"sync":"none",loadingPromise:async()=>{await a},style:"bar",keyframes:[{percentage:90,durationMs:1e3,text:"Downloading user data..."}]}}),cd({type:"authStateChanged",data:{isUserSignedIn:t!==null}})}async function l$(e,t){if(!na()){f("Authentication uninitialized",-1);return}if(!Xe()){f("You are offline",0,{duration:2});return}if(Um(),Nm(),ll(),e===""||t===""){f("Please fill in all fields",0),Ya(),Za(),Om();return}const a=n(".pageLogin .login #rememberMe input").prop("checked"),{error:o}=await Wt(sS(e,t,a));if(o!==null){f(o.message,-1),Ya(),Za(),en();return}}async function $1(e){if(!na()){f("Authentication uninitialized",-1,{duration:3});return}if(!Xe()){f("You are offline",0,{duration:2});return}Um(),Nm(),ll();const t=n(".pageLogin .login #rememberMe input").prop("checked"),{error:a}=await Wt(rS(e,t));if(a!==null){a.message!==""&&f(a.message,-1),Ya(),Za(),en();return}}async function c$(){return $1(eg)}async function d$(){return $1(tg)}async function u$(){return M1("Google",eg)}async function f$(){return M1("GitHub",tg)}async function M1(e,t){if(!Xe()){f("You are offline",0,{duration:2});return}if(!na()){f("Authentication uninitialized",-1,{duration:3});return}Z();const a=tt();if(a)try{await D2(a,t),N(),f(`${e} authentication added`,1),cd({type:"authConfigUpdated"})}catch(o){N();const i=ie(o,`Failed to add ${e} authentication`);f(i,-1)}}function dn(){if(!na()){f("Authentication uninitialized",-1,{duration:3});return}A()&&nS()}async function p$(){if(!na()){f("Authentication uninitialized",-1,{duration:3});return}if(!Xe()){f("You are offline",0,{duration:2});return}await s$();const e=await k1;if(e===void 0||e===""){f("Please complete the captcha",-1);return}Nm(),ll(),Um();const t=tT();if(t===!1){Ya(),Za(),en(),f("Please fill in all fields",0);return}const{name:a,email:o,password:i}=t;try{const s=await lS(o,i),l=await T.users.create({body:{name:a,captcha:e,email:o,uid:s.user.uid}});if(l.status!==200)throw new Error(`Failed to sign in: ${l.body.message}`);await Jb(s.user,{displayName:a}),await x1(),Ya(),await L1(!0,s.user),ny(),f("Account created",1)}catch(s){let l=ie(s,"Failed to create account");s instanceof Error&&"code"in s&&s.code==="auth/email-already-in-use"&&(l=ie({message:"Email already in use"},"Failed to create account")),f(l,-1),Ya(),Za(),en(),dn();return}}n(".pageLogin .login form").on("submit",e=>{e.preventDefault();const t=n(".pageLogin .login input")[0].value??"",a=n(".pageLogin .login input")[1].value??"";l$(t,a)});n(".pageLogin .login button.signInWithGoogle").on("click",()=>{c$()});n(".pageLogin .login button.signInWithGitHub").on("click",()=>{d$()});n("nav .accountButtonAndMenu .menu button.signOut").on("click",()=>{if(!na()){f("Authentication uninitialized",-1,{duration:3});return}dn()});n(".pageLogin .register form").on("submit",e=>{e.preventDefault(),p$()});n(".pageAccountSettings").on("click","#addGoogleAuth",()=>{u$()});n(".pageAccountSettings").on("click","#addGithubAuth",()=>{f$()});n(".pageAccount").on("click",".sendVerificationEmail",()=>{if(!Xe()){f("You are offline",0,{duration:2});return}x1()});const Fe={updateEmail:void 0,updateName:void 0,updatePassword:void 0,removeGoogleAuth:void 0,removeGithubAuth:void 0,removePasswordAuth:void 0,addPasswordAuth:void 0,deleteAccount:void 0,resetAccount:void 0,optOutOfLeaderboards:void 0,applyCustomFont:void 0,resetPersonalBests:void 0,resetSettings:void 0,revokeAllTokens:void 0,unlinkDiscord:void 0,editApeKey:void 0,deleteCustomText:void 0,deleteCustomTextLong:void 0,resetProgressCustomTextLong:void 0,updateCustomTheme:void 0,deleteCustomTheme:void 0,devGenerateData:void 0,lbGoToPage:void 0};function m$(e){const a=["password","github.com","google.com"].filter(o=>o!==e);for(const o of a)if(Kd(o))return o}function ao(){return Kd("password")}function g$(){return Kd("github.com")}function h$(){return Kd("google.com")}function Kd(e){return tt()?.providerData.some(t=>t.providerId===e)||!1}async function ua(e){if(!na())return{status:-1,message:"Authentication is not initialized"};const t=tt();if(t===null)return{status:-1,message:"User is not signed in"};const a=m$(e.excludeMethod);try{if(a===void 0)return{status:-1,message:"Failed to reauthenticate: there is no valid authentication present on the account."};if(a==="password"){if(e.password===void 0)return{status:-1,message:"Failed to reauthenticate using password: password missing."};const o=Xb.credential(t.email,e.password);await z2(t,o)}else await H2(t,a==="github.com"?tg:eg);return{status:1,message:"Reauthenticated",user:t}}catch(o){const i=o;return i.code==="auth/wrong-password"?{status:0,message:"Incorrect password"}:i.code==="auth/invalid-credential"?{status:0,message:"Password is incorrect or your account does not have password authentication enabled."}:{status:-1,message:"Failed to reauthenticate: "+(i?.message??JSON.stringify(o))}}}Fe.updateEmail=new de({id:"updateEmail",title:"Update email",inputs:[{placeholder:"Password",type:"password",initVal:""},{type:"text",placeholder:"New email",initVal:"",validation:{schema:fc}},{type:"text",placeholder:"Confirm new email",initVal:"",validation:{schema:fc,isValid:async(e,t)=>e===t.inputs?.[1]?.currentValue()||"Emails don't match",debounceDelay:0}}],buttonText:"update",onlineOnly:!0,execFn:async(e,t,a,o)=>{if(a!==o)return{status:0,message:"Emails don't match"};const i=await ua({password:t});if(i.status!==1)return{status:i.status,message:i.message};const s=await T.users.updateEmail({body:{newEmail:a,previousEmail:i.user.email}});return s.status!==200?{status:-1,message:"Failed to update email: "+s.body.message}:(dn(),{status:1,message:"Email updated"})},beforeInitFn:e=>{A()&&(ao()||(e.inputs=[],e.buttonText="",e.text="Password authentication is not enabled"))}});Fe.removeGoogleAuth=new de({id:"removeGoogleAuth",title:"Remove Google authentication",inputs:[{placeholder:"Password",type:"password",initVal:""}],onlineOnly:!0,buttonText:"remove",execFn:async(e,t)=>{const a=await ua({password:t,excludeMethod:"google.com"});if(a.status!==1)return{status:a.status,message:a.message};try{await yp(a.user,"google.com")}catch(o){return{status:-1,message:ie(o,"Failed to unlink Google account")}}return pi(),$o(3),{status:1,message:"Google authentication removed"}},beforeInitFn:e=>{A()&&(ao()||(e.inputs=[],g$()||(e.buttonText="",e.text="Password or GitHub authentication is not enabled")))}});Fe.removeGithubAuth=new de({id:"removeGithubAuth",title:"Remove GitHub authentication",inputs:[{placeholder:"Password",type:"password",initVal:""}],onlineOnly:!0,buttonText:"remove",execFn:async(e,t)=>{const a=await ua({password:t,excludeMethod:"github.com"});if(a.status!==1)return{status:a.status,message:a.message};try{await yp(a.user,"github.com")}catch(o){return{status:-1,message:ie(o,"Failed to unlink GitHub account")}}return pi(),$o(3),{status:1,message:"GitHub authentication removed"}},beforeInitFn:e=>{A()&&(ao()||(e.inputs=[],h$()||(e.buttonText="",e.text="Password or Google authentication is not enabled")))}});Fe.removePasswordAuth=new de({id:"removePaswordAuth",title:"Remove Password authentication",inputs:[{type:"checkbox",label:"I understand I will lose access to my Monkeytype account if my Google/GitHub account is lost or disabled."}],onlineOnly:!0,buttonText:"reauthenticate to remove",execFn:async e=>{const t=await ua({excludeMethod:"password"});if(t.status!==1)return{status:t.status,message:t.message};try{await yp(t.user,"password")}catch(a){return{status:-1,message:ie(a,"Failed to remove password authentication")}}return pi(),$o(3),{status:1,message:"Password authentication removed"}},beforeInitFn:()=>{A()}});Fe.updateName=new de({id:"updateName",title:"Update name",inputs:[{placeholder:"password",type:"password",initVal:""},{placeholder:"new name",type:"text",initVal:"",validation:{schema:Or,isValid:Od(async e=>T.users.getNameAvailability({params:{name:e}}),{check:e=>e.available||"Name not available"}),debounceDelay:1e3}}],buttonText:"update",onlineOnly:!0,execFn:async(e,t,a)=>{const o=await ua({password:t});if(o.status!==1)return{status:o.status,message:o.message};const i=await T.users.updateName({body:{name:a}});if(i.status!==200)return{status:-1,message:"Failed to update name: "+i.body.message};const s=S();return s&&(s.name=a,at(s),s.needsToChangeName&&$o(2)),{status:1,message:"Name updated"}},beforeInitFn:e=>{if(!A())return;const t=S();t&&(ao()||(e.inputs[0].hidden=!0,e.buttonText="reauthenticate to update"),t.needsToChangeName===!0&&(e.text="You need to change your account name. This might be because you have a duplicate name, no account name or your name is not allowed (contains whitespace or invalid characters). Sorry for the inconvenience."))}});Fe.updatePassword=new de({id:"updatePassword",title:"Update password",inputs:[{placeholder:"current password",type:"password",initVal:""},{placeholder:"new password",type:"password",initVal:"",validation:{schema:Hb}},{placeholder:"confirm new password",type:"password",initVal:""}],buttonText:"update",onlineOnly:!0,execFn:async(e,t,a,o)=>{if(a!==o)return{status:0,message:"New passwords don't match"};if(a===t)return{status:0,message:"New password must be different from previous password"};const i=await ua({password:t});if(i.status!==1)return{status:i.status,message:i.message};const s=await T.users.updatePassword({body:{newPassword:a}});return s.status!==200?{status:-1,message:"Failed to update password: "+s.body.message}:(dn(),{status:1,message:"Password updated"})},beforeInitFn:e=>{A()&&(ao()||(e.inputs=[],e.buttonText="",e.text="Password authentication is not enabled"))}});Fe.addPasswordAuth=new de({id:"addPasswordAuth",title:"Add password authentication",inputs:[{placeholder:"email",type:"email",initVal:""},{placeholder:"confirm email",type:"email",initVal:""},{placeholder:"new password",type:"password",initVal:""},{placeholder:"confirm new password",type:"password",initVal:""}],buttonText:"reauthenticate to add",onlineOnly:!0,execFn:async(e,t,a,o,i)=>{if(t!==a)return{status:0,message:"Emails don't match"};if(o!==i)return{status:0,message:"Passwords don't match"};const s=await ua({password:o});if(s.status!==1)return{status:s.status,message:s.message};try{const c=Xb.credential(t,o);await W2(s.user,c)}catch(c){return{status:-1,message:ie(c,"Failed to add password authentication")}}const l=await T.users.updateEmail({body:{newEmail:t,previousEmail:s.user.email}});return l.status!==200?{status:-1,message:"Password authentication added but updating the database email failed. This shouldn't happen, please contact support. Error: "+l.body.message}:(pi(),{status:1,message:"Password authentication added"})}});Fe.deleteAccount=new de({id:"deleteAccount",title:"Delete account",inputs:[{placeholder:"password",type:"password",initVal:""}],text:"This is the last time you can change your mind. After pressing the button everything is gone.",buttonText:"delete",onlineOnly:!0,execFn:async(e,t)=>{const a=await ua({password:t});if(a.status!==1)return{status:a.status,message:a.message};f("Deleting all data...",0);const o=await T.users.delete();return o.status!==200?{status:-1,message:"Failed to delete user data: "+o.body.message}:($o(3),{status:1,message:"Account deleted, goodbye"})},beforeInitFn:e=>{A()&&(ao()||(e.inputs=[],e.buttonText="reauthenticate to delete"))}});Fe.resetAccount=new de({id:"resetAccount",title:"Reset account",inputs:[{placeholder:"password",type:"password",initVal:""}],text:"This is the last time you can change your mind. After pressing the button everything is gone.",buttonText:"reset",onlineOnly:!0,execFn:async(e,t)=>{const a=await ua({password:t});if(a.status!==1)return{status:a.status,message:a.message};f("Resetting settings...",0),await qp(),await Je.deleteFile("LocalBackgroundFile"),f("Resetting account...",0);const o=await T.users.reset();return o.status!==200?{status:-1,message:"Failed to reset account: "+o.body.message}:($o(3),{status:1,message:"Account reset"})},beforeInitFn:e=>{A()&&(ao()||(e.inputs=[],e.buttonText="reauthenticate to reset"))}});Fe.optOutOfLeaderboards=new de({id:"optOutOfLeaderboards",title:"Opt out of leaderboards",inputs:[{placeholder:"password",type:"password",initVal:""}],text:"Are you sure you want to opt out of leaderboards?",buttonText:"opt out",onlineOnly:!0,execFn:async(e,t)=>{const a=await ua({password:t});if(a.status!==1)return{status:a.status,message:a.message};const o=await T.users.optOutOfLeaderboards();return o.status!==200?{status:-1,message:"Failed to opt out: "+o.body.message}:($o(3),{status:1,message:"Leaderboards opt out successful"})},beforeInitFn:e=>{A()&&(ao()||(e.inputs=[],e.buttonText="reauthenticate to opt out"))}});Fe.applyCustomFont=new de({id:"applyCustomFont",title:"Custom font",inputs:[{type:"text",placeholder:"Font name",initVal:""}],text:"Make sure you have the font installed on your computer before applying",buttonText:"apply",execFn:async(e,t)=>(E.fontFamily?.setValue(t.replace(/\s/g,"_")),{status:1,message:"Font applied"})});Fe.resetPersonalBests=new de({id:"resetPersonalBests",title:"Reset personal bests",inputs:[{placeholder:"password",type:"password",initVal:""}],buttonText:"reset",onlineOnly:!0,execFn:async(e,t)=>{const a=await ua({password:t});if(a.status!==1)return{status:a.status,message:a.message};const o=await T.users.deletePersonalBests();if(o.status!==200)return{status:-1,message:"Failed to reset personal bests: "+o.body.message};const i=S();return i?(i.personalBests={time:{},words:{},quote:{},zen:{},custom:{}},{status:1,message:"Personal bests reset"}):{status:-1,message:"Failed to reset personal bests: no snapshot"}},beforeInitFn:e=>{A()&&(ao()||(e.inputs=[],e.buttonText="reauthenticate to reset"))}});Fe.resetSettings=new de({id:"resetSettings",title:"Reset settings",text:"Are you sure you want to reset all your settings?",buttonText:"reset",onlineOnly:!0,execFn:async()=>(await qp(),await Je.deleteFile("LocalBackgroundFile"),{status:1,message:"Settings reset"})});Fe.revokeAllTokens=new de({id:"revokeAllTokens",title:"Revoke all tokens",inputs:[{placeholder:"password",type:"password",initVal:""}],text:"Are you sure you want to do this? This will log you out of all devices.",buttonText:"revoke all",onlineOnly:!0,execFn:async(e,t)=>{const a=await ua({password:t});if(a.status!==1)return{status:a.status,message:a.message};const o=await T.users.revokeAllTokens();return o.status!==200?{status:-1,message:"Failed to revoke tokens: "+o.body.message}:($o(3),{status:1,message:"Tokens revoked"})},beforeInitFn:e=>{!A()||!S()||ao()||(e.inputs[0].hidden=!0,e.buttonText="reauthenticate to revoke all tokens")}});Fe.unlinkDiscord=new de({id:"unlinkDiscord",title:"Unlink Discord",text:"Are you sure you want to unlink your Discord account?",buttonText:"unlink",onlineOnly:!0,execFn:async()=>{const e=S();if(!e)return{status:-1,message:"Failed to unlink Discord: no snapshot"};const t=await T.users.unlinkDiscord();return t.status!==200?{status:-1,message:"Failed to unlink Discord: "+t.body.message}:(e.discordAvatar=void 0,e.discordId=void 0,at(e),pi(),{status:1,message:"Discord unlinked"})}});Fe.deleteCustomText=new de({id:"deleteCustomText",title:"Delete custom text",text:"Are you sure?",buttonText:"delete",execFn:async e=>(o0(e.parameters[0],!1),oi("",void 0),{status:1,message:"Custom text deleted"}),beforeInitFn:e=>{e.text=`Are you sure you want to delete custom text ${e.parameters[0]}?`}});Fe.deleteCustomTextLong=new de({id:"deleteCustomTextLong",title:"Delete custom text",text:"Are you sure?",buttonText:"delete",execFn:async e=>(o0(e.parameters[0],!0),oi("",void 0),{status:1,message:"Custom text deleted"}),beforeInitFn:e=>{e.text=`Are you sure you want to delete custom text ${e.parameters[0]}?`}});Fe.resetProgressCustomTextLong=new de({id:"resetProgressCustomTextLong",title:"Reset progress for custom text",text:"Are you sure?",buttonText:"reset",execFn:async e=>{ju(e.parameters[0],0);const t=Tc(e.parameters[0],!0);return wo(t),{status:1,message:"Custom text progress reset"}},beforeInitFn:e=>{e.text=`Are you sure you want to reset your progress for custom text ${e.parameters[0]}?`}});Fe.updateCustomTheme=new de({id:"updateCustomTheme",title:"Update custom theme",inputs:[{type:"text",placeholder:"name",initVal:""},{type:"checkbox",initVal:!1,label:"Update custom theme to current colors",optional:!0}],buttonText:"update",onlineOnly:!0,execFn:async(e,t,a)=>{const o=S();if(!o)return{status:-1,message:"Failed to update custom theme: no snapshot"};const i=o.customThemes?.find(d=>d._id===e.parameters[0]);if(i===void 0)return{status:-1,message:"Failed to update custom theme: theme not found"};let s=[];if(a==="true")for(const d of ko)s.push(n(`.pageSettings .customTheme .tabContent.customTheme #${d}[type='color']`).attr("value"));else s=i.colors;const l={name:t.replaceAll(" ","_"),colors:s};return await FS(i._id,l)?(Xn(s),Wd(),{status:1,message:"Custom theme updated"}):{status:-1,message:"Failed to update custom theme"}},beforeInitFn:e=>{const t=S();if(!t)return;const a=t.customThemes?.find(o=>o._id===e.parameters[0]);a&&(e.inputs[0].initVal=a.name)}});Fe.deleteCustomTheme=new de({id:"deleteCustomTheme",title:"Delete custom theme",text:"Are you sure?",buttonText:"delete",onlineOnly:!0,execFn:async e=>(await PS(e.parameters[0]),Wd(),{status:1,message:"Custom theme deleted"})});Fe.devGenerateData=new de({id:"devGenerateData",title:"Generate data",showLabels:!0,inputs:[{type:"text",label:"username",placeholder:"username",oninput:e=>{const t=e.target,a=document.querySelector("#devGenerateData_1 + span");a.innerHTML=`if checked, user will be created with ${t.value}@example.com and password: password`},validation:{schema:Or}},{type:"checkbox",label:"create user",description:"if checked, user will be created with {username}@example.com and password: password",optional:!0},{type:"date",label:"first test",optional:!0},{type:"date",label:"last test",max:new Date,optional:!0},{type:"range",label:"min tests per day",initVal:0,min:0,max:200,step:10},{type:"range",label:"max tests per day",initVal:50,min:0,max:200,step:10}],buttonText:"generate (might take a while)",execFn:async(e,t,a,o,i,s,l)=>{const c={username:t,createUser:a==="true"};o!==void 0&&o.length>0&&(c.firstTestTimestamp=Date.parse(o)),i!==void 0&&i.length>0&&(c.lastTestTimestamp=Date.parse(i)),s!==void 0&&s.length>0&&(c.minTestsPerDay=Number.parseInt(s)),l!==void 0&&l.length>0&&(c.maxTestsPerDay=Number.parseInt(l));const d=await T.dev.generateData({body:c});return{status:d.status===200?1:-1,message:d.body.message,hideOptions:{clearModalChain:!0}}}});Fe.lbGoToPage=new de({id:"lbGoToPage",title:"Go to page",inputs:[{type:"number",placeholder:"Page number"}],buttonText:"Go",execFn:async(e,t)=>{const a=parseInt(t,10);return isNaN(a)||a<1?{status:0,message:"Invalid page number"}:(BT(a-1),{status:1,message:"Navigating to page "+a,showNotification:!1})}});function Re(e,t=[],a={}){const o=Fe[e];if(o===void 0){f("Failed to show popup - popup is not defined",-1);return}o.show(t,a)}n(".pageAccountSettings").on("click","#unlinkDiscordButton",()=>{Re("unlinkDiscord")});n(".pageAccountSettings").on("click","#removeGoogleAuth",()=>{Re("removeGoogleAuth")});n(".pageAccountSettings").on("click","#removeGithubAuth",()=>{Re("removeGithubAuth")});n(".pageAccountSettings").on("click","#removePasswordAuth",()=>{Re("removePasswordAuth")});n("#resetSettingsButton").on("click",()=>{Re("resetSettings")});n(".pageAccountSettings").on("click","#revokeAllTokens",()=>{Re("revokeAllTokens")});n(".pageAccountSettings").on("click","#resetPersonalBestsButton",()=>{Re("resetPersonalBests")});n(".pageAccountSettings").on("click","#updateAccountName",()=>{Re("updateName")});n("#bannerCenter").on("click",".banner .text .openNameChange",()=>{Re("updateName")});n(".pageAccountSettings").on("click","#addPasswordAuth",()=>{Re("addPasswordAuth")});n(".pageAccountSettings").on("click","#emailPasswordAuth",()=>{Re("updateEmail")});n(".pageAccountSettings").on("click","#passPasswordAuth",()=>{Re("updatePassword")});n(".pageAccountSettings").on("click","#deleteAccount",()=>{Re("deleteAccount")});n(".pageAccountSettings").on("click","#resetAccount",()=>{Re("resetAccount")});n(".pageAccountSettings").on("click","#optOutOfLeaderboardsButton",()=>{Re("optOutOfLeaderboards")});n(".pageSettings").on("click",".section.themes .customTheme .delButton",e=>{const a=n(e.currentTarget).parent(".customTheme.button").attr("customThemeId");Re("deleteCustomTheme",[a])});n(".pageSettings").on("click",".section.themes .customTheme .editButton",e=>{const a=n(e.currentTarget).parent(".customTheme.button").attr("customThemeId");Re("updateCustomTheme",[a],{focusFirstInput:"focusAndSelect"})});n(".pageSettings").on("click",".section[data-config-name='fontFamily'] button[data-config-value='custom']",()=>{Re("applyCustomFont")});async function A1(){const e=Gu(),t=n("#savedTextsModal .list").empty();let a="";if(e.length===0)a+="<div>No saved custom texts found</div>";else for(const l of e)a+=`<div class="savedText" data-name="${lt(l)}">
      <div class="button name">${lt(l)}</div>
      <div class="button delete">
      <i class="fas fa-fw fa-trash"></i>
      </div>
      </div>`;t.html(a);const o=Gu(!0),i=n("#savedTextsModal .listLong").empty();let s="";if(o.length===0)s+="<div>No saved long custom texts found</div>";else for(const l of o)s+=`<div class="savedLongText" data-name="${lt(l)}">
      <div class="button name">${lt(l)}</div>
      <div class="button ${Wp(l)<=0?"disabled":""} resetProgress">reset</div>
      <div class="button delete">
      <i class="fas fa-fw fa-trash"></i>
      </div>
      </div>`;i.html(s),n("#savedTextsModal .list .savedText .button.delete").on("click",l=>{const c=n(l.target).closest(".savedText").data("name");if(c===void 0){f("Failed to show delete modal: no name found",-1);return}Re("deleteCustomText",[c],{modalChain:dr})}),n("#savedTextsModal .listLong .savedLongText .button.delete").on("click",l=>{const c=n(l.target).closest(".savedLongText").data("name");if(c===void 0){f("Failed to show delete modal: no name found",-1);return}Re("deleteCustomTextLong",[c],{modalChain:dr})}),n("#savedTextsModal .listLong .savedLongText .button.resetProgress").on("click",l=>{const c=n(l.target).closest(".savedLongText").data("name");if(c===void 0){f("Failed to show delete modal: no name found",-1);return}Re("resetProgressCustomTextLong",[c],{modalChain:dr})}),n("#savedTextsModal .list .savedText .button.name").on("click",l=>{const c=n(l.target).text();oi(c,!1);const d=db(c,!1);cb({modalChainData:{text:d,long:!1}})}),n("#savedTextsModal .listLong .savedLongText .button.name").on("click",l=>{const c=n(l.target).text();oi(c,!0);const d=db(c,!0);cb({modalChainData:{text:d,long:!0}})})}async function b$(e){dr.show({...e,beforeAnimation:async()=>{A1()}})}function cb(e){dr.hide({...e})}function db(e,t){let a=Tc(e,t);return t&&(a=a.slice(Wp(e))),a.join(" ")}async function y$(){}const dr=new re({dialogId:"savedTextsModal",setup:y$,showOptionsWhenInChain:{beforeAnimation:async()=>{A1()}}}),Qc={textToSave:[]},ub=Fa(n("#saveCustomTextModal .textName")[0],{debounceDelay:500,schema:q.string().min(1).max(32).regex(/^[\w\s-]+$/,{message:"Name can only contain letters, numbers, spaces, underscores and hyphens"}),isValid:async e=>{const t=n("#saveCustomTextModal .isLongText").prop("checked");return Gu(t).includes(e)?"Duplicate name":!0},callback:e=>{e.status==="success"?n("#saveCustomTextModal button.save").prop("disabled",!1):n("#saveCustomTextModal button.save").prop("disabled",!0)}});async function v$(e){Qc.textToSave=[],_1.show({...e,beforeAnimation:async(t,a)=>{Qc.textToSave=a?.text??[],n("#saveCustomTextModal .textName").val(""),n("#saveCustomTextModal .isLongText").prop("checked",!1),n("#saveCustomTextModal button.save").prop("disabled",!0)}})}function w$(){const e=n("#saveCustomTextModal .textName").val(),t=n("#saveCustomTextModal .isLongText").prop("checked");return e?Qc.textToSave.length===0?(f("Custom text can't be empty",0),!1):Q3(e,Qc.textToSave,t)?(oi(e,t),f("Custom text saved",1),!0):(f("Error saving custom text",-1),!1):(f("Custom text needs a name",0),!1)}async function C$(e){e.addEventListener("submit",t=>{t.preventDefault(),ub.getValidationResult().status==="success"&&w$()&&_1.hide()}),e.querySelector(".isLongText")?.addEventListener("input",t=>{ub.triggerValidation()})}const _1=new re({dialogId:"saveCustomTextModal",setup:C$}),j="#customTextModal .modal",x={textarea:Jr().join(Ts()?"|":" "),longCustomTextWarning:!1,challengeWarning:!1,customTextMode:"simple",customTextLimits:{word:"",time:"",section:""},removeFancyTypographyEnabled:!0,replaceControlCharactersEnabled:!0,customTextPipeDelimiter:!1,replaceNewlines:"off",removeZeroWidthCharactersEnabled:!0};function Vt(){n(`${j} .inputs .group[data-id="mode"] button`).removeClass("active"),n(`${j} .inputs .group[data-id="mode"] button[value="${x.customTextMode}"]`).addClass("active"),n(`${j} .inputs .group[data-id="limit"] input.words`).addClass("hidden"),n(`${j} .inputs .group[data-id="limit"] input.sections`).addClass("hidden"),n(`${j} .inputs .group[data-id="limit"] input.words`).val(x.customTextLimits.word),n(`${j} .inputs .group[data-id="limit"] input.time`).val(x.customTextLimits.time),n(`${j} .inputs .group[data-id="limit"] input.sections`).val(x.customTextLimits.section),x.customTextLimits.word!==""&&n(`${j} .inputs .group[data-id="limit"] input.words`).removeClass("hidden"),x.customTextLimits.section!==""&&n(`${j} .inputs .group[data-id="limit"] input.sections`).removeClass("hidden"),x.customTextPipeDelimiter?(n(`${j} .inputs .group[data-id="limit"] input.sections`).removeClass("hidden"),n(`${j} .inputs .group[data-id="limit"] input.words`).addClass("hidden")):(n(`${j} .inputs .group[data-id="limit"] input.words`).removeClass("hidden"),n(`${j} .inputs .group[data-id="limit"] input.sections`).addClass("hidden")),x.customTextMode==="simple"?(n(`${j} .inputs .group[data-id="limit"]`).addClass("disabled"),n(`${j} .inputs .group[data-id="limit"] input`).val(""),n(`${j} .inputs .group[data-id="limit"] input`).prop("disabled",!0)):(n(`${j} .inputs .group[data-id="limit"]`).removeClass("disabled"),n(`${j} .inputs .group[data-id="limit"] input`).prop("disabled",!1)),n(`${j} .inputs .group[data-id="fancy"] button`).removeClass("active"),n(`${j} .inputs .group[data-id="fancy"] button[value="${x.removeFancyTypographyEnabled}"]`).addClass("active"),n(`${j} .inputs .group[data-id="control"] button`).removeClass("active"),n(`${j} .inputs .group[data-id="control"] button[value="${x.replaceControlCharactersEnabled}"]`).addClass("active"),n(`${j} .inputs .group[data-id="zeroWidth"] button`).removeClass("active"),n(`${j} .inputs .group[data-id="zeroWidth"] button[value="${x.removeZeroWidthCharactersEnabled}"]`).addClass("active"),n(`${j} .inputs .group[data-id="delimiter"] button`).removeClass("active"),n(`${j} .inputs .group[data-id="delimiter"] button[value="${x.customTextPipeDelimiter}"]`).addClass("active"),n(`${j} .inputs .group[data-id="newlines"] button`).removeClass("active"),n(`${j} .inputs .group[data-id="newlines"] button[value="${x.replaceNewlines}"]`).addClass("active"),n(`${j} textarea`).val(x.textarea),x.longCustomTextWarning?(n(`${j} .longCustomTextWarning`).removeClass("hidden"),n(`${j} .randomWordsCheckbox input`).prop("checked",!1),n(`${j} .delimiterCheck input`).prop("checked",!1),n(`${j} .typographyCheck`).prop("checked",!0),n(`${j} .replaceNewlineWithSpace input`).prop("checked",!1),n(`${j} .inputs`).addClass("disabled")):(n(`${j} .longCustomTextWarning`).addClass("hidden"),n(`${j} .inputs`).removeClass("disabled")),x.challengeWarning?(n(`${j} .challengeWarning`).removeClass("hidden"),n(`${j} .randomWordsCheckbox input`).prop("checked",!1),n(`${j} .delimiterCheck input`).prop("checked",!1),n(`${j} .typographyCheck`).prop("checked",!0),n(`${j} .replaceNewlineWithSpace input`).prop("checked",!1),n(`${j} .inputs`).addClass("disabled")):(n(`${j} .challengeWarning`).addClass("hidden"),n(`${j} .inputs`).removeClass("disabled"))}async function E1(e,t){if(x.customTextMode=Kl(),x.customTextMode==="repeat"&&ve()==="word"&&ye()===Jr().length&&(x.customTextMode="simple"),x.customTextLimits.word="",x.customTextLimits.time="",x.customTextLimits.section="",ve()==="word"?x.customTextLimits.word=`${ye()}`:ve()==="time"?x.customTextLimits.time=`${ye()}`:ve()==="section"&&(x.customTextLimits.section=`${ye()}`),x.customTextPipeDelimiter=Ts(),x.longCustomTextWarning=Xa()??!1,t?.text!==void 0){t.long!==!0&&Xa()&&(oi("",void 0),f("Disabled long custom text progress tracking",0,{duration:5}),x.longCustomTextWarning=!1);const a=t.set??!0?t.text:x.textarea+" "+t.text;x.textarea=a,x.customTextMode="simple",x.customTextLimits.word=`${Yc().length}`,x.customTextLimits.time="",x.customTextLimits.section=""}Vt()}async function q1(){!x.challengeWarning&&!x.longCustomTextWarning&&n(`${j} textarea`).trigger("focus")}function ag(e){x.textarea=Jr().join(Ts()?"|":" ").replace(/^ +/gm,""),Fn.show({...e,beforeAnimation:E1,afterAnimation:q1})}function ep(){Fn.hide()}function k$(){const e=n("#fileInput")[0].files?.[0];if(e){if(e.type!=="text/plain"){f("File is not a text file",-1,{duration:5});return}const t=new FileReader;t.readAsText(e,"UTF-8"),t.onload=a=>{const o=a.target?.result;x.textarea=o,Vt(),n("#fileInput").val("")},t.onerror=()=>{f("Failed to read file",-1,{duration:5})}}}function Yc(){let e=x.textarea;return e===""?[]:(e=e.normalize().trim(),e=e.replace(/[\u2000-\u200A\u202F\u205F\u00A0]/g," "),x.removeZeroWidthCharactersEnabled&&(e=e.replace(/[\u200B-\u200D\u2060\uFEFF]/g,"")),x.replaceControlCharactersEnabled&&(e=f5(e)),e=e.replace(/ +/gm," "),e=e.replace(/( *(\r\n|\r|\n) *)/g,`
 `),x.removeFancyTypographyEnabled&&(e=Ey(e)),x.replaceNewlines!=="off"&&(x.replaceNewlines==="periodSpace"?(e=e.replace(/\n/gm,". "),e=e.replace(/\.\. /gm,". "),e=e.replace(/ +/gm," ")):(e=e.replace(/\n/gm," "),e=e.replace(/ +/gm," "))),e.split(x.customTextPipeDelimiter?"|":" ").filter(a=>a!==""))}function S$(){if(x.textarea===""){f("Text cannot be empty",0);return}if([x.customTextLimits.word,x.customTextLimits.time,x.customTextLimits.section].filter(t=>t!=="").length>1){f("You can only specify one limit",0,{duration:5});return}if(x.customTextMode!=="simple"&&x.customTextLimits.word===""&&x.customTextLimits.time===""&&x.customTextLimits.section===""){f("You need to specify a limit",0,{duration:5});return}(x.customTextLimits.section==="0"||x.customTextLimits.word==="0"||x.customTextLimits.time==="0")&&f("Infinite test! Make sure to use Bail Out from the command line to save your result.",0,{duration:7});const e=Yc();if(e.length===0){f("Text cannot be empty",0);return}x.customTextMode==="simple"?(ls("repeat"),x.customTextLimits.word=`${e.length}`,x.customTextLimits.time="",x.customTextLimits.section=""):ls(x.customTextMode),Ui(x.customTextPipeDelimiter),wo(e),x.customTextMode==="simple"&&x.customTextPipeDelimiter?(ya("section"),Ua(e.length)):x.customTextLimits.word!==""?(ya("word"),Ua(parseInt(x.customTextLimits.word))):x.customTextLimits.time!==""?(ya("time"),Ua(parseInt(x.customTextLimits.time))):x.customTextLimits.section!==""&&(ya("section"),Ua(parseInt(x.customTextLimits.section))),Sv(),te(),r.mode!=="custom"&&rt("custom"),fm(),R(),ep()}function x$(){let e=x.textarea.split(x.customTextPipeDelimiter?" ":"|").join(x.customTextPipeDelimiter?"|":" ");e=e.replace(/\n /g,`
`),x.textarea=e}async function T$(e){e.querySelector("#fileInput")?.addEventListener("change",k$);const t=e.querySelectorAll(".group[data-id='mode'] button");for(const o of t)o.addEventListener("click",i=>{if(x.customTextMode=i.target.value,x.customTextMode==="simple"){const s=Yc();x.customTextLimits.word=`${s.length}`,x.customTextLimits.time="",x.customTextLimits.section=""}Vt()});for(const o of e.querySelectorAll(".group[data-id='fancy'] button"))o.addEventListener("click",i=>{x.removeFancyTypographyEnabled=i.target.value==="true",Vt()});for(const o of e.querySelectorAll(".group[data-id='control'] button"))o.addEventListener("click",i=>{x.replaceControlCharactersEnabled=i.target.value==="true",Vt()});for(const o of e.querySelectorAll(".group[data-id='zeroWidth'] button"))o.addEventListener("click",i=>{x.removeZeroWidthCharactersEnabled=i.target.value==="true",Vt()});for(const o of e.querySelectorAll(".group[data-id='delimiter'] button"))o.addEventListener("click",i=>{x.customTextPipeDelimiter=i.target.value==="true",x.customTextPipeDelimiter&&x.customTextLimits.word!==""&&(x.customTextLimits.word=""),!x.customTextPipeDelimiter&&x.customTextLimits.section!==""&&(x.customTextLimits.section=""),x$(),Vt()});for(const o of e.querySelectorAll(".group[data-id='newlines'] button"))o.addEventListener("click",i=>{x.replaceNewlines=i.target.value,Vt()});e.querySelector(".group[data-id='limit'] input.words")?.addEventListener("input",o=>{x.customTextLimits.word=o.target.value,x.customTextLimits.time="",x.customTextLimits.section="",Vt()}),e.querySelector(".group[data-id='limit'] input.time")?.addEventListener("input",o=>{x.customTextLimits.time=o.target.value,x.customTextLimits.word="",x.customTextLimits.section="",Vt()}),e.querySelector(".group[data-id='limit'] input.sections")?.addEventListener("input",o=>{x.customTextLimits.section=o.target.value,x.customTextLimits.word="",x.customTextLimits.time="",Vt()});const a=e.querySelector("textarea");a?.addEventListener("input",o=>{x.textarea=o.target.value}),a?.addEventListener("keydown",o=>{if(o.key!=="Tab")return;o.preventDefault();const i=o.target,s=i.selectionStart,l=i.selectionEnd;i.value=i.value.substring(0,s)+"	"+i.value.substring(l),i.selectionStart=i.selectionEnd=s+1,x.textarea=i.value}),a?.addEventListener("keypress",o=>{if(x.longCustomTextWarning||x.challengeWarning){o.preventDefault();return}o.code==="Enter"&&o.ctrlKey&&n(`${j} .button.apply`).trigger("click"),Xa()&&om()!==""&&(oi("",void 0),x.longCustomTextWarning=!1,f("Disabled long custom text progress tracking",0,{duration:5}))}),e.querySelector(".button.apply")?.addEventListener("click",()=>{S$()}),e.querySelector(".button.wordfilter")?.addEventListener("click",()=>{YL({modalChain:Fn})}),e.querySelector(".button.customGenerator")?.addEventListener("click",()=>{t$({modalChain:Fn})}),e.querySelector(".button.showSavedTexts")?.addEventListener("click",()=>{b$({modalChain:Fn})}),e.querySelector(".button.saveCustomText")?.addEventListener("click",()=>{v$({modalChain:Fn,modalChainData:{text:Yc()}})}),e.querySelector(".longCustomTextWarning")?.addEventListener("click",()=>{x.longCustomTextWarning=!1,Vt()}),e.querySelector(".challengeWarning")?.addEventListener("click",()=>{x.challengeWarning=!1,Vt()})}const Fn=new re({dialogId:"customTextModal",setup:T$,customEscapeHandler:async()=>{ep()},customWrapperClickHandler:async()=>{ep()},showOptionsWhenInChain:{beforeAnimation:E1,afterAnimation:q1}}),Br="videoAdPopupWrapper";async function I1(){if(Ht(Br,"popups"),await Lm(),Rd){f("Looks like you're using an adblocker. Video ads will not work until you disable it.",0,{duration:6});return}if(await $m(),Ar){f("Looks like you're using a cookie popup blocker. Video ads will not work without giving your consent through the popup.",0,{duration:7});return}if(!xa(Br)){const e=document.querySelector("#videoAdPopupWrapper");W(e,{opacity:[0,1],duration:125,onBegin:()=>{e.classList.remove("hidden")},onComplete:()=>{window.dataLayer.push({event:"EG_Video"})}})}}function fb(){if(xa(Br)){const e=document.querySelector("#videoAdPopupWrapper");W(e,{opacity:[1,0],duration:125,onComplete:()=>{e.classList.add("hidden"),yt(Br)}})}}function L$(e){const t=e.event;t==="started"||(t==="finished"?fb():t==="empty"&&(f("Failed to load video ad. Please try again later",-1,{duration:3}),fb()))}n(".pageTest #watchVideoAdButton").on("click",()=>{I1()});Nt(Br);function F1(e){return n(`#shareTestSettingsModal label.${e} input`).prop("checked")}function P1(){const e=location.origin+"?testSettings=",t=new Array(8).fill(null),a=[{key:"mode",getValue:()=>r.mode},{key:"mode2",getValue:()=>rn(r,me)},{key:"customText",getValue:()=>Co()},{key:"punctuation",getValue:()=>r.punctuation},{key:"numbers",getValue:()=>r.numbers},{key:"language",getValue:()=>r.language},{key:"difficulty",getValue:()=>r.difficulty},{key:"funbox",getValue:()=>r.funbox}];for(const[s,{key:l,getValue:c}]of a.entries())F1(l)&&(t[s]=c());const o=Yb.compressToURI(JSON.stringify(t)),i=e+o;$$(i)}function $$(e){const t=n("#shareTestSettingsModal");t.find("textarea.url").val(e),t.find(".tooLongWarning").toggleClass("hidden",e.length<=2e3)}function B1(){F1("mode")?n("#shareTestSettingsModal .subgroup").removeClass("hidden"):n("#shareTestSettingsModal .subgroup").addClass("hidden")}function og(e){A$.show({...e,beforeAnimation:async()=>{P1(),B1()}})}async function M$(e){e.querySelector("textarea.url")?.addEventListener("click",async a=>{a.target.select()});const t=e.querySelectorAll("label input");for(const a of t)a.addEventListener("change",async()=>{P1(),B1()})}const A$=new re({dialogId:"shareTestSettingsModal",setup:M$});let pb=!1;async function _$(){if(!pb){for(const e of Yp)e!=="swiss_german"&&n("#quoteSubmitModal .newQuoteLanguage").append(`<option value="${e}">${e.replace(/_/g," ")}</option>`);pb=!0}}let tp;async function E$(){const e=n("#quoteSubmitModal .newQuoteText").val(),t=n("#quoteSubmitModal .newQuoteSource").val(),a=n("#quoteSubmitModal .newQuoteLanguage").val(),o=dl("submitQuote");if(!e||!t||!a){f("Please fill in all fields",0);return}Z();const i=await T.quotes.add({body:{text:e,source:t,language:a,captcha:o}});if(N(),i.status!==200){f("Failed to submit quote: "+i.body.message,-1);return}f("Quote submitted.",1),n("#quoteSubmitModal .newQuoteText").val(""),n("#quoteSubmitModal .newQuoteSource").val(""),To("submitQuote")}async function q$(e){if(!tn()){f("Could not show quote submit popup: Captcha is not available. This could happen due to a blocked or failed network request. Please refresh the page or contact support if this issue persists.",-1);return}R1.show({...e,mode:"dialog",focusFirstInput:!0,afterAnimation:async()=>{Is(document.querySelector("#quoteSubmitModal .g-recaptcha"),"submitQuote"),await _$(),tp=new Ge({select:"#quoteSubmitModal .newQuoteLanguage"}),n("#quoteSubmitModal .newQuoteLanguage").val(Wa(r.language)),n("#quoteSubmitModal .newQuoteLanguage").trigger("change"),n("#quoteSubmitModal input").val(""),new Ir(n("#quoteSubmitModal .newQuoteText"),250)}})}function I$(e){R1.hide({clearModalChain:e})}async function F$(e){e.querySelector("button")?.addEventListener("click",()=>{E$(),I$(!0)})}async function P$(){To("submitQuote"),tp?.destroy(),tp=void 0}const R1=new re({dialogId:"quoteSubmitModal",setup:F$,cleanup:P$});let si=[];function jd(){n("#quoteApproveModal .quotes").empty(),si.forEach((e,t)=>{const a=n(`
      <div class="quote" data-id="${t}" data-db-id="${e._id}">
        <textarea class="text">${e.text}</textarea>
        <input type="text" class="source" placeholder="Source" value="${e.source}">
        <div class="buttons">
          <button disabled class="textButton undo" aria-label="Undo changes" data-balloon-pos="left"><i class="fas fa-fw fa-undo-alt"></i></button>
          <button class="textButton refuse" aria-label="Refuse quote" data-balloon-pos="left"><i class="fas fa-fw fa-times"></i></button>
          <button class="textButton approve" aria-label="Approve quote" data-balloon-pos="left"><i class="fas fa-fw fa-check"></i></button>
          <button class="textButton edit hidden" aria-label="Edit and approve quote" data-balloon-pos="left"><i class="fas fa-fw fa-pen"></i></button>
        </div>
        <div class="bottom">
          <div class="length ${e.text.length<60?"red":""}"><i class="fas fa-fw fa-ruler"></i>${e.text.length}</div>
          <div class="language"><i class="fas fa-fw fa-globe-americas"></i>${e.language}</div>
          <div class="timestamp"><i class="fas fa-fw fa-calendar"></i>${J(new Date(e.timestamp),"dd MMM yyyy HH:mm")}</div>
        </div>
      </div>
    `);n("#quoteApproveModal .quotes").append(a),a.find(".source").on("input",()=>{n(`#quoteApproveModal .quote[data-id=${t}] .undo`).prop("disabled",!1),n(`#quoteApproveModal .quote[data-id=${t}] .approve`).addClass("hidden"),n(`#quoteApproveModal .quote[data-id=${t}] .edit`).removeClass("hidden")}),a.find(".text").on("input",()=>{n(`#quoteApproveModal .quote[data-id=${t}] .undo`).prop("disabled",!1),n(`#quoteApproveModal .quote[data-id=${t}] .approve`).addClass("hidden"),n(`#quoteApproveModal .quote[data-id=${t}] .edit`).removeClass("hidden"),D1(t)}),a.find(".undo").on("click",()=>{R$(t)}),a.find(".approve").on("click",()=>{D$(t,e._id)}),a.find(".refuse").on("click",()=>{W$(t,e._id)}),a.find(".edit").on("click",()=>{z$(t,e._id)})})}function D1(e){const t=n(`#quoteApproveModal .quote[data-id=${e}] .text`).val()?.length;n(`#quoteApproveModal .quote[data-id=${e}] .length`).html(`<i class="fas fa-fw fa-ruler"></i>${t}`),t<60?n(`#quoteApproveModal .quote[data-id=${e}] .length`).addClass("red"):n(`#quoteApproveModal .quote[data-id=${e}] .length`).removeClass("red")}async function W1(){Z();const e=await T.quotes.get();if(N(),e.status!==200){f("Failed to get new quotes: "+e.body.message,-1);return}si=e.body.data??[],jd()}async function B$(e){O$.show({...e,beforeAnimation:async()=>{si=[],W1()}})}function ig(e){const t=n(`#quoteApproveModal .quotes .quote[data-id=${e}]`);t.find("button").prop("disabled",!1),t.find(".edit").hasClass("hidden")&&t.find(".undo").prop("disabled",!0)}function R$(e){n(`#quoteApproveModal .quote[data-id=${e}] .text`).val(si[e]?.text??""),n(`#quoteApproveModal .quote[data-id=${e}] .source`).val(si[e]?.source??""),n(`#quoteApproveModal .quote[data-id=${e}] .undo`).prop("disabled",!0),n(`#quoteApproveModal .quote[data-id=${e}] .approve`).removeClass("hidden"),n(`#quoteApproveModal .quote[data-id=${e}] .edit`).addClass("hidden"),D1(e)}async function D$(e,t){if(!confirm("Are you sure?"))return;const a=n(`#quoteApproveModal .quotes .quote[data-id=${e}]`);a.find("button").prop("disabled",!0),a.find("textarea, input").prop("disabled",!0),Z();const o=await T.quotes.approveSubmission({body:{quoteId:t}});if(N(),o.status!==200){ig(e),a.find("textarea, input").prop("disabled",!1),f("Failed to approve quote: "+o.body.message,-1);return}f(`Quote approved. ${o.body.message??""}`,1),si.splice(e,1),jd()}async function W$(e,t){if(!confirm("Are you sure?"))return;const a=n(`#quoteApproveModal .quotes .quote[data-id=${e}]`);a.find("button").prop("disabled",!0),a.find("textarea, input").prop("disabled",!0),Z();const o=await T.quotes.rejectSubmission({body:{quoteId:t}});if(N(),o.status!==200){ig(e),a.find("textarea, input").prop("disabled",!1),f("Failed to refuse quote: "+o.body.message,-1);return}f("Quote refused.",1),si.splice(e,1),jd()}async function z$(e,t){if(!confirm("Are you sure?"))return;const a=n(`#quoteApproveModal .quote[data-id=${e}] .text`).val(),o=n(`#quoteApproveModal .quote[data-id=${e}] .source`).val(),i=n(`#quoteApproveModal .quotes .quote[data-id=${e}]`);i.find("button").prop("disabled",!0),i.find("textarea, input").prop("disabled",!0),Z();const s=await T.quotes.approveSubmission({body:{quoteId:t,editText:a,editSource:o}});if(N(),s.status!==200){ig(e),i.find("textarea, input").prop("disabled",!1),f("Failed to approve quote: "+s.body.message,-1);return}f(`Quote edited and approved. ${s.body.message??""}`,1),si.splice(e,1),jd()}async function H$(e){e.querySelector("button.refreshList")?.addEventListener("click",()=>{n("#quoteApproveModal .quotes").empty(),W1()})}const O$=new re({dialogId:"quoteApproveModal",setup:H$}),Vn={quoteToReport:void 0,reasonSelect:void 0};async function z1(e,t){if(!tn()){f("Could not show quote report popup: Captcha is not available. This could happen due to a blocked or failed network request. Please refresh the page or contact support if this issue persists.",-1);return}H1.show({mode:"dialog",...t,beforeAnimation:async()=>{Is(document.querySelector("#quoteReportModal .g-recaptcha"),"quoteReportModal");const a=r.language==="swiss_german"?"german":r.language,{quotes:o}=await ct.getQuotes(a);Vn.quoteToReport=o.find(i=>i.id===e),n("#quoteReportModal .quote").text(Vn.quoteToReport?.text),n("#quoteReportModal .reason").val("Grammatical error"),n("#quoteReportModal .comment").val(""),Vn.reasonSelect=new Ge({select:"#quoteReportModal .reason",settings:{showSearch:!1}}),new Ir(n("#quoteReportModal .comment"),250)}})}async function N$(e=!1){H1.hide({clearModalChain:e})}async function U$(){const e=dl("quoteReportModal");if(!e){f("Please complete the captcha");return}const t=Vn.quoteToReport?.id.toString(),a=Wa(r.language),o=n("#quoteReportModal .reason").val(),i=n("#quoteReportModal .comment").val(),s=e;if(t===void 0||t===""){f("Please select a quote");return}if(!o){f("Please select a valid report reason");return}if(!i){f("Please provide a comment");return}const l=i.length-250;if(l>0){f(`Report comment is ${l} character(s) too long`);return}Z();const c=await T.quotes.report({body:{quoteId:t,quoteLanguage:a,reason:o,comment:i,captcha:s}});if(N(),c.status!==200){f("Failed to report quote: "+c.body.message,-1);return}f("Report submitted. Thank you!",1),N$(!0)}async function V$(e){e.querySelector("button")?.addEventListener("click",async()=>{await U$()})}async function K$(){To("quoteReportModal"),Vn.reasonSelect?.destroy(),Vn.reasonSelect=void 0}const H1=new re({dialogId:"quoteReportModal",setup:V$,cleanup:K$}),j$={fuzzyMatchSensitivity:.2,scoreForSimilarMatch:.5,scoreForExactMatch:1};function G$(e,t){return t===0?0:Math.log10(e/t)}const mb=.4;function Q$(e,t){return mb+(1-mb)*(t.termFrequencies[e]/t.maxTermFrequency)}function gb(e){return e.match(/[^\\\][.,"/#!?$%^&*;:{}=\-_`~()\s]+/g)??[]}const Y$=(e,t,a=j$)=>{const o={},i={};e.forEach((c,d)=>{const u=gb(t(c)),p={id:d,termFrequencies:{},maxTermFrequency:0};let g=0;u.forEach(m=>{const h=qg(m);Object.hasOwn(i,h)||(i[h]=new Set),i[h]?.add(m),Object.hasOwn(o,h)||(o[h]=new Set),o[h]?.add(p),h in p.termFrequencies||(p.termFrequencies[h]=0),p.termFrequencies[h]++,g=Math.max(g,p.termFrequencies[h])}),p.maxTermFrequency=g});const s=Object.keys(o);return{query:c=>{const d={results:[],matchedQueryTerms:[]},u=new Set(gb(c).map(h=>qg(h)));if(u.size===0)return d;const p=new Map,g=new Set;u.forEach(h=>{s.forEach(y=>{const{similarity:C}=y2(h,y),M=y===h,w=C>=1-a.fuzzyMatchSensitivity;if(M||w){const F=o[y],I=G$(e.length,F.size);F.forEach(P=>{const U=p.get(P.id)??0,K=Q$(y,P),ne=M?a.scoreForExactMatch:0,_e=w?a.scoreForSimilarMatch:0,Pe=(ne+_e)*I*K;p.set(P.id,U+Pe)}),i[y]?.forEach(P=>{g.add(P)})}})});const m=[...p].sort((h,y)=>y[1]-h[1]).map(h=>e[h[0]]);return d.results=m,d.matchedQueryTerms=[...g],d}}},Cu={},ku=100;let Vo=1;function J$(e,t,a){if(e in Cu)return Cu[e];const o=Y$(t,a);return Cu[e]=o,o}function X$(e){if(!La.isOpen())return[];const t=n("#quoteSearchModal .quoteLengthFilter").val();if(t.length===0)return e;const a=new Set(t.map(i=>parseInt(i,10)));return e.filter(i=>a.has(i.group))}function Z$(e){if(!La.isOpen())return[];const t=document.querySelector(".toggleFavorites").classList.contains("active");return e.filter(o=>t?ct.isQuoteFavorite(o):!0)}function eM(e,t){let a;e.length<101?a="short":e.length<301?a="medium":e.length<601?a="long":a="thicc";const o=!A(),i=!o&&ct.isQuoteFavorite(e);return`
  <div class="searchResult" data-quote-id="${e.id}">

    <div class="text">
      ${ou(e.text,t)}
    </div>

    <div class="id">
      <div class="sub">id</div>
      <span class="quote-id">
        ${ou(e.id.toString(),t)}
      </span>
    </div>

    <div class="length">
      <div class="sub">length</div>
      ${a}
    </div>

    <div class="source">
      <div class="sub">source</div>
      ${ou(e.source,t)}
    </div>

    <div class="textButton report ${o&&"hidden"}" aria-label="Report quote" data-balloon-pos="left">
      <i class="fas fa-flag report"></i>
    </div>

    <div class="textButton favorite ${o&&"hidden"}" aria-label="Favorite quote" data-balloon-pos="left">
      <i class="${i?"fas":"far"} fa-heart favorite"></i>
    </div>

  </div>
  `}async function Jc(e){if(!La.isOpen())return;const{quotes:t}=await ct.getQuotes(r.language),a=J$(r.language,t,g=>`${g.text} ${g.id} ${g.source}`),{results:o,matchedQueryTerms:i}=a.query(e),s=X$(Z$(e===""?t:o)),l=n("#quoteSearchResults");l.empty();const c=Math.ceil(s.length/ku);if(Vo>=c?n("#quoteSearchPageNavigator .nextPage").prop("disabled",!0):n("#quoteSearchPageNavigator .nextPage").prop("disabled",!1),Vo<=1?n("#quoteSearchPageNavigator .prevPage").prop("disabled",!0):n("#quoteSearchPageNavigator .prevPage").prop("disabled",!1),s.length===0){n("#quoteSearchModal  .pageInfo").html("No search results");return}const d=(Vo-1)*ku,u=Math.min(Vo*ku,s.length);n("#quoteSearchModal  .pageInfo").html(`${d+1} - ${u} of ${s.length}`),s.slice(d,u).forEach(g=>{const m=eM(g,i);l.append(m)});const p=La.getModal().querySelectorAll(".searchResult");for(const g of p){const m=parseInt(g.dataset.quoteId);g.querySelector(".textButton.favorite")?.addEventListener("click",h=>{if(h.stopPropagation(),m===void 0||isNaN(m)){f("Could not toggle quote favorite: quote id is not a number",-1);return}oM(`${m}`)}),g.querySelector(".textButton.report")?.addEventListener("click",h=>{if(h.stopPropagation(),m===void 0||isNaN(m)){f("Could not open quote report modal: quote id is not a number",-1);return}z1(m,{modalChain:La})}),g.addEventListener("click",h=>{Sp(m),aM(m)})}}let ap;async function ng(e){La.show({...e,focusFirstInput:!0,beforeAnimation:async()=>{A()?(n("#quoteSearchModal .goToQuoteSubmit").removeClass("hidden"),n("#quoteSearchModal .toggleFavorites").removeClass("hidden")):(n("#quoteSearchModal .goToQuoteSubmit").addClass("hidden"),n("#quoteSearchModal .toggleFavorites").addClass("hidden"));const t=S()?.quoteMod;t!==void 0&&(t===!0||t!=="")?n("#quoteSearchModal .goToQuoteApprove").removeClass("hidden"):n("#quoteSearchModal .goToQuoteApprove").addClass("hidden"),ap=new Ge({select:"#quoteSearchModal .quoteLengthFilter",settings:{showSearch:!1,placeholderText:"filter by length",contentLocation:La.getModal()},data:[{text:"short",value:"0"},{text:"medium",value:"1"},{text:"long",value:"2"},{text:"thicc",value:"3"}]})},afterAnimation:async()=>{const t=n("#quoteSearchModal input").val();Vo=1,Jc(t)}})}function tM(e=!1){La.hide({clearModalChain:e})}function aM(e){if(isNaN(e)&&(e=parseInt(document.getElementById("searchBox").value)),e!==null&&!isNaN(e)&&e>=0)fd([-2],!1),Sp(e),te();else{f("Quote ID must be at least 1",0);return}R(),tM(!0)}const Su=Mt(250,()=>{if(!La.isOpen())return;const e=document.getElementById("searchBox").value;Vo=1,Jc(e)});async function oM(e){const t=r.language;if(t===void 0||e===""){f("Could not get quote stats!",-1);return}const a={language:t,id:parseInt(e,10)},o=ct.isQuoteFavorite(a),i=n(`#quoteSearchModal .searchResult[data-quote-id=${e}] .textButton.favorite i`);if(S())if(o)try{Z(),await ct.setQuoteFavorite(a,!1),N(),i.removeClass("fas").addClass("far")}catch(l){N();const c=ie(l,"Failed to remove quote from favorites");f(c,-1)}else try{Z(),await ct.setQuoteFavorite(a,!0),N(),i.removeClass("far").addClass("fas")}catch(l){N();const c=ie(l,"Failed to add quote to favorites");f(c,-1)}}async function iM(e){e.querySelector(".searchBox")?.addEventListener("input",t=>{Su()}),e.querySelector("button.toggleFavorites")?.addEventListener("click",t=>{A()&&(n(t.target).toggleClass("active"),Su())}),e.querySelector(".goToQuoteApprove")?.addEventListener("click",t=>{B$({modalChain:La})}),e.querySelector(".goToQuoteSubmit")?.addEventListener("click",async t=>{Z();const a=await T.quotes.isSubmissionEnabled(),o=(a.status===200&&a.body.data?.isEnabled)??!1;if(N(),!o){f("Quote submission is disabled temporarily due to a large submission queue.",0,{duration:5});return}q$({modalChain:La})}),e.querySelector(".quoteLengthFilter")?.addEventListener("change",Su),e.querySelector(".nextPage")?.addEventListener("click",()=>{const t=document.getElementById("searchBox").value;Vo++,Jc(t)}),e.querySelector(".prevPage")?.addEventListener("click",()=>{const t=document.getElementById("searchBox").value;Vo--,Jc(t)})}async function nM(){ap?.destroy(),ap=void 0}const La=new re({dialogId:"quoteSearchModal",setup:iM,cleanup:nM});let cc=0,op,ip,sg=!0;const xi=document.querySelector("#fpsCounter");function O1(e){if(sg)return;const t=e-ip;if(cc++,t>500){const a=H(cc*1e3/t).toFixed(2);cc=0,ip=e,lM(a)}window.requestAnimationFrame(O1)}function sM(){sg=!1,cc=0,ip=performance.now(),op||(op=window.requestAnimationFrame(O1)),xi.classList.remove("hidden")}function rM(){cancelAnimationFrame(op),sg=!0,xi.classList.add("hidden")}async function lM(e){xi.innerHTML=`FPS ${e}`;const t=parseFloat(e);xi.classList.remove("error"),xi.classList.remove("main"),t<30?xi.classList.add("error"):t>55&&xi.classList.add("main")}const rg=c0();rg.then(e=>{GL(e)}).catch(e=>{console.error(ie(e,"Failed to update challenges commands"))});const N1=Ee("language"),U1=Ee("difficulty"),V1=Ee("blindMode"),K1=Ee("oppositeShiftMode"),j1=Ee("stopOnError"),G1=Ee("confidenceMode"),Q1=Ee("lazyMode"),Y1=Ee("layout"),J1=Ee("showAverage"),X1=Ee("keymapLayout"),Z1=Ee("customTheme"),eC=Ee("ads"),tC=Ee("minWpm"),aC=Ee("minAcc"),oC=Ee("paceCaret"),lg={title:"",list:[...hL,Ee("punctuation"),Ee("numbers"),Ee("mode"),Ee("time"),Ee("words"),Ee("quoteLength"),N1,{id:"changeCustomModeText",display:"Change custom text",icon:"fa-align-left",exec:()=>{ag()}},{id:"viewQuoteSearchPopup",display:"Search for quotes",icon:"fa-search",exec:()=>{rt("quote"),ng()},shouldFocusTestUI:!1},...K9,...V9,{id:"shareTestSettings",display:"Share test settings",icon:"fa-share",exec:async()=>{og()}},...c1,...UL,...tw,...bi(U1,"quickRestart","repeatQuotes",V1,"alwaysShowWordsHistory","singleListCommandLine",tC,aC,...n0,"britishEnglish",...p1,"customLayoutfluid","customPolyglot"),...bi("freedomMode","strictSpace",K1,j1,G1,"quickEnd","indicateTypos","hideExtraLetters",Q1,Y1,"codeUnindentOnBackspace"),...bi("soundVolume","playSoundOnClick","playSoundOnError","playTimeWarning"),...bi("smoothCaret","caretStyle",oC,"repeatedPace","paceCaretStyle"),...bi("timerStyle","liveSpeedStyle","liveAccStyle","liveBurstStyle","timerColor","timerOpacity","highlightMode","tapeMode","tapeMargin","smoothLineScroll","showAllLines","typingSpeedUnit","alwaysShowDecimalPlaces","startGraphsAtZero","maxLineWidth","fontSize",...ML,"keymapMode","keymapStyle","keymapLegendStyle","keymapSize",X1,"keymapShowTopRow"),...bi(...h1,Z1,...FL,"flipTestColors","colorfulMode",...EL,...$L,"customBackgroundSize",..._L,"randomTheme"),{id:"randomizeTheme",display:"Next random theme",icon:"fa-random",exec:async()=>rv(),available:()=>r.randomTheme!=="off"},...bi("showKeyTips","showOutOfFocusWarning","capsLockWarning",J1,"monkeyPowerLevel","monkey"),eC,...y1,...uL,{id:"watchVideoAd",display:"Watch video ad",alias:"support donate",icon:"fa-ad",exec:()=>{I1()}},{id:"importSettingsJSON",display:"Import settings JSON",icon:"fa-cog",alias:"import config",input:!0,exec:async({input:e})=>{e===void 0||e===""||await zy(e)}},{id:"exportSettingsJSON",display:"Export settings JSON",icon:"fa-cog",alias:"export config",input:!0,defaultValue:()=>JSON.stringify(r)},{id:"clearNotifications",display:"Clear all notifications",icon:"fa-trash-alt",alias:"dismiss",exec:async()=>{J2()}},{id:"clearSwCache",display:"Clear SW cache",icon:"fa-cog",exec:async()=>{const e=await caches.keys();for(const t of e)await caches.delete(t);window.location.reload()}},{id:"getSwCache",display:"Get SW cache",icon:"fa-cog",exec:async()=>{alert(await caches.keys())}},{id:"copyResultStats",display:"Copy result stats",icon:"fa-cog",visible:!1,exec:async()=>{navigator.clipboard.writeText(JSON.stringify(z0())).then(()=>{f("Copied to clipboard",1)}).catch(e=>{const t=ie(e,"Failed to copy to clipboard");f(t,-1)})}},{id:"fpsCounter",display:"FPS counter...",icon:"fa-cog",visible:!1,subgroup:{title:"FPS counter...",list:[{id:"startFpsCounter",display:"show",icon:"fa-cog",exec:()=>{sM()}},{id:"stopFpsCounter",display:"hide",icon:"fa-cog",exec:()=>{rM()}}]}},{id:"joinDiscord",display:"Join the Discord server",icon:"fa-users",exec:()=>{window.open("https://discord.gg/monkeytype")}}]},iC={keymapLayouts:X1.subgroup,enableAds:eC.subgroup,customThemesList:Z1.subgroup,themes:h1[0]?.subgroup,loadChallenge:y1[0]?.subgroup,languages:N1.subgroup,difficulty:U1.subgroup,lazyMode:Q1.subgroup,paceCaretMode:oC.subgroup,showAverage:J1.subgroup,minWpm:tC.subgroup,minAcc:aC.subgroup,minBurst:n0[0]?.subgroup,funbox:p1[0]?.subgroup,confidenceMode:G1.subgroup,stopOnError:j1.subgroup,layouts:Y1.subgroup,oppositeShiftMode:K1.subgroup,tags:c1[0]?.subgroup,resultSaving:tw[0]?.subgroup,blindMode:V1.subgroup};function cM(e){return iC[e]!==void 0}async function dM(e){await Promise.allSettled([rg]);const t=iC[e];if(!t)throw f(`List not found: ${e}`,-1),new Error(`List ${e} not found`);return t}let an=[];an=[lg];function uM(){return an.length}function fM(){pM([lg])}function pM(e){an=e}function mM(e){an.push(e)}function gM(){an.pop()}function hM(){return an[an.length-1]}let hb;async function bM(){await Promise.allSettled([rg]);const e=[];for(const t of lg.list){const a=nC(t);e.push(...a)}return hb={title:"",list:e},hb}function nC(e,t){const a=[];if(e.subgroup){e.subgroup.beforeList&&e.subgroup.beforeList();const o={...e,subgroup:{...e.subgroup,list:[]}};for(const i of e.subgroup.list)a.push(...nC(i,o))}else if(t){const o=t.display.replace(/\s?\.\.\.$/g,""),i=o+'<i class="fas fa-fw fa-chevron-right chevronIcon"></i>'+e.display,s=o+" "+e.display;let l;((t.alias??"")||(e.alias??""))&&(l=[t.alias,e.alias].filter(Boolean).join(" "));const c={...e,singleListDisplay:i,singleListDisplayNoIcon:s,configKey:t.subgroup?.configKey,icon:t.icon,alias:l,visible:(t.visible??!0)&&(e.visible??!0),available:async()=>(await t?.available?.()??!0)&&(await e?.available?.()??!0)};a.push(c)}else a.push(e);return a}function bi(...e){return e.map(t=>typeof t=="string"?Ee(t):t)}let Lt=0,Bt=!1,Qt="",Xc=null,Pn=!1,bo="search",xe={command:null,placeholder:"",value:"",icon:""},Ko=null,Rr=!1,np="",Ys;function yM(){n("#commandLine").addClass("noBackground"),r.showOutOfFocusWarning&&$s()}function sp(){n("#commandLine").removeClass("noBackground");const e=n("#wordsInput").is(":focus");r.showOutOfFocusWarning&&!e&&r0()}function un(e,t){ra.show({...t,focusFirstInput:!0,beforeAnimation:async()=>{Pn=!1,Qt="",Lt=0,bo="search",dc=null,xe={command:null,placeholder:null,value:null,icon:null},e?.subgroupOverride!==void 0?(typeof e.subgroupOverride=="string"?cM(e.subgroupOverride)?(Z(),Ko=await dM(e.subgroupOverride),N()):(Ko=null,Bt=r.singleListCommandLine==="on",f(`Command list ${e.subgroupOverride} not found`,0)):Ko=e.subgroupOverride,Bt=!1):(Ko=null,Bt=r.singleListCommandLine==="on");let a;if(e?.commandOverride!==void 0){const o=(await Yd()).find(i=>i.id===e.commandOverride);o===void 0?f(`Command ${e.commandOverride} not found`,0):o?.input!==!0?f(`Command ${e.commandOverride} is not an input command`,0):a=o}e?.singleListOverride&&(Bt=e.singleListOverride),Xc=null,_a(!1),fM(),await sn(),await on(),await nn(),await ka(),setTimeout(()=>{if(sC(),a){const o=a.display.split("</i>")[1]??a.display;bo="input",xe={command:a,placeholder:o,value:a.defaultValue?.()??"",icon:a.icon??"fa-chevron-right"},lC(a),sn(xe.value),cg()}},1)}})}function Gd(e=!1){Nf(),xr(),X()==="test"&&Ki(),Rr=!0,ra.hide({clearModalChain:e,afterAnimation:async()=>{if(Zc(),sp(),X()==="test"){const t=n("#wordsInput").is(":focus");X()==="test"&&!t&&Ki()}else document.activeElement?.blur();Rr=!1}})}async function vM(){if(bo==="input"){bo="search",xe={command:null,placeholder:null,value:null,icon:null},await sn(""),await on(),await nn(),await ka(),Zc();return}uM()>1?(gM(),Lt=0,await sn(""),await on(),await nn(),await ka(),Zc()):Gd()}async function on(){const e=await Qd();e.beforeList?.();const t=e.list,a=Qt.replace(/^>/gi,"").toLowerCase().trim(),o=a.length===0?[]:a.split(" "),i=[],s=[];for(const d of t){if(!(await d.available?.()??!0)){i.push({matchCount:-1,matchStrength:-1});continue}if(a.length===0||o.length===0){i.push({matchCount:0,matchStrength:0});continue}const p=(Bt&&(d.singleListDisplayNoIcon??"")||d.display).toLowerCase().split(" "),g=d.alias?.toLowerCase().split(" ")??[],m=p.concat(g),h=m.map(()=>null);let y=0;for(const[M,w]of o.entries())for(const[F,I]of m.entries()){const P=h[F];I.startsWith(w)&&P===null&&!h.includes(M)&&(h[F]=M,y+=w.length)}const C=h.filter(M=>M!==null).length;s.push(C),i.push({matchCount:C,matchStrength:y})}const l=Math.max(...i.map(d=>d.matchStrength));let c=o.length;do{if(s.filter(u=>u>=c).length>0)break;c--}while(c>0);c===0&&(c=1);for(const[d,u]of t.entries()){const p=i[d];if(p===void 0){u.found=!1;continue}p.matchCount>=c&&p.matchStrength>=l?u.found=!0:u.found=!1}}function cg(){const e=document.querySelector("#commandLine .suggestions");if(e===null)throw new Error("Commandline element not found");e.innerHTML="",Ys=void 0}let dc=null;async function Qd(){if(Ko!==null)return Ko;if(Bt)if(dc===null)dc=await bM();else return dc;return hM()}async function Yd(){return(await Qd()).list}function wM(e){let t='<i class="fas fa-fw fa-chevron-right"></i>';if(e.icon!==void 0&&e.icon!==""){const o=e.icon.startsWith("fa-"),s=(e.iconType??"solid")==="solid"?"fas":"far";o?t=`<i class="${s} fa-fw ${e.icon}"></i>`:t=`<div class="textIcon">${e.icon}</div>`}let a='<i class="fas fa-fw"></i>';return e.isActive&&(a='<i class="fas fa-fw fa-check"></i>'),{iconHtml:t,configIconHtml:a}}async function nn(){const e=document.querySelector("#commandLine .suggestions");if(e===null)throw new Error("Commandline element not found");if(Qt===""&&Bt){cg();return}const t=await Qd(),a=t.list.filter(s=>s.found===!0).map(s=>{let l=!1;if(s.active!==void 0)l=s.active();else{const c=s.configKey??t.configKey;c!==void 0&&(s.configValueMode==="include"?Array.isArray(s.configValue)?l=ri(Rb(r[c],s.configValue),s.configValue):l=r[c].includes(s.configValue):l=r[c]===s.configValue)}return{...s,isActive:l}});if(Ys&&Bt===Ys.usingSingleList&&ur(a,Ys.list))return;Ys={list:a,usingSingleList:Bt};let o="",i=0;for(const s of a){if(s.found!==!0)continue;let l="";s.customStyle!==void 0&&s.customStyle!==""&&(l=s.customStyle);const{iconHtml:c,configIconHtml:d}=wM(s);let u=s.display;Bt&&(u=(s.singleListDisplay??"")||s.display,(s.configValue!==void 0||s.active!==void 0)&&(u=u.replace('<i class="fas fa-fw fa-chevron-right chevronIcon"></i>','<i class="fas fa-fw fa-chevron-right chevronIcon"></i>'+d)));let p=c;if((!Bt&&s.subgroup===void 0&&s.configValue!==void 0||!Bt&&s.active!==void 0)&&(p=d),s.customData!==void 0){if(s.id.startsWith("changeTheme")&&(o+=`<div class="command changeThemeCommand" data-command-id="${s.id}" data-index="${i}" style="${l}">
      <div class="icon">${p}</div><div>${u}</div>
      <div class="themeFavIcon ${s.customData.isFavorite===!0?"":"hidden"}">
        <i class="fas fa-star"></i>
      </div>
      <div class="themeBubbles" style="background: ${s.customData.bgColor};outline: 0.25rem solid ${s.customData.bgColor};">
        <div class="themeBubble" style="background: ${s.customData.mainColor}"></div>
        <div class="themeBubble" style="background: ${s.customData.subColor}"></div>
        <div class="themeBubble" style="background: ${s.customData.textColor}"></div>
      </div>
      </div>`),s.id.startsWith("setFontFamily")){let g=s.customData.name;g==="Helvetica"&&(g="Comic Sans MS"),s.customData.isSystem===!1&&(g+=" Preview"),o+=`<div class="command" data-command-id="${s.id}" data-index="${i}" style="font-family: '${g}'"><div class="icon">${p}</div><div>${u}</div></div>`}}else o+=`<div class="command" data-command-id="${s.id}" data-index="${i}" style="${l}"><div class="icon">${p}</div><div>${u}</div></div>`;i++}e.innerHTML=o}async function ka(){if(Rr)return;const e=[...document.querySelectorAll("#commandLine .suggestions .command")];for(const o of e)o.classList.remove("active");const t=e[Lt],a=(await Yd()).filter(o=>o.found)[Lt];if(Xc=a??null,t===void 0||a===void 0){Nf(),xr(!1),sp();return}t.classList.add("active"),sC(),Nf(),a.id?.startsWith("changeTheme")||a.id?.startsWith("setCustomThemeId")?yM():(xr(),sp()),a.hover?.()}let xu;function CM(){if(!Rr){if(xe.command===null)throw new Error("Can't handle input submit - command is null");if(xe.validation?.status!=="checking"){if(xe.validation?.status==="failed"){ra.getModal().classList.add("hasError"),xu!==null&&clearTimeout(xu),xu=setTimeout(()=>{ra.getModal().classList.remove("hasError")},500);return}"inputValueConvert"in xe.command?xe.command.exec?.({commandlineModal:ra,input:xe.command.inputValueConvert(Qt)}):xe.command.exec?.({commandlineModal:ra,input:Qt}),Ji("usedCommandLine",{command:xe.command.id}),Gd()}}}async function bb(){if(Rr||Xc===null)return;const e=Xc;if(e.input){const t=e.display.split("</i>")[1]??e.display;bo="input",xe={command:e,placeholder:t,value:e.defaultValue?.()??"",icon:e.icon??"fa-chevron-right"},lC(e),await sn(xe.value),cg()}else e.subgroup?(mM(e.subgroup),await sn(""),await on(),await nn(),await ka()):(e.exec?.({commandlineModal:ra}),r.singleListCommandLine==="on"&&(np=Qt),e.sticky??!1?(await on(),await nn(),await ka()):(Ji("usedCommandLine",{command:e.id}),e.opensModal||Gd(!0)))}let yb;function sC(){if(Pn)return;const e=document.querySelector(".suggestions .command.active");e===null||e.dataset.index===yb||(e.scrollIntoView({behavior:"auto",block:"center"}),yb=e.dataset.index)}async function sn(e){const t=document.querySelector("#commandLine .searchicon"),a=document.querySelector("#commandLine input");if(a===null||t===null)throw new Error("Commandline element or icon element not found");if(e!==void 0&&(Qt=e),a.value=Qt,bo==="input")xe.icon!==null&&(t.innerHTML=`<i class="fas fa-fw ${xe.icon}"></i>`),xe.placeholder!==null&&(a.placeholder=xe.placeholder),xe.value!==null&&(a.value=xe.value,a.setSelectionRange(0,a.value.length));else{t.innerHTML='<i class="fas fa-fw fa-search"></i>',a.placeholder="Search...";const o=await Qd();o.title!==void 0&&o.title!==""&&(a.placeholder=`${o.title}`);let i=Qt.length;e!==void 0&&(i=e.length),setTimeout(()=>{a.setSelectionRange(i,i)},0)}}async function vb(){Lt++,Lt>=(await Yd()).filter(e=>e.found).length&&(Lt=0),await ka()}async function wb(){Lt--,Lt<0&&(Lt=(await Yd()).filter(e=>e.found).length-1),await ka()}function kM(e){const t=ra.getModal().querySelector(".warning"),a=ra.getModal().querySelector(".warning .text");if(t===null||a===null)throw new Error("Commandline warning element not found");t.classList.remove("hidden"),a.textContent=e}const rC=Mt(200,async()=>{const e=ra.getModal().querySelector(".checkingicon");if(e===null)throw new Error("Commandline checking icon element not found");e.classList.remove("hidden")});function Cb(){rC.cancel({upcomingOnly:!0});const e=ra.getModal().querySelector(".checkingicon");if(e===null)throw new Error("Commandline checking icon element not found");e.classList.add("hidden")}function Zc(){const e=ra.getModal().querySelector(".warning");if(e===null)throw new Error("Commandline warning element not found");e.classList.add("hidden")}function SM(e){xe.validation=e,e.status==="checking"?rC():e.status==="failed"&&e.errorMessage!==void 0?(kM(e.errorMessage),Cb()):(Zc(),Cb())}const rp=new Map;function lC(e){if("validation"in e&&!rp.has(e.id)){const t=e,a=aw(SM,t.validation,"inputValueConvert"in t?t.inputValueConvert:void 0);rp.set(e.id,a)}}const ra=new re({dialogId:"commandLine",customEscapeHandler:()=>{},customWrapperClickHandler:()=>{Gd()},showOptionsWhenInChain:{focusFirstInput:!0},setup:async e=>{const t=e.querySelector("input");t.addEventListener("input",Mt(50,async i=>{Qt=i.target.value,Ko===null&&(r.singleListCommandLine==="on"?Bt=!0:Bt=Qt.startsWith(">")),bo==="search"&&(Pn=!1,Lt=0,await on(),await nn(),await ka())})),t.addEventListener("keydown",async i=>{if(Pn=!1,i.key==="ArrowUp"||i.ctrlKey&&(i.key.toLowerCase()==="k"||i.key.toLowerCase()==="p")){if(r.singleListCommandLine==="on"&&Ko===null&&Qt===""&&np!==""){Qt=np,await sn(),await on(),await nn(),await ka();return}i.preventDefault(),await wb()}if((i.key==="ArrowDown"||i.ctrlKey&&(i.key.toLowerCase()==="j"||i.key.toLowerCase()==="n"))&&(i.preventDefault(),await vb()),i.key==="Tab"&&(i.preventDefault(),i.shiftKey?await wb():await vb()),i.key==="Enter")if(i.preventDefault(),bo==="search")await bb();else if(bo==="input")CM();else throw new Error("Unknown mode, can't handle enter press");i.key==="Escape"&&(i.preventDefault(),i.stopPropagation(),await vM())}),t.addEventListener("input",async i=>{if(xe===null||xe.command===null||!("validation"in xe.command))return;const s=rp.get(xe.command.id);if(s===void 0)throw new Error(`Expected handler for command ${xe.command.id} is missing`);await s(i)}),e.addEventListener("mousemove",i=>{Pn=!0});const a=document.querySelector(".suggestions");let o;a.addEventListener("mousemove",async i=>{Pn=!0;const s=i.target;if(s===o)return;const l=Bg(s?.getAttribute("data-index"));l!==void 0&&(o=i.target,Lt=l,await ka())}),a.addEventListener("click",async i=>{const s=i.target,l=Bg(s?.getAttribute("data-index"));if(l===void 0)return;const c=Lt;Lt=l,c!==Lt&&await ka(),await bb()})}});document.addEventListener("keydown",async e=>{zi()||e.key!==void 0&&(e.key==="Escape"&&r.quickRestart!=="esc"||e.key==="Tab"&&r.quickRestart==="esc"&&!br&&!e.shiftKey||e.key==="Tab"&&r.quickRestart==="esc"&&br&&e.shiftKey||e.key.toLowerCase()==="p"&&(e.metaKey||e.ctrlKey)&&e.shiftKey)&&(e.preventDefault(),id()||un())});window.addEventListener("keydown",function(e){e.code==="Space"&&(e.target===document.body||e.target?.id==="result")&&e.preventDefault()});window.onerror=function(e,t,a,o,i){};window.onunhandledrejection=function(e){};function cC(){dC.show()}const dC=new re({dialogId:"supportModal",setup:async e=>{e.querySelector("button.ads")?.addEventListener("click",async()=>{un({subgroupOverride:"enableAds"},{modalChain:dC})})}});function uC(){xM.show()}const xM=new re({dialogId:"contactModal"});function TM(){LM.show({beforeAnimation:async()=>{n("#versionHistoryModal .modal").html(`
    <div class="preloader">
      <i class="fas fa-fw fa-spin fa-circle-notch"></i>
    </div
  `),fx().then(e=>{n("#versionHistoryModal .modal").html('<div class="releases"></div'),e.forEach(t=>{if(!t.draft&&!t.prerelease){let a=t.body;a=a.replace(/\r\n/g,"<br>"),a=a.replace(/### (.*?)<br>/g,"<h3>$1</h3>"),a=a.replace(/<\/h3><br>/gi,"</h3>"),a=a.replace(/^- /gm,""),a=a.replace(/\*\*(.*?)\*\*/g,"<b>$1</b>"),a=a.replace(/\[(.*?)\]\((.*?)\)/g,'<a href="$2" target="_blank">$1</a>'),n("#versionHistoryModal .modal .releases").append(`
        <div class="release">
          <div class="title">${t.name}</div>
          <div class="date">${J(new Date(t.published_at),"dd MMM yyyy")}</div>
          <div class="body">${a}</div>
        </div>
      `)}})}).catch(e=>{const t=ie(e,"Failed to fetch version history");n("#versionHistoryModal .modal").html(`<div class="releases">${t}</div`)}),n("#newVersionIndicator").addClass("hidden")}})}const LM=new re({dialogId:"versionHistoryModal"});document.querySelector("footer #commandLineMobileButton")?.addEventListener("click",async()=>{un({singleListOverride:!1})});document.querySelector("footer #newVersionIndicator")?.addEventListener("click",e=>{e.stopPropagation(),document.querySelector("#newVersionIndicator")?.classList.add("hidden")});document.querySelector("footer .currentVersion")?.addEventListener("click",e=>{e.shiftKey?alert(JSON.stringify({clientVersion:ks.clientVersion,clientCompatibility:qu,lastSeenServerCompatibility:sy},null,2)):TM()});document.querySelector("footer .right .current-theme")?.addEventListener("click",async e=>{if(e.shiftKey){if(r.customTheme){mo(!1);return}if(A()&&(S()?.customThemes?.length??0)<1){f("No custom themes!",0),mo(!1);return}mo(!0)}else{const a=r.customTheme?"customThemesList":"themes";un({subgroupOverride:a})}});document.querySelector("footer #supportMeButton")?.addEventListener("click",()=>{cC()});document.querySelector("footer #contactPopupButton")?.addEventListener("click",()=>{uC()});n("#keymap").on("click",".r5 .layoutIndicator",async()=>{un({subgroupOverride:"keymapLayouts"})});function fC(e){dg.show({...e,focusFirstInput:"focusAndSelect",beforeAnimation:async t=>{t.querySelector("input").value=`${r.words}`}})}function $M(e=!1){dg.hide({clearModalChain:e})}function MM(){const e=parseInt(dg.getModal().querySelector("input")?.value,10);e!==null&&!isNaN(e)&&e>=0&&isFinite(e)?Oi(e)&&(te(),R(),e>2e3?f("Stay safe and take breaks!",0):e===0&&f("Infinite words! Make sure to use Bail Out from the command line to save your result.",0,{duration:7})):f("Custom word amount must be at least 1",0),$M(!0)}const dg=new re({dialogId:"customWordAmountModal",setup:async e=>{e.addEventListener("submit",t=>{t.preventDefault(),MM()})}}),qe={resultId:"",startingTags:[],tags:[],source:"accountPage"};function pC(e,t,a){if(!Xe()){f("You are offline",0,{duration:2});return}if(e===""){f("Failed to show edit result tags modal: result id is empty",-1);return}qe.resultId=e,qe.startingTags=[...t],qe.tags=[...t],qe.source=a,ug.show({beforeAnimation:async()=>{AM(),mC()}})}function kb(){ug.hide()}function AM(){const e=ug.getModal().querySelector(".buttons");if(e===null){f("Failed to append buttons to edit result tags modal: could not find buttons element",-1);return}const t=new Set([...S()?.tags.map(a=>a._id)??[],...qe.tags]);e.innerHTML="";for(const a of t){const o=S()?.tags.find(s=>s._id===a),i=document.createElement("button");i.classList.add("toggleTag"),i.setAttribute("data-tag-id",a),i.innerHTML=o?.display??"unknown tag",i.addEventListener("click",s=>{_M(a),mC()}),e.appendChild(i)}}function mC(){for(const e of n("#editResultTagsModal .modal .buttons button")){const t=n(e).attr("data-tag-id")??"";qe.tags.includes(t)?n(e).addClass("active"):n(e).removeClass("active")}}function _M(e){qe.tags.includes(e)?qe.tags=qe.tags.filter(t=>t!==e):qe.tags.push(e)}async function EM(){Z();const e=await T.results.updateTags({body:{resultId:qe.resultId,tagIds:qe.tags}});if(N(),qe.tags=qe.tags.filter(a=>a!==void 0),e.status!==200){f("Failed to update result tags: "+e.body.message,-1);return}const t=e.body.data?.tagPbs??[];f("Tags updated",1,{duration:2}),S()?.results?.forEach(a=>{a._id===qe.resultId&&(a.tags=qe.tags)}),qe.source==="accountPage"?U7(qe.resultId,qe.tags):qe.source==="resultPage"&&Z8(qe.tags,t)}const ug=new re({dialogId:"editResultTagsModal",setup:async e=>{e.querySelector("button.saveButton")?.addEventListener("click",t=>{if(ri(qe.startingTags,qe.tags)){kb();return}kb(),EM()})}});function gC(e){const t=/((-\s*)?\d+(\.\d+)?\s*[hms]?)/g,a=[...e.toLowerCase().matchAll(t)].map(o=>{const i=o[0],s=parseFloat(i.replace(/\s+/g,""));return i.includes("h")?3600*s:i.includes("m")?60*s:s}).reduce((o,i)=>o+i,0);return Math.floor(a)}function qM(e){const t=Math.floor(e/3600),a=Math.floor(e%3600/60),o=e%3600%60,i=[];return t>0&&i.push(`${t} hour${t===1?"":"s"}`),a>0&&i.push(`${a} minute${a===1?"":"s"}`),o>0&&i.push(`${o} second${o===1?"":"s"}`),i.length===3?`${i[0]}, ${i[1]} and ${i[2]}`:i.length===2?`${i[0]} and ${i[1]}`:`${i[0]}`}function hC(){const e=n("#customTestDurationModal input").val(),t=gC(e);let a="";t<0?a="Negative time? Really?":t===0?a="Infinite test":a=qM(t),n("#customTestDurationModal .preview").text(a)}function bC(e){yC.show({...e,focusFirstInput:"focusAndSelect",beforeAnimation:async t=>{t.querySelector("input").value=`${r.time}`,hC()}})}function IM(e=!1){yC.hide({clearModalChain:e})}function FM(){const e=gC(n("#customTestDurationModal input").val());if(e!==null&&!isNaN(e)&&e>=0&&isFinite(e))uo(e),te(),R(),e>=1800?f("Stay safe and take breaks!",0):e===0&&f("Infinite time! Make sure to use Bail Out from the command line to save your result.",0,{duration:7});else{f("Custom time must be a positive number or zero",0);return}IM(!0)}async function PM(e){e.addEventListener("submit",t=>{t.preventDefault(),FM()}),e.querySelector("input")?.addEventListener("input",t=>{hC()})}const yC=new re({dialogId:"customTestDurationModal",setup:PM});function vC(){const e=n("#mobileTestConfigModal");if(e.find("button").removeClass("active"),e.find(`.modeGroup button[data-mode='${r.mode}']`).addClass("active"),e.find(".timeGroup").addClass("hidden"),e.find(".wordsGroup").addClass("hidden"),e.find(".quoteGroup").addClass("hidden"),e.find(".customGroup").addClass("hidden"),e.find(`.${r.mode}Group`).removeClass("hidden"),r.punctuation?e.find(".punctuation").addClass("active"):e.find(".punctuation").removeClass("active"),r.numbers?e.find(".numbers").addClass("active"):e.find(".numbers").removeClass("active"),r.mode==="time")e.find(`.timeGroup button[data-time='${r.time}']`).addClass("active"),e.find(".punctuation").removeClass("disabled"),e.find(".numbers").removeClass("disabled");else if(r.mode==="words")e.find(`.wordsGroup button[data-words='${r.words}']`).addClass("active"),e.find(".punctuation").removeClass("disabled"),e.find(".numbers").removeClass("disabled");else if(r.mode==="quote"){if(ri(r.quoteLength,[0,1,2,3]))e.find(".quoteGroup button[data-quoteLength='all']").addClass("active");else for(const t of r.quoteLength)e.find(`.quoteGroup button[data-quoteLength='${t}']`).addClass("active");e.find(".punctuation").addClass("disabled"),e.find(".numbers").addClass("disabled")}else r.mode==="zen"?(e.find(".punctuation").addClass("disabled"),e.find(".numbers").addClass("disabled")):r.mode==="custom"&&(e.find(".punctuation").removeClass("disabled"),e.find(".numbers").removeClass("disabled"))}function BM(){$n.show({beforeAnimation:async()=>{vC()}})}async function RM(e){const t=e.querySelectorAll(".wordsGroup button");for(const l of t)l.addEventListener("click",c=>{const u=c.currentTarget.getAttribute("data-words");if(u==="custom")fC({modalChain:$n});else if(u!==void 0){const p=parseInt(u);Oi(p),te(),R()}});const a=e.querySelectorAll(".modeGroup button");for(const l of a)l.addEventListener("click",c=>{const u=c.currentTarget.getAttribute("data-mode");u!==r.mode&&(rt(u),te(),R())});const o=e.querySelectorAll(".timeGroup button");for(const l of o)l.addEventListener("click",c=>{const u=c.currentTarget.getAttribute("data-time");if(u==="custom")bC({modalChain:$n});else if(u!==void 0){const p=parseInt(u);uo(p),te(),R()}});const i=e.querySelectorAll(".quoteGroup button");for(const l of i)l.addEventListener("click",c=>{const u=c.currentTarget.getAttribute("data-quoteLength")??"0";if(u==="all")zn()&&(te(),R());else if(u==="-2")ng({modalChain:$n});else{const p=parseInt(u,10);let g=[];c.shiftKey?g=[...r.quoteLength,p]:g=[p],fd(g,!1)&&(te(),R())}});e.querySelector(".customChange")?.addEventListener("click",()=>{ag({modalChain:$n})}),e.querySelector(".punctuation")?.addEventListener("click",()=>{ei(!r.punctuation),te(),R()}),e.querySelector(".numbers")?.addEventListener("click",()=>{po(!r.numbers),te(),R()}),e.querySelector(".shareButton")?.addEventListener("click",()=>{og({modalChain:$n})});const s=e.querySelectorAll("button");for(const l of s)l.addEventListener("click",()=>{vC()})}const $n=new re({dialogId:"mobileTestConfigModal",setup:RM});n(".pageTest").on("click","#testModesNotice .textButton",async e=>{const t=n(e.currentTarget).attr("commands");t!==void 0&&un({subgroupOverride:t})});n(".pageTest").on("click","#testModesNotice .textButton",async e=>{const t=n(e.currentTarget).attr("commandId");t!==void 0&&un({commandOverride:t})});n(".pageTest").on("click","#testConfig .wordCount .textButton",e=>{n(e.currentTarget).attr("wordCount")==="custom"&&fC()});n(".pageTest").on("click","#testConfig .time .textButton",e=>{n(e.currentTarget).attr("timeconfig")==="custom"&&bC()});n(".pageTest").on("click","#testConfig .shareButton",e=>{og()});n(".pageTest").on("click",".tags .editTagsButton",()=>{if((S()?.tags?.length??0)>0){const e=n(".pageTest .tags .editTagsButton").attr("data-result-id"),t=n(".pageTest .tags .editTagsButton").attr("data-active-tag-ids"),a=t===""?[]:t.split(",");pC(e,a,"resultPage")}});n(".pageTest").on("click","#mobileTestConfigButton",()=>{BM()});n(".pageTest #rateQuoteButton").on("click",async()=>{if(me===null){f("Failed to show quote rating popup: no quote",-1);return}s8(me)});n(".pageTest #reportQuoteButton").on("click",async()=>{if(me===null){f("Failed to show quote report popup: no quote",-1);return}z1(me?.id)});n(".pageTest").on("click","#testConfig .quoteLength .textButton",e=>{parseInt(n(e.currentTarget).attr("quoteLength")??"0")===-2&&ng()});n(".pageTest").on("click","#testConfig .customText .textButton",()=>{ag()});n(".pageTest").on("click","#practiseWordsButton",()=>{if(r.mode==="zen"){f("Practice words is unsupported in zen mode",0);return}a1()});n(".pageTest #dailyLeaderboardRank").on("click",async()=>{Ie(`/leaderboards?type=daily&language=${r.language}&mode2=${rn(r,null)}&goToUserPage=true`)});document.querySelector("#pageAbout #supportMeAboutButton")?.addEventListener("click",()=>{cC()});document.querySelector("#pageAbout #contactPopupButton2")?.addEventListener("click",()=>{uC()});const fg={includeBackground:!1};function DM(){lp.show({beforeAnimation:async e=>{e.querySelector("input[type='checkbox']").checked=!1,fg.includeBackground=!1}})}async function WM(){const e={c:ko.map(t=>n(`.pageSettings .customTheme .tabContent.customTheme #${t}[type='color']`).attr("value"))};return fg.includeBackground&&(e.i=r.customBackground,e.s=r.customBackgroundSize,e.f=r.customBackgroundFilter),window.location.origin+"?customTheme="+btoa(JSON.stringify(e))}async function zM(){const e=await WM();try{await navigator.clipboard.writeText(e),f("URL Copied to clipboard",1),lp.hide()}catch{f("Looks like we couldn't copy the link straight to your clipboard. Please copy it manually.",0,{duration:5}),cp.show({modalChain:lp,focusFirstInput:"focusAndSelect",beforeAnimation:async a=>{a.querySelector("input").value=e}})}}const lp=new re({dialogId:"shareCustomThemeModal",setup:async e=>{e.querySelector("button")?.addEventListener("click",zM),e.querySelector("input[type='checkbox']")?.addEventListener("change",t=>{fg.includeBackground=t.target.checked})}}),cp=new re({dialogId:"shareCustomThemeUrlModal",customEscapeHandler:async()=>{await cp.hide({clearModalChain:!0})},customWrapperClickHandler:async()=>{await cp.hide({clearModalChain:!0})}}),HM=q.object({security:q.boolean(),analytics:q.boolean(),sentry:q.boolean()}).strict().nullable();function pg(){return wC.get()}function Tu(e){wC.set(e),CC()}const wC=new pt({key:"acceptedCookies",schema:HM,fallback:null});function CC(){const e=pg();e?.analytics&&q9(),e?.sentry&&jS()}function kC(e){_i.show({beforeAnimation:async()=>{if(e){const t=pg();SC(t)}},afterAnimation:async()=>{xa("cookiesModal")||_i.destroy()}})}function SC(e){_i.getModal().querySelector(".main")?.classList.add("hidden"),_i.getModal().querySelector(".settings")?.classList.remove("hidden"),e&&(e.analytics&&(_i.getModal().querySelector(".cookie.analytics input").checked=!0),e.sentry&&(_i.getModal().querySelector(".cookie.sentry input").checked=!0))}async function Lu(){_i.hide({afterAnimation:async()=>{Ki()}})}const _i=new re({dialogId:"cookiesModal",customEscapeHandler:()=>{},customWrapperClickHandler:()=>{},setup:async e=>{e.querySelector(".acceptAll")?.addEventListener("click",()=>{Tu({security:!0,analytics:!0,sentry:!0}),Lu()}),e.querySelector(".rejectAll")?.addEventListener("click",()=>{Tu({security:!0,analytics:!1,sentry:!1}),Lu()}),e.querySelector(".openSettings")?.addEventListener("click",()=>{SC()}),e.querySelector(".cookie.ads .textButton")?.addEventListener("click",()=>{try{x8()}catch{console.error("Failed to open ad consent UI"),f("Failed to open Ad consent popup. Do you have an ad or cookie popup blocker enabled?",-1)}}),e.querySelector(".acceptSelected")?.addEventListener("click",()=>{const t=e.querySelector(".cookie.analytics input").checked,a=e.querySelector(".cookie.sentry input").checked;Tu({security:!0,analytics:t,sentry:a}),Lu()})}}),Jd=document.querySelector("#pageSettings");Jd?.querySelector("#shareCustomThemeButton")?.addEventListener("click",()=>{DM()});Jd?.querySelector(".section.updateCookiePreferences .buttons button")?.addEventListener("click",()=>{kC(!0)});Jd?.querySelector(".section.presets")?.addEventListener("click",e=>{const t=e.target;if(t.classList.contains("addPresetButton"))sc("add");else if(t.classList.contains("editButton")){const a=t.parentElement?.getAttribute("data-id"),o=t.parentElement?.getAttribute("data-display");if(a===void 0||o===void 0||a===""||o===""||a===null||o===null){f("Failed to edit preset: Could not find preset id or name",-1);return}sc("edit",a,o)}else if(t.classList.contains("removeButton")){const a=t.parentElement?.getAttribute("data-id"),o=t.parentElement?.getAttribute("data-display");if(a===void 0||o===void 0||a===""||o===""||a===null||o===null){f("Failed to remove preset: Could not find preset id or name",-1);return}sc("remove",a,o)}});Jd?.querySelector(".section.tags")?.addEventListener("click",e=>{const t=e.target;if(t.classList.contains("addTagButton"))Gs("add");else if(t.classList.contains("editButton")){const a=t.parentElement?.getAttribute("data-id"),o=t.parentElement?.getAttribute("data-display");if(a===void 0||o===void 0||a===""||o===""||a===null||o===null){f("Failed to edit tag: Could not find tag id or name",-1);return}Gs("edit",a,o)}else if(t.classList.contains("clearPbButton")){const a=t.parentElement?.getAttribute("data-id"),o=t.parentElement?.getAttribute("data-display");if(a===void 0||o===void 0||a===""||o===""||a===null||o===null){f("Failed to clear tag PB: Could not find tag id or name",-1);return}Gs("clearPb",a,o)}else if(t.classList.contains("removeButton")){const a=t.parentElement?.getAttribute("data-id"),o=t.parentElement?.getAttribute("data-display");if(a===void 0||o===void 0||a===""||o===""||a===null||o===null){f("Failed to remove tag: Could not find tag id or name",-1);return}Gs("remove",a,o)}});function OM(e){const t=TC.getModal();t.querySelector("table tbody").innerHTML="",t.querySelector("table thead tr td").textContent=e,t.querySelector("table thead tr td span.unit").textContent=r.typingSpeedUnit;const a=S();if(!a)return;const o=a.personalBests?.[e];if(o===void 0)return;const i=[];Object.keys(o).forEach(function(l){let c=o[l]??[];c=c.sort(function(d,u){return u.wpm-d.wpm}),c.forEach(function(d){d.mode2=l,i.push(d)})});let s;i.forEach(l=>{let c='-<br><span class="sub">-</span>';const d=new Date(l.timestamp);l.timestamp&&(c=J(d,"dd MMM yyyy")+"<br><div class='sub'>"+J(d,"HH:mm")+"</div>"),t.querySelector("table tbody")?.insertAdjacentHTML("beforeend",`
      <tr>
        <td>${s===l.mode2?"":l.mode2}</td>
        <td>
          ${D.typingSpeed(l.wpm)}
          <br />
          <span class="sub">${D.accuracy(l.acc)}</span>
        </td>
        <td>
          ${D.typingSpeed(l.raw)}
          <br />
          <span class="sub">${D.percentage(l.consistency)}</span>
        </td>
        <td>${l.difficulty}</td>
        <td>${l.language?Aa(l.language):"-"}</td>
        <td>${l.punctuation?'<i class="fas fa-check"></i>':""}</td>
        <td>${l.numbers?'<i class="fas fa-check"></i>':""}</td>
        <td>${l.lazyMode?'<i class="fas fa-check"></i>':""}</td>
        <td>${c}</td>
      </tr>
    `),s=l.mode2})}function xC(e){TC.show({beforeAnimation:async()=>{OM(e)}})}const TC=new re({dialogId:"pbTablesModal"});function NM(){if(!Xe()){f("You are offline",0,{duration:2});return}$C.show({beforeAnimation:async()=>{KM(),jM()}})}function UM(){$C.hide({afterAnimation:async()=>{const e=S();e&&Nc("account",e)}})}const mg=n("#editProfileModal .bio"),gg=n("#editProfileModal .keyboard"),hg=n("#editProfileModal .twitter"),bg=n("#editProfileModal .github"),yg=n("#editProfileModal .website"),Rl=n("#editProfileModal .badgeSelectionContainer"),LC=document.querySelector("#editProfileModal .editProfileShowActivityOnPublicProfile"),VM=[$u(hg,_k),$u(bg,Ek),$u(yg,qk)];let Bn=-1;function KM(){const e=S();if(!e)return;const t=e.inventory?.badges??[],{bio:a,keyboard:o,socialProfiles:i,showActivityOnPublicProfile:s}=e.details??{};Bn=-1,mg.val(a??""),gg.val(o??""),hg.val(i?.twitter??""),bg.val(i?.github??""),yg.val(i?.website??""),Rl.html(""),LC.checked=s||!1,t?.forEach(l=>{l.selected&&(Bn=l.id);const c=ys(l.id,!1,!0),d=`<button type="button" class="badgeSelectionItem ${l.selected?"selected":""}" selection-id=${l.id}>${c}</button>`;Rl.append(d)}),Rl.prepend(`<button type="button" class="badgeSelectionItem ${Bn===-1?"selected":""}" selection-id=-1>
      <div class="badge">
        <i class="fas fa-frown-open"></i>
        <div class="text">none</div>
      </div>
    </button>`),n(".badgeSelectionItem").on("click",({currentTarget:l})=>{const c=n(l).attr("selection-id");Bn=parseInt(c,10),Rl.find(".badgeSelectionItem").removeClass("selected"),n(l).addClass("selected")}),VM.forEach(l=>l.hide())}function jM(){new Ir(mg,250),new Ir(gg,75)}function GM(){const e=mg.val()??"",t=gg.val()??"",a=hg.val()??"",o=bg.val()??"",i=yg.val()??"",s=LC.checked??!1;return{bio:e,keyboard:t,socialProfiles:{twitter:a,github:o,website:i},showActivityOnPublicProfile:s}}async function QM(){const e=S();if(!e)return;const t=GM(),a=39;if(t.socialProfiles?.github!==void 0&&t.socialProfiles?.github.length>a){f(`GitHub username exceeds maximum allowed length (${a} characters).`,-1);return}const o=20;if(t.socialProfiles?.twitter!==void 0&&t.socialProfiles?.twitter.length>o){f(`Twitter username exceeds maximum allowed length (${o} characters).`,-1);return}Z();const i=await T.users.updateProfile({body:{...t,selectedBadgeId:Bn}});if(N(),i.status!==200){f("Failed to update profile: "+i.body.message,-1);return}e.details=i.body.data??t,e.inventory?.badges.forEach(s=>{s.id===Bn?s.selected=!0:delete s.selected}),f("Profile updated",1),UM()}function $u(e,t){const a=new _m(e,{valid:{icon:"fa-check",level:1},invalid:{icon:"fa-times",level:-1},checking:{icon:"fa-circle-notch",spinIcon:!0,level:0}});return e.on("input",o=>{const i=o.target.value;if(i===void 0||i===""){a.hide();return}const s=t.safeParse(i);if(!s.success){a.show("invalid",s.error.errors.map(l=>l.message).join(", "));return}a.show("valid")}),a}const $C=new re({dialogId:"editProfileModal",setup:async e=>{e.addEventListener("submit",async t=>{t.preventDefault(),await QM()})}});function YM(){JM.show(void 0,{})}const JM=new de({id:"newFilterPresetModal",title:"New Filter Preset",inputs:[{placeholder:"Preset Name",type:"text",initVal:"",validation:{schema:uc.shape.name}}],buttonText:"add",onlineOnly:!0,execFn:async(e,t)=>await h7(t)===1?{status:1,message:"Filter preset created"}:{status:-1,message:"Error creating filter preset",alwaysHide:!0}}),fl=document.querySelector("#pageAccount");n(fl).on("click",".pbsTime .showAllButton",()=>{xC("time")});n(fl).on("click",".pbsWords .showAllButton",()=>{xC("words")});n(fl).on("click",".editProfileButton",()=>{if(!A()){f("You must be logged in to edit your profile",0);return}const e=S();if(!e){f("Failed to open edit profile modal: No user snapshot found",-1);return}if(e.banned===!0){f("Banned users cannot edit their profile",0);return}NM()});const XM=q.array(q.string());n(fl).on("click",".group.history .resultEditTagsButton",e=>{const t=n(e.target).attr("data-result-id"),a=n(e.target).attr("data-tags");pC(t??"",Cs(a??"[]",XM),"accountPage")});n(fl).find("button.createFilterPresetBtn").on("click",()=>{YM()});const ZM=document.getElementById("pageLeaderboards");for(const e of ZM?.querySelectorAll(".jumpButtons button[data-action='goToPage']")??[])e?.addEventListener("click",()=>{Re("lbGoToPage")});function eA(){if(!tn()){f("Could not show forgot password popup: Captcha is not available. This could happen due to a blocked or failed network request. Please refresh the page or contact support if this issue persists.",-1);return}vg.show({mode:"dialog",focusFirstInput:!0,beforeAnimation:async e=>{To("forgotPasswordModal"),Is(e.querySelector(".g-recaptcha"),"forgotPasswordModal",async()=>{await MC()})}})}async function MC(){const e=dl("forgotPasswordModal");if(!e){f("Please complete the captcha");return}const t=vg.getModal().querySelector("input").value.trim();if(!t){f("Please enter your email address"),To("forgotPasswordModal");return}if(!fc.safeParse(t).success){f("Please enter a valid email address"),To("forgotPasswordModal");return}Z(),T.users.forgotPasswordEmail({body:{email:t,captcha:e}}).then(o=>{if(N(),o.status!==200){f("Failed to send password reset email: "+o.body.message,-1);return}f(o.body.message,1,{duration:5})}),dp()}function dp(){vg.hide()}async function tA(e){e.querySelector("button")?.addEventListener("click",async()=>{await MC()})}const vg=new re({dialogId:"forgotPasswordModal",setup:tA,customEscapeHandler:async()=>{dp()},customWrapperClickHandler:async()=>{dp()}}),aA=document.querySelector("#pageLogin");n(aA).on("click","#forgotPasswordButton",()=>{eA()});let Ft;function oA(e){AC.show({mode:"dialog",focusFirstInput:!0,beforeAnimation:async()=>{if(Ft=e,!tn()){f("Could not show google sign up popup: Captcha is not avilable. This could happen due to a blocked or failed network request. Please refresh the page or contact support if this issue persists.",-1);return}To("googleSignUpModal"),Is(n("#googleSignUpModal .captcha")[0],"googleSignUpModal"),sA(),wg()},afterAnimation:async()=>{tn()||Dr()}})}async function Dr(){AC.hide({afterAnimation:async()=>{ny(),Ft!==void 0&&(f("Sign up process cancelled",0,{duration:5}),Ya(),Za(),bp(Ft)?.isNewUser&&(await T.users.delete(),await Ft?.user.delete().catch(()=>{})),dn(),Ft=void 0)}})}async function iA(){if(!Ft){f("Missing user credential. Please close the popup and try again.",-1);return}const e=dl("googleSignUpModal");if(!e){f("Please complete the captcha",0);return}rA(),wg(),Z();const t=n("#googleSignUpModal input").val();try{if(t.length===0)throw new Error("Name cannot be empty");const a=await T.users.create({body:{name:t,captcha:e}});if(a.status!==200)throw new Error(`Failed to create user: ${a.body.message}`);a.status===200&&(await Jb(Ft.user,{displayName:t}),await O2(Ft.user),f("Account created",1),Za(),Ya(),await T1(Ft.user),Ft=void 0,N(),Dr())}catch(a){console.log(a);const o=ie(a,"Failed to sign in with Google");f(o,-1),Ya(),Za(),Om(),Ft&&bp(Ft)?.isNewUser&&(await T.users.delete(),await Ft?.user.delete().catch(()=>{})),dn(),Ft=void 0,Dr(),N();return}}function nA(){n("#googleSignUpModal button").prop("disabled",!1)}function wg(){n("#googleSignUpModal button").prop("disabled",!0)}const Cg=document.querySelector("#googleSignUpModal input");function sA(){Cg.disabled=!1}function rA(){Cg.disabled=!0}Fa(Cg,{schema:Or,isValid:Od(async e=>T.users.getNameAvailability({params:{name:e}}),{check:e=>e.available||"Name not available"}),debounceDelay:1e3,callback:e=>{e.status==="success"?nA():wg()}});async function lA(e){e.addEventListener("submit",t=>{t.preventDefault(),iA()})}Z2((e,t)=>{e!==void 0&&t&&oA(e)});const AC=new re({dialogId:"googleSignUpModal",setup:lA,customEscapeHandler:async()=>{Dr()},customWrapperClickHandler:async()=>{Dr()}}),_C=console.log,cA=console.warn,dA=console.error,EC=new pt({key:"debugLogs",schema:q.boolean(),fallback:!1});let Js=EC.get();function uA(){Js=!Js,qC(`Debug logs ${Js?"enabled":"disabled"}`),EC.set(Js)}function qC(...e){_C("%cINFO","background:#4CAF50;color: #111;padding:0 5px;border-radius:10px",...e)}function fA(...e){cA("%cWRN","background:#FFC107;color: #111;padding:0 5px;border-radius:10px",...e)}function pA(...e){dA("%cERR","background:#F44336;color: #111;padding:0 5px;border-radius:10px",...e)}function mA(...e){Js&&_C("%cDEBG","background:#2196F3;color: #111;padding:0 5px;border-radius:10px",...e)}console.log=qC;console.warn=fA;console.error=pA;console.debug=mA;const IC=new pt({key:"accountSettingsMessageDismissed",schema:q.boolean(),fallback:!1});IC.get()&&n(".pageSettings .accountSettingsNotice").remove();n(".pageSettings .accountSettingsNotice .dismissAndGo").on("click",()=>{IC.set(!0),Ie("/account-settings"),n(".pageSettings .accountSettingsNotice").remove()});let up=!1;const gA=new RegExp("\\p{P}","u");async function hA(e){function t(u,p){let g=u.shiftKey;const m=up&&p.length>2?2:0,h=!gA.test(p.slice(m,m+2).join(""));us&&h&&(g=!u.shiftKey);const y=p[(g?1:0)+m]??"",C=p[g?1:0]??"",M=p[0];return y||C||M}let a;try{a=await Bi(r.layout)}catch(u){return f(ie(u,"Failed to emulate event"),-1),null}Jt().includes("layout_mirror")&&(a=mm(a));let i=[];if(a.type==="ansi"?i=["Backquote","Digit1","Digit2","Digit3","Digit4","Digit5","Digit6","Digit7","Digit8","Digit9","Digit0","Minus","Equal","KeyQ","KeyW","KeyE","KeyR","KeyT","KeyY","KeyU","KeyI","KeyO","KeyP","BracketLeft","BracketRight","Backslash","KeyA","KeyS","KeyD","KeyF","KeyG","KeyH","KeyJ","KeyK","KeyL","Semicolon","Quote","KeyZ","KeyX","KeyC","KeyV","KeyB","KeyN","KeyM","Comma","Period","Slash","Space"]:a.type==="iso"?i=["Backquote","Digit1","Digit2","Digit3","Digit4","Digit5","Digit6","Digit7","Digit8","Digit9","Digit0","Minus","Equal","KeyQ","KeyW","KeyE","KeyR","KeyT","KeyY","KeyU","KeyI","KeyO","KeyP","BracketLeft","BracketRight","KeyA","KeyS","KeyD","KeyF","KeyG","KeyH","KeyJ","KeyK","KeyL","Semicolon","Quote","Backslash","IntlBackslash","KeyZ","KeyX","KeyC","KeyV","KeyB","KeyN","KeyM","Comma","Period","Slash","Space"]:a.type==="matrix"&&(i=["Backquote","Digit1","Digit2","Digit3","Digit4","Digit5","Digit6","Digit7","Digit8","Digit9","Digit0","Minus","Equal","KeyQ","KeyW","KeyE","KeyR","KeyT","KeyY","KeyU","KeyI","KeyO","KeyP","BracketLeft","BracketRight","Backslash","KeyA","KeyS","KeyD","KeyF","KeyG","KeyH","KeyJ","KeyK","KeyL","Semicolon","Quote","KeyZ","KeyX","KeyC","KeyV","KeyB","KeyN","KeyM","Comma","Period","Slash","Space"]),!i.includes(e.code))return null;const s=a.keys,l=s.row1.concat(s.row2).concat(s.row3).concat(s.row4).concat(s.row5),c=i.indexOf(e.code);if(c===-1)return e.code.includes("Numpad")?e.key:null;const d=t(e,l[c]??[]);return d!==void 0?d:null}function FC(e){const t=e.code==="AltLeft"&&navigator.userAgent.includes("Mac");e.code!=="AltRight"&&!t||(e.type==="keydown"&&(up=!0),e.type==="keyup"&&(up=!1))}n(document).on("keydown",FC);n(document).on("keyup",FC);const PC=["MediaTrackNext","MediaTrackPrevious","MediaPlayPause","AudioVolumeUp","AudioVolumeDown","AudioVolumeMute","Home","End"],bA=["Alt","AltGraph","CapsLock","Control","Fn","FnLock","Hyper","Meta","OS","NumLock","ScrollLock","Scroll","Shift","Super","Symbol","SymbolLock"];let ed=!1,td=!0,Mu=!1,BC,Au=0,ad=!1;const Sb=document.getElementById("wordsInput"),RC=document.getElementById("koInputVisual");function ha(e){e!==Sb.value&&(Sb.value=e)}function Rn(){const e=H(tl());if(isNaN(e)||V3(e),r.keymapMode==="next"&&r.mode!=="zen")if(!r.language.startsWith("korean"))Ho(_.getCurrent().charAt(k.current.length));else{const t=Ze.disassemble(_.getCurrent(),!0),a=Ze.disassemble(k.current,!0),o=a.length-1;if(a[o]){const i=a[o].length;try{const s=t[o][i]??t[a.length][i-t[o].length];Ho(s)}catch{Ho("")}}else{const i=t?.[0]?.[0];i!==void 0&&Ho(i)}}}function DC(){if(!we)return;const e=Ms(le-1),t=k.getHistory().length===0,a=e===null,o=e?.classList.contains("hidden"),i=k.getHistory(le-1)===_.get(le-1);if(t||a||o||i&&!r.freedomMode||r.confidenceMode==="on"||r.confidenceMode==="max")return;const l=Ia()?.children[0]?.classList.contains("incorrect");if(r.stopOnError==="letter"&&l&&va(),k.current=k.popHistory(),Ke.popHistory(),ui("nospace")&&(k.current=k.current.slice(0,-1),ha(" "+k.current+" ")),bS(),Md(!0),qc(_.getCurrent()),va(),r.mode==="zen"){Zr();const c=document.querySelector("#words")?.children??[];for(let d=c.length-1;d>=0;d--){const u=c[d];if(u.classList.contains("newline")||u.classList.contains("beforeNewline")||u.classList.contains("afterNewline"))u.remove();else break}}vo(),Di("backWord")}async function xb(){if(!we||k.current===""||Ri()&&r.language.startsWith("chinese"))return;const e=_.getCurrent();for(const d of ft("handleSpace"))d.functions.handleSpace();ed=!0;const t=O0();U3(Math.round(t)),Qy(t);const a=ui("nospace"),o=e===k.current||r.mode==="zen";if(Vv(o,!0),Vy(o),o)r.stopOnError==="letter"&&va(),fh(!0,e),k.pushHistory(),zg(),qc(_.getCurrent()),Uu(),Vu(le),a||Ea(),Di("submitCorrectWord");else{a||(r.playSoundOnError==="off"||r.blindMode?Ea():il()),Ky(_.getCurrent()),Uy();const d=k.current.length;if(d<=_.getCurrent().length&&(d>=Ke.current.length?Ke.current+="_":Ke.current=Ke.current.substring(0,d)+"_"+Ke.current.substring(d+1)),r.stopOnError!=="off"){if(r.difficulty==="expert"||r.difficulty==="master"){cr("difficulty");return}r.stopOnError==="word"&&(ed=!1,Di("incorrectLetter","_"),va(),vo());return}fh(!1,e),r.blindMode?r.highlightMode!=="off"&&A4(le):M4(le),k.pushHistory(),zg(),qc(_.getCurrent()),Uu(),Vu(le),Di("submitErrorWord"),(r.difficulty==="expert"||r.difficulty==="master")&&cr("difficulty")}Ke.pushHistory();const i=le===_.length;if(Am()&&i){Xi();return}let s;r.mode==="zen"?s=k.current.length:s=_.getCurrent().length;const l=fk(r.minBurstCustomSpeed,s);if(r.minBurst==="fixed"&&t<r.minBurstCustomSpeed||r.minBurst==="flex"&&t<l){cr("min burst");return}r.keymapMode==="react"&&w0(" ",!0),(r.mode==="words"||r.mode==="custom"||r.mode==="quote"||r.mode==="zen")&&Zr(),i?(ad=!0,Z(),await Lh(),N(),ad=!1):Lh(),Md();const c=r.mode==="time"||r.mode==="custom"&&ve()==="time"||r.mode==="custom"&&ye()===0;if(!r.showAllLines||c){const d=Math.floor(Ms(le-1)?.offsetTop??0),{data:u}=nd(()=>Math.floor(Ia()?.offsetTop??0));(u??0)>d&&em(d)}vo()}function WC(e,t){if(!td)return!1;if(r.mode==="zen")return!0;if(k.getKoreanStatus()){const l=Ze.disassemble(_.getCurrent())[t];return l===void 0?!1:l===e}const a=_.getCurrent()[t];if(a===void 0)return!1;if(a===e)return!0;const o=Ao("isCharCorrect");return o?o.functions.isCharCorrect(e,a):!!(r.language.startsWith("russian")&&(e==="ё"||e==="е"||e==="e")&&(a==="ё"||a==="е"||a==="e")||h5(e,a))}async function ja(e,t,a){if(Vi||ce)return;if(e==="…"&&_.getCurrent()[t]!=="…"){for(let C=0;C<3;C++)await ja(".",t+C);return}console.debug("Handling char",e,t,a);const o=performance.now(),i=k.getKoreanStatus();for(const C of ft("handleChar"))e=C.functions.handleChar(e);const s=ui("nospace");if(e!==`
`&&e!=="	"&&/\s/.test(e)){if(s)return;if(xb(),r.difficulty!=="normal"||r.strictSpace&&r.mode!=="zen"||r.stopOnError==="word"&&t>0){if(ed){ed=!1;return}}else return}if(r.mode!=="zen"&&_.getCurrent()[t]!==`
`&&e===`
`||!we&&!H9(o))return;_a(!0),Jy();const l=WC(e,t);let c;if(l&&r.mode!=="zen"&&(e=i?Ze.disassemble(_.getCurrent())[t]??"":_.getCurrent().charAt(t)),!l&&e===`
`){if(k.current==="")return;e=" "}if(k.current===""&&_3(o),i||r.language.startsWith("korean")?(c=(a??"").slice(1),RC.innerText=c.slice(-1)):r.language.startsWith("chinese")?c=(a??"").slice(1):c=k.current.substring(0,t)+e+k.current.substring(t+1),!l&&Ri()&&!r.language.startsWith("korean")){k.current=c,va(),vo();return}if(Vv(l),Vy(l),l||(Uy(),Ky(_.getCurrent())),Xx(r.mode==="zen"?e:_.getCurrent()[t]??"",l),l||r.playSoundOnError==="off"||r.blindMode?Ea():il(),r.keymapMode==="react"&&w0(e,l),r.difficulty!=="master")if(td)Au=0;else{Au++,Au>=5&&f("Opposite shift mode is on.",0,{important:!0,customTitle:"Reminder"});return}if(Ke.current==="")Ke.current+=i?Ze.disassemble(c).join(""):c;else{const C=i?Ze.disassemble(Ke.current).length:Ke.current.length;t>=C?Ke.current+=i?Ze.disassemble(e).concat().join(""):e:l||(Ke.current=Ke.current.substring(0,t)+e+Ke.current.substring(t+1))}if(Uu(),Vu(le),r.difficulty!=="master"&&r.stopOnError==="letter"&&!l){r.blindMode||va(k.current+e);return}Di(l?"correctLetter":"incorrectLetter",e);const d=Ia();if((i?Ze.disassemble(k.current).length:k.current.length)===1&&le===0&&(d?.offsetTop,void 0),r.mode==="zen"&&t<30||r.mode!=="zen"&&c.length<_.getCurrent().length+20?k.current=c:console.error("Hitting word limit"),!l&&r.difficulty==="master"){cr("difficulty");return}if(r.mode!=="zen"){const C=_.getCurrent(),w=le===_.length-1,F=Am(),I=C===k.current,P=r.quickEnd&&!r.language.startsWith("korean")&&C.length===k.current.length&&r.stopOnError==="off",U=r.language.startsWith("chinese");if(w&&F&&(I||P)&&(!U||a!==void 0&&t+2===a.length)){Xi();return}}const p=d?.offsetTop;await va();const g=d?.offsetTop;p<g&&!af&&(r.mode==="zen"||r.indicateTypos==="replace"||r.indicateTypos==="both"?r.showAllLines||em(p):(k.current=k.current.slice(0,-1),await va())),(s&&k.current.length===_.getCurrent().length||e===`
`&&l)&&xb();const m=_.getCurrent(),h=/^\t+/.test(_.getCurrent()),y=m[k.current.length]==="	";setTimeout(()=>{if(l&&r.language.startsWith("code")&&h&&y){const C=new KeyboardEvent("keydown",{key:"Tab",code:"Tab"});document.dispatchEvent(C)}},0),e!==`
`&&vo()}async function yA(e,t){if(Vi){e.preventDefault();return}let a=!1;(r.mode==="zen"&&!e.shiftKey||br&&!e.shiftKey)&&(a=!0);const o=xa("commandLineWrapper")||t;if(r.quickRestart==="esc"){if(o||X()==="login")return;if(e.preventDefault(),!ce&&a){await ja("	",k.current.length),ha(" "+k.current);return}}else if(r.quickRestart==="tab"){if(o||X()==="login")return;if(X()!=="test"){await Ie("/");return}if(e.shiftKey?te():Cr(),!ce&&a){e.preventDefault(),await ja("	",k.current.length),ha(" "+k.current);return}R({event:e})}else{if(o||X()!=="test"||ce)return;if(a){e.preventDefault(),await ja("	",k.current.length),ha(" "+k.current);return}setTimeout(()=>{document.activeElement?.id!=="wordsInput"&&_a(!1)},0)}}n("#wordsInput").on("keydown",e=>{const t=X()==="test",a=xa("commandLineWrapper"),o=id();t&&!a&&!o&&!ce&&e.key!=="Enter"&&!ad&&dy||e.preventDefault()});let _u=-1;n(document).on("keydown",async e=>{if(zi()){console.debug("Ignoring keydown during page transition.");return}if(PC.includes(e.key)){console.debug(`Key ${e.key} is on the list of ignored keys. Stopping keydown event.`),e.preventDefault();return}for(const l of ft("handleKeydown"))l.functions.handleKeydown(e);const t=n("#wordsInput").is(":focus"),a=X()==="test",o=xa("commandLineWrapper"),i=id(),s=a&&!o&&!i&&!ce&&(t||e.key!=="Enter")&&!ad;if(s&&!t&&!["Enter"," ","Escape","Tab",...bA].includes(e.key)&&(Ki(),r.showOutOfFocusWarning&&!e.ctrlKey&&!e.metaKey&&e.preventDefault()),e.key==="Tab"&&await yA(e,i),e.key==="Escape"&&r.quickRestart==="esc"){if(xa("commandLineWrapper")||i)return;if(X()!=="test"){await Ie("/");return}e.shiftKey?te():Cr(),R({event:e})}if(e.key==="Enter"&&r.quickRestart==="enter"){const l=document.activeElement;if(l?.tagName==="BUTTON"||l?.tagName==="A"||l?.classList.contains("button")||l?.classList.contains("textButton")||l?.tagName==="INPUT"&&l?.id!=="wordsInput"||xa("commandLineWrapper")||i)return;if(X()!=="test"){await Ie("/");return}if(ce){R({event:e});return}r.mode==="zen"||(!yr&&!r.funbox.includes("58008")||(yr||r.funbox.includes("58008"))&&e.shiftKey)&&(e.shiftKey?te():Cr(),R({event:e}))}if(s){if(!e.originalEvent?.isTrusted||zt){e.preventDefault();return}if(Ny(),e.key==="Backspace"){if(Ea(),/INPUT|SELECT|TEXTAREA/i.test(e.target.tagName)||e.preventDefault(),r.confidenceMode==="max"){e.preventDefault();return}r.codeUnindentOnBackspace&&k.current.length>0&&/^\t*$/.test(k.current)&&r.language.startsWith("code")&&WC(k.current.slice(-1),k.current.length-1)&&(k.getHistory(le-1)!==_.get(le-1)||r.freedomMode)&&(k.current="",await va())}if(e.key==="Backspace"&&k.current.length===0&&(DC(),k.current&&ha(" "+k.current+" ")),e.key==="Enter")if(e.shiftKey)if(r.mode==="zen")Xi();else if(Dd(r.mode,r.words,r.time,Co(),Xa()??!1))await ja(`
`,k.current.length),ha(" "+k.current),Rn();else{const l=Date.now()-_u;_u===-1||l>200?(_u=Date.now(),l>=5e3&&f("Please double tap shift+enter to confirm bail out",0,{important:!0,duration:5})):(kp(!0),Xi())}else await ja(`
`,k.current.length),ha(" "+k.current),Rn();if(e.key==="Dead"&&!Ri()){Ea();const l=Ia(),c=k.current.length,d=l?.querySelectorAll("letter")[c];d&&d.classList.toggle("dead")}if(r.oppositeShiftMode!=="off")if(r.oppositeShiftMode==="keymap"&&r.keymapLayout!=="overrideSync"){let l=await Bi(r.keymapLayout).catch(()=>{});if(l===void 0){f("Failed to load keymap layout",-1);return}Jt().includes("layout_mirror")&&(l=mm(l));const d=U0(e.key,l);td=d===void 0?!0:cf(d)}else td=cf(e.code);for(const l of ft("preventDefaultEvent"))await l.functions.preventDefaultEvent(e)&&(e.preventDefault(),await ja(e.key,k.current.length),Rn(),ha(" "+k.current));if(r.layout!=="default"&&!(e.ctrlKey||e.altKey&&uk())){const l=await hA(e);l!==null&&(e.preventDefault(),await ja(l,k.current.length),Rn(),ha(" "+k.current))}BC=e.key==="Backspace"||e.key==="delete"}});n("#wordsInput").on("keydown",e=>{if(e.originalEvent?.repeat){console.log("spacing debug keydown STOPPED - repeat",e.key,e.code,e.which);return}w6(e),e.code==="NumpadEnter"&&r.funbox.includes("58008")&&(e.code="Space"),e.code.includes("Arrow")&&r.funbox.includes("arrows")&&(e.code="NoCode");const t=performance.now(),a=e.code===""||e.key==="Unidentified"?"NoCode":e.code;I3(t,a)});n("#wordsInput").on("keyup",e=>{if(e.originalEvent?.repeat){console.log("spacing debug keydown STOPPED - repeat",e.key,e.code,e.which);return}e.code==="NumpadEnter"&&r.funbox.includes("58008")&&(e.code="Space"),e.code.includes("Arrow")&&r.funbox.includes("arrows")&&(e.code="NoCode");const t=performance.now(),a=e.code===""||e.key==="Unidentified"?"NoCode":e.code;q3(t,a)});n("#wordsInput").on("keyup",e=>{if(!e.originalEvent?.isTrusted||zt){e.preventDefault();return}C6(e),PC.includes(e.key)});n("#wordsInput").on("beforeinput",e=>{e.originalEvent?.isTrusted&&e.target.value===""&&(e.target.value=" ")});n("#wordsInput").on("input",async e=>{if(!e.originalEvent?.isTrusted||zt){e.target.value=" ";return}if(id()){e.preventDefault();return}Ny(),(r.layout==="default"||r.layout==="korean")&&e.target.value.normalize().match(/[\uac00-\ud7af]|[\u1100-\u11ff]|[\u3130-\u318f]|[\ua960-\ua97f]|[\ud7b0-\ud7ff]/g)&&k.setKoreanStatus(!0);const a=k.getKoreanStatus(),o=r.language.startsWith("chinese"),i=e.target.value.normalize(),s=a?Ze.disassemble(i).join("").slice(1):i.slice(1),l=a?Ze.disassemble(k.current).join(""):k.current;if(a&&!BC&&(Mu||i.slice(1).length<k.current.length&&Ze.disassemble(k.current.slice(-1)).length>1)){Mu=!Mu;return}if(r.layout!=="default"&&s.length>=l.length){ha(" "+l),Rn();return}if(i.length===0&&l.length===0)DC();else if(s.length<l.length){if(o)if(l.length-s.length<=2&&l.startsWith(l))k.current=s;else{let d=0;for(;s[d]===l[d];)d++;let u=0;r.stopOnError!=="word"&&/.+ .+/.test(s)&&(u=s.indexOf(" ")+1);for(let p=d;p<s.length;p++)await ja(s[p],p-u,i)}else if(a){const d=e.target.value.normalize().slice(1);k.current=d,RC.innerText=d.slice(-1)}else k.current=s;va(),vo(),Ri()||((e?.originalEvent).inputType==="deleteWordBackward"?Di("setLetterIndex",0):Di("setLetterIndex",l.length-1))}if(s!==l){let d=0;for(;s[d]===l[d];)d++;let u=0;r.stopOnError!=="word"&&/.+ .+/.test(s)&&(u=s.indexOf(" ")+1);for(let p=d;p<s.length;p++)await ja(s[p],p-u,i)}ha(" "+k.current),Rn();const c=Ri();setTimeout(()=>{const d=Ri();c!==d&&va(),e.target.selectionStart!==e.target.value.length&&(!Po.test(e.target.value)||(e.target.selectionStart??0)<e.target.value.search(Po))&&(e.target.selectionStart=e.target.selectionEnd=e.target.value.length)},0)});document.querySelector("#wordsInput")?.addEventListener("focus",e=>{const t=e.target,a=t.value;t.setSelectionRange(a.length,a.length)});n("#wordsInput").on("copy paste",e=>{e.preventDefault()});n("#wordsInput").on("select selectstart",e=>{e.preventDefault()});n("#wordsInput").on("selectionchange",e=>{const t=e.target,a=t.value,o=t.selectionStart!==t.selectionEnd,i=t.selectionStart===a.length;(o||!i)&&t.setSelectionRange(a.length,a.length)});n("#wordsInput").on("keydown",e=>{e.key.startsWith("Arrow")&&e.preventDefault()});n("#wordsInput").on("compositionstart",()=>{r.layout==="default"&&(Up(!0),gx(k.current.length))});n("#wordsInput").on("compositionend",()=>{r.layout==="default"&&Up(!1)});const Tb=new pt({key:"merchBannerClosed3",schema:q.boolean(),fallback:!1});function vA(){Tb.get()||Y2('New merch store now open, including a limited edition metal keycap! <a target="_blank" rel="noopener" href="https://mktp.co/merch">monkeytype.store</a>',1,"./images/merch3.png",!1,()=>{Tb.set(!0)},!0)}n(async()=>{await Hy,await tS,n("body").css("transition","background .25s, transform .05s"),vA();for(const t of ft("applyGlobalCSS"))t.functions.applyGlobalCSS();const e=document.querySelector("#app");e?.classList.remove("hidden"),W(e,{opacity:[0,1],duration:G(250)}),Xe()&&ES().then(()=>{Ma()?.users.signUp||(l5(),n(".register").addClass("hidden"),n(".login").addClass("hidden"),n(".disabledNotification").removeClass("hidden")),Ma()?.connections.enabled||n(".accountButtonAndMenu .goToFriends").addClass("hidden")}),r9(),new v2("https://keymash.io/"),"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js",{scope:"/"}).then(t=>{console.log("ServiceWorker registration successful with scope: ",t.scope)}).catch(t=>{console.error("ServiceWorker registration failed: ",t)})})});n("#nocss .requestedStylesheets").html("Requested stylesheets:<br>"+[...document.querySelectorAll("link[rel=stylesheet")].map(e=>e.href).filter(e=>/\/css\/style/gi.test(e)).join("<br>"));n("#nocss .requestedJs").html("Requested Javascript files:<br>"+[...document.querySelectorAll("script")].map(e=>e.src).filter(e=>/(\/js\/mon|\/js\/vendor)/gi.test(e)).join("<br>")+"<br><br>Client version:<br>"+ks.clientVersion);window.navigator.userAgent.toLowerCase().includes("mac")?n("#nocss .keys").html(`
    <span
      style="
        padding: 1rem;
        display: inline-block;
        border-radius: 1rem;
        background: #2c2e31;
        margin-top: 1rem;
        margin-bottom: 1rem;
      "
    >
      Cmd
    </span>
    +
    <span
      style="
        padding: 1rem;
        display: inline-block;
        border-radius: 1rem;
        background: #2c2e31;
      "
    >
      Shift
    </span>
    +
    <span
      style="
        padding: 1rem;
        display: inline-block;
        border-radius: 1rem;
        background: #2c2e31;
      "
    >
      R
    </span>
  `):n("#nocss .keys").html(`
    <span
      style="
        padding: 1rem;
        display: inline-block;
        border-radius: 1rem;
        background: #2c2e31;
        margin-bottom: 1rem;
      "
    >
      Ctrl
    </span>
    +
    <span
      style="
        padding: 1rem;
        display: inline-block;
        border-radius: 1rem;
        background: #2c2e31;
      "
    >
      Shift
    </span>
    +
    <span
      style="
        padding: 1rem;
        display: inline-block;
        border-radius: 1rem;
        background: #2c2e31;
      "
    >
      R
    </span>
  `);let jo;async function zC(e=r.language){if(!jo)return;const a=(await ai(e)).bcp47??"en-US";jo.lang=a}async function HC(){jo=new SpeechSynthesisUtterance,await zC()}function wA(){jo=void 0}async function CA(e){window.speechSynthesis.cancel(),jo===void 0&&await HC(),jo!==void 0&&(jo.text=e,window.speechSynthesis.speak(jo))}ge((e,t)=>{e==="funbox"&&(t==="none"?wA():t==="tts"&&HC()),e==="language"&&r.funbox.includes("tts")&&zC()});Ex(e=>{CA(e)});const Os=new _m(n(".page.pageProfileSearch .search input"),{notFound:{icon:"fa-user-slash",level:-1},error:{icon:"fa-times",level:-1},checking:{icon:"fa-circle-notch",spinIcon:!0,level:1}});function kA(){n(".page.pageProfileSearch .search button").addClass("disabled"),n(".page.pageProfileSearch .search input").attr("disabled","disabled")}function SA(){n(".page.pageProfileSearch .search button").removeClass("disabled"),n(".page.pageProfileSearch .search input").removeAttr("disabled")}function xA(){return n(".page.pageProfileSearch .search input").attr("disabled")!==void 0}function Lb(){n(".page.pageProfileSearch .search input").trigger("focus")}async function TA(){Os.hide();const e=n(".page.pageProfileSearch .search input").val();if(e==="")return;Os.show("checking"),kA(),await ke(500);const t=await T.users.getProfile({params:{uidOrName:e}});if(SA(),t.status===404){Lb(),Os.show("notFound","User not found");return}else if(t.status!==200){Lb(),Os.show("error",`Error: ${t.body.message}`);return}Os.hide(),await Ie(`/profile/${e}`,{data:t.body.data})}n(".page.pageProfileSearch form").on("submit",e=>{e.preventDefault(),!xA()&&TA()});Nt("pageProfileSearch");const OC=new pt({key:"lastSeenVersion",schema:q.string(),fallback:""});let fp=null,od=null;function LA(e){OC.set(e)}function $A(){return OC.get()}async function MA(){const{data:e,error:t}=await Wt(ux());if(t){const o=ie(t,"Failed to fetch version number from GitHub");console.error(o);return}const a=$A();fp=e,od=a===""?!1:a!==e,(od||a==="")&&(LA(e),AA())}function AA(){"caches"in window&&caches.keys().then(function(e){for(const t of e)caches.delete(t)})}async function _A(){return(fp===null||od===null)&&await MA(),{version:fp,isNew:od}}function EA(e){n("footer .currentVersion .text").text(e)}function qA(e){e?n("#newVersionIndicator").removeClass("hidden"):n("#newVersionIndicator").addClass("hidden")}async function IA(){const{version:e,isNew:t}=await _A();EA(e),qA(t)}Nt("devOptionsModal");let la=[],NC=0,Ga=[],yo=[];const Zo={notifications:[],psas:[]};function Eu(){pp(!1),NS(0),VC.hide({afterAnimation:async()=>{n("#alertsPopup .notificationHistory .list").empty(),n("#alertsPopup .psas .list").empty();const e=[];let t=0;if(Ga.length===0&&yo.length===0)return;const a=await T.users.updateInbox({body:{mailIdsToMarkRead:Ga.length>0?Ga:void 0,mailIdsToDelete:yo.length>0?yo:void 0}}),o=a.status,i=a.body.message;if(o!==200){f(`Failed to update inbox: ${i}`,-1);return}const s=la.filter(l=>l.rewards.length>0&&Ga.includes(l.id)).map(l=>l.rewards).reduce(function(l,c){return l.concat(c)},[]);for(const l of s)if(l.type==="xp")t+=l.item;else if(l.type==="badge"){const c=A7(l.item.id);c&&(e.push(c.name),US(l.item))}if(e.length>0&&f(`New badge${e.length>1?"s":""} unlocked: ${e.join(", ")}`,1,{duration:5,customTitle:"Reward",customIcon:"gift"}),t>0){const l=S()?.xp??0;$y(l,t);const c=X();(c==="account"||c==="profile")&&Tw(c,l+t,!0),OS(t)}}})}async function FA(){VC.show({beforeAnimation:async()=>{A()?(n("#alertsPopup .accountAlerts").removeClass("hidden"),n("#alertsPopup .separator.accountSeparator").removeClass("hidden"),n("#alertsPopup .accountAlerts .list").html(`
          <div class="preloader"><i class="fas fa-fw fa-spin fa-circle-notch"></i></div>`)):(n("#alertsPopup .accountAlerts").addClass("hidden"),n("#alertsPopup .separator.accountSeparator").addClass("hidden")),la=[],yo=[],Ga=[],DA(),RA()},afterAnimation:async()=>{A()&&PA()}})}async function PA(){if(!Xe()){n("#alertsPopup .accountAlerts .list").html(`
    <div class="nothing">
    You are offline
    </div>
    `);return}const e=await T.users.getInbox();if(e.status===503){n("#alertsPopup .accountAlerts .list").html(`
    <div class="nothing">
    Account inboxes are temporarily unavailable
    </div>
    `);return}else if(e.status!==200){n("#alertsPopup .accountAlerts .list").html(`
    <div class="nothing">
    Error getting inbox: ${e.body.message} Please try again later
    </div>
    `);return}const t=e.body.data;if(la=t.inbox,kg(),la.length===0){n("#alertsPopup .accountAlerts .list").html(`
    <div class="nothing">
    Nothing to show
    </div>
    `);return}NC=t.maxMail,UC(),n("#alertsPopup .accountAlerts .list").empty();for(const a of la){!a.read&&a.rewards.length===0&&Ga.push(a.id);let o="";a.rewards.length>0&&!a.read&&(o=`<div class="rewards">
        <i class="fas fa-fw fa-gift"></i>
        <span>${a.rewards.length}</span>
      </div>`),n("#alertsPopup .accountAlerts .list").append(`
    
      <div class="item" data-id="${a.id}">
        <div class="indicator ${a.read?"":"main"}"></div>
        <div class="timestamp">${Vb(new Date(a.timestamp))} ago</div>
        <div class="title">${a.subject}</div>
        <div class="body">
          ${a.body}

${o}
        </div>
        <div class="buttons">
          ${a.rewards.length>0&&!a.read?'<button class="markReadAlert textButton" aria-label="Claim" data-balloon-pos="left"><i class="fas fa-gift"></i></button>':""}
          ${a.rewards.length>0&&a.read||a.rewards.length===0?'<button class="deleteAlert textButton" aria-label="Delete" data-balloon-pos="left"><i class="fas fa-trash"></i></button>':""}
        </div>
      </div>
    
    `)}}function BA(e,t){Zo.psas.push({message:e,level:t})}function RA(){if(Zo.psas.length===0)n("#alertsPopup .psas .list").html('<div class="nothing">Nothing to show</div>');else{n("#alertsPopup .psas .list").empty();for(const e of Zo.psas){const{message:t,level:a}=e;let o="";a===-1?o="error":a===1?o="main":a===0&&(o="sub"),n("#alertsPopup .psas .list").prepend(`
        <div class="item">
        <div class="indicator ${o}"></div>
        <div class="body">
          ${lt(t)}
        </div>
      </div>
      `)}}}function DA(){if(Zo.notifications.length===0)n("#alertsPopup .notificationHistory .list").html('<div class="nothing">Nothing to show</div>');else{n("#alertsPopup .notificationHistory .list").empty();for(const e of Zo.notifications){const{message:t,level:a,customTitle:o}=e;let i="Notice",s="sub";a===-1?(s="error",i="Error"):a===1&&(s="main",i="Success"),o!==void 0&&(i=o),n("#alertsPopup .notificationHistory .list").prepend(`
      <div class="item">
      <div class="indicator ${s}"></div>
      <div class="title">${i}</div>
      <div class="body">
        ${lt(t)}
      </div>
    </div>
    `)}}}function pp(e){e?n("header nav .showAlerts .notificationBubble").removeClass("hidden"):n("header nav .showAlerts .notificationBubble").addClass("hidden")}function UC(){const e=la.length-yo.length;n("#alertsPopup .accountAlerts .title .right").text(`${e}/${NC}`)}function $b(e){yo.push(e),n(`#alertsPopup .accountAlerts .list .item[data-id="${e}"]`).remove(),n("#alertsPopup .accountAlerts .list .item").length===0&&n("#alertsPopup .accountAlerts .list").html(`
    <div class="nothing">
    Nothing to show
    </div>
    `),kg(),UC()}function Mb(e){Ga.push(e);const t=n(`#alertsPopup .accountAlerts .list .item[data-id="${e}"]`);kg(),t.find(".indicator").removeClass("main"),t.find(".buttons").empty(),t.find(".buttons").append('<button class="deleteAlert textButton" aria-label="Delete" data-balloon-pos="left"><i class="fas fa-trash"></i></button>'),W(t.find(".rewards")[0],{opacity:0,height:0,marginTop:0,duration:250,onComplete:()=>{t.find(".rewards").remove()}})}function kg(){const e=n("#alertsPopup .accountAlerts .claimAll"),t=n("#alertsPopup .accountAlerts .deleteAll");if(e.addClass("hidden"),t.addClass("hidden"),la.length>0){let a=0;for(const o of la)!o.read&&!Ga.includes(o.id)&&(a+=o.rewards.length);a>0?e.removeClass("hidden"):t.removeClass("hidden")}yo.length===la.length&&t.addClass("hidden")}n("header nav .showAlerts").on("click",()=>{FA()});K2((e,t,a)=>{Zo.notifications.push({message:e,level:t,customTitle:a}),Zo.notifications.length>25&&Zo.notifications.shift()});qa(e=>{if(e.type==="snapshotUpdated"&&e.data.isInitial){const t=S();pp((t?.inboxUnreadSize??0)>0)}e.type==="authStateChanged"&&!e.data.isUserSignedIn&&(pp(!1),la=[],Ga=[],yo=[],n("#alertsPopup .accountAlerts .list").empty())});const VC=new re({dialogId:"alertsPopup",customAnimations:{show:{modal:{marginRight:["-10rem","0"]}},hide:{modal:{marginRight:["0","-10rem"]}}},customEscapeHandler:()=>{Eu()},customWrapperClickHandler:()=>{Eu()},setup:async()=>{n("#alertsPopup .accountAlerts").on("click",".claimAll",()=>{for(const e of la)!e.read&&!Ga.includes(e.id)&&Mb(e.id)}),n("#alertsPopup .accountAlerts").on("click",".deleteAll",()=>{for(const e of la)yo.includes(e.id)||$b(e.id)}),n("#alertsPopup .mobileClose").on("click",()=>{Eu()}),n("#alertsPopup .accountAlerts .list").on("click",".item .buttons .deleteAlert",e=>{const t=n(e.currentTarget).closest(".item").attr("data-id");$b(t)}),n("#alertsPopup .accountAlerts .list").on("click",".item .buttons .markReadAlert",e=>{const t=n(e.currentTarget).closest(".item").attr("data-id");Mb(t)})}}),Sg=new pt({key:"confirmedPSAs",schema:q.array(zb),fallback:[]});function WA(){Sg.set([])}function KC(){return Sg.get()}function zA(e){const t=KC();t.push(e),Sg.set(t)}async function HA(){const e=await T.psas.get();if(e.status===500){{const{data:t,error:a}=await Wt(fetch("https://monkeytype.instatus.com/summary.json"));let o;a?console.log("Failed to fetch Instatus summary",a):o=(await t.json()).activeMaintenances,o!==void 0&&o.length>0&&o[0]!==void 0&&o[0].status==="INPROGRESS"?qi(`Server is currently offline for scheduled maintenance. <a target= '_blank' href='${o[0].url}'>Check the status page</a> for more info.`,-1,"bullhorn",!0,void 0,!0):qi("Looks like the server is experiencing unexpected down time.<br>Check the <a target= '_blank' href='https://monkeytype.instatus.com/'>status page</a> for more information.",-1,"exclamation-triangle",!1,void 0,!0)}return null}else{if(e.status===503)return qi("Server is currently under maintenance. <a target= '_blank' href='https://monkeytype.instatus.com/'>Check the status page</a> for more info.",-1,"bullhorn",!0,void 0,!0),null;if(e.status!==200)return null}return e.body.data}async function OA(){const e=await HA();if(e===null)return;if(e.length===0){WA();return}const t=KC();e.forEach(a=>{if(fe(a.date)){const o=new Date(a.date),i=a.date-Date.now(),s=Ye(i/1e3,!1,!1,"text",!1,!0);a.message=a.message.replace("{dateDifference}",s),a.message=a.message.replace("{dateNoTime}",J(o,"dd MMM yyyy")),a.message=a.message.replace("{date}",J(o,"dd MMM yyyy HH:mm"))}BA(a.message,a.level??-1),!(t.includes(a._id)&&!(a.sticky??!1))&&qi(a.message,a.level,"bullhorn",a.sticky,()=>{zA(a._id)},!0)})}qa(e=>{e.type==="authStateChanged"&&OA()});async function NA(e){if(!e)return;const t=new URLSearchParams(e.slice(1));if(t.has("access_token")){history.replaceState(null,"","/");const a=t.get("access_token"),o=t.get("token_type"),i=t.get("state");Z();const s=await T.users.linkDiscord({body:{tokenType:o,accessToken:a,state:i}});if(N(),s.status!==200){f("Failed to link Discord: "+s.body.message,-1);return}if(s.body.data===null){f("Failed to link Discord: data returned was null",-1);return}f(s.body.message,1);const l=S();if(!l)return;const{discordId:c,discordAvatar:d}=s.body.data;c!==void 0&&(l.discordId=c),d!==void 0&&(l.discordAvatar=d),at(l),Wu(l)}}const UA=q.object({c:Pk,i:q.string().optional(),s:Fk.optional(),f:Ik.optional()});function VA(e){const t=mp("customTheme",e);if(t===null)return;const{data:a,error:o}=nd(()=>Cs(atob(t),UA));if(o){console.log("Custom theme URL decoding failed",o),f("Failed to load theme from URL: "+o.message,0);return}let i,s,l,c;if(Array.isArray(a.c)&&a.c.length===10?(i=a.c,s=a.i,l=a.s,c=a.f):Array.isArray(a)&&a.length===10&&(i=a),i===void 0||i.length!==10){f("Failed to load theme from URL: no colors found",0);return}const d=r.customTheme,u=r.customThemeColors;try{Xn(i),f("Custom theme applied",1),s!==void 0&&l!==void 0&&c!==void 0&&(y3(s),Wy(l),_n(c)),r.customTheme||mo(!0)}catch(p){f("Something went wrong. Reverting to previous state.",0),console.error(p),mo(d),Xn(u)}}const KA=q.tuple([Ob.nullable(),Bk.nullable(),a0.partial({pipeDelimiter:!0,limit:!0,mode:!0}).extend({isTimeRandom:q.boolean().optional(),isWordRandom:q.boolean().optional(),word:q.number().int().optional(),time:q.number().int().optional(),delimiter:q.string().optional()}).nullable(),q.boolean().nullable(),q.boolean().nullable(),q.string().nullable(),Rk.nullable(),Db.or(q.string().nullable())]);function jA(e){const t=mp("testSettings",e);if(t===null)return;const{data:a,error:o}=nd(()=>Cs(Yb.decompressFromURI(t)??"",KA));if(o){console.error("Failed to parse test settings:",o),f("Failed to load test settings from URL: "+o.message,0);return}const i={};a[0]!==null&&(rt(a[0],!0),i.mode=a[0]);const s=a[0]??r.mode;if(a[1]!==null&&(s==="time"?uo(parseInt(a[1],10),!0):s==="words"?Oi(parseInt(a[1],10),!0):s==="quote"&&(fd([-2],!1),Sp(parseInt(a[1],10)),te()),i.mode2=a[1]),a[2]!==null){const c=a[2];wo(c.text),ls(c.mode??"repeat"),c.limit!==void 0?(ya(c.limit.mode),Ua(c.limit.value)):(c.isWordRandom?ya("word"):c.isTimeRandom&&ya("time"),c.word!==void 0?Ua(c.word):c.time!==void 0&&Ua(c.time)),c.pipeDelimiter?Ui(c.pipeDelimiter):c.delimiter==="|"&&Ui(!0),i["custom text settings"]=""}if(a[3]!==null&&(ei(a[3],!0),i.punctuation=a[3]?"on":"off"),a[4]!==null&&(po(a[4],!0),i.numbers=a[4]?"on":"off"),a[5]!==null&&(Zn(a[5],!0),i.language=a[5]),a[6]!==null&&(no(a[6],!0),i.difficulty=a[6]),a[7]!==null){let c=[];typeof a[7]=="string"?c=a[7].split("#"):c=a[7],zo(c,!0),i.funbox=c.join(", ")}R({nosave:!0});let l="";Object.keys(i).forEach(c=>{const d=i[c];d!==void 0&&(l+=`${c}${lt(d?": "+d:"")}<br>`)}),l!==""&&f("Settings applied from URL:<br><br>"+l,1,{duration:10,allowHTML:!0})}function GA(e){const t=(mp("challenge",e)??"").toLowerCase();t!==""&&(f("Loading challenge",0),xv(t).then(a=>{a&&(f("Challenge loaded",1),R({nosave:!0}))}).catch(a=>{f("Failed to load challenge",-1),console.error(a)}))}qa(e=>{if(e.type==="authStateChanged"){const t=window.location.search,a=window.location.hash;VA(t),jA(t),GA(t),NA(a)}});async function QA(e){const t=ga;if(t===null)return;z9(e);const a=await T.results.add({body:{result:t}});if(a.status!==200){f("Failed to save last result: "+a.body.message,-1);return}const o=structuredClone(t),i={xp:a.body.data.xp,streak:a.body.data.streak,result:o,isPb:a.body.data.isPb};o._id=a.body.data.insertedId,a.body.data.isPb&&(o.isPb=!0),ky(i),Zv(),f(`Last test result saved ${a.body.data.isPb?"(new pb!)":""}`,1)}function YA(){Wr.getModal().querySelector(".result").innerHTML=`
  <div class="group wpm">
        <div class="sub">wpm</div>
        <div class="val">-</div>
      </div>
      <div class="group acc">
        <div class="sub">accuracy</div>
        <div class="val">-</div>
      </div>
      <div class="group raw">
        <div class="sub">raw</div>
        <div class="val">-</div>
      </div>
      <div class="group con">
        <div class="sub">consistency</div>
        <div class="val">-</div>
      </div>
      <div class="group chardata">
        <div class="sub">characters</div>
        <div class="val">-</div>
      </div>
      <div class="group testType">
        <div class="sub">test type</div>
        <div class="val">-</div>
      </div>`}function JA(){const e=ga;kn("wpm",e.wpm),kn("acc",e.acc+"%"),kn("raw",e.rawWpm),kn("con",e.consistency+"%"),kn("chardata",e.charStats.join("/"));let t=e.mode+" "+e.mode2;t+="<br>"+e.language,e.numbers&&(t+="<br>numbers"),e.punctuation&&(t+="<br>punctuation"),e.blindMode&&(t+="<br>blind"),e.lazyMode&&(t+="<br>lazy"),e.funbox.length>0&&(t+="<br>"+e.funbox.map(a=>a.replace(/_/g," ")).join(",")),e.difficulty!=="normal"&&(t+="<br>"+e.difficulty),e.tags.length>0&&(t+="<br>"+e.tags.length+" tags"),kn("testType",t,!0)}function kn(e,t,a=!1){a?n(Wr.getModal()).find(`.group.${e} .val`).html(`${t}`):n(Wr.getModal()).find(`.group.${e} .val`).text(t)}function XA(){if(!ga){f("Failed to show last signed out result modal: no last result",-1);return}Wr.show({beforeAnimation:async()=>{YA(),JA()}})}function Ab(){Wr.hide()}qa(e=>{e.type==="snapshotUpdated"&&e.data.isInitial&&ga!==null&&XA()});const Wr=new re({dialogId:"lastSignedOutResult",setup:async e=>{e.querySelector("button.save")?.addEventListener("click",async()=>{const t=tt();t!==null&&QA(t.uid),Ab()}),e.querySelector("button.discard")?.addEventListener("click",()=>{Zv(),f("Last test result discarded",0),Ab()})},customWrapperClickHandler:()=>{}});Object.defineProperty(Math,"random",{value:Math.random,writable:!1,configurable:!1,enumerable:!0});Object.freeze(Math);Object.defineProperty(window,"Math",{value:Math,writable:!1,configurable:!1,enumerable:!0});bv();k3();IA();_a(!0,!0);oS(L1);const ZA=pg();ZA===null?kC():CC();pk({snapshot:S,config:r,toggleFilterDebug:z7,glarsesMode:_8,stats:z0,replay:G6,enableTimerDebug:I6,getTimerStats:N6,toggleSmoothedBurst:W8,egVideoListener:L$,toggleDebugLogs:uA,toggleSentryDebug:YS});
//# sourceMappingURL=monkeytype.BDbsTsS3.js.map
